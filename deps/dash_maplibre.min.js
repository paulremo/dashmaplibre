/*! For license information please see dash_maplibre.min.js.LICENSE.txt */
(()=>{var e={216:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},557:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},1113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1234:()=>{},1354:e=>{"use strict";e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),a="/*# ".concat(i," */");return[t].concat([a]).join("\n")}return[t].join("\n")}},1413:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z%27/%3E%3C/svg%3E"},1880:e=>{e.exports=function e(t,r){"use strict";var n,i,a=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,u=/^0/,c=function(t){return e.insensitive&&(""+t).toLowerCase()||""+t},h=c(t).replace(o,"")||"",p=c(r).replace(o,"")||"",d=h.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),f=p.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(h.match(l),16)||1!==d.length&&h.match(s)&&Date.parse(h),g=parseInt(p.match(l),16)||m&&p.match(s)&&Date.parse(p)||null;if(g){if(m<g)return-1;if(m>g)return 1}for(var y=0,v=Math.max(d.length,f.length);y<v;y++){if(n=!(d[y]||"").match(u)&&parseFloat(d[y])||d[y]||0,i=!(f[y]||"").match(u)&&parseFloat(f[y])||f[y]||0,isNaN(n)!==isNaN(i))return isNaN(n)?1:-1;if(typeof n!=typeof i&&(n+="",i+=""),n<i)return-1;if(n>i)return 1}return 0}},1907:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},2228:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%2333b5e5%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},2353:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27none%27 stroke=%27%2333b5e5%27 viewBox=%270 0 22 22%27%3E%3Ccircle cx=%2711%27 cy=%2711%27 r=%278.5%27/%3E%3Cpath d=%27M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z%27/%3E%3Cpath d=%27M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z%27/%3E%3Cpath d=%27M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z%27/%3E%3C/svg%3E"},2369:function(e){e.exports=function(){"use strict";function e(){return!0}function t(){return!1}function r(){}const n="Argument is not a typed-function.";return function i(){function a(e){return"object"==typeof e&&null!==e&&e.constructor===Object}const o=[{name:"number",test:function(e){return"number"==typeof e}},{name:"string",test:function(e){return"string"==typeof e}},{name:"boolean",test:function(e){return"boolean"==typeof e}},{name:"Function",test:function(e){return"function"==typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:a},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],s={name:"any",test:e,isAny:!0};let l,u,c=0,h={createCount:0};function p(e){const t=l.get(e);if(t)return t;let r='Unknown type "'+e+'"';const n=e.toLowerCase();let i;for(i of u)if(i.toLowerCase()===n){r+='. Did you mean "'+i+'" ?';break}throw new TypeError(r)}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";const r=t?p(t).index:u.length,n=[];for(let t=0;t<e.length;++t){if(!e[t]||"string"!=typeof e[t].name||"function"!=typeof e[t].test)throw new TypeError("Object with properties {name: string, test: function} expected");const i=e[t].name;if(l.has(i))throw new TypeError('Duplicate type name "'+i+'"');n.push(i),l.set(i,{name:i,test:e[t].test,isAny:e[t].isAny,index:r+t,conversionsTo:[]})}const i=u.slice(r);u=u.slice(0,r).concat(n).concat(i);for(let e=r+n.length;e<u.length;++e)l.get(u[e]).index=e}function f(){l=new Map,u=[],c=0,d([s],!1)}function m(e){const t=u.filter((t=>{const r=l.get(t);return!r.isAny&&r.test(e)}));return t.length?t:["any"]}function g(e){return e&&"function"==typeof e&&"_typedFunctionData"in e}function y(e,t,r){if(!g(e))throw new TypeError(n);const i=r&&r.exact,a=w(Array.isArray(t)?t.join(","):t),o=v(a);if(!i||o in e.signatures){const t=e._typedFunctionData.signatureMap.get(o);if(t)return t}const s=a.length;let l,u;if(i){let t;for(t in l=[],e.signatures)l.push(e._typedFunctionData.signatureMap.get(t))}else l=e._typedFunctionData.signatures;for(let e=0;e<s;++e){const t=a[e],r=[];let n;for(n of l){const i=M(n.params,e);if(i&&(!t.restParam||i.restParam)){if(!i.hasAny){const e=b(i);if(t.types.some((t=>!e.has(t.name))))continue}r.push(n)}}if(l=r,0===l.length)break}for(u of l)if(u.params.length<=s)return u;throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+v(a,", ")+"))")}function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.map((e=>e.name)).join(t)}function x(e){const t=0===e.indexOf("..."),r=(t?e.length>3?e.slice(3):"any":e).split("|").map((e=>p(e.trim())));let n=!1,i=t?"...":"";return{types:r.map((function(e){return n=e.isAny||n,i+=e.name+"|",{name:e.name,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:null,conversionIndex:-1}})),name:i.slice(0,-1),hasAny:n,hasConversion:!1,restParam:t}}function _(e){const t=function(e){if(0===e.length)return[];const t=e.map(p);e.length>1&&t.sort(((e,t)=>e.index-t.index));let r=t[0].conversionsTo;if(1===e.length)return r;r=r.concat([]);const n=new Set(e);for(let e=1;e<t.length;++e){let i;for(i of t[e].conversionsTo)n.has(i.from)||(r.push(i),n.add(i.from))}return r}(e.types.map((e=>e.name)));let r=e.hasAny,n=e.name;const i=t.map((function(e){const t=p(e.from);return r=t.isAny||r,n+="|"+e.from,{name:e.from,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:e,conversionIndex:e.index}}));return{types:e.types.concat(i),name:n,hasAny:r,hasConversion:i.length>0,restParam:e.restParam}}function b(e){return e.typeSet||(e.typeSet=new Set,e.types.forEach((t=>e.typeSet.add(t.name)))),e.typeSet}function w(e){const t=[];if("string"!=typeof e)throw new TypeError("Signatures must be strings");const r=e.trim();if(""===r)return t;const n=r.split(",");for(let e=0;e<n.length;++e){const r=x(n[e].trim());if(r.restParam&&e!==n.length-1)throw new SyntaxError('Unexpected rest parameter "'+n[e]+'": only allowed for the last parameter');if(0===r.types.length)return null;t.push(r)}return t}function A(e){const t=Z(e);return!!t&&t.restParam}function C(t){if(t&&0!==t.types.length){if(1===t.types.length)return p(t.types[0].name).test;if(2===t.types.length){const e=p(t.types[0].name).test,r=p(t.types[1].name).test;return function(t){return e(t)||r(t)}}{const e=t.types.map((function(e){return p(e.name).test}));return function(t){for(let r=0;r<e.length;r++)if(e[r](t))return!0;return!1}}}return e}function E(e){let t,r,n;if(A(e)){t=V(e).map(C);const r=t.length,n=C(Z(e)),i=function(e){for(let t=r;t<e.length;t++)if(!n(e[t]))return!1;return!0};return function(e){for(let r=0;r<t.length;r++)if(!t[r](e[r]))return!1;return i(e)&&e.length>=r+1}}return 0===e.length?function(e){return 0===e.length}:1===e.length?(r=C(e[0]),function(e){return r(e[0])&&1===e.length}):2===e.length?(r=C(e[0]),n=C(e[1]),function(e){return r(e[0])&&n(e[1])&&2===e.length}):(t=e.map(C),function(e){for(let r=0;r<t.length;r++)if(!t[r](e[r]))return!1;return e.length===t.length})}function M(e,t){return t<e.length?e[t]:A(e)?Z(e):null}function S(e,t){const r=M(e,t);return r?b(r):new Set}function D(e){return null===e.conversion||void 0===e.conversion}function T(e,t){const r=new Set;return e.forEach((e=>{const n=S(e.params,t);let i;for(i of n)r.add(i)})),r.has("any")?["any"]:Array.from(r)}function N(e,t,r){let n,i;const a=e||"unnamed";let o,s=r;for(o=0;o<t.length;o++){const e=[];if(s.forEach((r=>{const n=C(M(r.params,o));(o<r.params.length||A(r.params))&&n(t[o])&&e.push(r)})),0===e.length){if(i=T(s,o),i.length>0){const e=m(t[o]);return n=new TypeError("Unexpected type of argument in function "+a+" (expected: "+i.join(" or ")+", actual: "+e.join(" | ")+", index: "+o+")"),n.data={category:"wrongType",fn:a,index:o,actual:e,expected:i},n}}else s=e}const l=s.map((function(e){return A(e.params)?1/0:e.params.length}));if(t.length<Math.min.apply(null,l))return i=T(s,o),n=new TypeError("Too few arguments in function "+a+" (expected: "+i.join(" or ")+", index: "+t.length+")"),n.data={category:"tooFewArgs",fn:a,index:t.length,expected:i},n;const u=Math.max.apply(null,l);if(t.length>u)return n=new TypeError("Too many arguments in function "+a+" (expected: "+u+", actual: "+t.length+")"),n.data={category:"tooManyArgs",fn:a,index:t.length,expectedLength:u},n;const c=[];for(let e=0;e<t.length;++e)c.push(m(t[e]).join("|"));return n=new TypeError('Arguments of type "'+c.join(", ")+'" do not match any of the defined signatures of function '+a+"."),n.data={category:"mismatch",actual:c},n}function I(e){let t=u.length+1;for(let r=0;r<e.types.length;r++)D(e.types[r])&&(t=Math.min(t,e.types[r].typeIndex));return t}function P(e){let t=c+1;for(let r=0;r<e.types.length;r++)D(e.types[r])||(t=Math.min(t,e.types[r].conversionIndex));return t}function z(e,t){if(e.hasAny){if(!t.hasAny)return 1}else if(t.hasAny)return-1;if(e.restParam){if(!t.restParam)return 1}else if(t.restParam)return-1;if(e.hasConversion){if(!t.hasConversion)return 1}else if(t.hasConversion)return-1;const r=I(e)-I(t);if(r<0)return-1;if(r>0)return 1;const n=P(e)-P(t);return n<0?-1:n>0?1:0}function B(e,t){const r=e.params,n=t.params,i=Z(r),a=Z(n),o=A(r),s=A(n);if(o&&i.hasAny){if(!s||!a.hasAny)return 1}else if(s&&a.hasAny)return-1;let l,u=0,c=0;for(l of r)l.hasAny&&++u,l.hasConversion&&++c;let h=0,p=0;for(l of n)l.hasAny&&++h,l.hasConversion&&++p;if(u!==h)return u-h;if(o&&i.hasConversion){if(!s||!a.hasConversion)return 1}else if(s&&a.hasConversion)return-1;if(c!==p)return c-p;if(o){if(!s)return 1}else if(s)return-1;const d=(r.length-n.length)*(o?-1:1);if(0!==d)return d;const f=[];let m,g=0;for(let e=0;e<r.length;++e){const t=z(r[e],n[e]);f.push(t),g+=t}if(0!==g)return g;for(m of f)if(0!==m)return m;return 0}function k(e,t){let r=t;if(e.some((e=>e.hasConversion))){const n=A(e),i=e.map(F);r=function(){const e=[],r=n?arguments.length-1:arguments.length;for(let t=0;t<r;t++)e[t]=i[t](arguments[t]);return n&&(e[r]=arguments[r].map(i[r])),t.apply(this,e)}}let n=r;if(A(e)){const t=e.length-1;n=function(){return r.apply(this,$(arguments,0,t).concat([$(arguments,t)]))}}return n}function F(e){let t,r,n,i;const a=[],o=[];switch(e.types.forEach((function(e){e.conversion&&(a.push(p(e.conversion.from).test),o.push(e.conversion.convert))})),o.length){case 0:return function(e){return e};case 1:return t=a[0],n=o[0],function(e){return t(e)?n(e):e};case 2:return t=a[0],r=a[1],n=o[0],i=o[1],function(e){return t(e)?n(e):r(e)?i(e):e};default:return function(e){for(let t=0;t<o.length;t++)if(a[t](e))return o[t](e);return e}}}function R(e){return function e(t,r,n){if(r<t.length){const o=t[r];let s=[];if(o.restParam){const e=o.types.filter(D);e.length<o.types.length&&s.push({types:e,name:"..."+e.map((e=>e.name)).join("|"),hasAny:e.some((e=>e.isAny)),hasConversion:!1,restParam:!0}),s.push(o)}else s=o.types.map((function(e){return{types:[e],name:e.name,hasAny:e.isAny,hasConversion:e.conversion,restParam:!1}}));return i=s,a=function(i){return e(t,r+1,n.concat([i]))},Array.prototype.concat.apply([],i.map(a))}var i,a;return[n]}(e,0,[])}function O(e,t){const r=Math.max(e.length,t.length);for(let n=0;n<r;n++){const r=S(e,n),i=S(t,n);let a,o=!1;for(a of i)if(r.has(a)){o=!0;break}if(!o)return!1}const n=e.length,i=t.length,a=A(e),o=A(t);return a?o?n===i:i>=n:o?n>=i:n===i}function L(e,t,r){const n=[];let i;for(i of e){let e=r[i];if("number"!=typeof e)throw new TypeError('No definition for referenced signature "'+i+'"');if(e=t[e],"function"!=typeof e)return!1;n.push(e)}return n}function q(e,t,r){const n=function(e){return e.map((e=>X(e)?H(e.referToSelf.callback):W(e)?G(e.referTo.references,e.referTo.callback):e))}(e),i=new Array(n.length).fill(!1);let a=!0;for(;a;){a=!1;let e=!0;for(let o=0;o<n.length;++o){if(i[o])continue;const s=n[o];if(X(s))n[o]=s.referToSelf.callback(r),n[o].referToSelf=s.referToSelf,i[o]=!0,e=!1;else if(W(s)){const r=L(s.referTo.references,n,t);r?(n[o]=s.referTo.callback.apply(this,r),n[o].referTo=s.referTo,i[o]=!0,e=!1):a=!0}}if(e&&a)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return n}function j(e,n){if(h.createCount++,0===Object.keys(n).length)throw new SyntaxError("No signatures provided");h.warnAgainstDeprecatedThis&&function(e){const t=/\bthis(\(|\.signatures\b)/;Object.keys(e).forEach((r=>{const n=e[r];if(t.test(n.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")}))}(n);const i=[],a=[],o={},s=[];let l;for(l in n){if(!Object.prototype.hasOwnProperty.call(n,l))continue;const e=w(l);if(!e)continue;i.forEach((function(t){if(O(t,e))throw new TypeError('Conflicting signatures "'+v(t)+'" and "'+v(e)+'".')})),i.push(e);const t=a.length;a.push(n[l]);const r=e.map(_);let u;for(u of R(r)){const e=v(u);s.push({params:u,name:e,fn:t}),u.every((e=>!e.hasConversion))&&(o[e]=t)}}s.sort(B);const u=q(a,o,se);let c;for(c in o)Object.prototype.hasOwnProperty.call(o,c)&&(o[c]=u[o[c]]);const p=[],d=new Map;for(c of s)d.has(c.name)||(c.fn=u[c.fn],p.push(c),d.set(c.name,c));const f=p[0]&&p[0].params.length<=2&&!A(p[0].params),m=p[1]&&p[1].params.length<=2&&!A(p[1].params),g=p[2]&&p[2].params.length<=2&&!A(p[2].params),y=p[3]&&p[3].params.length<=2&&!A(p[3].params),x=p[4]&&p[4].params.length<=2&&!A(p[4].params),b=p[5]&&p[5].params.length<=2&&!A(p[5].params),M=f&&m&&g&&y&&x&&b;for(let e=0;e<p.length;++e)p[e].test=E(p[e].params);const S=f?C(p[0].params[0]):t,D=m?C(p[1].params[0]):t,T=g?C(p[2].params[0]):t,N=y?C(p[3].params[0]):t,I=x?C(p[4].params[0]):t,P=b?C(p[5].params[0]):t,z=f?C(p[0].params[1]):t,F=m?C(p[1].params[1]):t,L=g?C(p[2].params[1]):t,j=y?C(p[3].params[1]):t,U=x?C(p[4].params[1]):t,V=b?C(p[5].params[1]):t;for(let e=0;e<p.length;++e)p[e].implementation=k(p[e].params,p[e].fn);const Z=f?p[0].implementation:r,$=m?p[1].implementation:r,G=g?p[2].implementation:r,H=y?p[3].implementation:r,W=x?p[4].implementation:r,X=b?p[5].implementation:r,Y=f?p[0].params.length:-1,K=m?p[1].params.length:-1,J=g?p[2].params.length:-1,Q=y?p[3].params.length:-1,ee=x?p[4].params.length:-1,te=b?p[5].params.length:-1,re=M?6:0,ne=p.length,ie=p.map((e=>e.test)),ae=p.map((e=>e.implementation)),oe=function(){for(let e=re;e<ne;e++)if(ie[e](arguments))return ae[e].apply(this,arguments);return h.onMismatch(e,arguments,p)};function se(e,t){return arguments.length===Y&&S(e)&&z(t)?Z.apply(this,arguments):arguments.length===K&&D(e)&&F(t)?$.apply(this,arguments):arguments.length===J&&T(e)&&L(t)?G.apply(this,arguments):arguments.length===Q&&N(e)&&j(t)?H.apply(this,arguments):arguments.length===ee&&I(e)&&U(t)?W.apply(this,arguments):arguments.length===te&&P(e)&&V(t)?X.apply(this,arguments):oe.apply(this,arguments)}try{Object.defineProperty(se,"name",{value:e})}catch(e){}return se.signatures=o,se._typedFunctionData={signatures:p,signatureMap:d},se}function U(e,t,r){throw N(e,t,r)}function V(e){return $(e,0,e.length-1)}function Z(e){return e[e.length-1]}function $(e,t,r){return Array.prototype.slice.call(e,t,r)}function G(e,t){return{referTo:{references:e,callback:t}}}function H(e){if("function"!=typeof e)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:e}}}function W(e){return e&&"object"==typeof e.referTo&&Array.isArray(e.referTo.references)&&"function"==typeof e.referTo.callback}function X(e){return e&&"object"==typeof e.referToSelf&&"function"==typeof e.referToSelf.callback}function Y(e,t){if(!e)return t;if(t&&t!==e){const r=new Error("Function names do not match (expected: "+e+", actual: "+t+")");throw r.data={actual:t,expected:e},r}return e}function K(e){let t;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(g(e[r])||"string"==typeof e[r].signature)&&(t=Y(t,e[r].name));return t}function J(e,t){let r;for(r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(r in e&&t[r]!==e[r]){const n=new Error('Signature "'+r+'" is defined twice');throw n.data={signature:r,sourceFunction:t[r],destFunction:e[r]},n}e[r]=t[r]}}f(),d(o);const Q=h;function ee(e){if(!e||"string"!=typeof e.from||"string"!=typeof e.to||"function"!=typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(e.to===e.from)throw new SyntaxError('Illegal to define conversion from "'+e.from+'" to itself.')}return h=function(e){const t="string"==typeof e;let r=t?e:"";const n={};for(let e=t?1:0;e<arguments.length;++e){const i=arguments[e];let o,s={};if("function"==typeof i?(o=i.name,"string"==typeof i.signature?s[i.signature]=i:g(i)&&(s=i.signatures)):a(i)&&(s=i,t||(o=K(i))),0===Object.keys(s).length){const t=new TypeError("Argument to 'typed' at index "+e+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw t.data={index:e,argument:i},t}t||(r=Y(r,o)),J(n,s)}return j(r||"",n)},h.create=i,h.createCount=Q.createCount,h.onMismatch=U,h.throwMismatchError=U,h.createError=N,h.clear=f,h.clearConversions=function(){let e;for(e of u)l.get(e).conversionsTo=[];c=0},h.addTypes=d,h._findType=p,h.referTo=function(){const e=V(arguments).map((e=>v(w(e)))),t=Z(arguments);if("function"!=typeof t)throw new TypeError("Callback function expected as last argument");return G(e,t)},h.referToSelf=H,h.convert=function(e,t){const r=p(t);if(r.test(e))return e;const n=r.conversionsTo;if(0===n.length)throw new Error("There are no conversions to "+t+" defined.");for(let t=0;t<n.length;t++)if(p(n[t].from).test(e))return n[t].convert(e);throw new Error("Cannot convert "+e+" to "+t)},h.findSignature=y,h.find=function(e,t,r){return y(e,t,r).implementation},h.isTypedFunction=g,h.warnAgainstDeprecatedThis=!0,h.addType=function(e,t){let r="any";!1!==t&&l.has("Object")&&(r="Object"),h.addTypes([e],r)},h.addConversion=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{override:!1};ee(e);const r=p(e.to),n=r.conversionsTo.find((t=>t.from===e.from));if(n){if(!t||!t.override)throw new Error('There is already a conversion from "'+e.from+'" to "'+r.name+'"');h.removeConversion({from:n.from,to:e.to,convert:n.convert})}r.conversionsTo.push({from:e.from,convert:e.convert,index:c++})},h.addConversions=function(e,t){e.forEach((e=>h.addConversion(e,t)))},h.removeConversion=function(e){ee(e);const t=p(e.to),r=function(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return e[r]}(t.conversionsTo,(t=>t.from===e.from));if(!r)throw new Error("Attempt to remove nonexistent conversion from "+e.from+" to "+e.to);if(r.convert!==e.convert)throw new Error("Conversion to remove does not match existing conversion");const n=t.conversionsTo.indexOf(r);t.conversionsTo.splice(n,1)},h.resolve=function(e,t){if(!g(e))throw new TypeError(n);const r=e._typedFunctionData.signatures;for(let e=0;e<r.length;++e)if(r[e].test(t))return r[e];return null},h}()}()},3031:function(e,t,r){var n;!function(e,i){function a(e){var t=this,r="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),n==r.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var r=new a(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.xorwow=s}(0,e=r.nmd(e),r.amdD)},3144:e=>{"use strict";var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},n={"–":"\\--","—":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},i=function(e,r){return t({},e,r)};e.exports=function(e){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.preserveFormatting,s=void 0!==o&&o,l=a.escapeMapFn,u=void 0===l?i:l,c=String(e),h="",p=u(t({},r),s?t({},n):{}),d=Object.keys(p),f=function(){var e=!1;d.forEach((function(t,r){e||c.length>=t.length&&c.slice(0,t.length)===t&&(h+=p[d[r]],c=c.slice(t.length,c.length),e=!0)})),e||(h+=c.slice(0,1),c=c.slice(1,c.length))};c;)f();return h}},3181:function(e,t,r){var n;!function(e,i){function a(e){var t=this,r="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var r=new a(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.xor128=s}(0,e=r.nmd(e),r.amdD)},3363:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},3470:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},3490:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},3717:function(e,t,r){var n;!function(e,i){function a(e){var t=this,r="";t.next=function(){var e=t.b,r=t.c,n=t.d,i=t.a;return e=e<<25^e>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^r,t.c=r=r-n|0,t.d=n<<16^r>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):r+=e;for(var n=0;n<r.length+20;n++)t.b^=0|r.charCodeAt(n),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var r=new a(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.tychei=s}(0,e=r.nmd(e),r.amdD)},3737:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23666%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},3913:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},4417:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},4420:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},4643:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},4665:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},4801:function(e,t,r){var n;!function(i,a,o){var s,l=256,u=o.pow(l,6),c=o.pow(2,52),h=2*c,p=255;function d(e,t,r){var n=[],p=y(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(a)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(l):(e=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(e)),v(e)}catch(e){var t=i.navigator,r=t&&t.plugins;return[+new Date,i,r,i.screen,v(a)]}}():e,3),n),d=new f(n),x=function(){for(var e=d.g(6),t=u,r=0;e<c;)e=(e+r)*l,t*=l,r=d.g(1);for(;e>=h;)e/=2,t/=2,r>>>=1;return(e+r)/t};return x.int32=function(){return 0|d.g(4)},x.quick=function(){return d.g(4)/4294967296},x.double=x,y(v(d.S),a),(t.pass||r||function(e,t,r,n){return n&&(n.S&&m(n,d),e.state=function(){return m(d,{})}),r?(o.random=e,t):e})(x,p,"global"in t?t.global:this==o,t.state)}function f(e){var t,r=e.length,n=this,i=0,a=n.i=n.j=0,o=n.S=[];for(r||(e=[r++]);i<l;)o[i]=i++;for(i=0;i<l;i++)o[i]=o[a=p&a+e[i%r]+(t=o[i])],o[a]=t;(n.g=function(e){for(var t,r=0,i=n.i,a=n.j,o=n.S;e--;)t=o[i=p&i+1],r=r*l+o[p&(o[i]=o[a=p&a+t])+(o[a]=t)];return n.i=i,n.j=a,r})(l)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var r,n=[],i=typeof e;if(t&&"object"==i)for(r in e)try{n.push(g(e[r],t-1))}catch(e){}return n.length?n:"string"==i?e:e+"\0"}function y(e,t){for(var r,n=e+"",i=0;i<n.length;)t[p&i]=p&(r^=19*t[p&i])+n.charCodeAt(i++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(y(o.random(),a),e.exports){e.exports=d;try{s=r(1234)}catch(e){}}else void 0===(n=function(){return d}.call(t,r,t,e))||(e.exports=n)}("undefined"!=typeof self?self:this,[],Math)},4890:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},5056:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var a={},o=[],s=0;s<e.length;s++){var l=e[s],u=n.base?l[0]+n.base:l[0],c=a[u]||0,h="".concat(u," ").concat(c);a[u]=c+1;var p=r(h),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(d);else{var f=i(d,n);n.byIndex=s,t.splice(s,0,{identifier:h,updater:f,references:1})}o.push(h)}return o}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var a=n(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<a.length;o++){var s=r(a[o]);t[s].references--}for(var l=n(e,i),u=0;u<a.length;u++){var c=r(a[u]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}a=l}}},5446:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27%23333%27 viewBox=%270 0 22 22%27%3E%3Cpath d=%27m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0%27/%3E%3C/svg%3E"},5796:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23aaa%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},6117:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724%27 height=%2724%27 fill-rule=%27evenodd%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0%27/%3E%3C/svg%3E"},6311:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724%27 height=%2724%27 fill=%27%23fff%27 fill-rule=%27evenodd%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0%27/%3E%3C/svg%3E"},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,i,a){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(n)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);n&&o[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},6505:function(e){e.exports=function(){"use strict";var e={},t={};function r(r,n,i){if(t[r]=i,"index"===r){var a="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",o={};return t.shared(o),t.index(e,o),"undefined"!=typeof window&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))),e}}return r("shared",0,(function(e){function t(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n,i;function a(){if(i)return n;function e(e,t){this.x=e,this.y=t}return i=1,n=e,e.prototype={clone:function(){return new e(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=n,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-n*(this.y-t.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},e.convert=function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t},n}"function"==typeof SuppressedError&&SuppressedError;var o,s,l=r(a()),u=function(){if(s)return o;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return s=1,o=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=i/a}var o=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?o=r:s=r,r=.5*(s-o)+o;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},o}(),c=r(u);let h,p;function d(){return null==h&&(h="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),h}function f(){if(null==p&&(p=!1,d())){const e=5,t=new OffscreenCanvas(e,e).getContext("2d",{willReadFrequently:!0});if(t){for(let r=0;r<e*e;r++){const n=4*r;t.fillStyle=`rgb(${n},${n+1},${n+2})`,t.fillRect(r%e,Math.floor(r/e),1,1)}const r=t.getImageData(0,0,e,e).data;for(let t=0;t<e*e*4;t++)if(t%4!=3&&r[t]!==t){p=!0;break}}}return p||!1}var m=1e-6,g="undefined"!=typeof Float32Array?Float32Array:Array;function y(){var e=new g(9);return g!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function v(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function x(){var e=new g(3);return g!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function _(e){return Math.hypot(e[0],e[1],e[2])}function b(e,t,r){var n=new g(3);return n[0]=e,n[1]=t,n[2]=r,n}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var w,A=_;function C(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}function E(){var e=new g(4);return g!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function M(){var e=new g(2);return g!=Float32Array&&(e[0]=0,e[1]=0),e}function S(e,t){var r=new g(2);return r[0]=e,r[1]=t,r}x(),w=new g(4),g!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0,w[3]=0),x(),b(1,0,0),b(0,1,0),E(),E(),y(),M();const D=8192;function T(e,t,r){return t*(D/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}function N(e,t){return(e%t+t)%t}function I(e,t,r){return e*(1-r)+t*r}function P(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function z(e,t,r,n){const i=new c(e,t,r,n);return e=>i.solve(e)}const B=z(.25,.1,.25,1);function k(e,t,r){return Math.min(r,Math.max(t,e))}function F(e,t,r){const n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function R(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}let O=1;function L(e,t,r){const n={};for(const r in e)n[r]=t.call(this,e[r],r,e);return n}function q(e,t,r){const n={};for(const r in e)t.call(this,e[r],r,e)&&(n[r]=e[r]);return n}function j(e){return Array.isArray(e)?e.map(j):"object"==typeof e&&e?L(e,j):e}const U={};function V(e){U[e]||("undefined"!=typeof console&&console.warn(e),U[e]=!0)}function Z(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function $(e){return"undefined"!=typeof WorkerGlobalScope&&void 0!==e&&e instanceof WorkerGlobalScope}let G=null;function H(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}const W="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function X(e,r,n,i,a){return t(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const t=new VideoFrame(e,{timestamp:0});try{const o=null==t?void 0:t.format;if(!o||!o.startsWith("BGR")&&!o.startsWith("RGB"))throw new Error(`Unrecognized format ${o}`);const s=o.startsWith("BGR"),l=new Uint8ClampedArray(i*a*4);if(yield t.copyTo(l,function(e,t,r,n,i){const a=4*Math.max(1,0),o=(Math.max(0,r)-r)*n*4+a,s=4*n,l=Math.max(0,t),u=Math.max(0,r);return{rect:{x:l,y:u,width:Math.min(e.width,t+n)-l,height:Math.min(e.height,r+i)-u},layout:[{offset:o,stride:s}]}}(e,r,n,i,a)),s)for(let e=0;e<l.length;e+=4){const t=l[e];l[e]=l[e+2],l[e+2]=t}return l}finally{t.close()}}))}let Y,K;function J(e,t,r,n){return e.addEventListener(t,r,n),{unsubscribe:()=>{e.removeEventListener(t,r,n)}}}function Q(e){return e*Math.PI/180}function ee(e){return e/Math.PI*180}const te={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},re={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ne="AbortError";function ie(){return new Error(ne)}const ae={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function oe(e){return ae.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}const se="global-dispatcher";class le extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}}const ue=()=>$(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,ce=function(e,r){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){const t=oe(e.url);if(t)return t(e,r);if($(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:se},r)}if(!(/^file:/.test(n=e.url)||/^file:/.test(ue())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(e,r){return t(this,void 0,void 0,(function*(){const t=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:ue(),signal:r.signal});let n,i;"json"!==e.type||t.headers.has("Accept")||t.headers.set("Accept","application/json");try{n=yield fetch(t)}catch(t){throw new le(0,t.message,e.url,new Blob)}if(!n.ok){const t=yield n.blob();throw new le(n.status,n.statusText,e.url,t)}i="arrayBuffer"===e.type||"image"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text();const a=yield i;if(r.signal.aborted)throw ie();return{data:a,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}))}(e,r);if($(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:se},r)}var n;return function(e,t){return new Promise(((r,n)=>{var i;const a=new XMLHttpRequest;a.open(e.method||"GET",e.url,!0),"arrayBuffer"!==e.type&&"image"!==e.type||(a.responseType="arraybuffer");for(const t in e.headers)a.setRequestHeader(t,e.headers[t]);"json"===e.type&&(a.responseType="text",(null===(i=e.headers)||void 0===i?void 0:i.Accept)||a.setRequestHeader("Accept","application/json")),a.withCredentials="include"===e.credentials,a.onerror=()=>{n(new Error(a.statusText))},a.onload=()=>{if(!t.signal.aborted)if((a.status>=200&&a.status<300||0===a.status)&&null!==a.response){let t=a.response;if("json"===e.type)try{t=JSON.parse(a.response)}catch(e){return void n(e)}r({data:t,cacheControl:a.getResponseHeader("Cache-Control"),expires:a.getResponseHeader("Expires")})}else{const t=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});n(new le(a.status,a.statusText,e.url,t))}},t.signal.addEventListener("abort",(()=>{a.abort(),n(ie())})),a.send(e.body)}))}(e,r)};function he(e){if(!e||e.indexOf("://")<=0||0===e.indexOf("data:image/")||0===e.indexOf("blob:"))return!0;const t=new URL(e),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function pe(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function de(e,t,r){if(r&&r[e]){const n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}class fe{constructor(e,t={}){R(this,t),this.type=e}}class me extends fe{constructor(e,t={}){super("error",R({error:e},t))}}class ge{on(e,t){return this._listeners=this._listeners||{},pe(e,t,this._listeners),{unsubscribe:()=>{this.off(e,t)}}}off(e,t){return de(e,t,this._listeners),de(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},pe(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){"string"==typeof e&&(e=new fe(e,t||{}));const r=e.type;if(this.listens(r)){e.target=this;const t=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const r of t)r.call(this,e);const n=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const t of n)de(r,t,this._oneTimeListeners),t.call(this,e);const i=this._eventedParent;i&&(R(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(e))}else e instanceof me&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ve=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function xe(e,t){const r={};for(const t in e)"ref"!==t&&(r[t]=e[t]);return ve.forEach((e=>{e in t&&(r[e]=t[e])})),r}function _e(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!_e(e[r],t[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!_e(e[r],t[r]))return!1;return!0}return e===t}function be(e,t){e.push(t)}function we(e,t,r){be(r,{command:"addSource",args:[e,t[e]]})}function Ae(e,t,r){be(t,{command:"removeSource",args:[e]}),r[e]=!0}function Ce(e,t,r,n){Ae(e,r,n),we(e,t,r)}function Ee(e,t,r){let n;for(n in e[r])if(Object.prototype.hasOwnProperty.call(e[r],n)&&"data"!==n&&!_e(e[r][n],t[r][n]))return!1;for(n in t[r])if(Object.prototype.hasOwnProperty.call(t[r],n)&&"data"!==n&&!_e(e[r][n],t[r][n]))return!1;return!0}function Me(e,t,r,n,i,a){e=e||{},t=t||{};for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(_e(e[o],t[o])||r.push({command:a,args:[n,o,t[o],i]}));for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&!Object.prototype.hasOwnProperty.call(e,o)&&(_e(e[o],t[o])||r.push({command:a,args:[n,o,t[o],i]}))}function Se(e){return e.id}function De(e,t){return e[t.id]=t,e}class Te{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function Ne(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}class Ie extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class Pe{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[e,r]of t)this.bindings[e]=r}concat(e){return new Pe(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ze={kind:"null"},Be={kind:"number"},ke={kind:"string"},Fe={kind:"boolean"},Re={kind:"color"},Oe={kind:"projectionDefinition"},Le={kind:"object"},qe={kind:"value"},je={kind:"collator"},Ue={kind:"formatted"},Ve={kind:"padding"},Ze={kind:"colorArray"},$e={kind:"numberArray"},Ge={kind:"resolvedImage"},He={kind:"variableAnchorOffsetCollection"};function We(e,t){return{kind:"array",itemType:e,N:t}}function Xe(e){if("array"===e.kind){const t=Xe(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const Ye=[ze,Be,ke,Fe,Re,Oe,Ue,Le,We(qe),Ve,$e,Ze,Ge,He];function Ke(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Ke(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of Ye)if(!Ke(e,t))return null}return`Expected ${Xe(e)} but found ${Xe(t)} instead.`}function Je(e,t){return t.some((t=>t.kind===e.kind))}function Qe(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}function et(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const tt=.96422,rt=.82521,nt=4/29,it=6/29,at=3*it*it,ot=it*it*it,st=Math.PI/180,lt=180/Math.PI;function ut(e){return(e%=360)<0&&(e+=360),e}function ct([e,t,r,n]){let i,a;const o=pt((.2225045*(e=ht(e))+.7168786*(t=ht(t))+.0606169*(r=ht(r)))/1);e===t&&t===r?i=a=o:(i=pt((.4360747*e+.3850649*t+.1430804*r)/tt),a=pt((.0139322*e+.0971045*t+.7141733*r)/rt));const s=116*o-16;return[s<0?0:s,500*(i-o),200*(o-a),n]}function ht(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function pt(e){return e>ot?Math.pow(e,1/3):e/at+nt}function dt([e,t,r,n]){let i=(e+16)/116,a=isNaN(t)?i:i+t/500,o=isNaN(r)?i:i-r/200;return i=1*mt(i),a=tt*mt(a),o=rt*mt(o),[ft(3.1338561*a-1.6168667*i-.4906146*o),ft(-.9787684*a+1.9161415*i+.033454*o),ft(.0719453*a-.2289914*i+1.4052427*o),n]}function ft(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function mt(e){return e>it?e*e*e:at*(e-nt)}const gt=Object.hasOwn||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function yt(e,t){return gt(e,t)?e[t]:void 0}function vt(e){return parseInt(e.padEnd(2,e),16)/255}function xt(e,t){return _t(t?e/100:e,0,1)}function _t(e,t,r){return Math.min(Math.max(t,e),r)}function bt(e){return!e.some(Number.isNaN)}const wt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function At(e,t,r){return e+r*(t-e)}function Ct(e,t,r){return e.map(((e,n)=>At(e,t[n],r)))}class Et{constructor(e,t,r,n=1,i=!0){this.r=e,this.g=t,this.b=r,this.a=n,i||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,r,n]))}static parse(e){if(e instanceof Et)return e;if("string"!=typeof e)return;const t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];const t=yt(wt,e);if(t){const[e,r,n]=t;return[e/255,r/255,n/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const t=e.length<6?1:2;let r=1;return[vt(e.slice(r,r+=t)),vt(e.slice(r,r+=t)),vt(e.slice(r,r+=t)),vt(e.slice(r,r+t)||"ff")]}if(e.startsWith("rgb")){const t=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(t){const[e,r,n,i,a,o,s,l,u,c,h,p]=t,d=[i||" ",s||" ",c].join("");if("  "===d||"  /"===d||",,"===d||",,,"===d){const e=[n,o,u].join(""),t="%%%"===e?100:""===e?255:0;if(t){const e=[_t(+r/t,0,1),_t(+a/t,0,1),_t(+l/t,0,1),h?xt(+h,p):1];if(bt(e))return e}}return}}const r=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(r){const[e,t,n,i,a,o,s,l,u]=r,c=[n||" ",a||" ",s].join("");if("  "===c||"  /"===c||",,"===c||",,,"===c){const e=[+t,_t(+i,0,100),_t(+o,0,100),l?xt(+l,u):1];if(bt(e))return function([e,t,r,n]){function i(n){const i=(n+e/30)%12,a=t*Math.min(r,1-r);return r-a*Math.max(-1,Math.min(i-3,9-i,1))}return e=ut(e),t/=100,r/=100,[i(0),i(8),i(4),n]}(e)}}}(e);return t?new Et(...t,!1):void 0}get rgb(){const{r:e,g:t,b:r,a:n}=this,i=n||1/0;return this.overwriteGetter("rgb",[e/i,t/i,r/i,n])}get hcl(){return this.overwriteGetter("hcl",function(e){const[t,r,n,i]=ct(e),a=Math.sqrt(r*r+n*n);return[Math.round(1e4*a)?ut(Math.atan2(n,r)*lt):NaN,a,t,i]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ct(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map((e=>Math.round(255*e))).join(",")},${n})`}static interpolate(e,t,r,n="rgb"){switch(n){case"rgb":{const[n,i,a,o]=Ct(e.rgb,t.rgb,r);return new Et(n,i,a,o,!1)}case"hcl":{const[n,i,a,o]=e.hcl,[s,l,u,c]=t.hcl;let h,p;if(isNaN(n)||isNaN(s))isNaN(n)?isNaN(s)?h=NaN:(h=s,1!==a&&0!==a||(p=l)):(h=n,1!==u&&0!==u||(p=i));else{let e=s-n;s>n&&e>180?e-=360:s<n&&n-s>180&&(e+=360),h=n+r*e}const[d,f,m,g]=function([e,t,r,n]){return e=isNaN(e)?0:e*st,dt([r,Math.cos(e)*t,Math.sin(e)*t,n])}([h,null!=p?p:At(i,l,r),At(a,u,r),At(o,c,r)]);return new Et(d,f,m,g,!1)}case"lab":{const[n,i,a,o]=dt(Ct(e.lab,t.lab,r));return new Et(n,i,a,o,!1)}}}}Et.black=new Et(0,0,0,1),Et.white=new Et(1,1,1,1),Et.transparent=new Et(0,0,0,0),Et.red=new Et(1,0,0,1);class Mt{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const St=["bottom","center","top"];class Dt{constructor(e,t,r,n,i,a){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i,this.verticalAlign=a}}class Tt{constructor(e){this.sections=e}static fromString(e){return new Tt([new Dt(e,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Tt?e:Tt.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}}class Nt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Nt)return e;if("number"==typeof e)return new Nt([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Nt(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new Nt(Ct(e.values,t.values,r))}}class It{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof It)return e;if("number"==typeof e)return new It([e]);if(Array.isArray(e)){for(const t of e)if("number"!=typeof t)return;return new It(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new It(Ct(e.values,t.values,r))}}class Pt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Pt)return e;if("string"==typeof e){const t=Et.parse(e);if(!t)return;return new Pt([t])}if(!Array.isArray(e))return;const t=[];for(const r of e){if("string"!=typeof r)return;const e=Et.parse(r);if(!e)return;t.push(e)}return new Pt(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r,n="rgb"){const i=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let a=0;a<e.values.length;a++)i.push(Et.interpolate(e.values[a],t.values[a],r,n));return new Pt(i)}}class zt extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const Bt=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class kt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof kt)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){const r=e[t],n=e[t+1];if("string"!=typeof r||!Bt.has(r))return;if(!Array.isArray(n)||2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])return}return new kt(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){const n=e.values,i=t.values;if(n.length!==i.length)throw new zt(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);const a=[];for(let e=0;e<n.length;e+=2){if(n[e]!==i[e])throw new zt(`Cannot interpolate values containing mismatched anchors. from[${e}]: ${n[e]}, to[${e}]: ${i[e]}`);a.push(n[e]);const[t,o]=n[e+1],[s,l]=i[e+1];a.push([At(t,s,r),At(o,l,r)])}return new kt(a)}}class Ft{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ft({name:e,available:!1}):null}}class Rt{constructor(e,t,r){this.from=e,this.to=t,this.transition=r}static interpolate(e,t,r){return new Rt(e,t,r)}static parse(e){return e instanceof Rt?e:Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]?new Rt(e[0],e[1],e[2]):"object"==typeof e&&"string"==typeof e.from&&"string"==typeof e.to&&"number"==typeof e.transition?new Rt(e.from,e.to,e.transition):"string"==typeof e?new Rt(e,e,1):void 0}}function Ot(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Lt(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Rt||e instanceof Et||e instanceof Mt||e instanceof Tt||e instanceof Nt||e instanceof It||e instanceof Pt||e instanceof kt||e instanceof Ft)return!0;if(Array.isArray(e)){for(const t of e)if(!Lt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Lt(e[t]))return!1;return!0}return!1}function qt(e){if(null===e)return ze;if("string"==typeof e)return ke;if("boolean"==typeof e)return Fe;if("number"==typeof e)return Be;if(e instanceof Et)return Re;if(e instanceof Rt)return Oe;if(e instanceof Mt)return je;if(e instanceof Tt)return Ue;if(e instanceof Nt)return Ve;if(e instanceof It)return $e;if(e instanceof Pt)return Ze;if(e instanceof kt)return He;if(e instanceof Ft)return Ge;if(Array.isArray(e)){const t=e.length;let r;for(const t of e){const e=qt(t);if(r){if(r===e)continue;r=qe;break}r=e}return We(r||qe,t)}return Le}function jt(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Et||e instanceof Rt||e instanceof Tt||e instanceof Nt||e instanceof It||e instanceof Pt||e instanceof kt||e instanceof Ft?e.toString():JSON.stringify(e)}class Ut{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Lt(e[1]))return t.error("invalid value");const r=e[1];let n=qt(r);const i=t.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new Ut(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Vt={string:ke,number:Be,boolean:Fe,object:Le};class Zt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const i=e[0];if("array"===i){let i,a;if(e.length>2){const r=e[1];if("string"!=typeof r||!(r in Vt)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=Vt[r],n++}else i=qe;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],n++}r=We(i,a)}else{if(!Vt[i])throw new Error(`Types doesn't contain name = ${i}`);r=Vt[i]}const a=[];for(;n<e.length;n++){const r=t.parse(e[n],n,qe);if(!r)return null;a.push(r)}return new Zt(r,a)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e);if(!Ke(this.type,qt(r)))return r;if(t===this.args.length-1)throw new zt(`Expected value to be of type ${Xe(this.type)}, but found ${Xe(qt(r))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const $t={"to-boolean":Fe,"to-color":Re,"to-number":Be,"to-string":ke};class Gt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(!$t[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=$t[r],i=[];for(let r=1;r<e.length;r++){const n=t.parse(e[r],r,qe);if(!n)return null;i.push(n)}return new Gt(n,i)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof Et)return t;if("string"==typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:Ot(t[0],t[1],t[2],t[3]),!r))return new Et(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new zt(r||`Could not parse color from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"padding":{let t;for(const r of this.args){t=r.evaluate(e);const n=Nt.parse(t);if(n)return n}throw new zt(`Could not parse padding from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=It.parse(t);if(n)return n}throw new zt(`Could not parse numberArray from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(const r of this.args){t=r.evaluate(e);const n=Pt.parse(t);if(n)return n}throw new zt(`Could not parse colorArray from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(const r of this.args){t=r.evaluate(e);const n=kt.parse(t);if(n)return n}throw new zt(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof t?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new zt(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Tt.fromString(jt(this.args[0].evaluate(e)));case"resolvedImage":return Ft.fromString(jt(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return jt(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Ht=["Unknown","Point","LineString","Polygon"];class Wt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ht[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=Et.parse(e),this._parseColorCache.set(e,t)),t}}class Xt{constructor(e,t,r=[],n,i=new Pe,a=[]){this.registry=e,this.path=r,this.key=r.map((e=>`[${e}]`)).join(""),this.scope=i,this.errors=a,this.expectedType=n,this._isConstant=t}parse(e,t,r,n,i={}){return t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)}_parse(e,t){function r(e,t,r){return"assert"===r?new Zt(t,[e]):"coerce"===r?new Gt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[n];if(i){let n=i.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,i=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==i.kind){if("projectionDefinition"===e.kind&&["string","array"].includes(i.kind)||["color","formatted","resolvedImage"].includes(e.kind)&&["value","string"].includes(i.kind)||["padding","numberArray"].includes(e.kind)&&["value","number","array"].includes(i.kind)||"colorArray"===e.kind&&["value","string","array"].includes(i.kind)||"variableAnchorOffsetCollection"===e.kind&&["value","array"].includes(i.kind))n=r(n,e,t.typeAnnotation||"coerce");else if(this.checkSubtype(e,i))return null}else n=r(n,e,t.typeAnnotation||"assert")}if(!(n instanceof Ut)&&"resolvedImage"!==n.type.kind&&this._isConstant(n)){const t=new Wt;try{n=new Ut(n.type,n.evaluate(t))}catch(e){return this.error(e.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){const n="number"==typeof e?this.path.concat(e):this.path,i=r?this.scope.concat(r):this.scope;return new Xt(this.registry,this._isConstant,n,t||null,i,this.errors)}error(e,...t){const r=`${this.key}${t.map((e=>`[${e}]`)).join("")}`;this.errors.push(new Ie(r,e))}checkSubtype(e,t){const r=Ke(e,t);return r&&this.error(r),r}}class Yt{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let n=1;n<e.length-1;n+=2){const i=e[n];if("string"!=typeof i)return t.error(`Expected string, but found ${typeof i} instead.`,n);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);const a=t.parse(e[n+1],n+1);if(!a)return null;r.push([i,a])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new Yt(r,n):null}outputDefined(){return this.result.outputDefined()}}class Kt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new Kt(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Jt{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,Be),n=t.parse(e[2],2,We(t.expectedType||qe));return r&&n?new Jt(n.type.itemType,r,n):null}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new zt(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new zt(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new zt(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Qt{constructor(e,t){this.type=Fe,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,qe),n=t.parse(e[2],2,qe);return r&&n?Je(r.type,[Fe,ke,Be,ze,qe])?new Qt(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xe(r.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Qe(t,["boolean","string","number","null"]))throw new zt(`Expected first argument to be of type boolean, string, number or null, but found ${Xe(qt(t))} instead.`);if(!Qe(r,["string","array"]))throw new zt(`Expected second argument to be of type array or string, but found ${Xe(qt(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class er{constructor(e,t,r){this.type=Be,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,qe),n=t.parse(e[2],2,qe);if(!r||!n)return null;if(!Je(r.type,[Fe,ke,Be,ze,qe]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xe(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,Be);return i?new er(r,n,i):null}return new er(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Qe(t,["boolean","string","number","null"]))throw new zt(`Expected first argument to be of type boolean, string, number or null, but found ${Xe(qt(t))} instead.`);let n;if(this.fromIndex&&(n=this.fromIndex.evaluate(e)),Qe(r,["string"])){const e=r.indexOf(t,n);return-1===e?-1:[...r.slice(0,e)].length}if(Qe(r,["array"]))return r.indexOf(t,n);throw new zt(`Expected second argument to be of type array or string, but found ${Xe(qt(r))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class tr{constructor(e,t,r,n,i,a){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=a}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const i={},a=[];for(let o=2;o<e.length-1;o+=2){let s=e[o];const l=e[o+1];Array.isArray(s)||(s=[s]);const u=t.concat(o);if(0===s.length)return u.error("Expected at least one branch label.");for(const e of s){if("number"!=typeof e&&"string"!=typeof e)return u.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,qt(e)))return null}else r=qt(e);if(void 0!==i[String(e)])return u.error("Branch labels must be unique.");i[String(e)]=a.length}const c=t.parse(l,o,n);if(!c)return null;n=n||c.type,a.push(c)}const o=t.parse(e[1],1,qe);if(!o)return null;const s=t.parse(e[e.length-1],e.length-1,n);return s?"value"!==o.type.kind&&t.concat(1).checkSubtype(r,o.type)?null:new tr(r,n,o,i,a,s):null}evaluate(e){const t=this.input.evaluate(e);return(qt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class rr{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let i=1;i<e.length-1;i+=2){const a=t.parse(e[i],i,Fe);if(!a)return null;const o=t.parse(e[i+1],i+1,r);if(!o)return null;n.push([a,o]),r=r||o.type}const i=t.parse(e[e.length-1],e.length-1,r);if(!i)return null;if(!r)throw new Error("Can't infer output type");return new rr(r,n,i)}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((([e,t])=>t.outputDefined()))&&this.otherwise.outputDefined()}}class nr{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,qe),n=t.parse(e[2],2,Be);if(!r||!n)return null;if(!Je(r.type,[We(qe),ke,qe]))return t.error(`Expected first argument to be of type array or string, but found ${Xe(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,Be);return i?new nr(r.type,r,n,i):null}return new nr(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);let n;if(this.endIndex&&(n=this.endIndex.evaluate(e)),Qe(t,["string"]))return[...t].slice(r,n).join("");if(Qe(t,["array"]))return t.slice(r,n);throw new zt(`Expected first argument to be of type array or string, but found ${Xe(qt(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function ir(e,t){const r=e.length-1;let n,i,a=0,o=r,s=0;for(;a<=o;)if(s=Math.floor((a+o)/2),n=e[s],i=e[s+1],n<=t){if(s===r||t<i)return s;a=s+1}else{if(!(n>t))throw new zt("Input is not a number.");o=s-1}return 0}class ar{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[e,t]of r)this.labels.push(e),this.outputs.push(t)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,Be);if(!r)return null;const n=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let r=1;r<e.length;r+=2){const a=1===r?-1/0:e[r],o=e[r+1],s=r,l=r+1;if("number"!=typeof a)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const u=t.parse(o,l,i);if(!u)return null;i=i||u.type,n.push([a,u])}return new ar(i,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;return n>=t[i-1]?r[i-1].evaluate(e):r[ir(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}var or,sr,lr=function(){if(sr)return or;function e(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}return sr=1,or=e,e.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=i/a}var o=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?o=r:s=r,r=.5*(s-o)+o;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},or}(),ur=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(lr);class cr{constructor(e,t,r,n,i){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[e,t]of i)this.labels.push(e),this.outputs.push(t)}static interpolationFactor(e,t,r,n){let i=0;if("exponential"===e.name)i=hr(t,e.base,r,n);else if("linear"===e.name)i=hr(t,1,r,n);else if("cubic-bezier"===e.name){const a=e.controlPoints;i=new ur(a[0],a[1],a[2],a[3]).solve(hr(t,1,r,n))}return i}static parse(e,t){let[r,n,i,...a]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(i=t.parse(i,2,Be),!i)return null;const o=[];let s=null;"interpolate-hcl"!==r&&"interpolate-lab"!==r||t.expectedType==Ze?t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType):s=Re;for(let e=0;e<a.length;e+=2){const r=a[e],n=a[e+1],i=e+3,l=e+4;if("number"!=typeof r)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(o.length&&o[o.length-1][0]>=r)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const u=t.parse(n,l,s);if(!u)return null;s=s||u.type,o.push([r,u])}return et(s,Be)||et(s,Oe)||et(s,Re)||et(s,Ve)||et(s,$e)||et(s,Ze)||et(s,He)||et(s,We(Be))?new cr(s,r,n,i,o):t.error(`Type ${Xe(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);const a=ir(t,n),o=cr.interpolationFactor(this.interpolation,n,t[a],t[a+1]),s=r[a].evaluate(e),l=r[a+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return At(s,l,o);case"color":return Et.interpolate(s,l,o);case"padding":return Nt.interpolate(s,l,o);case"colorArray":return Pt.interpolate(s,l,o);case"numberArray":return It.interpolate(s,l,o);case"variableAnchorOffsetCollection":return kt.interpolate(s,l,o);case"array":return Ct(s,l,o);case"projectionDefinition":return Rt.interpolate(s,l,o)}case"interpolate-hcl":switch(this.type.kind){case"color":return Et.interpolate(s,l,o,"hcl");case"colorArray":return Pt.interpolate(s,l,o,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Et.interpolate(s,l,o,"lab");case"colorArray":return Pt.interpolate(s,l,o,"lab")}}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function hr(e,t,r,n){const i=n-r,a=e-r;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}const pr={color:Et.interpolate,number:At,padding:Nt.interpolate,numberArray:It.interpolate,colorArray:Pt.interpolate,variableAnchorOffsetCollection:kt.interpolate,array:Ct};class dr{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const i=[];for(const n of e.slice(1)){const e=t.parse(n,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,i.push(e)}if(!r)throw new Error("No output type");const a=n&&i.some((e=>Ke(n,e.type)));return new dr(a?qe:r,i)}evaluate(e){let t,r=null,n=0;for(const i of this.args)if(n++,r=i.evaluate(e),r&&r instanceof Ft&&!r.available&&(t||(t=r.name),r=null,n===this.args.length&&(r=t)),null!==r)break;return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function fr(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function mr(e,t,r,n){return 0===n.compare(t,r)}function gr(e,t,r){const n="=="!==e&&"!="!==e;return class i{constructor(e,t,r){this.type=Fe,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let a=t.parse(e[1],1,qe);if(!a)return null;if(!fr(r,a.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${Xe(a.type)}'.`);let o=t.parse(e[2],2,qe);if(!o)return null;if(!fr(r,o.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${Xe(o.type)}'.`);if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error(`Cannot compare types '${Xe(a.type)}' and '${Xe(o.type)}'.`);n&&("value"===a.type.kind&&"value"!==o.type.kind?a=new Zt(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new Zt(a.type,[o])));let s=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,je),!s)return null}return new i(a,o,s)}evaluate(i){const a=this.lhs.evaluate(i),o=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){const t=qt(a),r=qt(o);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new zt(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=qt(a),r=qt(o);if("string"!==e.kind||"string"!==r.kind)return t(i,a,o)}return this.collator?r(i,a,o,this.collator.evaluate(i)):t(i,a,o)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const yr=gr("==",(function(e,t,r){return t===r}),mr),vr=gr("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!mr(0,t,r,n)})),xr=gr("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),_r=gr(">",(function(e,t,r){return t>r}),(function(e,t,r,n){return n.compare(t,r)>0})),br=gr("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),wr=gr(">=",(function(e,t,r){return t>=r}),(function(e,t,r,n){return n.compare(t,r)>=0}));class Ar{constructor(e,t,r){this.type=je,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Fe);if(!n)return null;const i=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Fe);if(!i)return null;let a=null;return r.locale&&(a=t.parse(r.locale,1,ke),!a)?null:new Ar(n,i,a)}evaluate(e){return new Mt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Cr{constructor(e,t,r,n,i){this.type=ke,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=i}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,Be);if(!r)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let i=null;if(n.locale&&(i=t.parse(n.locale,1,ke),!i))return null;let a=null;if(n.currency&&(a=t.parse(n.currency,1,ke),!a))return null;let o=null;if(n["min-fraction-digits"]&&(o=t.parse(n["min-fraction-digits"],1,Be),!o))return null;let s=null;return n["max-fraction-digits"]&&(s=t.parse(n["max-fraction-digits"],1,Be),!s)?null:new Cr(r,i,a,o,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Er{constructor(e){this.type=Ue,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");const n=[];let i=!1;for(let r=1;r<=e.length-1;++r){const a=e[r];if(i&&"object"==typeof a&&!Array.isArray(a)){i=!1;let e=null;if(a["font-scale"]&&(e=t.parse(a["font-scale"],1,Be),!e))return null;let r=null;if(a["text-font"]&&(r=t.parse(a["text-font"],1,We(ke)),!r))return null;let o=null;if(a["text-color"]&&(o=t.parse(a["text-color"],1,Re),!o))return null;let s=null;if(a["vertical-align"]){if("string"==typeof a["vertical-align"]&&!St.includes(a["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${a["vertical-align"]}' instead.`);if(s=t.parse(a["vertical-align"],1,ke),!s)return null}const l=n[n.length-1];l.scale=e,l.font=r,l.textColor=o,l.verticalAlign=s}else{const a=t.parse(e[r],1,qe);if(!a)return null;const o=a.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:a,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Er(n)}evaluate(e){return new Tt(this.sections.map((t=>{const r=t.content.evaluate(e);return qt(r)===Ge?new Dt("",r,null,null,null,t.verticalAlign?t.verticalAlign.evaluate(e):null):new Dt(jt(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null,t.verticalAlign?t.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}}class Mr{constructor(e){this.type=Ge,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,ke);return r?new Mr(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=Ft.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}}class Sr{constructor(e){this.type=Be,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${Xe(r.type)} instead.`):new Sr(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new zt(`Expected value to be of type string or array, but found ${Xe(qt(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const Dr=8192;function Tr(e,t){const r=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,i=Math.pow(2,t.z);return[Math.round(r*i*Dr),Math.round(n*i*Dr)]}function Nr(e,t){const r=Math.pow(2,t.z);return[(i=(e[0]/Dr+t.x)/r,360*i-180),(n=(e[1]/Dr+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90)];var n,i}function Ir(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Pr(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function zr(e,t,r){const n=e[0]-t[0],i=e[1]-t[1],a=e[0]-r[0],o=e[1]-r[1];return n*o-a*i==0&&n*a<=0&&i*o<=0}function Br(e,t,r,n){return 0!=(i=[n[0]-r[0],n[1]-r[1]])[0]*(a=[t[0]-e[0],t[1]-e[1]])[1]-i[1]*a[0]&&!(!qr(e,t,r,n)||!qr(r,n,e,t));var i,a}function kr(e,t,r){for(const n of r)for(let r=0;r<n.length-1;++r)if(Br(e,t,n[r],n[r+1]))return!0;return!1}function Fr(e,t,r=!1){let n=!1;for(const s of t)for(let t=0;t<s.length-1;t++){if(zr(e,s[t],s[t+1]))return r;(a=s[t])[1]>(i=e)[1]!=(o=s[t+1])[1]>i[1]&&i[0]<(o[0]-a[0])*(i[1]-a[1])/(o[1]-a[1])+a[0]&&(n=!n)}var i,a,o;return n}function Rr(e,t){for(const r of t)if(Fr(e,r))return!0;return!1}function Or(e,t){for(const r of e)if(!Fr(r,t))return!1;for(let r=0;r<e.length-1;++r)if(kr(e[r],e[r+1],t))return!1;return!0}function Lr(e,t){for(const r of t)if(Or(e,r))return!0;return!1}function qr(e,t,r,n){const i=n[0]-r[0],a=n[1]-r[1],o=(e[0]-r[0])*a-i*(e[1]-r[1]),s=(t[0]-r[0])*a-i*(t[1]-r[1]);return o>0&&s<0||o<0&&s>0}function jr(e,t,r){const n=[];for(let i=0;i<e.length;i++){const a=[];for(let n=0;n<e[i].length;n++){const o=Tr(e[i][n],r);Ir(t,o),a.push(o)}n.push(a)}return n}function Ur(e,t,r){const n=[];for(let i=0;i<e.length;i++){const a=jr(e[i],t,r);n.push(a)}return n}function Vr(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let i=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===i&&(i=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=i}Ir(t,e)}function Zr(e,t,r,n){const i=Math.pow(2,n.z)*Dr,a=[n.x*Dr,n.y*Dr],o=[];for(const n of e)for(const e of n){const n=[e.x+a[0],e.y+a[1]];Vr(n,t,r,i),o.push(n)}return o}function $r(e,t,r,n){const i=Math.pow(2,n.z)*Dr,a=[n.x*Dr,n.y*Dr],o=[];for(const r of e){const e=[];for(const n of r){const r=[n.x+a[0],n.y+a[1]];Ir(t,r),e.push(r)}o.push(e)}if(t[2]-t[0]<=i/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of o)for(const n of e)Vr(n,t,r,i)}var s;return o}class Gr{constructor(e,t){this.type=Fe,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Lt(e[1])){const t=e[1];if("FeatureCollection"===t.type){const e=[];for(const r of t.features){const{type:t,coordinates:n}=r.geometry;"Polygon"===t&&e.push(n),"MultiPolygon"===t&&e.push(...n)}if(e.length)return new Gr(t,{type:"MultiPolygon",coordinates:e})}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new Gr(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new Gr(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const a=jr(t.coordinates,n,i),o=Zr(e.geometry(),r,n,i);if(!Pr(r,n))return!1;for(const e of o)if(!Fr(e,a))return!1}if("MultiPolygon"===t.type){const a=Ur(t.coordinates,n,i),o=Zr(e.geometry(),r,n,i);if(!Pr(r,n))return!1;for(const e of o)if(!Rr(e,a))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const a=jr(t.coordinates,n,i),o=$r(e.geometry(),r,n,i);if(!Pr(r,n))return!1;for(const e of o)if(!Or(e,a))return!1}if("MultiPolygon"===t.type){const a=Ur(t.coordinates,n,i),o=$r(e.geometry(),r,n,i);if(!Pr(r,n))return!1;for(const e of o)if(!Lr(e,a))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Hr=class{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,a=t[i];if(r(n,a)>=0)break;t[e]=a,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1);const a=n+1;if(a<this.length&&r(t[a],t[n])<0&&(n=a),r(t[n],i)>=0)break;t[e]=t[n],e=n}t[e]=i}};function Wr(e,t,r=0,n=e.length-1,i=Yr){for(;n>r;){if(n-r>600){const a=n-r+1,o=t-r+1,s=Math.log(a),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);Wr(e,t,Math.max(r,Math.floor(t-o*l/a+u)),Math.min(n,Math.floor(t+(a-o)*l/a+u)),i)}const a=e[t];let o=r,s=n;for(Xr(e,r,t),i(e[n],a)>0&&Xr(e,r,n);o<s;){for(Xr(e,o,s),o++,s--;i(e[o],a)<0;)o++;for(;i(e[s],a)>0;)s--}0===i(e[r],a)?Xr(e,r,s):(s++,Xr(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}}function Xr(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Yr(e,t){return e<t?-1:e>t?1:0}function Kr(e,t){if(e.length<=1)return[e];const r=[];let n,i;for(const t of e){const e=Qr(t);0!==e&&(t.area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(n&&r.push(n),n=[t]):n.push(t))}if(n&&r.push(n),t>1)for(let e=0;e<r.length;e++)r[e].length<=t||(Wr(r[e],t,1,r[e].length-1,Jr),r[e]=r[e].slice(0,t));return r}function Jr(e,t){return t.area-e.area}function Qr(e){let t=0;for(let r,n,i=0,a=e.length,o=a-1;i<a;o=i++)r=e[i],n=e[o],t+=(n.x-r.x)*(r.y+n.y);return t}const en=1/298.257223563,tn=en*(2-en),rn=Math.PI/180;class nn{constructor(e){const t=6378.137*rn*1e3,r=Math.cos(e*rn),n=1/(1-tn*(1-r*r)),i=Math.sqrt(n);this.kx=t*i*r,this.ky=t*i*n*(1-tn)}distance(e,t){const r=this.wrap(e[0]-t[0])*this.kx,n=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+n*n)}pointOnLine(e,t){let r,n,i,a,o=1/0;for(let s=0;s<e.length-1;s++){let l=e[s][0],u=e[s][1],c=this.wrap(e[s+1][0]-l)*this.kx,h=(e[s+1][1]-u)*this.ky,p=0;0===c&&0===h||(p=(this.wrap(t[0]-l)*this.kx*c+(t[1]-u)*this.ky*h)/(c*c+h*h),p>1?(l=e[s+1][0],u=e[s+1][1]):p>0&&(l+=c/this.kx*p,u+=h/this.ky*p)),c=this.wrap(t[0]-l)*this.kx,h=(t[1]-u)*this.ky;const d=c*c+h*h;d<o&&(o=d,r=l,n=u,i=s,a=p)}return{point:[r,n],index:i,t:Math.max(0,Math.min(1,a))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function an(e,t){return t[0]-e[0]}function on(e){return e[1]-e[0]+1}function sn(e,t){return e[1]>=e[0]&&e[1]<t}function ln(e,t){if(e[0]>e[1])return[null,null];const r=on(e);if(t){if(2===r)return[e,null];const t=Math.floor(r/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===r)return[e,null];const n=Math.floor(r/2)-1;return[[e[0],e[0]+n],[e[0]+n+1,e[1]]]}function un(e,t){if(!sn(t,e.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let n=t[0];n<=t[1];++n)Ir(r,e[n]);return r}function cn(e){const t=[1/0,1/0,-1/0,-1/0];for(const r of e)for(const e of r)Ir(t,e);return t}function hn(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function pn(e,t,r){if(!hn(e)||!hn(t))return NaN;let n=0,i=0;return e[2]<t[0]&&(n=t[0]-e[2]),e[0]>t[2]&&(n=e[0]-t[2]),e[1]>t[3]&&(i=e[1]-t[3]),e[3]<t[1]&&(i=t[1]-e[3]),r.distance([0,0],[n,i])}function dn(e,t,r){const n=r.pointOnLine(t,e);return r.distance(e,n.point)}function fn(e,t,r,n,i){const a=Math.min(dn(e,[r,n],i),dn(t,[r,n],i)),o=Math.min(dn(r,[e,t],i),dn(n,[e,t],i));return Math.min(a,o)}function mn(e,t,r,n,i){if(!sn(t,e.length)||!sn(n,r.length))return 1/0;let a=1/0;for(let o=t[0];o<t[1];++o){const t=e[o],s=e[o+1];for(let e=n[0];e<n[1];++e){const n=r[e],o=r[e+1];if(Br(t,s,n,o))return 0;a=Math.min(a,fn(t,s,n,o,i))}}return a}function gn(e,t,r,n,i){if(!sn(t,e.length)||!sn(n,r.length))return NaN;let a=1/0;for(let o=t[0];o<=t[1];++o)for(let t=n[0];t<=n[1];++t)if(a=Math.min(a,i.distance(e[o],r[t])),0===a)return a;return a}function yn(e,t,r){if(Fr(e,t,!0))return 0;let n=1/0;for(const i of t){const t=i[0],a=i[i.length-1];if(t!==a&&(n=Math.min(n,dn(e,[a,t],r)),0===n))return n;const o=r.pointOnLine(i,e);if(n=Math.min(n,r.distance(e,o.point)),0===n)return n}return n}function vn(e,t,r,n){if(!sn(t,e.length))return NaN;for(let n=t[0];n<=t[1];++n)if(Fr(e[n],r,!0))return 0;let i=1/0;for(let a=t[0];a<t[1];++a){const t=e[a],o=e[a+1];for(const e of r)for(let r=0,a=e.length,s=a-1;r<a;s=r++){const a=e[s],l=e[r];if(Br(t,o,a,l))return 0;i=Math.min(i,fn(t,o,a,l,n))}}return i}function xn(e,t){for(const r of e)for(const e of r)if(Fr(e,t,!0))return!0;return!1}function _n(e,t,r,n=1/0){const i=cn(e),a=cn(t);if(n!==1/0&&pn(i,a,r)>=n)return n;if(Pr(i,a)){if(xn(e,t))return 0}else if(xn(t,e))return 0;let o=1/0;for(const n of e)for(let e=0,i=n.length,a=i-1;e<i;a=e++){const i=n[a],s=n[e];for(const e of t)for(let t=0,n=e.length,a=n-1;t<n;a=t++){const n=e[a],l=e[t];if(Br(i,s,n,l))return 0;o=Math.min(o,fn(i,s,n,l,r))}}return o}function bn(e,t,r,n,i,a){if(!a)return;const o=pn(un(n,a),i,r);o<t&&e.push([o,a,[0,0]])}function wn(e,t,r,n,i,a,o){if(!a||!o)return;const s=pn(un(n,a),un(i,o),r);s<t&&e.push([s,a,o])}function An(e,t,r,n,i=1/0){let a=Math.min(n.distance(e[0],r[0][0]),i);if(0===a)return a;const o=new Hr([[0,[0,e.length-1],[0,0]]],an),s=cn(r);for(;o.length>0;){const i=o.pop();if(i[0]>=a)continue;const l=i[1],u=t?50:100;if(on(l)<=u){if(!sn(l,e.length))return NaN;if(t){const t=vn(e,l,r,n);if(isNaN(t)||0===t)return t;a=Math.min(a,t)}else for(let t=l[0];t<=l[1];++t){const i=yn(e[t],r,n);if(a=Math.min(a,i),0===a)return 0}}else{const r=ln(l,t);bn(o,a,n,e,s,r[0]),bn(o,a,n,e,s,r[1])}}return a}function Cn(e,t,r,n,i,a=1/0){let o=Math.min(a,i.distance(e[0],r[0]));if(0===o)return o;const s=new Hr([[0,[0,e.length-1],[0,r.length-1]]],an);for(;s.length>0;){const a=s.pop();if(a[0]>=o)continue;const l=a[1],u=a[2],c=t?50:100,h=n?50:100;if(on(l)<=c&&on(u)<=h){if(!sn(l,e.length)&&sn(u,r.length))return NaN;let a;if(t&&n)a=mn(e,l,r,u,i),o=Math.min(o,a);else if(t&&!n){const t=e.slice(l[0],l[1]+1);for(let e=u[0];e<=u[1];++e)if(a=dn(r[e],t,i),o=Math.min(o,a),0===o)return o}else if(!t&&n){const t=r.slice(u[0],u[1]+1);for(let r=l[0];r<=l[1];++r)if(a=dn(e[r],t,i),o=Math.min(o,a),0===o)return o}else a=gn(e,l,r,u,i),o=Math.min(o,a)}else{const a=ln(l,t),c=ln(u,n);wn(s,o,i,e,r,a[0],c[0]),wn(s,o,i,e,r,a[0],c[1]),wn(s,o,i,e,r,a[1],c[0]),wn(s,o,i,e,r,a[1],c[1])}}return o}function En(e){return"MultiPolygon"===e.type?e.coordinates.map((e=>({type:"Polygon",coordinates:e}))):"MultiLineString"===e.type?e.coordinates.map((e=>({type:"LineString",coordinates:e}))):"MultiPoint"===e.type?e.coordinates.map((e=>({type:"Point",coordinates:e}))):[e]}class Mn{constructor(e,t){this.type=Be,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Lt(e[1])){const t=e[1];if("FeatureCollection"===t.type)return new Mn(t,t.features.map((e=>En(e.geometry))).flat());if("Feature"===t.type)return new Mn(t,En(t.geometry));if("type"in t&&"coordinates"in t)return new Mn(t,En(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map((t=>Nr([t.x,t.y],e.canonical)));if(0===r.length)return NaN;const i=new nn(n[0][1]);let a=1/0;for(const e of t){switch(e.type){case"Point":a=Math.min(a,Cn(n,!1,[e.coordinates],!1,i,a));break;case"LineString":a=Math.min(a,Cn(n,!1,e.coordinates,!0,i,a));break;case"Polygon":a=Math.min(a,An(n,!1,e.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=e.geometry(),n=r.flat().map((t=>Nr([t.x,t.y],e.canonical)));if(0===r.length)return NaN;const i=new nn(n[0][1]);let a=1/0;for(const e of t){switch(e.type){case"Point":a=Math.min(a,Cn(n,!0,[e.coordinates],!1,i,a));break;case"LineString":a=Math.min(a,Cn(n,!0,e.coordinates,!0,i,a));break;case"Polygon":a=Math.min(a,An(n,!0,e.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries);if("Polygon"===e.geometryType())return function(e,t){const r=e.geometry();if(0===r.length||0===r[0].length)return NaN;const n=Kr(r,0).map((t=>t.map((t=>t.map((t=>Nr([t.x,t.y],e.canonical))))))),i=new nn(n[0][0][0][1]);let a=1/0;for(const e of t)for(const t of n){switch(e.type){case"Point":a=Math.min(a,An([e.coordinates],!1,t,i,a));break;case"LineString":a=Math.min(a,An(e.coordinates,!0,t,i,a));break;case"Polygon":a=Math.min(a,_n(t,e.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Sn{constructor(e){this.type=qe,this.key=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=e[1];return null==r?t.error("Global state property must be defined."):"string"!=typeof r?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new Sn(r)}evaluate(e){var t;const r=null===(t=e.globals)||void 0===t?void 0:t.globalState;return r&&0!==Object.keys(r).length?yt(r,this.key):null}eachChild(){}outputDefined(){return!1}}const Dn={"==":yr,"!=":vr,">":_r,"<":xr,">=":wr,"<=":br,array:Zt,at:Jt,boolean:Zt,case:rr,coalesce:dr,collator:Ar,format:Er,image:Mr,in:Qt,"index-of":er,interpolate:cr,"interpolate-hcl":cr,"interpolate-lab":cr,length:Sr,let:Yt,literal:Ut,match:tr,number:Zt,"number-format":Cr,object:Zt,slice:nr,step:ar,string:Zt,"to-boolean":Gt,"to-color":Gt,"to-number":Gt,"to-string":Gt,var:Kt,within:Gr,distance:Mn,"global-state":Sn};class Tn{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const r=e[0],n=Tn.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=a.filter((([t])=>!Array.isArray(t)||t.length===e.length-1));let s=null;for(const[n,a]of o){s=new Xt(t.registry,Bn,t.path,null,t.scope);const o=[];let l=!1;for(let t=1;t<e.length;t++){const r=e[t],i=Array.isArray(n)?n[t-1]:n.type,a=s.parse(r,1+o.length,i);if(!a){l=!0;break}o.push(a)}if(!l)if(Array.isArray(n)&&n.length!==o.length)s.error(`Expected ${n.length} arguments, but found ${o.length} instead.`);else{for(let e=0;e<o.length;e++){const t=Array.isArray(n)?n[e]:n.type,r=o[e];s.concat(e+1).checkSubtype(t,r.type)}if(0===s.errors.length)return new Tn(r,i,a,o)}}if(1===o.length)t.errors.push(...s.errors);else{const r=(o.length?o:a).map((([e])=>{return t=e,Array.isArray(t)?`(${t.map(Xe).join(", ")})`:`(${Xe(t.type)}...)`;var t})).join(" | "),n=[];for(let r=1;r<e.length;r++){const i=t.parse(e[r],1+n.length);if(!i)return null;n.push(Xe(i.type))}t.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){Tn.definitions=t;for(const r in t)e[r]=Tn}}function Nn(e,[t,r,n,i]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const a=i?i.evaluate(e):1,o=Ot(t,r,n,a);if(o)throw new zt(o);return new Et(t/255,r/255,n/255,a,!1)}function In(e,t){return e in t}function Pn(e,t){const r=t[e];return void 0===r?null:r}function zn(e){return{type:e}}function Bn(e){if(e instanceof Kt)return Bn(e.boundExpression);if(e instanceof Tn&&"error"===e.name)return!1;if(e instanceof Ar)return!1;if(e instanceof Gr)return!1;if(e instanceof Mn)return!1;if(e instanceof Sn)return!1;const t=e instanceof Gt||e instanceof Zt;let r=!0;return e.eachChild((e=>{r=t?r&&Bn(e):r&&e instanceof Ut})),!!r&&kn(e)&&Rn(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function kn(e){if(e instanceof Tn){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Gr)return!1;if(e instanceof Mn)return!1;let t=!0;return e.eachChild((e=>{t&&!kn(e)&&(t=!1)})),t}function Fn(e){if(e instanceof Tn&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!Fn(e)&&(t=!1)})),t}function Rn(e,t){if(e instanceof Tn&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild((e=>{r&&!Rn(e,t)&&(r=!1)})),r}function On(e){return{result:"success",value:e}}function Ln(e){return{result:"error",value:e}}function qn(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function jn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Un(e){return!!e.expression&&e.expression.interpolated}function Vn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Zn(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&qt(e)===Le}function $n(e){return e}function Gn(e,t){const r=e.stops&&"object"==typeof e.stops[0][0],n=r||!(r||void 0!==e.property),i=e.type||(Un(t)?"exponential":"interval"),a=function(e){switch(e.type){case"color":return Et.parse;case"padding":return Nt.parse;case"numberArray":return It.parse;case"colorArray":return Pt.parse;default:return null}}(t);if(a&&((e=Ne({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],a(e[1])]))),e.default=a(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==(o=e.colorSpace)&&"hcl"!==o&&"lab"!==o)throw new Error(`Unknown color space: "${e.colorSpace}"`);var o;const s=function(e){switch(e){case"exponential":return Yn;case"interval":return Xn;case"categorical":return Wn;case"identity":return Kn;default:throw new Error(`Unknown function type "${e}"`)}}(i);let l,u;if("categorical"===i){l=Object.create(null);for(const t of e.stops)l[t[0]]=t[1];u=typeof e.stops[0][0]}if(r){const r={},n=[];for(let t=0;t<e.stops.length;t++){const i=e.stops[t],a=i[0].zoom;void 0===r[a]&&(r[a]={zoom:a,type:e.type,property:e.property,default:e.default,stops:[]},n.push(a)),r[a].stops.push([i[0].value,i[1]])}const i=[];for(const e of n)i.push([r[e].zoom,Gn(r[e],t)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:cr.interpolationFactor.bind(void 0,a),zoomStops:i.map((e=>e[0])),evaluate:({zoom:r},n)=>Yn({stops:i,base:e.base},t,r).evaluate(r,n)}}if(n){const r="exponential"===i?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:r,interpolationFactor:cr.interpolationFactor.bind(void 0,r),zoomStops:e.stops.map((e=>e[0])),evaluate:({zoom:r})=>s(e,t,r,l,u)}}return{kind:"source",evaluate(r,n){const i=n&&n.properties?n.properties[e.property]:void 0;return void 0===i?Hn(e.default,t.default):s(e,t,i,l,u)}}}function Hn(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Wn(e,t,r,n,i){return Hn(typeof r===i?n[r]:void 0,e.default,t.default)}function Xn(e,t,r){if("number"!==Vn(r))return Hn(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];const i=ir(e.stops.map((e=>e[0])),r);return e.stops[i][1]}function Yn(e,t,r){const n=void 0!==e.base?e.base:1;if("number"!==Vn(r))return Hn(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];const a=ir(e.stops.map((e=>e[0])),r),o=function(e,t,r,n){const i=n-r,a=e-r;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}(r,n,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],l=e.stops[a+1][1],u=pr[t.type]||$n;return"function"==typeof s.evaluate?{evaluate(...t){const r=s.evaluate.apply(void 0,t),n=l.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==n)return u(r,n,o,e.colorSpace)}}:u(s,l,o,e.colorSpace)}function Kn(e,t,r){switch(t.type){case"color":r=Et.parse(r);break;case"formatted":r=Tt.fromString(r.toString());break;case"resolvedImage":r=Ft.fromString(r.toString());break;case"padding":r=Nt.parse(r);break;case"colorArray":r=Pt.parse(r);break;case"numberArray":r=It.parse(r);break;default:Vn(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0)}return Hn(r,e.default,t.default)}Tn.register(Dn,{error:[{kind:"error"},[ke],(e,[t])=>{throw new zt(t.evaluate(e))}],typeof:[ke,[qe],(e,[t])=>Xe(qt(t.evaluate(e)))],"to-rgba":[We(Be,4),[Re],(e,[t])=>{const[r,n,i,a]=t.evaluate(e).rgb;return[255*r,255*n,255*i,a]}],rgb:[Re,[Be,Be,Be],Nn],rgba:[Re,[Be,Be,Be,Be],Nn],has:{type:Fe,overloads:[[[ke],(e,[t])=>In(t.evaluate(e),e.properties())],[[ke,Le],(e,[t,r])=>In(t.evaluate(e),r.evaluate(e))]]},get:{type:qe,overloads:[[[ke],(e,[t])=>Pn(t.evaluate(e),e.properties())],[[ke,Le],(e,[t,r])=>Pn(t.evaluate(e),r.evaluate(e))]]},"feature-state":[qe,[ke],(e,[t])=>Pn(t.evaluate(e),e.featureState||{})],properties:[Le,[],e=>e.properties()],"geometry-type":[ke,[],e=>e.geometryType()],id:[qe,[],e=>e.id()],zoom:[Be,[],e=>e.globals.zoom],"heatmap-density":[Be,[],e=>e.globals.heatmapDensity||0],"line-progress":[Be,[],e=>e.globals.lineProgress||0],accumulated:[qe,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[Be,zn(Be),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[Be,zn(Be),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:Be,overloads:[[[Be,Be],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[Be],(e,[t])=>-t.evaluate(e)]]},"/":[Be,[Be,Be],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[Be,[Be,Be],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[Be,[],()=>Math.LN2],pi:[Be,[],()=>Math.PI],e:[Be,[],()=>Math.E],"^":[Be,[Be,Be],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[Be,[Be],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[Be,[Be],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[Be,[Be],(e,[t])=>Math.log(t.evaluate(e))],log2:[Be,[Be],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[Be,[Be],(e,[t])=>Math.sin(t.evaluate(e))],cos:[Be,[Be],(e,[t])=>Math.cos(t.evaluate(e))],tan:[Be,[Be],(e,[t])=>Math.tan(t.evaluate(e))],asin:[Be,[Be],(e,[t])=>Math.asin(t.evaluate(e))],acos:[Be,[Be],(e,[t])=>Math.acos(t.evaluate(e))],atan:[Be,[Be],(e,[t])=>Math.atan(t.evaluate(e))],min:[Be,zn(Be),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[Be,zn(Be),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[Be,[Be],(e,[t])=>Math.abs(t.evaluate(e))],round:[Be,[Be],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Be,[Be],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[Be,[Be],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[Fe,[ke,qe],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[Fe,[qe],(e,[t])=>e.id()===t.value],"filter-type-==":[Fe,[ke],(e,[t])=>e.geometryType()===t.value],"filter-<":[Fe,[ke,qe],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[Fe,[qe],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[Fe,[ke,qe],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[Fe,[qe],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[Fe,[ke,qe],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[Fe,[qe],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[Fe,[ke,qe],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[Fe,[qe],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[Fe,[qe],(e,[t])=>t.value in e.properties()],"filter-has-id":[Fe,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[Fe,[We(ke)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[Fe,[We(qe)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[Fe,[ke,We(qe)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[Fe,[ke,We(qe)],(e,[t,r])=>function(e,t,r,n){for(;r<=n;){const i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Fe,overloads:[[[Fe,Fe],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[zn(Fe),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:Fe,overloads:[[[Fe,Fe],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[zn(Fe),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[Fe,[Fe],(e,[t])=>!t.evaluate(e)],"is-supported-script":[Fe,[ke],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[ke,[ke],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[ke,[ke],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[ke,zn(qe),(e,t)=>t.map((t=>jt(t.evaluate(e)))).join("")],"resolved-locale":[ke,[je],(e,[t])=>t.evaluate(e).resolvedLocale()]});class Jn{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Wt,this._defaultValue=t?function(e){if("color"===e.type&&Zn(e.default))return new Et(0,0,0,0);switch(e.type){case"color":return Et.parse(e.default)||null;case"padding":return Nt.parse(e.default)||null;case"numberArray":return It.parse(e.default)||null;case"colorArray":return Pt.parse(e.default)||null;case"variableAnchorOffsetCollection":return kt.parse(e.default)||null;case"projectionDefinition":return Rt.parse(e.default)||null;default:return void 0===e.default?null:e.default}}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,i,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,i,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new zt(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function Qn(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Dn}function ei(e,t){const r=new Xt(Dn,Bn,[],t?function(e){const t={color:Re,string:ke,number:Be,enum:ke,boolean:Fe,formatted:Ue,padding:Ve,numberArray:$e,colorArray:Ze,projectionDefinition:Oe,resolvedImage:Ge,variableAnchorOffsetCollection:He};return"array"===e.type?We(t[e.value]||qe,e.length):t[e.type]}(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?On(new Jn(n,t)):Ln(r.errors)}class ti{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Fn(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,i,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,a)}evaluate(e,t,r,n,i,a){return this._styleExpression.evaluate(e,t,r,n,i,a)}}class ri{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Fn(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,i,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,a)}evaluate(e,t,r,n,i,a){return this._styleExpression.evaluate(e,t,r,n,i,a)}interpolationFactor(e,t,r){return this.interpolationType?cr.interpolationFactor(this.interpolationType,e,t,r):0}}function ni(e,t){const r=ei(e,t);if("error"===r.result)return r;const n=r.value.expression,i=kn(n);if(!i&&!qn(t))return Ln([new Ie("","data expressions not supported")]);const a=Rn(n,["zoom"]);if(!a&&!jn(t))return Ln([new Ie("","zoom expressions not supported")]);const o=ai(n);return o||a?o instanceof Ie?Ln([o]):o instanceof cr&&!Un(t)?Ln([new Ie("",'"interpolate" expressions cannot be used with this property')]):On(o?new ri(i?"camera":"composite",r.value,o.labels,o instanceof cr?o.interpolation:void 0):new ti(i?"constant":"source",r.value)):Ln([new Ie("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ii{constructor(e,t){this._parameters=e,this._specification=t,Ne(this,Gn(this._parameters,this._specification))}static deserialize(e){return new ii(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ai(e){let t=null;if(e instanceof Yt)t=ai(e.result);else if(e instanceof dr){for(const r of e.args)if(t=ai(r),t)break}else(e instanceof ar||e instanceof cr)&&e.input instanceof Tn&&"zoom"===e.input.name&&(t=e);return t instanceof Ie||e.eachChild((e=>{const r=ai(e);r instanceof Ie?t=r:!t&&r?t=new Ie("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new Ie("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function oi(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!oi(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const si={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function li(e){if(null==e)return{filter:()=>!0,needGeometry:!1};oi(e)||(e=hi(e));const t=ei(e,si);if("error"===t.result)throw new Error(t.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return{filter:(e,r,n)=>t.value.evaluate(e,r,{},n),needGeometry:ci(e)}}function ui(e,t){return e<t?-1:e>t?1:0}function ci(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(ci(e[t]))return!0;return!1}function hi(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?pi(e[1],e[2],"=="):"!="===t?mi(pi(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?pi(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(hi))):"all"===t?["all"].concat(e.slice(1).map(hi)):"none"===t?["all"].concat(e.slice(1).map(hi).map(mi)):"in"===t?di(e[1],e.slice(2)):"!in"===t?mi(di(e[1],e.slice(2))):"has"===t?fi(e[1]):"!has"!==t||mi(fi(e[1]));var r}function pi(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function di(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(ui)]]:["filter-in-small",e,["literal",t]]}}function fi(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function mi(e){return["!",e]}function gi(e){const t=typeof e;if("number"===t||"boolean"===t||"string"===t||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const r of e)t+=`${gi(r)},`;return`${t}]`}const r=Object.keys(e).sort();let n="{";for(let t=0;t<r.length;t++)n+=`${JSON.stringify(r[t])}:${gi(e[r[t]])},`;return`${n}}`}function yi(e){let t="";for(const r of ve)t+=`/${gi(e[r])}`;return t}function vi(e){const t=e.value;return t?[new Te(e.key,t,"constants have been deprecated as of v8")]:[]}function xi(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function _i(e){if(Array.isArray(e))return e.map(_i);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=_i(e[r]);return t}return xi(e)}function bi(e){const t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},a=e.style,o=e.styleSpec,s=e.validateSpec;let l=[];const u=Vn(r);if("object"!==u)return[new Te(t,r,`object expected, ${u} found`)];for(const e in r){const u=e.split(".")[0],c=yt(n,u)||n["*"];let h;if(yt(i,u))h=i[u];else if(yt(n,u))h=s;else if(i["*"])h=i["*"];else{if(!n["*"]){l.push(new Te(t,r[e],`unknown property "${e}"`));continue}h=s}l=l.concat(h({key:(t?`${t}.`:t)+e,value:r[e],valueSpec:c,style:a,styleSpec:o,object:r,objectKey:e,validateSpec:s},r))}for(const e in n)i[e]||n[e].required&&void 0===n[e].default&&void 0===r[e]&&l.push(new Te(t,r,`missing required property "${e}"`));return l}function wi(e){const t=e.value,r=e.valueSpec,n=e.style,i=e.styleSpec,a=e.key,o=e.arrayElementValidator||e.validateSpec;if("array"!==Vn(t))return[new Te(a,t,`array expected, ${Vn(t)} found`)];if(r.length&&t.length!==r.length)return[new Te(a,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Te(a,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let s={type:r.value,values:r.values};i.$version<7&&(s.function=r.function),"object"===Vn(r.value)&&(s=r.value);let l=[];for(let r=0;r<t.length;r++)l=l.concat(o({array:t,arrayIndex:r,value:t[r],valueSpec:s,validateSpec:e.validateSpec,style:n,styleSpec:i,key:`${a}[${r}]`}));return l}function Ai(e){const t=e.key,r=e.value,n=e.valueSpec;let i=Vn(r);return"number"===i&&r!=r&&(i="NaN"),"number"!==i?[new Te(t,r,`number expected, ${i} found`)]:"minimum"in n&&r<n.minimum?[new Te(t,r,`${r} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&r>n.maximum?[new Te(t,r,`${r} is greater than the maximum value ${n.maximum}`)]:[]}function Ci(e){const t=e.valueSpec,r=xi(e.value.type);let n,i,a,o={};const s="categorical"!==r&&void 0===e.value.property,l=!s,u="array"===Vn(e.value.stops)&&"array"===Vn(e.value.stops[0])&&"object"===Vn(e.value.stops[0][0]),c=bi({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===r)return[new Te(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(wi({key:e.key,value:n,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===Vn(n)&&0===n.length&&t.push(new Te(e.key,n,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&s&&c.push(new Te(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||c.push(new Te(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!Un(e.valueSpec)&&c.push(new Te(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!qn(e.valueSpec)?c.push(new Te(e.key,e.value,"property functions not supported")):s&&!jn(e.valueSpec)&&c.push(new Te(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!u||void 0!==e.value.property||c.push(new Te(e.key,e.value,'"property" property is required')),c;function h(e){let r=[];const n=e.value,s=e.key;if("array"!==Vn(n))return[new Te(s,n,`array expected, ${Vn(n)} found`)];if(2!==n.length)return[new Te(s,n,`array length 2 expected, length ${n.length} found`)];if(u){if("object"!==Vn(n[0]))return[new Te(s,n,`object expected, ${Vn(n[0])} found`)];if(void 0===n[0].zoom)return[new Te(s,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new Te(s,n,"object stop key must have value")];if(a&&a>xi(n[0].zoom))return[new Te(s,n[0].zoom,"stop zoom values must appear in ascending order")];xi(n[0].zoom)!==a&&(a=xi(n[0].zoom),i=void 0,o={}),r=r.concat(bi({key:`${s}[0]`,value:n[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Ai,value:p}}))}else r=r.concat(p({key:`${s}[0]`,value:n[0],validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},n));return Qn(_i(n[1]))?r.concat([new Te(`${s}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(e.validateSpec({key:`${s}[1]`,value:n[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function p(e,a){const s=Vn(e.value),l=xi(e.value),u=null!==e.value?e.value:a;if(n){if(s!==n)return[new Te(e.key,u,`${s} stop domain type must match previous stop domain type ${n}`)]}else n=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Te(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==r){let n=`number expected, ${s} found`;return qn(t)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Te(e.key,u,n)]}return"categorical"!==r||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==r&&"number"===s&&void 0!==i&&l<i?[new Te(e.key,u,"stop domain values must appear in ascending order")]:(i=l,"categorical"===r&&l in o?[new Te(e.key,u,"stop domain values must be unique")]:(o[l]=!0,[])):[new Te(e.key,u,`integer expected, found ${l}`)]}}function Ei(e){const t=("property"===e.expressionContext?ni:ei)(_i(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new Te(`${e.key}${t.key}`,e.value,t.message)));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Te(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Fn(r))return[new Te(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Fn(r))return[new Te(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!Rn(r,["zoom","feature-state"]))return[new Te(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!kn(r))return[new Te(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Mi(e){const t=e.key,r=e.value,n=Vn(r);return"string"!==n?[new Te(t,r,`color expected, ${n} found`)]:Et.parse(String(r))?[]:[new Te(t,r,`color expected, "${r}" found`)]}function Si(e){const t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(xi(r))&&i.push(new Te(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf(xi(r))&&i.push(new Te(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function Di(e){return oi(_i(e.value))?Ei(Ne({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ti(e)}function Ti(e){const t=e.value,r=e.key;if("array"!==Vn(t))return[new Te(r,t,`array expected, ${Vn(t)} found`)];const n=e.styleSpec;let i,a=[];if(t.length<1)return[new Te(r,t,"filter array must have at least 1 element")];switch(a=a.concat(Si({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),xi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===xi(t[1])&&a.push(new Te(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&a.push(new Te(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(i=Vn(t[1]),"string"!==i&&a.push(new Te(`${r}[1]`,t[1],`string expected, ${i} found`)));for(let o=2;o<t.length;o++)i=Vn(t[o]),"$type"===xi(t[1])?a=a.concat(Si({key:`${r}[${o}]`,value:t[o],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new Te(`${r}[${o}]`,t[o],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)a=a.concat(Ti({key:`${r}[${n}]`,value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Vn(t[1]),2!==t.length?a.push(new Te(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==i&&a.push(new Te(`${r}[1]`,t[1],`string expected, ${i} found`))}return a}function Ni(e,t){const r=e.key,n=e.validateSpec,i=e.style,a=e.styleSpec,o=e.value,s=e.objectKey,l=a[`${t}_${e.layerType}`];if(!l)return[];const u=s.match(/^(.*)-transition$/);if("paint"===t&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:o,valueSpec:a.transition,style:i,styleSpec:a});const c=e.valueSpec||l[s];if(!c)return[new Te(r,o,`unknown property "${s}"`)];let h;if("string"===Vn(o)&&qn(c)&&!c.tokens&&(h=/^{([^}]+)}$/.exec(o)))return[new Te(r,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const p=[];return"symbol"===e.layerType&&("text-field"===s&&i&&!i.glyphs&&p.push(new Te(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&Zn(_i(o))&&"identity"===xi(o.type)&&p.push(new Te(r,o,'"text-font" does not support identity functions'))),p.concat(n({key:e.key,value:o,valueSpec:c,style:i,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:s}))}function Ii(e){return Ni(e,"paint")}function Pi(e){return Ni(e,"layout")}function zi(e){let t=[];const r=e.value,n=e.key,i=e.style,a=e.styleSpec;if("object"!==Vn(r))return[new Te(n,r,`object expected, ${Vn(r)} found`)];r.type||r.ref||t.push(new Te(n,r,'either "type" or "ref" is required'));let o=xi(r.type);const s=xi(r.ref);if(r.id){const a=xi(r.id);for(let o=0;o<e.arrayIndex;o++){const e=i.layers[o];xi(e.id)===a&&t.push(new Te(n,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in r&&t.push(new Te(n,r[e],`"${e}" is prohibited for ref layers`))})),i.layers.forEach((t=>{xi(t.id)===s&&(e=t)})),e?e.ref?t.push(new Te(n,r.ref,"ref cannot reference another ref layer")):o=xi(e.type):t.push(new Te(n,r.ref,`ref layer "${s}" not found`))}else if("background"!==o)if(r.source){const e=i.sources&&i.sources[r.source],a=e&&xi(e.type);e?"vector"===a&&"raster"===o?t.push(new Te(n,r.source,`layer "${r.id}" requires a raster source`)):"raster-dem"!==a&&"hillshade"===o?t.push(new Te(n,r.source,`layer "${r.id}" requires a raster-dem source`)):"raster"===a&&"raster"!==o?t.push(new Te(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==a||r["source-layer"]?"raster-dem"===a&&"hillshade"!==o?t.push(new Te(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!r.paint||!r.paint["line-gradient"]||"geojson"===a&&e.lineMetrics||t.push(new Te(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Te(n,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Te(n,r.source,`source "${r.source}" not found`))}else t.push(new Te(n,r,'missing required property "source"'));return t=t.concat(bi({key:n,value:r,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:`${n}.type`,value:r.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"}),filter:Di,layout:e=>bi({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Pi(Ne({layerType:o},e))}}),paint:e=>bi({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Ii(Ne({layerType:o},e))}})}})),t}function Bi(e){const t=e.value,r=e.key,n=Vn(t);return"string"!==n?[new Te(r,t,`string expected, ${n} found`)]:[]}const ki={promoteId:function({key:e,value:t}){if("string"===Vn(t))return Bi({key:e,value:t});{const r=[];for(const n in t)r.push(...Bi({key:`${e}.${n}`,value:t[n]}));return r}}};function Fi(e){const t=e.value,r=e.key,n=e.styleSpec,i=e.style,a=e.validateSpec;if(!t.type)return[new Te(r,t,'"type" is required')];const o=xi(t.type);let s;switch(o){case"vector":case"raster":return s=bi({key:r,value:t,valueSpec:n[`source_${o.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:ki,validateSpec:a}),s;case"raster-dem":return s=function(e){var t;const r=null!==(t=e.sourceName)&&void 0!==t?t:"",n=e.value,i=e.styleSpec,a=i.source_raster_dem,o=e.style;let s=[];const l=Vn(n);if(void 0===n)return s;if("object"!==l)return s.push(new Te("source_raster_dem",n,`object expected, ${l} found`)),s;const u="custom"===xi(n.encoding),c=["redFactor","greenFactor","blueFactor","baseShift"],h=e.value.encoding?`"${e.value.encoding}"`:"Default";for(const t in n)!u&&c.includes(t)?s.push(new Te(t,n[t],`In "${r}": "${t}" is only valid when "encoding" is set to "custom". ${h} encoding found`)):a[t]?s=s.concat(e.validateSpec({key:t,value:n[t],valueSpec:a[t],validateSpec:e.validateSpec,style:o,styleSpec:i})):s.push(new Te(t,n[t],`unknown property "${t}"`));return s}({sourceName:r,value:t,style:e.style,styleSpec:n,validateSpec:a}),s;case"geojson":if(s=bi({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:a,objectElementValidators:ki}),t.cluster)for(const e in t.clusterProperties){const[n,i]=t.clusterProperties[e],a="string"==typeof n?[n,["accumulated"],["get",e]]:n;s.push(...Ei({key:`${r}.${e}.map`,value:i,expressionContext:"cluster-map"})),s.push(...Ei({key:`${r}.${e}.reduce`,value:a,expressionContext:"cluster-reduce"}))}return s;case"video":return bi({key:r,value:t,valueSpec:n.source_video,style:i,validateSpec:a,styleSpec:n});case"image":return bi({key:r,value:t,valueSpec:n.source_image,style:i,validateSpec:a,styleSpec:n});case"canvas":return[new Te(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Si({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Ri(e){const t=e.value,r=e.styleSpec,n=r.light,i=e.style;let a=[];const o=Vn(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new Te("light",t,`object expected, ${o} found`)]),a;for(const o in t){const s=o.match(/^(.*)-transition$/);a=a.concat(s&&n[s[1]]&&n[s[1]].transition?e.validateSpec({key:o,value:t[o],valueSpec:r.transition,validateSpec:e.validateSpec,style:i,styleSpec:r}):n[o]?e.validateSpec({key:o,value:t[o],valueSpec:n[o],validateSpec:e.validateSpec,style:i,styleSpec:r}):[new Te(o,t[o],`unknown property "${o}"`)])}return a}function Oi(e){const t=e.value,r=e.styleSpec,n=r.sky,i=e.style,a=Vn(t);if(void 0===t)return[];if("object"!==a)return[new Te("sky",t,`object expected, ${a} found`)];let o=[];for(const a in t)o=o.concat(n[a]?e.validateSpec({key:a,value:t[a],valueSpec:n[a],style:i,styleSpec:r}):[new Te(a,t[a],`unknown property "${a}"`)]);return o}function Li(e){const t=e.value,r=e.styleSpec,n=r.terrain,i=e.style;let a=[];const o=Vn(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new Te("terrain",t,`object expected, ${o} found`)]),a;for(const o in t)a=a.concat(n[o]?e.validateSpec({key:o,value:t[o],valueSpec:n[o],validateSpec:e.validateSpec,style:i,styleSpec:r}):[new Te(o,t[o],`unknown property "${o}"`)]);return a}function qi(e){let t=[];const r=e.value,n=e.key;if(Array.isArray(r)){const i=[],a=[];for(const o in r)r[o].id&&i.includes(r[o].id)&&t.push(new Te(n,r,`all the sprites' ids must be unique, but ${r[o].id} is duplicated`)),i.push(r[o].id),r[o].url&&a.includes(r[o].url)&&t.push(new Te(n,r,`all the sprites' URLs must be unique, but ${r[o].url} is duplicated`)),a.push(r[o].url),t=t.concat(bi({key:`${n}[${o}]`,value:r[o],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:e.validateSpec}));return t}return Bi({key:n,value:r})}function ji(e){return t=e.value,Boolean(t)&&t.constructor===Object?[]:[new Te(e.key,e.value,`object expected, ${Vn(e.value)} found`)];var t}const Ui={"*":()=>[],array:wi,boolean:function(e){const t=e.value,r=e.key,n=Vn(t);return"boolean"!==n?[new Te(r,t,`boolean expected, ${n} found`)]:[]},number:Ai,color:Mi,constants:vi,enum:Si,filter:Di,function:Ci,layer:zi,object:bi,source:Fi,light:Ri,sky:Oi,terrain:Li,projection:function(e){const t=e.value,r=e.styleSpec,n=r.projection,i=e.style,a=Vn(t);if(void 0===t)return[];if("object"!==a)return[new Te("projection",t,`object expected, ${a} found`)];let o=[];for(const a in t)o=o.concat(n[a]?e.validateSpec({key:a,value:t[a],valueSpec:n[a],style:i,styleSpec:r}):[new Te(a,t[a],`unknown property "${a}"`)]);return o},projectionDefinition:function(e){const t=e.key;let r=e.value;r=r instanceof String?r.valueOf():r;const n=Vn(r);return"array"!==n||function(e){return Array.isArray(e)&&3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]&&"number"==typeof e[2]}(r)||function(e){return!!["interpolate","step","literal"].includes(e[0])}(r)?["array","string"].includes(n)?[]:[new Te(t,r,`projection expected, invalid type "${n}" found`)]:[new Te(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Bi,formatted:function(e){return 0===Bi(e).length?[]:Ei(e)},resolvedImage:function(e){return 0===Bi(e).length?[]:Ei(e)},padding:function(e){const t=e.key,r=e.value;if("array"===Vn(r)){if(r.length<1||r.length>4)return[new Te(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const n={type:"number"};let i=[];for(let a=0;a<r.length;a++)i=i.concat(e.validateSpec({key:`${t}[${a}]`,value:r[a],validateSpec:e.validateSpec,valueSpec:n}));return i}return Ai({key:t,value:r,valueSpec:{}})},numberArray:function(e){const t=e.key,r=e.value;if("array"===Vn(r)){const n={type:"number"};if(r.length<1)return[new Te(t,r,"array length at least 1 expected, length 0 found")];let i=[];for(let a=0;a<r.length;a++)i=i.concat(e.validateSpec({key:`${t}[${a}]`,value:r[a],validateSpec:e.validateSpec,valueSpec:n}));return i}return Ai({key:t,value:r,valueSpec:{}})},colorArray:function(e){const t=e.key,r=e.value;if("array"===Vn(r)){if(r.length<1)return[new Te(t,r,"array length at least 1 expected, length 0 found")];let e=[];for(let n=0;n<r.length;n++)e=e.concat(Mi({key:`${t}[${n}]`,value:r[n]}));return e}return Mi({key:t,value:r})},variableAnchorOffsetCollection:function(e){const t=e.key,r=e.value,n=Vn(r),i=e.styleSpec;if("array"!==n||r.length<1||r.length%2!=0)return[new Te(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let n=0;n<r.length;n+=2)a=a.concat(Si({key:`${t}[${n}]`,value:r[n],valueSpec:i.layout_symbol["text-anchor"]})),a=a.concat(wi({key:`${t}[${n+1}]`,value:r[n+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:i}));return a},sprite:qi,state:ji};function Vi(e){const t=e.value,r=e.valueSpec,n=e.styleSpec;return e.validateSpec=Vi,r.expression&&Zn(xi(t))?Ci(e):r.expression&&Qn(_i(t))?Ei(e):r.type&&Ui[r.type]?Ui[r.type](e):bi(Ne({},e,{valueSpec:r.type?n[r.type]:r}))}function Zi(e){const t=e.value,r=e.key,n=Bi(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new Te(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new Te(r,t,'"glyphs" url must include a "{range}" token'))),n}function $i(e,t=ye){let r=[];return r=r.concat(Vi({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:Vi,objectElementValidators:{glyphs:Zi,"*":()=>[]}})),e.constants&&(r=r.concat(vi({key:"constants",value:e.constants}))),Hi(r)}function Gi(e){return function(t){return e({...t,validateSpec:Vi})}}function Hi(e){return[].concat(e).sort(((e,t)=>e.line-t.line))}function Wi(e){return function(...t){return Hi(e.apply(this,t))}}$i.source=Wi(Gi(Fi)),$i.sprite=Wi(Gi(qi)),$i.glyphs=Wi(Gi(Zi)),$i.light=Wi(Gi(Ri)),$i.sky=Wi(Gi(Oi)),$i.terrain=Wi(Gi(Li)),$i.state=Wi(Gi(ji)),$i.layer=Wi(Gi(zi)),$i.filter=Wi(Gi(Di)),$i.paintProperty=Wi(Gi(Ii)),$i.layoutProperty=Wi(Gi(Pi));const Xi=$i,Yi=Xi.light,Ki=Xi.sky,Ji=Xi.paintProperty,Qi=Xi.layoutProperty;function ea(e,t){let r=!1;if(t&&t.length)for(const n of t)e.fire(new me(new Error(n.message))),r=!0;return r}class ta{constructor(e,t,r){const n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const i=new Int32Array(this.arrayBuffer);e=i[0],this.d=(t=i[1])+2*(r=i[2]);for(let e=0;e<this.d*this.d;e++){const t=i[3+e],r=i[3+e+1];n.push(t===r?null:i.subarray(t,r))}const a=i[3+n.length+1];this.keys=i.subarray(i[3+n.length],a),this.bboxes=i.subarray(a),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let e=0;e<this.d*this.d;e++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;const i=r/t*e;this.min=-i,this.max=e+i}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,n,i,a){this.cells[i].push(a)}query(e,t,r,n,i){const a=this.min,o=this.max;if(e<=a&&t<=a&&o<=r&&o<=n&&!i)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(e,t,r,n,this._queryCell,a,{},i),a}}_queryCell(e,t,r,n,i,a,o,s){const l=this.cells[i];if(null!==l){const i=this.keys,u=this.bboxes;for(let c=0;c<l.length;c++){const h=l[c];if(void 0===o[h]){const l=4*h;(s?s(u[l+0],u[l+1],u[l+2],u[l+3]):e<=u[l+2]&&t<=u[l+3]&&r>=u[l+0]&&n>=u[l+1])?(o[h]=!0,a.push(i[h])):o[h]=!1}}}}_forEachCell(e,t,r,n,i,a,o,s){const l=this._convertToCellCoord(e),u=this._convertToCellCoord(t),c=this._convertToCellCoord(r),h=this._convertToCellCoord(n);for(let p=l;p<=c;p++)for(let l=u;l<=h;l++){const u=this.d*l+p;if((!s||s(this._convertFromCellCoord(p),this._convertFromCellCoord(l),this._convertFromCellCoord(p+1),this._convertFromCellCoord(l+1)))&&i.call(this,e,t,r,n,u,a,o,s))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,t=3+this.cells.length+1+1;let r=0;for(let e=0;e<this.cells.length;e++)r+=this.cells[e].length;const n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let i=t;for(let t=0;t<e.length;t++){const r=e[t];n[3+t]=i,n.set(r,i),i+=r.length}return n[3+e.length]=i,n.set(this.keys,i),i+=this.keys.length,n[3+e.length+1]=i,n.set(this.bboxes,i),i+=this.bboxes.length,n.buffer}static serialize(e,t){const r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}}static deserialize(e){return new ta(e.buffer)}}const ra={};function na(e,t,r={}){if(ra[e])throw new Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),ra[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}na("Object",Object),na("TransferableGridIndex",ta),na("Color",Et),na("Error",Error),na("AJAXError",le),na("ResolvedImage",Ft),na("StylePropertyFunction",ii),na("StyleExpression",Jn,{omit:["_evaluator"]}),na("ZoomDependentExpression",ri),na("ZoomConstantExpression",ti),na("CompoundExpression",Tn,{omit:["_evaluate"]});for(const e in Dn)Dn[e]._classRegistryKey||na(`Expression_${e}`,Dn[e]);function ia(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function aa(e){return e.$name||e.constructor._classRegistryKey}function oa(e){return!function(e){if(null===e||"object"!=typeof e)return!1;const t=aa(e);return!(!t||"Object"===t)}(e)&&(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||ia(e)||H(e)||ArrayBuffer.isView(e)||e instanceof ImageData)}function sa(e,t){if(oa(e))return(ia(e)||H(e))&&t&&t.push(e),ArrayBuffer.isView(e)&&t&&t.push(e.buffer),e instanceof ImageData&&t&&t.push(e.data.buffer),e;if(Array.isArray(e)){const r=[];for(const n of e)r.push(sa(n,t));return r}if("object"!=typeof e)throw new Error("can't serialize object of type "+typeof e);const r=aa(e);if(!r)throw new Error(`can't serialize object of unregistered class ${e.constructor.name}`);if(!ra[r])throw new Error(`${r} is not registered.`);const{klass:n}=ra[r],i=n.serialize?n.serialize(e,t):{};if(n.serialize){if(t&&i===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const n in e){if(!e.hasOwnProperty(n))continue;if(ra[r].omit.indexOf(n)>=0)continue;const a=e[n];i[n]=ra[r].shallow.indexOf(n)>=0?a:sa(a,t)}e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(i.$name=r),i}function la(e){if(oa(e))return e;if(Array.isArray(e))return e.map(la);if("object"!=typeof e)throw new Error("can't deserialize object of type "+typeof e);const t=aa(e)||"Object";if(!ra[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=ra[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);const n=Object.create(r.prototype);for(const r of Object.keys(e)){if("$name"===r)continue;const i=e[r];n[r]=ra[t].shallow.indexOf(r)>=0?i:la(i)}return n}class ua{constructor(){this.first=!0}update(e,t){const r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}const ca={"Latin-1 Supplement":e=>e>=128&&e<=255,"Hangul Jamo":e=>e>=4352&&e<=4607,Khmer:e=>e>=6016&&e<=6143,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Kanbun:e=>e>=12688&&e<=12703,"CJK Strokes":e=>e>=12736&&e<=12783,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Hangul Syllables":e=>e>=44032&&e<=55215,"Private Use Area":e=>e>=57344&&e<=63743,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function ha(e){for(const t of e)if(ya(t.charCodeAt(0)))return!0;return!1}function pa(e){for(const t of e)if(!ma(t.charCodeAt(0)))return!1;return!0}function da(e){const t=e.map((e=>{try{return new RegExp(`\\p{sc=${e}}`,"u").source}catch(e){return null}})).filter((e=>e));return new RegExp(t.join("|"),"u")}const fa=da(["Arab","Dupl","Mong","Ougr","Syrc"]);function ma(e){return!fa.test(String.fromCodePoint(e))}const ga=da(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function ya(e){return!(746!==e&&747!==e&&(e<4352||!(ca["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||ca["CJK Compatibility"](e)||ca["CJK Strokes"](e)||!(!ca["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||ca["Enclosed CJK Letters and Months"](e)||ca["Ideographic Description Characters"](e)||ca.Kanbun(e)||ca.Katakana(e)&&12540!==e||!(!ca["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!ca["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||ca["Vertical Forms"](e)||ca["Yijing Hexagram Symbols"](e)||/\p{sc=Cans}/u.test(String.fromCodePoint(e))||/\p{sc=Hang}/u.test(String.fromCodePoint(e))||ga.test(String.fromCodePoint(e)))))}function va(e){return!(ya(e)||function(e){return!!(ca["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||ca["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||ca["Letterlike Symbols"](e)||ca["Number Forms"](e)||ca["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||ca["Control Pictures"](e)&&9251!==e||ca["Optical Character Recognition"](e)||ca["Enclosed Alphanumerics"](e)||ca["Geometric Shapes"](e)||ca["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ca["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ca["CJK Symbols and Punctuation"](e)||ca.Katakana(e)||ca["Private Use Area"](e)||ca["CJK Compatibility Forms"](e)||ca["Small Form Variants"](e)||ca["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}const xa=da(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function _a(e){return xa.test(String.fromCodePoint(e))}function ba(e,t){return!(!t&&_a(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||ca.Khmer(e))}function wa(e){for(const t of e)if(_a(t.charCodeAt(0)))return!0;return!1}const Aa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){if(Aa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getRTLTextPluginStatus(){return this.pluginStatus}syncState(e,r){return t(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if("loading"!==e.pluginStatus)return this.setState(e),e;const t=e.pluginURL,n=new Promise((e=>{this.loadScriptResolve=e}));r(t);const i=new Promise((e=>setTimeout((()=>e()),this.TIMEOUT)));if(yield Promise.race([n,i]),this.isParsed()){const e={pluginStatus:"loaded",pluginURL:t};return this.setState(e),e}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${t}`)}))}};class Ca{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ua,this.transition={})}isSupportedScript(e){return function(e,t){for(const r of e)if(!ba(r.charCodeAt(0),t))return!1;return!0}(e,"loaded"===Aa.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}}class Ea{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(Zn(e))return new ii(e,t);if(Qn(e)){const r=ni(e,t);if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return r.value}{let r=e;return"color"===t.type&&"string"==typeof e?r=Et.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"numberArray"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"colorArray"!==t.type||"string"!=typeof e&&!Array.isArray(e)?"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)?r=kt.parse(e):"projectionDefinition"===t.type&&"string"==typeof e&&(r=Rt.parse(e)):r=Pt.parse(e):r=It.parse(e):r=Nt.parse(e),{kind:"constant",evaluate:()=>r}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}class Ma{constructor(e){this.property=e,this.value=new Ea(e,void 0)}transitioned(e,t){return new Da(this.property,this.value,t,R({},e.transition,this.transition),e.now)}untransitioned(){return new Da(this.property,this.value,null,{},0)}}class Sa{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return j(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ma(this._values[e].property)),this._values[e].value=new Ea(this._values[e].property,null===t?void 0:j(t))}getTransition(e){return j(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ma(this._values[e].property)),this._values[e].transition=j(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r);const n=this.getTransition(t);void 0!==n&&(e[`${t}-transition`]=n)}return e}transitioned(e,t){const r=new Ta(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){const e=new Ta(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Da{constructor(e,t,r,n,i){this.property=e,this.value=t,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){const n=e.now||0,i=this.value.possiblyEvaluate(e,t,r),a=this.prior;if(a){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return a.possiblyEvaluate(e,t,r);{const o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,r),i,P(o))}}return i}}class Ta{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){const n=new Pa(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Na{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return void 0!==this._values[e].value}getValue(e){return j(this._values[e].value)}setValue(e,t){this._values[e]=new Ea(this._values[e].property,null===t?void 0:j(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){const n=new Pa(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}}class Ia{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}}class Pa{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class za{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){const n=pr[this.specification.type];return n?n(e,t,r):e}}class Ba{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return new Ia(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)}:e.expression,t)}interpolate(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Ia(this,{kind:"constant",value:void 0},e.parameters);const n=pr[this.specification.type];if(n){const i=n(e.value.value,t.value.value,r);return new Ia(this,{kind:"constant",value:i},e.parameters)}return e}evaluate(e,t,r,n,i,a){return"constant"===e.kind?e.value:e.evaluate(t,r,n,i,a)}}class ka extends Ba{possiblyEvaluate(e,t,r,n){if(void 0===e.value)return new Ia(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},r,n),a="resolvedImage"===e.property.specification.type&&"string"!=typeof i?i.name:i,o=this._calculate(a,a,a,t);return new Ia(this,{kind:"constant",value:o},t)}if("camera"===e.expression.kind){const r=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new Ia(this,{kind:"constant",value:r},t)}return new Ia(this,e.expression,t)}evaluate(e,t,r,n,i,a){if("source"===e.kind){const o=e.evaluate(t,r,n,i,a);return this._calculate(o,o,o,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class Fa{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){if(void 0!==e.value){if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},r,n);return this._calculate(i,i,i,t)}return this._calculate(e.expression.evaluate(new Ca(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Ca(Math.floor(t.zoom),t)),e.expression.evaluate(new Ca(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}}class Ra{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}}class Oa{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const t in e){const r=e[t];r.specification.overridable&&this.overridableProperties.push(t);const n=this.defaultPropertyValues[t]=new Ea(r,void 0),i=this.defaultTransitionablePropertyValues[t]=new Ma(r);this.defaultTransitioningPropertyValues[t]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}}}na("DataDrivenProperty",Ba),na("DataConstantProperty",za),na("CrossFadedDataDrivenProperty",ka),na("CrossFadedProperty",Fa),na("ColorRampProperty",Ra);const La="-transition";class qa extends ge{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Na(t.layout)),t.paint)){this._transitionablePaint=new Sa(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Pa(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,r={}){null!=t&&this._validate(Qi,`layers.${this.id}.layout.${e}`,e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return e.endsWith(La)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(null!=t&&this._validate(Ji,`layers.${this.id}.paint.${e}`,e,t,r))return!1;if(e.endsWith(La))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const r=this._transitionablePaint._values[e],n="cross-faded-data-driven"===r.property.specification["property-type"],i=r.value.isDataDriven(),a=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const o=this._transitionablePaint._values[e].value;return o.isDataDriven()||i||n||this._handleOverridablePaintPropertyUpdate(e,a,o)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),q(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,r,n,i={}){return(!i||!1!==i.validate)&&ea(this,e.call(Xi,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof Ia&&qn(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}const ja={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ua{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Va{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Za(e,t=1){let r=0,n=0;return{members:e.map((e=>{const i=ja[e.type].BYTES_PER_ELEMENT,a=r=$a(r,Math.max(t,i)),o=e.components||1;return n=Math.max(n,i),r+=i*o,{name:e.name,type:e.type,components:o,offset:a}})),size:$a(r,Math.max(n,t)),alignment:t}}function $a(e,t){return Math.ceil(e/t)*t}class Ga extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e}}Ga.prototype.bytesPerElement=4,na("StructArrayLayout2i4",Ga);class Ha extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,e}}Ha.prototype.bytesPerElement=6,na("StructArrayLayout3i6",Ha);class Wa extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const a=4*e;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=n,this.int16[a+3]=i,e}}Wa.prototype.bytesPerElement=8,na("StructArrayLayout4i8",Wa);class Xa extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}emplace(e,t,r,n,i,a,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=o,e}}Xa.prototype.bytesPerElement=12,na("StructArrayLayout2i4i12",Xa);class Ya extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}emplace(e,t,r,n,i,a,o){const s=4*e,l=8*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.uint8[l+4]=n,this.uint8[l+5]=i,this.uint8[l+6]=a,this.uint8[l+7]=o,e}}Ya.prototype.bytesPerElement=8,na("StructArrayLayout2i4ub8",Ya);class Ka extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e}}Ka.prototype.bytesPerElement=8,na("StructArrayLayout2f8",Ka);class Ja extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l,u){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,i,a,o,s,l,u)}emplace(e,t,r,n,i,a,o,s,l,u,c){const h=10*e;return this.uint16[h+0]=t,this.uint16[h+1]=r,this.uint16[h+2]=n,this.uint16[h+3]=i,this.uint16[h+4]=a,this.uint16[h+5]=o,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,e}}Ja.prototype.bytesPerElement=20,na("StructArrayLayout10ui20",Ja);class Qa extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l,u,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,t,r,n,i,a,o,s,l,u,c,h)}emplace(e,t,r,n,i,a,o,s,l,u,c,h,p){const d=12*e;return this.int16[d+0]=t,this.int16[d+1]=r,this.int16[d+2]=n,this.int16[d+3]=i,this.uint16[d+4]=a,this.uint16[d+5]=o,this.uint16[d+6]=s,this.uint16[d+7]=l,this.int16[d+8]=u,this.int16[d+9]=c,this.int16[d+10]=h,this.int16[d+11]=p,e}}Qa.prototype.bytesPerElement=24,na("StructArrayLayout4i4ui4i24",Qa);class eo extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}eo.prototype.bytesPerElement=12,na("StructArrayLayout3f12",eo);class to extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}to.prototype.bytesPerElement=4,na("StructArrayLayout1ul4",to);class ro extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,n,i,a,o,s,l)}emplace(e,t,r,n,i,a,o,s,l,u){const c=10*e,h=5*e;return this.int16[c+0]=t,this.int16[c+1]=r,this.int16[c+2]=n,this.int16[c+3]=i,this.int16[c+4]=a,this.int16[c+5]=o,this.uint32[h+3]=s,this.uint16[c+8]=l,this.uint16[c+9]=u,e}}ro.prototype.bytesPerElement=20,na("StructArrayLayout6i1ul2ui20",ro);class no extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}emplace(e,t,r,n,i,a,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=o,e}}no.prototype.bytesPerElement=12,na("StructArrayLayout2i2i2i12",no);class io extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i)}emplace(e,t,r,n,i,a){const o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.int16[s+6]=i,this.int16[s+7]=a,e}}io.prototype.bytesPerElement=16,na("StructArrayLayout2f1f2i16",io);class ao extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}emplace(e,t,r,n,i,a,o){const s=16*e,l=4*e,u=8*e;return this.uint8[s+0]=t,this.uint8[s+1]=r,this.float32[l+1]=n,this.float32[l+2]=i,this.int16[u+6]=a,this.int16[u+7]=o,e}}ao.prototype.bytesPerElement=16,na("StructArrayLayout2ub2f2i16",ao);class oo extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,this.uint16[i+2]=n,e}}oo.prototype.bytesPerElement=6,na("StructArrayLayout3ui6",oo);class so extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,t,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g)}emplace(e,t,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g,y){const v=24*e,x=12*e,_=48*e;return this.int16[v+0]=t,this.int16[v+1]=r,this.uint16[v+2]=n,this.uint16[v+3]=i,this.uint32[x+2]=a,this.uint32[x+3]=o,this.uint32[x+4]=s,this.uint16[v+10]=l,this.uint16[v+11]=u,this.uint16[v+12]=c,this.float32[x+7]=h,this.float32[x+8]=p,this.uint8[_+36]=d,this.uint8[_+37]=f,this.uint8[_+38]=m,this.uint32[x+10]=g,this.int16[v+22]=y,e}}so.prototype.bytesPerElement=48,na("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",so);class lo extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,x,_,b,w,A,C,E,M,S){const D=this.length;return this.resize(D+1),this.emplace(D,e,t,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,x,_,b,w,A,C,E,M,S)}emplace(e,t,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,x,_,b,w,A,C,E,M,S,D){const T=32*e,N=16*e;return this.int16[T+0]=t,this.int16[T+1]=r,this.int16[T+2]=n,this.int16[T+3]=i,this.int16[T+4]=a,this.int16[T+5]=o,this.int16[T+6]=s,this.int16[T+7]=l,this.uint16[T+8]=u,this.uint16[T+9]=c,this.uint16[T+10]=h,this.uint16[T+11]=p,this.uint16[T+12]=d,this.uint16[T+13]=f,this.uint16[T+14]=m,this.uint16[T+15]=g,this.uint16[T+16]=y,this.uint16[T+17]=v,this.uint16[T+18]=x,this.uint16[T+19]=_,this.uint16[T+20]=b,this.uint16[T+21]=w,this.uint16[T+22]=A,this.uint32[N+12]=C,this.float32[N+13]=E,this.float32[N+14]=M,this.uint16[T+30]=S,this.uint16[T+31]=D,e}}lo.prototype.bytesPerElement=64,na("StructArrayLayout8i15ui1ul2f2ui64",lo);class uo extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}uo.prototype.bytesPerElement=4,na("StructArrayLayout1f4",uo);class co extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[6*e+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}co.prototype.bytesPerElement=12,na("StructArrayLayout1ui2f12",co);class ho extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=4*e;return this.uint32[2*e+0]=t,this.uint16[i+2]=r,this.uint16[i+3]=n,e}}ho.prototype.bytesPerElement=8,na("StructArrayLayout1ul2ui8",ho);class po extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}}po.prototype.bytesPerElement=4,na("StructArrayLayout2ui4",po);class fo extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}fo.prototype.bytesPerElement=2,na("StructArrayLayout1ui2",fo);class mo extends Va{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const a=4*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,this.float32[a+3]=i,e}}mo.prototype.bytesPerElement=16,na("StructArrayLayout4f16",mo);class go extends Ua{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new l(this.anchorPointX,this.anchorPointY)}}go.prototype.size=20;class yo extends ro{get(e){return new go(this,e)}}na("CollisionBoxArray",yo);class vo extends Ua{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}vo.prototype.size=48;class xo extends so{get(e){return new vo(this,e)}}na("PlacedSymbolArray",xo);class _o extends Ua{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}_o.prototype.size=64;class bo extends lo{get(e){return new _o(this,e)}}na("SymbolInstanceArray",bo);class wo extends uo{getoffsetX(e){return this.float32[1*e+0]}}na("GlyphOffsetArray",wo);class Ao extends Ha{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}na("SymbolLineVertexArray",Ao);class Co extends Ua{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Co.prototype.size=12;class Eo extends co{get(e){return new Co(this,e)}}na("TextAnchorOffsetArray",Eo);class Mo extends Ua{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Mo.prototype.size=8;class So extends ho{get(e){return new Mo(this,e)}}na("FeatureIndexArray",So);class Do extends Ga{}class To extends Ga{}class No extends Ga{}class Io extends Xa{}class Po extends Ya{}class zo extends Ka{}class Bo extends Ja{}class ko extends Qa{}class Fo extends eo{}class Ro extends to{}class Oo extends no{}class Lo extends ao{}class qo extends oo{}class jo extends po{}const Uo=Za([{name:"a_pos",components:2,type:"Int16"}],4),{members:Vo}=Uo;class Zo{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,t,r,n){const i=this.segments[this.segments.length-1];return e>Zo.MAX_VERTEX_ARRAY_LENGTH&&V(`Max vertices per segment is ${Zo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Zo.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!i||i.vertexLength+e>Zo.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n?this.createNewSegment(t,r,n):i}createNewSegment(e,t,r){const n={vertexOffset:e.length,primitiveOffset:t.length,vertexLength:0,primitiveLength:0,vaos:{}};return void 0!==r&&(n.sortKey=r),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(n),n}getOrCreateLatestSegment(e,t,r){return this.prepareSegment(0,e,t,r)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,n){return new Zo([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}}function $o(e,t){return 256*(e=k(Math.floor(e),0,255))+k(Math.floor(t),0,255)}Zo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,na("SegmentVector",Zo);const Go=Za([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ho,Wo,Xo,Yo={exports:{}},Ko={exports:{}},Jo={exports:{}},Qo=function(){if(Xo)return Yo.exports;Xo=1;var e=(Ho||(Ho=1,Ko.exports=function(e,t){var r,n,i,a,o,s,l,u;for(n=e.length-(r=3&e.length),i=t,o=3432918353,s=461845907,u=0;u<n;)l=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,i=27492+(65535&(a=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,r){case 3:l^=(255&e.charCodeAt(u+2))<<16;case 2:l^=(255&e.charCodeAt(u+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(u)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}),Ko.exports),t=(Wo||(Wo=1,Jo.exports=function(e,t){for(var r,n=e.length,i=t^n,a=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++a;switch(n){case 3:i^=(255&e.charCodeAt(a+2))<<16;case 2:i^=(255&e.charCodeAt(a+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(a)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}),Jo.exports);return Yo.exports=e,Yo.exports.murmur3=e,Yo.exports.murmur2=t,Yo.exports}(),es=r(Qo);class ts{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,n){this.ids.push(rs(e)),this.positions.push(t,r,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const t=rs(e);let r=0,n=this.ids.length-1;for(;r<n;){const e=r+n>>1;this.ids[e]>=t?n=e:r=e+1}const i=[];for(;this.ids[r]===t;)i.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return i}static serialize(e,t){const r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return ns(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}}static deserialize(e){const t=new ts;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function rs(e){const t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:es(String(e))}function ns(e,t,r,n){for(;r<n;){const i=e[r+n>>1];let a=r-1,o=n+1;for(;;){do{a++}while(e[a]<i);do{o--}while(e[o]>i);if(a>=o)break;is(e,a,o),is(t,3*a,3*o),is(t,3*a+1,3*o+1),is(t,3*a+2,3*o+2)}o-r<n-o?(ns(e,t,r,o),r=o+1):(ns(e,t,o+1,n),n=o)}}function is(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}na("FeaturePositionMap",ts);class as{constructor(e,t){this.gl=e.gl,this.location=t}}class os extends as{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class ss extends as{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class ls extends as{constructor(e,t){super(e,t),this.current=Et.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const us=new Float32Array(16);function cs(e){return[$o(255*e.r,255*e.g),$o(255*e.b,255*e.a)]}class hs{constructor(e,t,r){this.value=e,this.uniformNames=t.map((e=>`u_${e}`)),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return"color"===this.type?new ls(e,t):new os(e,t)}}class ps{constructor(e,t){this.uniformNames=t.map((e=>`u_${e}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,r,n){const i="u_pattern_to"===n?this.patternTo:"u_pattern_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;i&&e.set(i)}getBinding(e,t,r){return"u_pattern"===r.substr(0,9)?new ss(e,t):new os(e,t)}}class ds{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new n}populatePaintArray(e,t,r,n,i){const a=this.paintVertexArray.length,o=this.expression.evaluate(new Ca(0),t,{},n,[],i);this.paintVertexArray.resize(e),this._setPaintValue(a,e,o)}updatePaintArray(e,t,r,n){const i=this.expression.evaluate({zoom:0},r,n);this._setPaintValue(e,t,i)}_setPaintValue(e,t,r){if("color"===this.type){const n=cs(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class fs{constructor(e,t,r,n,i,a){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new a}populatePaintArray(e,t,r,n,i){const a=this.expression.evaluate(new Ca(this.zoom),t,{},n,[],i),o=this.expression.evaluate(new Ca(this.zoom+1),t,{},n,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,a,o)}updatePaintArray(e,t,r,n){const i=this.expression.evaluate({zoom:this.zoom},r,n),a=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(e,t,i,a)}_setPaintValue(e,t,r,n){if("color"===this.type){const i=cs(r),a=cs(n);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1],a[0],a[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){const r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=k(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,t,r){return new os(e,t)}}class ms{constructor(e,t,r,n,i,a){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=a,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i}populatePaintArray(e,t,r){const n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,n,i){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],i)}_setPaintValues(e,t,r,n){if(!n||!r)return;const{min:i,mid:a,max:o}=r,s=n[i],l=n[a],u=n[o];if(s&&l&&u)for(let r=e;r<t;r++)this.zoomInPaintVertexArray.emplace(r,l.tl[0],l.tl[1],l.br[0],l.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],l.pixelRatio,s.pixelRatio),this.zoomOutPaintVertexArray.emplace(r,l.tl[0],l.tl[1],l.br[0],l.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],l.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Go.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Go.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class gs{constructor(e,t,r){this.binders={},this._buffers=[];const n=[];for(const i in e.paint._values){if(!r(i))continue;const a=e.paint.get(i);if(!(a instanceof Ia&&qn(a.property.specification)))continue;const o=vs(i,e.type),s=a.value,l=a.property.specification.type,u=a.property.useIntegerZoom,c=a.property.specification["property-type"],h="cross-faded"===c||"cross-faded-data-driven"===c;if("constant"===s.kind)this.binders[i]=h?new ps(s.value,o):new hs(s.value,o,l),n.push(`/u_${i}`);else if("source"===s.kind||h){const r=xs(i,l,"source");this.binders[i]=h?new ms(s,l,u,t,r,e.id):new ds(s,o,l,r),n.push(`/a_${i}`)}else{const e=xs(i,l,"composite");this.binders[i]=new fs(s,o,l,u,t,e),n.push(`/z_${i}`)}}this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof ds||t instanceof fs?t.maxValue:0}populatePaintArrays(e,t,r,n,i){for(const a in this.binders){const o=this.binders[a];(o instanceof ds||o instanceof fs||o instanceof ms)&&o.populatePaintArray(e,t,r,n,i)}}setConstantPatternPositions(e,t){for(const r in this.binders){const n=this.binders[r];n instanceof ps&&n.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,r,n,i){let a=!1;for(const o in e){const s=t.getPositions(o);for(const t of s){const s=r.feature(t.index);for(const r in this.binders){const l=this.binders[r];if((l instanceof ds||l instanceof fs||l instanceof ms)&&!0===l.expression.isStateDependent){const u=n.paint.get(r);l.expression=u.value,l.updatePaintArray(t.start,t.end,s,e[o],i),a=!0}}}}return a}defines(){const e=[];for(const t in this.binders){const r=this.binders[t];(r instanceof hs||r instanceof ps)&&e.push(...r.uniformNames.map((e=>`#define HAS_UNIFORM_${e}`)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof ds||r instanceof fs)for(let t=0;t<r.paintVertexAttributes.length;t++)e.push(r.paintVertexAttributes[t].name);else if(r instanceof ms)for(let t=0;t<Go.members.length;t++)e.push(Go.members[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof hs||r instanceof ps||r instanceof fs)for(const t of r.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){const r=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof hs||i instanceof ps||i instanceof fs)for(const a of i.uniformNames)if(t[a]){const o=i.getBinding(e,t[a],a);r.push({name:a,property:n,binding:o})}}return r}setUniforms(e,t,r,n){for(const{name:e,property:i,binding:a}of t)this.binders[i].setUniform(a,n,r.get(i),e)}updatePaintBuffers(e){this._buffers=[];for(const t in this.binders){const r=this.binders[t];if(e&&r instanceof ms){const t=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(r instanceof ds||r instanceof fs)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const t in this.binders){const r=this.binders[t];(r instanceof ds||r instanceof fs||r instanceof ms)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof ds||t instanceof fs||t instanceof ms)&&t.destroy()}}}class ys{constructor(e,t,r=()=>!0){this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new gs(n,t,r);this.needsUpload=!1,this._featureMap=new ts,this._bufferOffset=0}populatePaintArrays(e,t,r,n,i,a){for(const r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(e,t,n,i,a);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n){for(const i of r)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,t,i,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function vs(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}function xs(e,t,r){const n={color:{source:Ka,composite:mo},number:{source:uo,composite:Ka}},i=function(e){return{"line-pattern":{source:Bo,composite:Bo},"fill-pattern":{source:Bo,composite:Bo},"fill-extrusion-pattern":{source:Bo,composite:Bo}}[e]}(e);return i&&i[r]||n[t][r]}na("ConstantBinder",hs),na("CrossFadedConstantBinder",ps),na("SourceExpressionBinder",ds),na("CrossFadedCompositeBinder",ms),na("CompositeExpressionBinder",fs),na("ProgramConfiguration",gs,{omit:["_buffers"]}),na("ProgramConfigurationSet",ys);const _s=Math.pow(2,14)-1,bs=-_s-1;function ws(e){const t=D/e.extent,r=e.loadGeometry();for(let e=0;e<r.length;e++){const n=r[e];for(let e=0;e<n.length;e++){const r=n[e],i=Math.round(r.x*t),a=Math.round(r.y*t);r.x=k(i,bs,_s),r.y=k(a,bs,_s),(i<r.x||i>r.x+1||a<r.y||a>r.y+1)&&V("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function As(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ws(e):[]}}const Cs=-32768;function Es(e,t,r,n,i){e.emplaceBack(Cs+8*t+n,Cs+8*r+i)}class Ms{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new To,this.indexArray=new qo,this.segments=new Zo,this.programConfigurations=new ys(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){const n=this.layers[0],i=[];let a=null,o=!1,s="heatmap"===n.type;if("circle"===n.type){const e=n;a=e.layout.get("circle-sort-key"),o=!a.isConstant(),s=s||"map"===e.paint.get("circle-pitch-alignment")}const l=s?t.subdivisionGranularity.circle:1;for(const{feature:t,id:n,index:s,sourceLayerIndex:l}of e){const e=this.layers[0]._featureFilter.needGeometry,u=As(t,e);if(!this.layers[0]._featureFilter.filter(new Ca(this.zoom),u,r))continue;const c=o?a.evaluate(u,{},r):void 0,h={id:n,properties:t.properties,type:t.type,sourceLayerIndex:l,index:s,geometry:e?u.geometry:ws(t),patterns:{},sortKey:c};i.push(h)}o&&i.sort(((e,t)=>e.sortKey-t.sortKey));for(const n of i){const{geometry:i,index:a,sourceLayerIndex:o}=n,s=e[a].feature;this.addFeature(n,i,a,r,l),t.featureIndex.insert(s,i,a,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n,i=1){let a;switch(i){case 1:a=[0,7];break;case 3:a=[0,2,5,7];break;case 5:a=[0,1,3,4,6,7];break;case 7:a=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${i}; valid values are 1, 3, 5, 7.`)}const o=a.length;for(const r of t)for(const t of r){const r=t.x,n=t.y;if(r<0||r>=D||n<0||n>=D)continue;const i=this.segments.prepareSegment(o*o,this.layoutVertexArray,this.indexArray,e.sortKey),s=i.vertexLength;for(let e=0;e<o;e++)for(let t=0;t<o;t++)Es(this.layoutVertexArray,r,n,a[t],a[e]);for(let e=0;e<o-1;e++)for(let t=0;t<o-1;t++){const r=s+e*o+t,n=s+(e+1)*o+t;this.indexArray.emplaceBack(r,n+1,r+1),this.indexArray.emplaceBack(r,n,n+1)}i.vertexLength+=o*o,i.primitiveLength+=(o-1)*(o-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n)}}function Ss(e,t){for(let r=0;r<e.length;r++)if(Fs(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(Fs(e,t[r]))return!0;return!!Is(e,t)}function Ds(e,t,r){return!!Fs(e,t)||!!zs(t,e,r)}function Ts(e,t){if(1===e.length)return ks(t,e[0]);for(let r=0;r<t.length;r++){const n=t[r];for(let t=0;t<n.length;t++)if(Fs(e,n[t]))return!0}for(let r=0;r<e.length;r++)if(ks(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(Is(e,t[r]))return!0;return!1}function Ns(e,t,r){if(e.length>1){if(Is(e,t))return!0;for(let n=0;n<t.length;n++)if(zs(t[n],e,r))return!0}for(let n=0;n<e.length;n++)if(zs(e[n],t,r))return!0;return!1}function Is(e,t){if(0===e.length||0===t.length)return!1;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1];for(let e=0;e<t.length-1;e++)if(Ps(n,i,t[e],t[e+1]))return!0}return!1}function Ps(e,t,r,n){return Z(e,r,n)!==Z(t,r,n)&&Z(e,t,r)!==Z(e,t,n)}function zs(e,t,r){const n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(let r=1;r<t.length;r++)if(Bs(e,t[r-1],t[r])<n)return!0;return!1}function Bs(e,t,r){const n=t.distSqr(r);if(0===n)return e.distSqr(t);const i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return e.distSqr(i<0?t:i>1?r:r.sub(t)._mult(i)._add(t))}function ks(e,t){for(let r=0;r<e.length;r++)if(Fs(e[r],t))return!0;return!1}function Fs(e,t){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){const a=e[n],o=e[i];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(r=!r)}return r}function Rs(e,t,r){const n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;const a=Z(e,t,r[0]);return a!==Z(e,t,r[1])||a!==Z(e,t,r[2])||a!==Z(e,t,r[3])}function Os(e,t,r){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Ls(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function qs(e,t,r,n,i){if(!t[0]&&!t[1])return e;const a=l.convert(t)._mult(i);"viewport"===r&&a._rotate(-n);const o=[];for(let t=0;t<e.length;t++)o.push(e[t].sub(a));return o}let js,Us;na("CircleBucket",Ms,{omit:["layers"]});var Vs={get paint(){return Us=Us||new Oa({"circle-radius":new Ba(ye.paint_circle["circle-radius"]),"circle-color":new Ba(ye.paint_circle["circle-color"]),"circle-blur":new Ba(ye.paint_circle["circle-blur"]),"circle-opacity":new Ba(ye.paint_circle["circle-opacity"]),"circle-translate":new za(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new za(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new za(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new za(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ba(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ba(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ba(ye.paint_circle["circle-stroke-opacity"])})},get layout(){return js=js||new Oa({"circle-sort-key":new Ba(ye.layout_circle["circle-sort-key"])})}};class Zs extends qa{constructor(e){super(e,Vs)}createBucket(e){return new Ms(e)}queryRadius(e){const t=e;return Os("circle-radius",this,t)+Os("circle-stroke-width",this,t)+Ls(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:r,geometry:n,transform:i,pixelsToTileUnits:a,unwrappedTileID:o,getElevation:s}){const l=qs(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-i.bearingInRadians,a),u=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),c="map"===this.paint.get("circle-pitch-alignment"),h=c?l:function(e,t,r,n){return e.map((e=>$s(e,t,r,n)))}(l,i,o,s),p=c?u*a:u;for(const e of n)for(const t of e){const e=c?t:$s(t,i,o,s);let r=p;const n=i.projectTileCoordinates(t.x,t.y,o,s).signedDistanceFromCamera;if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?r*=n/i.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(r*=i.cameraToCenterDistance/n),Ds(h,e,r))return!0}return!1}}function $s(e,t,r,n){const i=t.projectTileCoordinates(e.x,e.y,r,n).point;return new l((.5*i.x+.5)*t.width,(.5*-i.y+.5)*t.height)}class Gs extends Ms{}let Hs;na("HeatmapBucket",Gs,{omit:["layers"]});var Ws={get paint(){return Hs=Hs||new Oa({"heatmap-radius":new Ba(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ba(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new za(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ra(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new za(ye.paint_heatmap["heatmap-opacity"])})}};function Xs(e,{width:t,height:r},n,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==t*r*n)throw new RangeError(`mismatched image size. expected: ${i.length} but got: ${t*r*n}`)}else i=new Uint8Array(t*r*n);return e.width=t,e.height=r,e.data=i,e}function Ys(e,{width:t,height:r},n){if(t===e.width&&r===e.height)return;const i=Xs({},{width:t,height:r},n);Ks(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,t),height:Math.min(e.height,r)},n),e.width=t,e.height=r,e.data=i.data}function Ks(e,t,r,n,i,a){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const o=e.data,s=t.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){const u=((r.y+l)*e.width+r.x)*a,c=((n.y+l)*t.width+n.x)*a;for(let e=0;e<i.width*a;e++)s[c+e]=o[u+e]}return t}class Js{constructor(e,t){Xs(this,e,1,t)}resize(e){Ys(this,e,1)}clone(){return new Js({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){Ks(e,t,r,n,i,1)}}class Qs{constructor(e,t){Xs(this,e,4,t)}resize(e){Ys(this,e,4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Qs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){Ks(e,t,r,n,i,4)}}function el(e){const t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new Qs({width:r,height:n});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const a=(r,n,a)=>{t[e.evaluationKey]=a;const o=e.expression.evaluate(t);i.data[r+n+0]=Math.floor(255*o.r/o.a),i.data[r+n+1]=Math.floor(255*o.g/o.a),i.data[r+n+2]=Math.floor(255*o.b/o.a),i.data[r+n+3]=Math.floor(255*o.a)};if(e.clips)for(let t=0,i=0;t<n;++t,i+=4*r)for(let n=0,o=0;n<r;n++,o+=4){const s=n/(r-1),{start:l,end:u}=e.clips[t];a(i,o,l*(1-s)+u*s)}else for(let e=0,t=0;e<r;e++,t+=4)a(0,t,e/(r-1));return i}na("AlphaImage",Js),na("RGBAImage",Qs);const tl="big-fb";class rl extends qa{createBucket(e){return new Gs(e)}constructor(e){super(e,Ws),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=el({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(tl)&&this.heatmapFbos.delete(tl)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let nl;var il={get paint(){return nl=nl||new Oa({"hillshade-illumination-direction":new za(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new za(ye.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new za(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new za(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new za(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new za(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new za(ye.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new za(ye.paint_hillshade["hillshade-method"])})}};class al extends qa{constructor(e){super(e,il),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,t=this.paint.get("hillshade-illumination-altitude").values,r=this.paint.get("hillshade-highlight-color").values,n=this.paint.get("hillshade-shadow-color").values;const i=Math.max(e.length,t.length,r.length,n.length);e=e.concat(Array(i-e.length).fill(e.at(-1))),t=t.concat(Array(i-t.length).fill(t.at(-1))),r=r.concat(Array(i-r.length).fill(r.at(-1))),n=n.concat(Array(i-n.length).fill(n.at(-1)));const a=t.map(Q);return{directionRadians:e.map(Q),altitudeRadians:a,shadowColor:n,highlightColor:r}}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const ol=Za([{name:"a_pos",components:2,type:"Int16"}],4),{members:sl}=ol;function ll(e,t,r){const n=r.patternDependencies;let i=!1;for(const r of t){const t=r.paint.get(`${e}-pattern`);t.isConstant()||(i=!0);const a=t.constantOr(null);a&&(i=!0,n[a.to]=!0,n[a.from]=!0)}return i}function ul(e,t,r,n,i){const a=i.patternDependencies;for(const o of t){const t=o.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:n-1},r,{},i.availableImages),s=t.evaluate({zoom:n},r,{},i.availableImages),l=t.evaluate({zoom:n+1},r,{},i.availableImages);e=e&&e.name?e.name:e,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,a[e]=!0,a[s]=!0,a[l]=!0,r.patterns[o.id]={min:e,mid:s,max:l}}}return r}function cl(e,t,r,n,i){let a;if(i===function(e,t,r,n){let i=0;for(let a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,r,n)>0)for(let i=t;i<r;i+=n)a=Pl(i/n|0,e[i],e[i+1],a);else for(let i=r-n;i>=t;i-=n)a=Pl(i/n|0,e[i],e[i+1],a);return a&&Ml(a,a.next)&&(zl(a),a=a.next),a}function hl(e,t){if(!e)return e;t||(t=e);let r,n=e;do{if(r=!1,n.steiner||!Ml(n,n.next)&&0!==El(n.prev,n,n.next))n=n.next;else{if(zl(n),n=t=n.prev,n===n.next)break;r=!0}}while(r||n!==t);return t}function pl(e,t,r,n,i,a,o){if(!e)return;!o&&a&&function(e,t,r,n){let i=e;do{0===i.z&&(i.z=_l(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,r=1;do{let n,i=e;e=null;let a=null;for(t=0;i;){t++;let o=i,s=0;for(let e=0;e<r&&(s++,o=o.nextZ,o);e++);let l=r;for(;s>0||l>0&&o;)0!==s&&(0===l||!o||i.z<=o.z)?(n=i,i=i.nextZ,s--):(n=o,o=o.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;i=o}a.nextZ=null,r*=2}while(t>1)}(i)}(e,n,i,a);let s=e;for(;e.prev!==e.next;){const l=e.prev,u=e.next;if(a?fl(e,n,i,a):dl(e))t.push(l.i,e.i,u.i),zl(e),e=u.next,s=u.next;else if((e=u)===s){o?1===o?pl(e=ml(hl(e),t),t,r,n,i,a,2):2===o&&gl(e,t,r,n,i,a):pl(hl(e),t,r,n,i,a,1);break}}}function dl(e){const t=e.prev,r=e,n=e.next;if(El(t,r,n)>=0)return!1;const i=t.x,a=r.x,o=n.x,s=t.y,l=r.y,u=n.y,c=Math.min(i,a,o),h=Math.min(s,l,u),p=Math.max(i,a,o),d=Math.max(s,l,u);let f=n.next;for(;f!==t;){if(f.x>=c&&f.x<=p&&f.y>=h&&f.y<=d&&Al(i,s,a,l,o,u,f.x,f.y)&&El(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function fl(e,t,r,n){const i=e.prev,a=e,o=e.next;if(El(i,a,o)>=0)return!1;const s=i.x,l=a.x,u=o.x,c=i.y,h=a.y,p=o.y,d=Math.min(s,l,u),f=Math.min(c,h,p),m=Math.max(s,l,u),g=Math.max(c,h,p),y=_l(d,f,t,r,n),v=_l(m,g,t,r,n);let x=e.prevZ,_=e.nextZ;for(;x&&x.z>=y&&_&&_.z<=v;){if(x.x>=d&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==o&&Al(s,c,l,h,u,p,x.x,x.y)&&El(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,_.x>=d&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==o&&Al(s,c,l,h,u,p,_.x,_.y)&&El(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;x&&x.z>=y;){if(x.x>=d&&x.x<=m&&x.y>=f&&x.y<=g&&x!==i&&x!==o&&Al(s,c,l,h,u,p,x.x,x.y)&&El(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;_&&_.z<=v;){if(_.x>=d&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==o&&Al(s,c,l,h,u,p,_.x,_.y)&&El(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function ml(e,t){let r=e;do{const n=r.prev,i=r.next.next;!Ml(n,i)&&Sl(n,r,r.next,i)&&Nl(n,i)&&Nl(i,n)&&(t.push(n.i,r.i,i.i),zl(r),zl(r.next),r=e=i),r=r.next}while(r!==e);return hl(r)}function gl(e,t,r,n,i,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&Cl(o,e)){let s=Il(o,e);return o=hl(o,o.next),s=hl(s,s.next),pl(o,t,r,n,i,a,0),void pl(s,t,r,n,i,a,0)}e=e.next}o=o.next}while(o!==e)}function yl(e,t){let r=e.x-t.x;return 0===r&&(r=e.y-t.y,0===r)&&(r=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function vl(e,t){const r=function(e,t){let r=t;const n=e.x,i=e.y;let a,o=-1/0;if(Ml(e,r))return r;do{if(Ml(e,r.next))return r.next;if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){const e=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=n&&e>o&&(o=e,a=r.x<r.next.x?r:r.next,e===n))return a}r=r.next}while(r!==t);if(!a)return null;const s=a,l=a.x,u=a.y;let c=1/0;r=a;do{if(n>=r.x&&r.x>=l&&n!==r.x&&wl(i<u?n:o,i,l,u,i<u?o:n,i,r.x,r.y)){const t=Math.abs(i-r.y)/(n-r.x);Nl(r,e)&&(t<c||t===c&&(r.x>a.x||r.x===a.x&&xl(a,r)))&&(a=r,c=t)}r=r.next}while(r!==s);return a}(e,t);if(!r)return t;const n=Il(r,e);return hl(n,n.next),hl(r,r.next)}function xl(e,t){return El(e.prev,e,t.prev)<0&&El(t.next,e,e.next)<0}function _l(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function bl(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function wl(e,t,r,n,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(n-s)>=(r-o)*(t-s)&&(r-o)*(a-s)>=(i-o)*(n-s)}function Al(e,t,r,n,i,a,o,s){return!(e===o&&t===s)&&wl(e,t,r,n,i,a,o,s)}function Cl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Sl(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(Nl(e,t)&&Nl(t,e)&&function(e,t){let r=e,n=!1;const i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(El(e.prev,e,t.prev)||El(e,t.prev,t))||Ml(e,t)&&El(e.prev,e,e.next)>0&&El(t.prev,t,t.next)>0)}function El(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ml(e,t){return e.x===t.x&&e.y===t.y}function Sl(e,t,r,n){const i=Tl(El(e,t,r)),a=Tl(El(e,t,n)),o=Tl(El(r,n,e)),s=Tl(El(r,n,t));return i!==a&&o!==s||!(0!==i||!Dl(e,r,t))||!(0!==a||!Dl(e,n,t))||!(0!==o||!Dl(r,e,n))||!(0!==s||!Dl(r,t,n))}function Dl(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Tl(e){return e>0?1:e<0?-1:0}function Nl(e,t){return El(e.prev,e,e.next)<0?El(e,t,e.next)>=0&&El(e,e.prev,t)>=0:El(e,t,e.prev)<0||El(e,e.next,t)<0}function Il(e,t){const r=Bl(e.i,e.x,e.y),n=Bl(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Pl(e,t,r,n){const i=Bl(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function zl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Bl(e,t,r){return{i:e,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class kl{constructor(e,t){if(t>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=t}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class Fl{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}Fl.noSubdivision=new Fl({fill:new kl(0,0),line:new kl(0,0),tile:new kl(0,0),stencil:new kl(0,0),circle:1}),na("SubdivisionGranularityExpression",kl),na("SubdivisionGranularitySetting",Fl);const Rl=-32768,Ol=32767;class Ll{constructor(e,t){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=D/e,this._canonical=t}_getKey(e,t){return(e+=32768)<<16|t+32768}_vertexToIndex(e,t){if(e<-32768||t<-32768||e>32767||t>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const r=0|Math.round(e),n=0|Math.round(t),i=this._getKey(r,n);if(this._vertexDictionary.has(i))return this._vertexDictionary.get(i);const a=this._vertexBuffer.length/2;return this._vertexDictionary.set(i,a),this._vertexBuffer.push(r,n),a}_subdivideTrianglesScanline(e){if(this._granularity<2)return function(e,t){const r=[];for(let n=0;n<t.length;n+=3){const i=t[n],a=t[n+1],o=t[n+2],s=e[2*i],l=e[2*i+1];(e[2*a]-s)*(e[2*o+1]-l)-(e[2*a+1]-l)*(e[2*o]-s)>0?(r.push(i),r.push(o),r.push(a)):(r.push(i),r.push(a),r.push(o))}return r}(this._vertexBuffer,e);const t=[],r=e.length;for(let n=0;n<r;n+=3){const r=[e[n+0],e[n+1],e[n+2]],i=[this._vertexBuffer[2*e[n+0]+0],this._vertexBuffer[2*e[n+0]+1],this._vertexBuffer[2*e[n+1]+0],this._vertexBuffer[2*e[n+1]+1],this._vertexBuffer[2*e[n+2]+0],this._vertexBuffer[2*e[n+2]+1]];let a=1/0,o=1/0,s=-1/0,l=-1/0;for(let e=0;e<3;e++){const t=i[2*e],r=i[2*e+1];a=Math.min(a,t),s=Math.max(s,t),o=Math.min(o,r),l=Math.max(l,r)}if(a===s||o===l)continue;const u=Math.floor(a/this._granularityCellSize),c=Math.ceil(s/this._granularityCellSize),h=Math.floor(o/this._granularityCellSize),p=Math.ceil(l/this._granularityCellSize);if(u!==c||h!==p)for(let e=h;e<p;e++){const n=this._scanlineGenerateVertexRingForCellRow(e,i,r);Ul(this._vertexBuffer,n,t)}else t.push(...r)}return t}_scanlineGenerateVertexRingForCellRow(e,t,r){const n=e*this._granularityCellSize,i=n+this._granularityCellSize,a=[];for(let e=0;e<3;e++){const o=t[2*e],s=t[2*e+1],l=t[2*(e+1)%6],u=t[(2*(e+1)+1)%6],c=t[2*(e+2)%6],h=t[(2*(e+2)+1)%6],p=l-o,d=u-s,f=0===p,m=0===d,g=(n-s)/d,y=(i-s)/d,v=Math.min(g,y),x=Math.max(g,y);if(!m&&(v>=1||x<=0)||m&&(s<n||s>i)){u>=n&&u<=i&&a.push(r[(e+1)%3]);continue}!m&&v>0&&a.push(this._vertexToIndex(o+p*v,s+d*v));const _=o+p*Math.max(v,0),b=o+p*Math.min(x,1);f||this._generateIntraEdgeVertices(a,o,s,l,u,_,b),!m&&x<1&&a.push(this._vertexToIndex(o+p*x,s+d*x)),(m||u>=n&&u<=i)&&a.push(r[(e+1)%3]),!m&&(u<=n||u>=i)&&this._generateInterEdgeVertices(a,o,s,l,u,c,h,b,n,i)}return a}_generateIntraEdgeVertices(e,t,r,n,i,a,o){const s=n-t,l=i-r,u=0===l,c=u?Math.min(t,n):Math.min(a,o),h=u?Math.max(t,n):Math.max(a,o),p=Math.floor(c/this._granularityCellSize)+1,d=Math.ceil(h/this._granularityCellSize)-1;if(u?t<n:a<o)for(let n=p;n<=d;n++){const i=n*this._granularityCellSize;e.push(this._vertexToIndex(i,r+l*(i-t)/s))}else for(let n=d;n>=p;n--){const i=n*this._granularityCellSize;e.push(this._vertexToIndex(i,r+l*(i-t)/s))}}_generateInterEdgeVertices(e,t,r,n,i,a,o,s,l,u){const c=i-r,h=a-n,p=o-i,d=(l-i)/p,f=(u-i)/p,m=Math.min(d,f),g=Math.max(d,f),y=n+h*m;let v=Math.floor(Math.min(y,s)/this._granularityCellSize)+1,x=Math.ceil(Math.max(y,s)/this._granularityCellSize)-1,_=s<y;const b=0===p;if(b&&(o===l||o===u))return;if(b||m>=1||g<=0){const e=r-o,n=a+(t-a)*Math.min((l-o)/e,(u-o)/e);v=Math.floor(Math.min(n,s)/this._granularityCellSize)+1,x=Math.ceil(Math.max(n,s)/this._granularityCellSize)-1,_=s<n}const w=c>0?u:l;if(_)for(let t=v;t<=x;t++)e.push(this._vertexToIndex(t*this._granularityCellSize,w));else for(let t=x;t>=v;t--)e.push(this._vertexToIndex(t*this._granularityCellSize,w))}_generateOutline(e){const t=[];for(const r of e){const e=jl(r,this._granularity,!0),n=this._pointArrayToIndices(e),i=[];for(let e=1;e<n.length;e++)i.push(n[e-1]),i.push(n[e]);t.push(i)}return t}_handlePoles(e){let t=!1,r=!1;this._canonical&&(0===this._canonical.y&&(t=!0),this._canonical.y===(1<<this._canonical.z)-1&&(r=!0)),(t||r)&&this._fillPoles(e,t,r)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let t=0;t<e.length;t+=2){const r=e[t+1];r===Rl&&(e[t+1]=-32767),r===Ol&&(e[t+1]=32766)}}_generatePoleQuad(e,t,r,n,i,a){n>i!=(a===Rl)?(e.push(t),e.push(r),e.push(this._vertexToIndex(n,a)),e.push(r),e.push(this._vertexToIndex(i,a)),e.push(this._vertexToIndex(n,a))):(e.push(r),e.push(t),e.push(this._vertexToIndex(n,a)),e.push(this._vertexToIndex(i,a)),e.push(r),e.push(this._vertexToIndex(n,a)))}_fillPoles(e,t,r){const n=this._vertexBuffer,i=D,a=e.length;for(let o=2;o<a;o+=3){const a=e[o-2],s=e[o-1],l=e[o],u=n[2*a],c=n[2*a+1],h=n[2*s],p=n[2*s+1],d=n[2*l],f=n[2*l+1];t&&(0===c&&0===p&&this._generatePoleQuad(e,a,s,u,h,Rl),0===p&&0===f&&this._generatePoleQuad(e,s,l,h,d,Rl),0===f&&0===c&&this._generatePoleQuad(e,l,a,d,u,Rl)),r&&(c===i&&p===i&&this._generatePoleQuad(e,a,s,u,h,Ol),p===i&&f===i&&this._generatePoleQuad(e,s,l,h,d,Ol),f===i&&c===i&&this._generatePoleQuad(e,l,a,d,u,Ol))}}_initializeVertices(e){for(let t=0;t<e.length;t+=2)this._vertexToIndex(e[t],e[t+1])}subdividePolygonInternal(e,t){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:r,holeIndices:n}=function(e){const t=[],r=[];for(const n of e)if(0!==n.length){n!==e[0]&&t.push(r.length/2);for(let e=0;e<n.length;e++)r.push(n[e].x),r.push(n[e].y)}return{flattened:r,holeIndices:t}}(e);let i;this._initializeVertices(r);try{const e=function(e,t,r=2){const n=t&&t.length,i=n?t[0]*r:e.length;let a=cl(e,0,i,r,!0);const o=[];if(!a||a.next===a.prev)return o;let s,l,u;if(n&&(a=function(e,t,r,n){const i=[];for(let r=0,a=t.length;r<a;r++){const o=cl(e,t[r]*n,r<a-1?t[r+1]*n:e.length,n,!1);o===o.next&&(o.steiner=!0),i.push(bl(o))}i.sort(yl);for(let e=0;e<i.length;e++)r=vl(i[e],r);return r}(e,t,a,r)),e.length>80*r){s=1/0,l=1/0;let t=-1/0,n=-1/0;for(let a=r;a<i;a+=r){const r=e[a],i=e[a+1];r<s&&(s=r),i<l&&(l=i),r>t&&(t=r),i>n&&(n=i)}u=Math.max(t-s,n-l),u=0!==u?32767/u:0}return pl(a,o,r,s,l,u,0),o}(r,n),t=this._convertIndices(r,e);i=this._subdivideTrianglesScanline(t)}catch(e){console.error(e)}let a=[];return t&&(a=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(i),{verticesFlattened:this._vertexBuffer,indicesTriangles:i,indicesLineList:a}}_convertIndices(e,t){const r=[];for(let n=0;n<t.length;n++)r.push(this._vertexToIndex(e[2*t[n]],e[2*t[n]+1]));return r}_pointArrayToIndices(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];t.push(this._vertexToIndex(n.x,n.y))}return t}}function ql(e,t,r,n=!0){return new Ll(r,t).subdividePolygonInternal(e,n)}function jl(e,t,r=!1){if(!e||e.length<1)return[];if(e.length<2)return[];const n=e[0],i=e[e.length-1],a=r&&(n.x!==i.x||n.y!==i.y);if(t<2)return a?[...e,e[0]]:[...e];const o=Math.floor(D/t),s=[];s.push(new l(e[0].x,e[0].y));const u=e.length,c=a?u:u-1;for(let t=0;t<c;t++){const r=e[t],n=t<u-1?e[t+1]:e[0],i=r.x,a=r.y,c=n.x,h=n.y,p=i!==c,d=a!==h;if(!p&&!d)continue;const f=c-i,m=h-a,g=Math.abs(f),y=Math.abs(m);let v=i,x=a;for(;;){const e=f>0?(Math.floor(v/o)+1)*o:(Math.ceil(v/o)-1)*o,t=m>0?(Math.floor(x/o)+1)*o:(Math.ceil(x/o)-1)*o,r=Math.abs(v-e),n=Math.abs(x-t),i=Math.abs(v-c),a=Math.abs(x-h),u=p?r/g:Number.POSITIVE_INFINITY,_=d?n/y:Number.POSITIVE_INFINITY;if((i<=r||!p)&&(a<=n||!d))break;if(u<_&&p||!d){v=e,x+=m*u;const t=new l(v,Math.round(x));s[s.length-1].x===t.x&&s[s.length-1].y===t.y||s.push(t)}else{v+=f*_,x=t;const e=new l(Math.round(v),x);s[s.length-1].x===e.x&&s[s.length-1].y===e.y||s.push(e)}}const _=new l(c,h);s[s.length-1].x===_.x&&s[s.length-1].y===_.y||s.push(_)}return s}function Ul(e,t,r){if(0===t.length)throw new Error("Subdivision vertex ring is empty.");let n=0,i=e[2*t[0]];for(let r=1;r<t.length;r++){const a=e[2*t[r]];a<i&&(i=a,n=r)}const a=t.length;let o=n,s=(o+1)%a;for(;;){const n=o-1>=0?o-1:a-1,i=(s+1)%a,l=e[2*t[n]],u=e[2*t[i]],c=e[2*t[o]],h=e[2*t[o]+1],p=e[2*t[s]+1];let d=!1;if(l<u)d=!0;else if(l>u)d=!1;else{const r=p-h,a=-(e[2*t[s]]-c),o=h<p?1:-1;((l-c)*r+(e[2*t[n]+1]-h)*a)*o>((u-c)*r+(e[2*t[i]+1]-h)*a)*o&&(d=!0)}if(d){const e=t[n],i=t[o],l=t[s];e!==i&&e!==l&&i!==l&&r.push(l,i,e),o--,o<0&&(o=a-1)}else{const e=t[i],n=t[o],l=t[s];e!==n&&e!==l&&n!==l&&r.push(l,n,e),s++,s>=a&&(s=0)}if(n===i)break}}function Vl(e,t,r,n,i,a,o,s,l){const u=i.length/2,c=o&&s&&l;if(u<Zo.MAX_VERTEX_ARRAY_LENGTH){const h=t.prepareSegment(u,r,n),p=h.vertexLength;for(let e=0;e<a.length;e+=3)n.emplaceBack(p+a[e],p+a[e+1],p+a[e+2]);let d,f;h.vertexLength+=u,h.primitiveLength+=a.length/3,c&&(f=o.prepareSegment(u,r,s),d=f.vertexLength,f.vertexLength+=u);for(let t=0;t<i.length;t+=2)e(i[t],i[t+1]);if(c)for(let e=0;e<l.length;e++){const t=l[e];for(let e=1;e<t.length;e+=2)s.emplaceBack(d+t[e-1],d+t[e]);f.primitiveLength+=t.length/2}}else!function(e,t,r,n,i,a){const o=[];for(let e=0;e<n.length/2;e++)o.push(-1);const s={count:0};let l=0,u=e.getOrCreateLatestSegment(t,r),c=u.vertexLength;for(let h=2;h<i.length;h+=3){const p=i[h-2],d=i[h-1],f=i[h];let m=o[p]<l,g=o[d]<l,y=o[f]<l;u.vertexLength+((m?1:0)+(g?1:0)+(y?1:0))>Zo.MAX_VERTEX_ARRAY_LENGTH&&(u=e.createNewSegment(t,r),l=s.count,m=!0,g=!0,y=!0,c=0);const v=Zl(o,n,a,s,p,m,u),x=Zl(o,n,a,s,d,g,u),_=Zl(o,n,a,s,f,y,u);r.emplaceBack(c+v-l,c+x-l,c+_-l),u.primitiveLength++}}(t,r,n,i,a,e),c&&function(e,t,r,n,i,a){const o=[];for(let e=0;e<n.length/2;e++)o.push(-1);const s={count:0};let l=0,u=e.getOrCreateLatestSegment(t,r),c=u.vertexLength;for(let h=0;h<i.length;h++){const p=i[h];for(let d=1;d<i[h].length;d+=2){const i=p[d-1],h=p[d];let f=o[i]<l,m=o[h]<l;u.vertexLength+((f?1:0)+(m?1:0))>Zo.MAX_VERTEX_ARRAY_LENGTH&&(u=e.createNewSegment(t,r),l=s.count,f=!0,m=!0,c=0);const g=Zl(o,n,a,s,i,f,u),y=Zl(o,n,a,s,h,m,u);r.emplaceBack(c+g-l,c+y-l),u.primitiveLength++}}}(o,r,s,i,l,e),t.forceNewSegmentOnNextPrepare(),null==o||o.forceNewSegmentOnNextPrepare()}function Zl(e,t,r,n,i,a,o){if(a){const a=n.count;return r(t[2*i],t[2*i+1]),e[i]=n.count,n.count++,o.vertexLength++,a}return e[i]}class $l{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new No,this.indexArray=new qo,this.indexArray2=new jo,this.programConfigurations=new ys(e.layers,e.zoom),this.segments=new Zo,this.segments2=new Zo,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasPattern=ll("fill",this.layers,t);const n=this.layers[0].layout.get("fill-sort-key"),i=!n.isConstant(),a=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:u}of e){const e=this.layers[0]._featureFilter.needGeometry,c=As(o,e);if(!this.layers[0]._featureFilter.filter(new Ca(this.zoom),c,r))continue;const h=i?n.evaluate(c,{},r,t.availableImages):void 0,p={id:s,properties:o.properties,type:o.type,sourceLayerIndex:u,index:l,geometry:e?c.geometry:ws(o),patterns:{},sortKey:h};a.push(p)}i&&a.sort(((e,t)=>e.sortKey-t.sortKey));for(const n of a){const{geometry:i,index:a,sourceLayerIndex:o}=n;if(this.hasPattern){const e=ul("fill",this.layers,n,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(n,i,a,r,{},t.subdivisionGranularity);t.featureIndex.insert(e[a].feature,i,a,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(const n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r,e.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sl),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,i,a){for(const e of Kr(t,500)){const t=ql(e,n,a.fill.getGranularityForZoomLevel(n.z)),r=this.layoutVertexArray;Vl(((e,t)=>{r.emplaceBack(e,t)}),this.segments,this.layoutVertexArray,this.indexArray,t.verticesFlattened,t.indicesTriangles,this.segments2,this.indexArray2,t.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}}let Gl,Hl;na("FillBucket",$l,{omit:["layers","patternFeatures"]});var Wl={get paint(){return Hl=Hl||new Oa({"fill-antialias":new za(ye.paint_fill["fill-antialias"]),"fill-opacity":new Ba(ye.paint_fill["fill-opacity"]),"fill-color":new Ba(ye.paint_fill["fill-color"]),"fill-outline-color":new Ba(ye.paint_fill["fill-outline-color"]),"fill-translate":new za(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new za(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new ka(ye.paint_fill["fill-pattern"])})},get layout(){return Gl=Gl||new Oa({"fill-sort-key":new Ba(ye.layout_fill["fill-sort-key"])})}};class Xl extends qa{constructor(e){super(e,Wl)}recalculate(e,t){super.recalculate(e,t);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new $l(e)}queryRadius(){return Ls(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:t,transform:r,pixelsToTileUnits:n}){return Ts(qs(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-r.bearingInRadians,n),t)}isTileClipped(){return!0}}const Yl=Za([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Kl=Za([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Jl}=Yl;var Ql,eu,tu,ru,nu,iu,au,ou={};function su(){if(eu)return Ql;eu=1;var e=a();function t(e,t,n,i,a){this.properties={},this.extent=n,this.type=0,this._pbf=e,this._geometry=-1,this._keys=i,this._values=a,e.readFields(r,this,t)}function r(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function n(e){for(var t,r,n=0,i=0,a=e.length,o=a-1;i<a;o=i++)n+=((r=e[o]).x-(t=e[i]).x)*(t.y+r.y);return n}return Ql=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var r,n=t.readVarint()+t.pos,i=1,a=0,o=0,s=0,l=[];t.pos<n;){if(a<=0){var u=t.readVarint();i=7&u,a=u>>3}if(a--,1===i||2===i)o+=t.readSVarint(),s+=t.readSVarint(),1===i&&(r&&l.push(r),r=[]),r.push(new e(o,s));else{if(7!==i)throw new Error("unknown command "+i);r&&r.push(r[0].clone())}}return r&&l.push(r),l},t.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,a=0,o=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)(i+=e.readSVarint())<o&&(o=i),i>s&&(s=i),(a+=e.readSVarint())<l&&(l=a),a>u&&(u=a);else if(7!==r)throw new Error("unknown command "+r)}return[o,l,s,u]},t.prototype.toGeoJSON=function(e,r,i){var a,o,s=this.extent*Math.pow(2,i),l=this.extent*e,u=this.extent*r,c=this.loadGeometry(),h=t.types[this.type];function p(e){for(var t=0;t<e.length;t++){var r=e[t];e[t]=[360*(r.x+l)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+u)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var d=[];for(a=0;a<c.length;a++)d[a]=c[a][0];p(c=d);break;case 2:for(a=0;a<c.length;a++)p(c[a]);break;case 3:for(c=function(e){var t=e.length;if(t<=1)return[e];for(var r,i,a=[],o=0;o<t;o++){var s=n(e[o]);0!==s&&(void 0===i&&(i=s<0),i===s<0?(r&&a.push(r),r=[e[o]]):r.push(e[o]))}return r&&a.push(r),a}(c),a=0;a<c.length;a++)for(o=0;o<c[a].length;o++)p(c[a][o])}1===c.length?c=c[0]:h="Multi"+h;var f={type:"Feature",geometry:{type:h,coordinates:c},properties:this.properties};return"id"in this&&(f.id=this.id),f},Ql}function lu(){if(ru)return tu;ru=1;var e=su();function t(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(r,this,t),this.length=this._features.length}function r(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}return tu=t,t.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var r=this._pbf.readVarint()+this._pbf.pos;return new e(this._pbf,r,this.extent,this._keys,this._values)},tu}function uu(){return au||(au=1,ou.VectorTile=function(){if(iu)return nu;iu=1;var e=lu();function t(t,r,n){if(3===t){var i=new e(n,n.readVarint()+n.pos);i.length&&(r[i.name]=i)}}return nu=function(e,r){this.layers=e.readFields(t,{},r)},nu}(),ou.VectorTileFeature=su(),ou.VectorTileLayer=lu()),ou}var cu=r(uu());const hu=cu.VectorTileFeature.types,pu=Math.pow(2,13);function du(e,t,r,n,i,a,o,s){e.emplaceBack(t,r,2*Math.floor(n*pu)+o,i*pu*2,a*pu*2,Math.round(s))}class fu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Io,this.centroidVertexArray=new Do,this.indexArray=new qo,this.programConfigurations=new ys(e.layers,e.zoom),this.segments=new Zo,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.features=[],this.hasPattern=ll("fill-extrusion",this.layers,t);for(const{feature:n,id:i,index:a,sourceLayerIndex:o}of e){const e=this.layers[0]._featureFilter.needGeometry,s=As(n,e);if(!this.layers[0]._featureFilter.filter(new Ca(this.zoom),s,r))continue;const l={id:i,sourceLayerIndex:o,index:a,geometry:e?s.geometry:ws(n),properties:n.properties,type:n.type,patterns:{}};this.hasPattern?this.features.push(ul("fill-extrusion",this.layers,l,this.zoom,t)):this.addFeature(l,l.geometry,a,r,{},t.subdivisionGranularity),t.featureIndex.insert(n,l.geometry,a,o,this.index,!0)}}addFeatures(e,t,r){for(const n of this.features){const{geometry:i}=n;this.addFeature(n,i,n.index,t,r,e.subdivisionGranularity)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jl),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Kl.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,n,i,a){for(const r of Kr(t,500)){const t={x:0,y:0,sampleCount:0},i=this.layoutVertexArray.length;this.processPolygon(t,n,e,r,a);const o=this.layoutVertexArray.length-i,s=Math.floor(t.x/t.sampleCount),l=Math.floor(t.y/t.sampleCount);for(let e=0;e<o;e++)this.centroidVertexArray.emplaceBack(s,l)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}processPolygon(e,t,r,n,i){if(n.length<1)return;if(yu(n[0]))return;for(const t of n)0!==t.length&&mu(e,t);const a={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},o=i.fill.getGranularityForZoomLevel(t.z),s="Polygon"===hu[r.type];for(const e of n){if(0===e.length)continue;if(yu(e))continue;const t=jl(e,o,s);this._generateSideFaces(t,a)}if(!s)return;const l=ql(n,t,o,!1),u=this.layoutVertexArray;Vl(((e,t)=>{du(u,e,t,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,l.verticesFlattened,l.indicesTriangles)}_generateSideFaces(e,t){let r=0;for(let n=1;n<e.length;n++){const i=e[n],a=e[n-1];if(gu(i,a))continue;t.segment.vertexLength+4>Zo.MAX_VERTEX_ARRAY_LENGTH&&(t.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const o=i.sub(a)._perp()._unit(),s=a.dist(i);r+s>32768&&(r=0),du(this.layoutVertexArray,i.x,i.y,o.x,o.y,0,0,r),du(this.layoutVertexArray,i.x,i.y,o.x,o.y,0,1,r),r+=s,du(this.layoutVertexArray,a.x,a.y,o.x,o.y,0,0,r),du(this.layoutVertexArray,a.x,a.y,o.x,o.y,0,1,r);const l=t.segment.vertexLength;this.indexArray.emplaceBack(l,l+2,l+1),this.indexArray.emplaceBack(l+1,l+2,l+3),t.segment.vertexLength+=4,t.segment.primitiveLength+=2}}}function mu(e,t){for(let r=0;r<t.length;r++){const n=t[r];r===t.length-1&&t[0].x===n.x&&t[0].y===n.y||(e.x+=n.x,e.y+=n.y,e.sampleCount++)}}function gu(e,t){return e.x===t.x&&(e.x<0||e.x>D)||e.y===t.y&&(e.y<0||e.y>D)}function yu(e){return e.every((e=>e.x<0))||e.every((e=>e.x>D))||e.every((e=>e.y<0))||e.every((e=>e.y>D))}let vu;na("FillExtrusionBucket",fu,{omit:["layers","features"]});var xu={get paint(){return vu=vu||new Oa({"fill-extrusion-opacity":new za(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ba(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new za(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new za(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ka(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ba(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ba(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new za(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class _u extends qa{constructor(e){super(e,xu)}createBucket(e){return new fu(e)}queryRadius(){return Ls(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:r,geometry:n,transform:i,pixelsToTileUnits:a,pixelPosMatrix:o}){const s=qs(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-i.bearingInRadians,a),u=this.paint.get("fill-extrusion-height").evaluate(t,r),c=this.paint.get("fill-extrusion-base").evaluate(t,r),h=function(e,t){const r=[];for(const n of e){const e=[n.x,n.y,0,1];C(e,e,t),r.push(new l(e[0]/e[3],e[1]/e[3]))}return r}(s,o),p=function(e,t,r,n){const i=[],a=[],o=n[8]*t,s=n[9]*t,u=n[10]*t,c=n[11]*t,h=n[8]*r,p=n[9]*r,d=n[10]*r,f=n[11]*r;for(const t of e){const e=[],r=[];for(const i of t){const t=i.x,a=i.y,m=n[0]*t+n[4]*a+n[12],g=n[1]*t+n[5]*a+n[13],y=n[2]*t+n[6]*a+n[14],v=n[3]*t+n[7]*a+n[15],x=y+u,_=v+c,b=m+h,w=g+p,A=y+d,C=v+f,E=new l((m+o)/_,(g+s)/_);E.z=x/_,e.push(E);const M=new l(b/C,w/C);M.z=A/C,r.push(M)}i.push(e),a.push(r)}return[i,a]}(n,c,u,o);return function(e,t,r){let n=1/0;Ts(r,t)&&(n=wu(r,t[0]));for(let i=0;i<t.length;i++){const a=t[i],o=e[i];for(let e=0;e<a.length-1;e++){const t=a[e],i=[t,a[e+1],o[e+1],o[e],t];Ss(r,i)&&(n=Math.min(n,wu(r,i)))}}return n!==1/0&&n}(p[0],p[1],h)}}function bu(e,t){return e.x*t.x+e.y*t.y}function wu(e,t){if(1===e.length){let r=0;const n=t[r++];let i;for(;!i||n.equals(i);)if(i=t[r++],!i)return 1/0;for(;r<t.length;r++){const a=t[r],o=e[0],s=i.sub(n),l=a.sub(n),u=o.sub(n),c=bu(s,s),h=bu(s,l),p=bu(l,l),d=bu(u,s),f=bu(u,l),m=c*p-h*h,g=(p*d-h*f)/m,y=(c*f-h*d)/m,v=n.z*(1-g-y)+i.z*g+a.z*y;if(isFinite(v))return v}return 1/0}{let e=1/0;for(const r of t)e=Math.min(e,r.z);return e}}const Au=Za([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Cu}=Au,Eu=Za([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Mu}=Eu,Su=cu.VectorTileFeature.types,Du=Math.cos(Math.PI/180*37.5),Tu=Math.pow(2,14)/.5;class Nu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new Po,this.layoutVertexArray2=new zo,this.indexArray=new qo,this.programConfigurations=new ys(e.layers,e.zoom),this.segments=new Zo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r){this.hasPattern=ll("line",this.layers,t);const n=this.layers[0].layout.get("line-sort-key"),i=!n.isConstant(),a=[];for(const{feature:t,id:o,index:s,sourceLayerIndex:l}of e){const e=this.layers[0]._featureFilter.needGeometry,u=As(t,e);if(!this.layers[0]._featureFilter.filter(new Ca(this.zoom),u,r))continue;const c=i?n.evaluate(u,{},r):void 0,h={id:o,properties:t.properties,type:t.type,sourceLayerIndex:l,index:s,geometry:e?u.geometry:ws(t),patterns:{},sortKey:c};a.push(h)}i&&a.sort(((e,t)=>e.sortKey-t.sortKey));for(const n of a){const{geometry:i,index:a,sourceLayerIndex:o}=n;if(this.hasPattern){const e=ul("line",this.layers,n,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(n,i,a,r,{},t.subdivisionGranularity);t.featureIndex.insert(e[a].feature,i,a,o,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(const n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r,e.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Mu)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cu),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,r,n,i,a){const o=this.layers[0].layout,s=o.get("line-join").evaluate(e,{}),l=o.get("line-cap"),u=o.get("line-miter-limit"),c=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const r of t)this.addLine(r,e,s,l,u,c,n,a);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}addLine(e,t,r,n,i,a,o,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=jl(e,o?s.line.getGranularityForZoomLevel(o.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const l="Polygon"===Su[t.type];let u=e.length;for(;u>=2&&e[u-1].equals(e[u-2]);)u--;let c=0;for(;c<u-1&&e[c].equals(e[c+1]);)c++;if(u<(l?3:2))return;"bevel"===r&&(i=1.05);const h=this.overscaling<=16?15*D/(512*this.overscaling):0,p=this.segments.prepareSegment(10*u,this.layoutVertexArray,this.indexArray);let d,f,m,g,y;this.e1=this.e2=-1,l&&(d=e[u-2],y=e[c].sub(d)._unit()._perp());for(let t=c;t<u;t++){if(m=t===u-1?l?e[c+1]:void 0:e[t+1],m&&e[t].equals(m))continue;y&&(g=y),d&&(f=d),d=e[t],y=m?m.sub(d)._unit()._perp():g,g=g||y;let o=g.add(y);0===o.x&&0===o.y||o._unit();const s=g.x*y.x+g.y*y.y,v=o.x*y.x+o.y*y.y,x=0!==v?1/v:1/0,_=2*Math.sqrt(2-2*v),b=v<Du&&f&&m,w=g.x*y.y-g.y*y.x>0;if(b&&t>c){const e=d.dist(f);if(e>2*h){const t=d.sub(d.sub(f)._mult(h/e)._round());this.updateDistance(f,t),this.addCurrentVertex(t,g,0,0,p),f=t}}const A=f&&m;let C=A?r:l?"butt":n;if(A&&"round"===C&&(x<a?C="miter":x<=2&&(C="fakeround")),"miter"===C&&x>i&&(C="bevel"),"bevel"===C&&(x>2&&(C="flipbevel"),x<i&&(C="miter")),f&&this.updateDistance(f,d),"miter"===C)o._mult(x),this.addCurrentVertex(d,o,0,0,p);else if("flipbevel"===C){if(x>100)o=y.mult(-1);else{const e=x*g.add(y).mag()/g.sub(y).mag();o._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(d,o,0,0,p),this.addCurrentVertex(d,o.mult(-1),0,0,p)}else if("bevel"===C||"fakeround"===C){const e=-Math.sqrt(x*x-1),t=w?e:0,r=w?0:e;if(f&&this.addCurrentVertex(d,g,t,r,p),"fakeround"===C){const e=Math.round(180*_/Math.PI/20);for(let t=1;t<e;t++){let r=t/e;if(.5!==r){const e=r-.5;r+=r*e*(r-1)*((1.0904+s*(s*(3.55645-1.43519*s)-3.2452))*e*e+(.848013+s*(.215638*s-1.06021)))}const n=y.sub(g)._mult(r)._add(g)._unit()._mult(w?-1:1);this.addHalfVertex(d,n.x,n.y,!1,w,0,p)}}m&&this.addCurrentVertex(d,y,-t,-r,p)}else if("butt"===C)this.addCurrentVertex(d,o,0,0,p);else if("square"===C){const e=f?1:-1;this.addCurrentVertex(d,o,e,e,p)}else"round"===C&&(f&&(this.addCurrentVertex(d,g,0,0,p),this.addCurrentVertex(d,g,1,1,p,!0)),m&&(this.addCurrentVertex(d,y,-1,-1,p,!0),this.addCurrentVertex(d,y,0,0,p)));if(b&&t<u-1){const e=d.dist(m);if(e>2*h){const t=d.add(m.sub(d)._mult(h/e)._round());this.updateDistance(d,t),this.addCurrentVertex(t,y,0,0,p),d=t}}}}addCurrentVertex(e,t,r,n,i,a=!1){const o=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,a,!1,r,i),this.addHalfVertex(e,o,s,a,!0,-n,i),this.distance>Tu/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,r,n,i,a))}addHalfVertex({x:e,y:t},r,n,i,a,o,s){const l=.5*(this.lineClips?this.scaledDistance*(Tu-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(i?1:0),(t<<1)+(a?1:0),Math.round(63*r)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const u=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,u,this.e2),s.primitiveLength++),a?this.e2=u:this.e1=u}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}let Iu,Pu;na("LineBucket",Nu,{omit:["layers","patternFeatures"]});var zu={get paint(){return Pu=Pu||new Oa({"line-opacity":new Ba(ye.paint_line["line-opacity"]),"line-color":new Ba(ye.paint_line["line-color"]),"line-translate":new za(ye.paint_line["line-translate"]),"line-translate-anchor":new za(ye.paint_line["line-translate-anchor"]),"line-width":new Ba(ye.paint_line["line-width"]),"line-gap-width":new Ba(ye.paint_line["line-gap-width"]),"line-offset":new Ba(ye.paint_line["line-offset"]),"line-blur":new Ba(ye.paint_line["line-blur"]),"line-dasharray":new Fa(ye.paint_line["line-dasharray"]),"line-pattern":new ka(ye.paint_line["line-pattern"]),"line-gradient":new Ra(ye.paint_line["line-gradient"])})},get layout(){return Iu=Iu||new Oa({"line-cap":new za(ye.layout_line["line-cap"]),"line-join":new Ba(ye.layout_line["line-join"]),"line-miter-limit":new za(ye.layout_line["line-miter-limit"]),"line-round-limit":new za(ye.layout_line["line-round-limit"]),"line-sort-key":new Ba(ye.layout_line["line-sort-key"])})}};class Bu extends Ba{possiblyEvaluate(e,t){return t=new Ca(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=R({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}}let ku;class Fu extends qa{constructor(e){super(e,zu),this.gradientVersion=0,ku||(ku=new Bu(zu.paint.properties["line-width"].specification),ku.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this.gradientExpression();this.stepInterpolant=!!function(e){return void 0!==e._styleExpression}(e)&&e._styleExpression.expression instanceof ar,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=ku.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Nu(e)}queryRadius(e){const t=e,r=Ru(Os("line-width",this,t),Os("line-gap-width",this,t)),n=Os("line-offset",this,t);return r/2+Math.abs(n)+Ls(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:t,featureState:r,geometry:n,transform:i,pixelsToTileUnits:a}){const o=qs(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-i.bearingInRadians,a),s=a/2*Ru(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),u=this.paint.get("line-offset").evaluate(t,r);return u&&(n=function(e,t){const r=[];for(let n=0;n<e.length;n++){const i=e[n],a=[];for(let e=0;e<i.length;e++){const r=i[e-1],n=i[e],o=i[e+1],s=0===e?new l(0,0):n.sub(r)._unit()._perp(),u=e===i.length-1?new l(0,0):o.sub(n)._unit()._perp(),c=s._add(u)._unit(),h=c.x*u.x+c.y*u.y;0!==h&&c._mult(1/h),a.push(c._mult(t)._add(n))}r.push(a)}return r}(n,u*a)),function(e,t,r){for(let n=0;n<t.length;n++){const i=t[n];if(e.length>=3)for(let t=0;t<i.length;t++)if(Fs(e,i[t]))return!0;if(Ns(e,i,r))return!0}return!1}(o,n,s)}isTileClipped(){return!0}}function Ru(e,t){return t>0?t+2*e:e}const Ou=Za([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Lu=Za([{name:"a_projected_pos",components:3,type:"Float32"}],4);Za([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const qu=Za([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Za([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ju=Za([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Uu=Za([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vu(e,t,r){return e.sections.forEach((e=>{e.text=function(e,t,r){const n=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),Aa.applyArabicShaping&&(e=Aa.applyArabicShaping(e)),e}(e.text,t,r)})),e}Za([{name:"triangle",components:3,type:"Uint16"}]),Za([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Za([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Za([{type:"Float32",name:"offsetX"}]),Za([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Za([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Zu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var $u,Gu,Hu,Wu=24,Xu={};function Yu(){if(Hu)return Gu;Hu=1,Gu=t;var e=($u||($u=1,Xu.read=function(e,t,r,n,i){var a,o,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=r?i-1:0,p=r?-1:1,d=e[t+h];for(h+=p,a=d&(1<<-c)-1,d>>=-c,c+=s;c>0;a=256*a+e[t+h],h+=p,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;c>0;o=256*o+e[t+h],h+=p,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),a-=u}return(d?-1:1)*o*Math.pow(2,a-n)},Xu.write=function(e,t,r,n,i,a){var o,s,l,u=8*a-i-1,c=(1<<u)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(t*l-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+d]=255&s,d+=f,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;e[r+d]=255&o,d+=f,o/=256,u-=8);e[r+d-f]|=128*m}),Xu);function t(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var r=4294967296,n=1/r,i="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");function a(e){return e.type===t.Bytes?e.readVarint()+e.pos:e.pos+1}function o(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function s(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function l(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function u(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function c(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function h(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function p(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function d(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function f(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function m(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function g(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function y(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function v(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function x(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,a=this.pos;this.type=7&n,e(i,t,this),this.pos===a&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=y(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=x(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=y(this.buf,this.pos)+y(this.buf,this.pos+4)*r;return this.pos+=8,e},readSFixed64:function(){var e=y(this.buf,this.pos)+x(this.buf,this.pos+4)*r;return this.pos+=8,e},readFloat:function(){var t=e.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=e.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,i,a=r.buf;if(n=(112&(i=a[r.pos++]))>>4,i<128)return o(e,n,t);if(n|=(127&(i=a[r.pos++]))<<3,i<128)return o(e,n,t);if(n|=(127&(i=a[r.pos++]))<<10,i<128)return o(e,n,t);if(n|=(127&(i=a[r.pos++]))<<17,i<128)return o(e,n,t);if(n|=(127&(i=a[r.pos++]))<<24,i<128)return o(e,n,t);if(n|=(1&(i=a[r.pos++]))<<31,i<128)return o(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&i?function(e,t,r){return i.decode(e.subarray(t,r))}(this.buf,t,e):function(e,t,r){for(var n="",i=t;i<r;){var a,o,s,l=e[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(a=e[i+1]))&&(u=(31&l)<<6|63&a)<=127&&(u=null):3===c?(o=e[i+2],128==(192&(a=e[i+1]))&&128==(192&o)&&((u=(15&l)<<12|(63&a)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=e[i+2],s=e[i+3],128==(192&(a=e[i+1]))&&128==(192&o)&&128==(192&s)&&((u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),i+=c}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,r){if(this.type!==t.Bytes)return e.push(this.readVarint(r));var n=a(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(r));return e},readPackedSVarint:function(e){if(this.type!==t.Bytes)return e.push(this.readSVarint());var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==t.Bytes)return e.push(this.readBoolean());var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==t.Bytes)return e.push(this.readFloat());var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==t.Bytes)return e.push(this.readDouble());var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==t.Bytes)return e.push(this.readFixed32());var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==t.Bytes)return e.push(this.readSFixed32());var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==t.Bytes)return e.push(this.readFixed64());var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==t.Bytes)return e.push(this.readSFixed64());var r=a(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed64());return e},skip:function(e){var r=7&e;if(r===t.Varint)for(;this.buf[this.pos++]>127;);else if(r===t.Bytes)this.pos=this.readVarint()+this.pos;else if(r===t.Fixed32)this.pos+=4;else{if(r!==t.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),v(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),v(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),v(this.buf,-1&e,this.pos),v(this.buf,Math.floor(e*n),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),v(this.buf,-1&e,this.pos),v(this.buf,Math.floor(e*n),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,r.buf[r.pos]=127&(e>>>=7)}(r,0,t),function(e,t){var r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,a=0;a<t.length;a++){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){n>56319||a+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&s(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),e.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),e.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&s(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,r,n){this.writeTag(e,t.Bytes),this.writeRawMessage(r,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,l,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,u,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,c,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,h,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,g,t)},writeBytesField:function(e,r){this.writeTag(e,t.Bytes),this.writeBytes(r)},writeFixed32Field:function(e,r){this.writeTag(e,t.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(e,r){this.writeTag(e,t.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(e,r){this.writeTag(e,t.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(e,r){this.writeTag(e,t.Fixed64),this.writeSFixed64(r)},writeVarintField:function(e,r){this.writeTag(e,t.Varint),this.writeVarint(r)},writeSVarintField:function(e,r){this.writeTag(e,t.Varint),this.writeSVarint(r)},writeStringField:function(e,r){this.writeTag(e,t.Bytes),this.writeString(r)},writeFloatField:function(e,r){this.writeTag(e,t.Fixed32),this.writeFloat(r)},writeDoubleField:function(e,r){this.writeTag(e,t.Fixed64),this.writeDouble(r)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}},Gu}var Ku=r(Yu());function Ju(e,t,r){1===e&&r.readMessage(Qu,t)}function Qu(e,t,r){if(3===e){const{id:e,bitmap:n,width:i,height:a,left:o,top:s,advance:l}=r.readMessage(ec,{});t.push({id:e,bitmap:new Js({width:i+6,height:a+6},n),metrics:{width:i,height:a,left:o,top:s,advance:l}})}}function ec(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function tc(e){let t=0,r=0;for(const n of e)t+=n.w*n.h,r=Math.max(r,n.w);e.sort(((e,t)=>t.h-e.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let i=0,a=0;for(const t of e)for(let e=n.length-1;e>=0;e--){const r=n[e];if(!(t.w>r.w||t.h>r.h)){if(t.x=r.x,t.y=r.y,a=Math.max(a,t.y+t.h),i=Math.max(i,t.x+t.w),t.w===r.w&&t.h===r.h){const t=n.pop();e<n.length&&(n[e]=t)}else t.h===r.h?(r.x+=t.w,r.w-=t.w):t.w===r.w?(r.y+=t.h,r.h-=t.h):(n.push({x:r.x+t.w,y:r.y,w:r.w-t.w,h:t.h}),r.y+=t.h,r.h-=t.h);break}}return{w:i,h:a,fill:t/(i*a)||0}}class rc{constructor(e,{pixelRatio:t,version:r,stretchX:n,stretchY:i,content:a,textFitWidth:o,textFitHeight:s}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=i,this.content=a,this.version=r,this.textFitWidth=o,this.textFitHeight=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class nc{constructor(e,t){const r={},n={};this.haveRenderCallbacks=[];const i=[];this.addImages(e,r,i),this.addImages(t,n,i);const{w:a,h:o}=tc(i),s=new Qs({width:a||1,height:o||1});for(const t in e){const n=e[t],i=r[t].paddedRect;Qs.copy(n.data,s,{x:0,y:0},{x:i.x+1,y:i.y+1},n.data)}for(const e in t){const r=t[e],i=n[e].paddedRect,a=i.x+1,o=i.y+1,l=r.data.width,u=r.data.height;Qs.copy(r.data,s,{x:0,y:0},{x:a,y:o},r.data),Qs.copy(r.data,s,{x:0,y:u-1},{x:a,y:o-1},{width:l,height:1}),Qs.copy(r.data,s,{x:0,y:0},{x:a,y:o+u},{width:l,height:1}),Qs.copy(r.data,s,{x:l-1,y:0},{x:a-1,y:o},{width:1,height:u}),Qs.copy(r.data,s,{x:0,y:0},{x:a+l,y:o},{width:1,height:u})}this.image=s,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(const n in e){const i=e[n],a={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(a),t[n]=new rc(a,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,i]=e.tl;r.update(t.data,void 0,{x:n,y:i})}}var ic;na("ImagePosition",rc),na("ImageAtlas",nc),e.al=void 0,(ic=e.al||(e.al={}))[ic.none=0]="none",ic[ic.horizontal=1]="horizontal",ic[ic.vertical=2]="vertical",ic[ic.horizontalOnly=3]="horizontalOnly";const ac=-17;class oc{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(e,t,r){const n=new oc;return n.scale=e||1,n.fontStack=t,n.verticalAlign=r||"bottom",n}static forImage(e,t){const r=new oc;return r.imageName=e,r.verticalAlign=t||"bottom",r}}class sc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const r=new sc;for(let n=0;n<e.sections.length;n++){const i=e.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,t)}return r}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let t="";for(let r=0;r<e.length;r++){const n=e.charCodeAt(r+1)||null,i=e.charCodeAt(r-1)||null;t+=n&&va(n)&&!Zu[e[r+1]]||i&&va(i)&&!Zu[e[r-1]]||!Zu[e[r]]?e[r]:Zu[e[r]]}return t}(this.text)}trim(){let e=0;for(let t=0;t<this.text.length&&uc[this.text.charCodeAt(t)];t++)e++;let t=this.text.length;for(let r=this.text.length-1;r>=0&&r>=e&&uc[this.text.charCodeAt(r)];r--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const r=new sc;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}getMaxImageSize(e){let t=0,r=0;for(let n=0;n<this.length();n++){const i=this.getSection(n);if(i.imageName){const n=e[i.imageName];if(!n)continue;const a=n.displaySize;t=Math.max(t,a[0]),r=Math.max(r,a[1])}}return{maxImageWidth:t,maxImageHeight:r}}addTextSection(e,t){this.text+=e.text,this.sections.push(oc.forText(e.scale,e.fontStack||t,e.verticalAlign));const r=this.sections.length-1;for(let t=0;t<e.text.length;++t)this.sectionIndex.push(r)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void V("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(oc.forImage(t,e.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):V("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function lc(t,r,n,i,a,o,s,l,u,c,h,p,d,f,m){const g=sc.fromFeature(t,a);let y;p===e.al.vertical&&g.verticalizePunctuation();const{processBidirectionalText:v,processStyledBidirectionalText:x}=Aa;if(v&&1===g.sections.length){y=[];const e=v(g.toString(),yc(g,c,o,r,i,f));for(const t of e){const e=new sc;e.text=t,e.sections=g.sections;for(let r=0;r<t.length;r++)e.sectionIndex.push(0);y.push(e)}}else if(x){y=[];const e=x(g.text,g.sectionIndex,yc(g,c,o,r,i,f));for(const t of e){const e=new sc;e.text=t[0],e.sectionIndex=t[1],e.sections=g.sections,y.push(e)}}else y=function(e,t){const r=[],n=e.text;let i=0;for(const n of t)r.push(e.substring(i,n)),i=n;return i<n.length&&r.push(e.substring(i,n.length)),r}(g,yc(g,c,o,r,i,f));const _=[],b={positionedLines:_,text:g.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(e,t,r,n,i,a,o,s,l,u,c,h){let p=0,d=0,f=0,m=0;const g="right"===s?1:"left"===s?0:.5,y=Wu/h;let v=0;for(const o of i){o.trim();const i=o.getMaxScale(),s={positionedGlyphs:[],lineOffset:0};e.positionedLines[v]=s;const h=s.positionedGlyphs;let x=0;if(!o.length()){d+=a,++v;continue}const _=xc(n,o,y);for(let a=0;a<o.length();a++){const s=o.getSection(a),f=o.getSectionIndex(a),m=o.getCharCode(a),g=bc(l,c,m);let v;if(s.imageName){if(e.iconsInText=!0,s.scale=s.scale*y,v=Ac(s,g,i,_,n),!v)continue;x=Math.max(x,v.imageOffset)}else if(v=wc(s,m,g,_,t,r),!v)continue;const{rect:b,metrics:w,baselineOffset:A}=v;h.push({glyph:m,imageName:s.imageName,x:p,y:d+A+ac,vertical:g,scale:s.scale,fontStack:s.fontStack,sectionIndex:f,metrics:w,rect:b}),g?(e.verticalizable=!0,p+=(s.imageName?w.advance:Wu)*s.scale+u):p+=w.advance*s.scale+u}0!==h.length&&(f=Math.max(p-u,f),Cc(h,0,h.length-1,g)),p=0,s.lineOffset=Math.max(x,(i-1)*Wu);const b=a*i+x;d+=b,m=Math.max(b,m),++v}const{horizontalAlign:x,verticalAlign:_}=vc(o);(function(e,t,r,n,i,a,o,s,l){const u=(t-r)*i;let c=0;c=a!==o?-s*n-ac:-n*l*o+.5*o;for(const t of e)for(const e of t.positionedGlyphs)e.x+=u,e.y+=c})(e.positionedLines,g,x,_,f,m,a,d,i.length),e.top+=-_*d,e.bottom=e.top+d,e.left+=-x*f,e.right=e.left+f}(b,r,n,i,y,s,l,u,p,c,d,m),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(_)&&b}const uc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},cc={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},hc={40:!0};function pc(e,t,r,n,i,a){if(t.imageName){const e=n[t.imageName];return e?e.displaySize[0]*t.scale*Wu/a+i:0}{const n=r[t.fontStack],a=n&&n[e];return a?a.metrics.advance*t.scale+i:0}}function dc(e,t,r,n){const i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function fc(e,t,r){let n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function mc(e,t,r,n,i,a){let o=null,s=dc(t,r,i,a);for(const e of n){const n=dc(t-e.x,r,i,a)+e.badness;n<=s&&(o=e,s=n)}return{index:e,x:t,priorBreak:o,badness:s}}function gc(e){return e?gc(e.priorBreak).concat(e.index):[]}function yc(e,t,r,n,i,a){if(!e)return[];const o=[],s=function(e,t,r,n,i,a){let o=0;for(let r=0;r<e.length();r++){const s=e.getSection(r);o+=pc(e.getCharCode(r),s,n,i,t,a)}return o/Math.max(1,Math.ceil(o/r))}(e,t,r,n,i,a),l=e.text.indexOf("​")>=0;let u=0;for(let r=0;r<e.length();r++){const h=e.getSection(r),p=e.getCharCode(r);if(uc[p]||(u+=pc(p,h,n,i,t,a)),r<e.length()-1){const t=!((c=p)<11904)&&(!!ca["CJK Compatibility Forms"](c)||!!ca["CJK Compatibility"](c)||!!ca["CJK Strokes"](c)||!!ca["CJK Symbols and Punctuation"](c)||!!ca["Enclosed CJK Letters and Months"](c)||!!ca["Halfwidth and Fullwidth Forms"](c)||!!ca["Ideographic Description Characters"](c)||!!ca["Vertical Forms"](c)||ga.test(String.fromCodePoint(c)));(cc[p]||t||h.imageName||r!==e.length()-2&&hc[e.getCharCode(r+1)])&&o.push(mc(r+1,u,s,o,fc(p,e.getCharCode(r+1),t&&l),!1))}}var c;return gc(mc(e.length(),u,s,o,0,!0))}function vc(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function xc(e,t,r){const n=t.getMaxScale()*Wu,{maxImageWidth:i,maxImageHeight:a}=t.getMaxImageSize(e),o=Math.max(n,a*r);return{verticalLineContentWidth:Math.max(n,i*r),horizontalLineContentHeight:o}}function _c(e){switch(e){case"top":return 0;case"center":return.5;default:return 1}}function bc(t,r,n){return!(t===e.al.horizontal||!r&&!ya(n)||r&&(uc[n]||(i=n,/\p{sc=Arab}/u.test(String.fromCodePoint(i)))));var i}function wc(e,t,r,n,i,a){const o=a[e.fontStack],s=function(e,t,r,n){if(e&&e.rect)return e;const i=t[r.fontStack],a=i&&i[n];return a?{rect:null,metrics:a.metrics}:null}(o&&o[t],i,e,t);if(null===s)return null;let l;if(r)l=n.verticalLineContentWidth-e.scale*Wu;else{const t=_c(e.verticalAlign);l=(n.horizontalLineContentHeight-e.scale*Wu)*t}return{rect:s.rect,metrics:s.metrics,baselineOffset:l}}function Ac(e,t,r,n,i){const a=i[e.imageName];if(!a)return null;const o=a.paddedRect,s=a.displaySize,l={width:s[0],height:s[1],left:1,top:-3,advance:t?s[1]:s[0]};let u;if(t)u=n.verticalLineContentWidth-s[1]*e.scale;else{const t=_c(e.verticalAlign);u=(n.horizontalLineContentHeight-s[1]*e.scale)*t}return{rect:o,metrics:l,baselineOffset:u,imageOffset:(t?s[0]:s[1])*e.scale-Wu*r}}function Cc(e,t,r,n){if(0===n)return;const i=e[r],a=(e[r].x+i.metrics.advance*i.scale)*n;for(let n=t;n<=r;n++)e[n].x-=a}function Ec(e,t,r){const{horizontalAlign:n,verticalAlign:i}=vc(r),a=t[0]-e.displaySize[0]*n,o=t[1]-e.displaySize[1]*i;return{image:e,top:o,bottom:o+e.displaySize[1],left:a,right:a+e.displaySize[0]}}function Mc(e){var t,r;let n=e.left,i=e.top,a=e.right-n,o=e.bottom-i;const s=null!==(t=e.image.textFitWidth)&&void 0!==t?t:"stretchOrShrink",l=null!==(r=e.image.textFitHeight)&&void 0!==r?r:"stretchOrShrink",u=(e.image.content[2]-e.image.content[0])/(e.image.content[3]-e.image.content[1]);if("proportional"===l){if("stretchOnly"===s&&a/o<u||"proportional"===s){const e=Math.ceil(o*u);n*=e/a,a=e}}else if("proportional"===s&&"stretchOnly"===l&&0!==u&&a/o>u){const e=Math.ceil(a/u);i*=e/o,o=e}return{x1:n,y1:i,x2:n+a,y2:i+o}}function Sc(e,t,r,n,i,a){const o=e.image;let s;if(o.content){const e=o.content,t=o.pixelRatio||1;s=[e[0]/t,e[1]/t,o.displaySize[0]-e[2]/t,o.displaySize[1]-e[3]/t]}const l=t.left*a,u=t.right*a;let c,h,p,d;"width"===r||"both"===r?(d=i[0]+l-n[3],h=i[0]+u+n[1]):(d=i[0]+(l+u-o.displaySize[0])/2,h=d+o.displaySize[0]);const f=t.top*a,m=t.bottom*a;return"height"===r||"both"===r?(c=i[1]+f-n[0],p=i[1]+m+n[2]):(c=i[1]+(f+m-o.displaySize[1])/2,p=c+o.displaySize[1]),{image:o,top:c,right:h,bottom:p,left:d,collisionPadding:s}}const Dc=128,Tc=32640;function Nc(e,t){const{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Ca(e+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=r;let i=0;for(;i<t.length&&t[i]<=e;)i++;i=Math.max(0,i-1);let a=i;for(;a<t.length&&t[a]<e+1;)a++;a=Math.min(t.length-1,a);const o=t[i],s=t[a];return"composite"===r.kind?{kind:"composite",minZoom:o,maxZoom:s,interpolationType:n}:{kind:"camera",minZoom:o,maxZoom:s,minSize:r.evaluate(new Ca(o)),maxSize:r.evaluate(new Ca(s)),interpolationType:n}}}function Ic(e,t,r){let n="never";const i=e.get(t);return i?n=i:e.get(r)&&(n="always"),n}const Pc=cu.VectorTileFeature.types,zc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Bc(e,t,r,n,i,a,o,s,l,u,c,h,p){const d=s?Math.min(Tc,Math.round(s[0])):0,f=s?Math.min(Tc,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),a,o,(d<<1)+(l?1:0),f,16*u,16*c,256*h,256*p)}function kc(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Fc(e){for(const t of e.sections)if(wa(t.text))return!0;return!1}class Rc{constructor(e){this.layoutVertexArray=new ko,this.indexArray=new qo,this.programConfigurations=e,this.segments=new Zo,this.dynamicLayoutVertexArray=new Fo,this.opacityVertexArray=new Ro,this.hasVisibleVertices=!1,this.placedSymbolArray=new xo}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ou.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Lu.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,zc,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}na("SymbolBuffers",Rc);class Oc{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new Zo,this.collisionVertexArray=new Lo}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,qu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}na("CollisionBuffers",Oc);class Lc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Nc(this.zoom,r["text-size"]),this.iconSizeData=Nc(this.zoom,r["icon-size"]);const n=this.layers[0].layout,i=n.get("symbol-sort-key"),a=n.get("symbol-z-order");this.canOverlap="never"!==Ic(n,"text-overlap","text-allow-overlap")||"never"!==Ic(n,"icon-overlap","icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!i.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((t=>e.al[t]))),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=t.sourceID}createArrays(){this.text=new Rc(new ys(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new Rc(new ys(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new wo,this.lineVertexArray=new Ao,this.symbolInstances=new bo,this.textAnchorOffsets=new Eo}calculateGlyphDependencies(e,t,r,n,i){for(let a=0;a<e.length;a++)if(t[e.charCodeAt(a)]=!0,(r||n)&&i){const r=Zu[e.charAt(a)];r&&(t[r.charCodeAt(0)]=!0)}}populate(t,r,n){const i=this.layers[0],a=i.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),u=("constant"!==s.value.kind||s.value.value instanceof Tt&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),c="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=a.get("symbol-sort-key");if(this.features=[],!u&&!c)return;const p=r.iconDependencies,d=r.glyphDependencies,f=r.availableImages,m=new Ca(this.zoom);for(const{feature:r,id:s,index:l,sourceLayerIndex:g}of t){const t=i._featureFilter.needGeometry,y=As(r,t);if(!i._featureFilter.filter(m,y,n))continue;let v,x;if(t||(y.geometry=ws(r)),u){const e=i.getValueAndResolveTokens("text-field",y,n,f),t=Tt.factory(e),r=this.hasRTLText=this.hasRTLText||Fc(t);(!r||"unavailable"===Aa.getRTLTextPluginStatus()||r&&Aa.isParsed())&&(v=Vu(t,i,y))}if(c){const e=i.getValueAndResolveTokens("icon-image",y,n,f);x=e instanceof Ft?e:Ft.fromString(e)}if(!v&&!x)continue;const _=this.sortFeaturesByKey?h.evaluate(y,{},n):void 0;if(this.features.push({id:s,text:v,icon:x,index:l,sourceLayerIndex:g,geometry:y.geometry,properties:r.properties,type:Pc[r.type],sortKey:_}),x&&(p[x.name]=!0),v){const t=o.evaluate(y,{},n).join(","),r="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.al.vertical)>=0;for(const e of v.sections)if(e.image)p[e.image.name]=!0;else{const n=ha(v.toString()),i=e.fontStack||t,a=d[i]=d[i]||{};this.calculateGlyphDependencies(e.text,a,r,this.allowVerticalPlacement,n)}}}"line"===a.get("symbol-placement")&&(this.features=function(e){const t={},r={},n=[];let i=0;function a(t){n.push(e[t]),i++}function o(e,t,i){const a=r[e];return delete r[e],r[t]=a,n[a].geometry[0].pop(),n[a].geometry[0]=n[a].geometry[0].concat(i[0]),a}function s(e,r,i){const a=t[r];return delete t[r],t[e]=a,n[a].geometry[0].shift(),n[a].geometry[0]=i[0].concat(n[a].geometry[0]),a}function l(e,t,r){const n=r?t[0][t[0].length-1]:t[0][0];return`${e}:${n.x}:${n.y}`}for(let u=0;u<e.length;u++){const c=e[u],h=c.geometry,p=c.text?c.text.toString():null;if(!p){a(u);continue}const d=l(p,h),f=l(p,h,!0);if(d in r&&f in t&&r[d]!==t[f]){const e=s(d,f,h),i=o(d,f,n[e].geometry);delete t[d],delete r[f],r[l(p,n[i].geometry,!0)]=i,n[e].geometry=null}else d in r?o(d,f,h):f in t?s(d,f,h):(a(u),t[d]=i-1,r[f]=i-1)}return n.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const r=this.lineVertexArray.length;if(void 0!==e.segment){let r=e.dist(t[e.segment+1]),n=e.dist(t[e.segment]);const i={};for(let n=e.segment+1;n<t.length;n++)i[n]={x:t[n].x,y:t[n].y,tileUnitDistanceFromAnchor:r},n<t.length-1&&(r+=t[n+1].dist(t[n]));for(let r=e.segment||0;r>=0;r--)i[r]={x:t[r].x,y:t[r].y,tileUnitDistanceFromAnchor:n},r>0&&(n+=t[r-1].dist(t[r]));for(let e=0;e<t.length;e++){const t=i[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(t,r,n,i,a,o,s,l,u,c,h,p){const d=t.indexArray,f=t.layoutVertexArray,m=t.segments.prepareSegment(4*r.length,f,d,this.canOverlap?o.sortKey:void 0),g=this.glyphOffsetArray.length,y=m.vertexLength,v=this.allowVerticalPlacement&&s===e.al.vertical?Math.PI/2:0,x=o.text&&o.text.sections;for(let e=0;e<r.length;e++){const{tl:i,tr:a,bl:s,br:u,tex:c,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:y,minFontScaleY:_,glyphOffset:b,isSDF:w,sectionIndex:A}=r[e],C=m.vertexLength,E=b[1];Bc(f,l.x,l.y,i.x,E+i.y,c.x,c.y,n,w,h.x,h.y,y,_),Bc(f,l.x,l.y,a.x,E+a.y,c.x+c.w,c.y,n,w,g.x,h.y,y,_),Bc(f,l.x,l.y,s.x,E+s.y,c.x,c.y+c.h,n,w,h.x,g.y,y,_),Bc(f,l.x,l.y,u.x,E+u.y,c.x+c.w,c.y+c.h,n,w,g.x,g.y,y,_),kc(t.dynamicLayoutVertexArray,l,v),d.emplaceBack(C,C+2,C+1),d.emplaceBack(C+1,C+2,C+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),e!==r.length-1&&A===r[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(f.length,o,o.index,{},p,x&&x[A])}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,h)}_addCollisionDebugVertex(e,t,r,n,i,a){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,i,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,t,r,n,i,a,o){const s=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),u=s.vertexLength,c=i.layoutVertexArray,h=i.collisionVertexArray,p=o.anchorX,d=o.anchorY;this._addCollisionDebugVertex(c,h,a,p,d,new l(e,t)),this._addCollisionDebugVertex(c,h,a,p,d,new l(r,t)),this._addCollisionDebugVertex(c,h,a,p,d,new l(r,n)),this._addCollisionDebugVertex(c,h,a,p,d,new l(e,n)),s.vertexLength+=4;const f=i.indexArray;f.emplaceBack(u,u+1),f.emplaceBack(u+1,u+2),f.emplaceBack(u+2,u+3),f.emplaceBack(u+3,u),s.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,n){for(let i=e;i<t;i++){const e=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(e.x1,e.y1,e.x2,e.y2,n?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Oc(Oo,ju.members,jo),this.iconCollisionBox=new Oc(Oo,ju.members,jo);for(let e=0;e<this.symbolInstances.length;e++){const t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,n,i,a,o,s,l){const u={};for(let n=t;n<r;n++){const t=e.get(n);u.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},u.textFeatureIndex=t.featureIndex;break}for(let t=n;t<i;t++){const r=e.get(t);u.verticalTextBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.verticalTextFeatureIndex=r.featureIndex;break}for(let t=a;t<o;t++){const r=e.get(t);u.iconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.iconFeatureIndex=r.featureIndex;break}for(let t=s;t<l;t++){const r=e.get(t);u.verticalIconBox={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,anchorPointX:r.anchorPointX,anchorPointY:r.anchorPointY},u.verticalIconFeatureIndex=r.featureIndex;break}return u}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs;for(let t=r.vertexStartIndex;t<n;t+=4)e.indexArray.emplaceBack(t,t+2,t+1),e.indexArray.emplaceBack(t+1,t+2,t+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),r=Math.cos(e),n=[],i=[],a=[];for(let e=0;e<this.symbolInstances.length;++e){a.push(e);const o=this.symbolInstances.get(e);n.push(0|Math.round(t*o.anchorX+r*o.anchorY)),i.push(o.featureIndex)}return a.sort(((e,t)=>n[e]-n[t]||i[t]-i[e])),a}addToSortKeyRanges(e,t){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach(((e,t,r)=>{e>=0&&r.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)})),t.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),t.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),t.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let qc,jc;na("SymbolBucket",Lc,{omit:["layers","collisionBoxArray","features","compareText"]}),Lc.MAX_GLYPHS=65535,Lc.addDynamicAttributes=kc;var Uc={get paint(){return jc=jc||new Oa({"icon-opacity":new Ba(ye.paint_symbol["icon-opacity"]),"icon-color":new Ba(ye.paint_symbol["icon-color"]),"icon-halo-color":new Ba(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ba(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ba(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new za(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new za(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ba(ye.paint_symbol["text-opacity"]),"text-color":new Ba(ye.paint_symbol["text-color"],{runtimeType:Re,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Ba(ye.paint_symbol["text-halo-color"]),"text-halo-width":new Ba(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new Ba(ye.paint_symbol["text-halo-blur"]),"text-translate":new za(ye.paint_symbol["text-translate"]),"text-translate-anchor":new za(ye.paint_symbol["text-translate-anchor"])})},get layout(){return qc=qc||new Oa({"symbol-placement":new za(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new za(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new za(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ba(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new za(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new za(ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new za(ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new za(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new za(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new za(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ba(ye.layout_symbol["icon-size"]),"icon-text-fit":new za(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new za(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ba(ye.layout_symbol["icon-image"]),"icon-rotate":new Ba(ye.layout_symbol["icon-rotate"]),"icon-padding":new Ba(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new za(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new Ba(ye.layout_symbol["icon-offset"]),"icon-anchor":new Ba(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new za(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new za(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new za(ye.layout_symbol["text-rotation-alignment"]),"text-field":new Ba(ye.layout_symbol["text-field"]),"text-font":new Ba(ye.layout_symbol["text-font"]),"text-size":new Ba(ye.layout_symbol["text-size"]),"text-max-width":new Ba(ye.layout_symbol["text-max-width"]),"text-line-height":new za(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new Ba(ye.layout_symbol["text-letter-spacing"]),"text-justify":new Ba(ye.layout_symbol["text-justify"]),"text-radial-offset":new Ba(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new za(ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ba(ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ba(ye.layout_symbol["text-anchor"]),"text-max-angle":new za(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new za(ye.layout_symbol["text-writing-mode"]),"text-rotate":new Ba(ye.layout_symbol["text-rotate"]),"text-padding":new za(ye.layout_symbol["text-padding"]),"text-keep-upright":new za(ye.layout_symbol["text-keep-upright"]),"text-transform":new Ba(ye.layout_symbol["text-transform"]),"text-offset":new Ba(ye.layout_symbol["text-offset"]),"text-allow-overlap":new za(ye.layout_symbol["text-allow-overlap"]),"text-overlap":new za(ye.layout_symbol["text-overlap"]),"text-ignore-placement":new za(ye.layout_symbol["text-ignore-placement"]),"text-optional":new za(ye.layout_symbol["text-optional"])})}};class Vc{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:ze,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}na("FormatSectionOverride",Vc,{omit:["defaultValue"]});class Zc extends qa{constructor(e){super(e,Uc)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const e=this.layout.get("text-writing-mode");if(e){const t=[];for(const r of e)t.indexOf(r)<0&&t.push(r);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){const i=this.layout.get(e).evaluate(t,{},r,n),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||Qn(a.value)||!i?i:function(e,t){return t.replace(/{([^{}]+)}/g,((t,r)=>e&&r in e?String(e[r]):""))}(t.properties,i)}createBucket(e){return new Lc(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Uc.paint.overridableProperties){if(!Zc.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),r=new Vc(t),n=new Jn(r,t.property.specification);let i=null;i="constant"===t.value.kind||"source"===t.value.kind?new ti("source",n):new ri("composite",n,t.value.zoomStops),this.paint._values[e]=new Ia(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&Zc.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const r=e.get("text-field"),n=Uc.paint.properties[t];let i=!1;const a=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(i=!0)};if("constant"===r.value.kind&&r.value.value instanceof Tt)a(r.value.value.sections);else if("source"===r.value.kind){const e=t=>{i||(t instanceof Ut&&qt(t.value)===Ue?a(t.value.sections):t instanceof Er?a(t.sections):t.eachChild(e))},t=r.value;t._styleExpression&&e(t._styleExpression.expression)}return i}}let $c;var Gc={get paint(){return $c=$c||new Oa({"background-color":new za(ye.paint_background["background-color"]),"background-pattern":new Fa(ye.paint_background["background-pattern"]),"background-opacity":new za(ye.paint_background["background-opacity"])})}};class Hc extends qa{constructor(e){super(e,Gc)}}let Wc;var Xc={get paint(){return Wc=Wc||new Oa({"raster-opacity":new za(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new za(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new za(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new za(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new za(ye.paint_raster["raster-saturation"]),"raster-contrast":new za(ye.paint_raster["raster-contrast"]),"raster-resampling":new za(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new za(ye.paint_raster["raster-fade-duration"])})}};class Yc extends qa{constructor(e){super(e,Xc)}}class Kc extends qa{constructor(e){super(e,{}),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Jc{constructor(e){this._methodToThrottle=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Qc={once:!0},eh=6371008.8;class th{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new th(F(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,r=this.lat*t,n=e.lat*t,i=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return eh*Math.acos(Math.min(i,1))}static convert(e){if(e instanceof th)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new th(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new th(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const rh=2*Math.PI*eh;function nh(e){return rh*Math.cos(e*Math.PI/180)}function ih(e){return(180+e)/360}function ah(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function oh(e,t){return e/nh(t)}function sh(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function lh(e,t){return e*nh(sh(t))}class uh{constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e,t=0){const r=th.convert(e);return new uh(ih(r.lng),ah(r.lat),oh(t,r.lat))}toLngLat(){return new th(360*this.x-180,sh(this.y))}toAltitude(){return lh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/rh*(e=sh(this.y),1/Math.cos(e*Math.PI/180));var e}}function ch(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}class hh{constructor(e,t,r){if(!function(e,t,r){return!(e<0||e>25||r<0||r>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))}(e,t,r))throw new Error(`x=${t}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=r,this.key=fh(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){const n=(a=this.y,o=this.z,s=ch(256*(i=this.x),256*(a=Math.pow(2,o)-a-1),o),l=ch(256*(i+1),256*(a+1),o),s[0]+","+s[1]+","+l[0]+","+l[1]);var i,a,o,s,l;const u=function(e,t,r){let n,i="";for(let a=e;a>0;a--)n=1<<a-1,i+=(t&n?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,u).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){const t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){const t=Math.pow(2,this.z);return new l((e.x*t-this.x)*D,(e.y*t-this.y)*D)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ph{constructor(e,t){this.wrap=e,this.canonical=t,this.key=fh(e,t.z,t.z,t.x,t.y)}}class dh{constructor(e,t,r,n,i){if(this.terrainRttPosMatrix32f=null,e<r)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${r}`);this.overscaledZ=e,this.wrap=t,this.canonical=new hh(r,+n,+i),this.key=fh(t,e,r,n,i)}clone(){return new dh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const t=this.canonical.z-e;return e>this.canonical.z?new dh(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new dh(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?fh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):fh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new dh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new dh(t,this.wrap,t,r,n),new dh(t,this.wrap,t,r+1,n),new dh(t,this.wrap,t,r,n+1),new dh(t,this.wrap,t,r+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new dh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new dh(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ph(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new uh(e.x-this.wrap,e.y))}}function fh(e,t,r,n,i){(e*=2)<0&&(e=-1*e-1);const a=1<<r;return(a*a*e+a*i+n).toString(36)+r.toString(36)+t.toString(36)}na("CanonicalTileID",hh),na("OverscaledTileID",dh,{omit:["terrainRttPosMatrix32f"]});class mh{constructor(e,t,r,n=1,i=1,a=1,o=0){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&!["mapbox","terrarium","custom"].includes(r))return void V(`"${r}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=t.height;const s=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),r){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=i,this.blueFactor=a,this.baseShift=o;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let e=0;e<s;e++)this.data[this._idx(-1,e)]=this.data[this._idx(0,e)],this.data[this._idx(s,e)]=this.data[this._idx(s-1,e)],this.data[this._idx(e,-1)]=this.data[this._idx(e,0)],this.data[this._idx(e,s)]=this.data[this._idx(e,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let e=0;e<s;e++)for(let t=0;t<s;t++){const r=this.get(e,t);r>this.max&&(this.max=r),r<this.min&&(this.min=r)}}get(e,t){const r=new Uint8Array(this.data.buffer),n=4*this._idx(e,t);return this.unpack(r[n],r[n+1],r[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,r){return e*this.redFactor+t*this.greenFactor+r*this.blueFactor-this.baseShift}getPixels(){return new Qs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,i=t*this.dim+this.dim,a=r*this.dim,o=r*this.dim+this.dim;switch(t){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:a=o-1;break;case 1:o=a+1}const s=-t*this.dim,l=-r*this.dim;for(let t=a;t<o;t++)for(let r=n;r<i;r++)this.data[this._idx(r,t)]=e.data[this._idx(r+s,t+l)]}}na("DEMData",mh);class gh{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class yh{constructor(e,t,r,n,i){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=n,this.properties=e.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}}class vh{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ta(D,16,0),this.grid3D=new ta(D,16,0),this.featureIndexArray=new So,this.promoteId=t}insert(e,t,r,n,i,a){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i);const s=a?this.grid3D:this.grid;for(let e=0;e<t.length;e++){const r=t[e],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<r.length;e++){const t=r[e];n[0]=Math.min(n[0],t.x),n[1]=Math.min(n[1],t.y),n[2]=Math.max(n[2],t.x),n[3]=Math.max(n[3],t.y)}n[0]<D&&n[1]<D&&n[2]>=0&&n[3]>=0&&s.insert(o,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new cu.VectorTile(new Ku(this.rawTileData)).layers,this.sourceLayerCoder=new gh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,r,n){this.loadVTLayers();const i=e.params,a=D/e.tileSize/e.scale,o=li(i.filter),s=e.queryGeometry,u=e.queryPadding*a,c=_h(s),h=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),p=_h(e.cameraQueryGeometry),d=this.grid3D.query(p.minX-u,p.minY-u,p.maxX+u,p.maxY+u,((t,r,n,i)=>function(e,t,r,n,i){for(const a of e)if(t<=a.x&&r<=a.y&&n>=a.x&&i>=a.y)return!0;const a=[new l(t,r),new l(t,i),new l(n,i),new l(n,r)];if(e.length>2)for(const t of a)if(Fs(e,t))return!0;for(let t=0;t<e.length-1;t++)if(Rs(e[t],e[t+1],a))return!0;return!1}(e.cameraQueryGeometry,t-u,r-u,n+u,i+u)));for(const e of d)h.push(e);h.sort(bh);const f={};let m;for(let l=0;l<h.length;l++){const u=h[l];if(u===m)continue;m=u;const c=this.featureIndexArray.get(u);let p=null;this.loadMatchingFeature(f,c.bucketIndex,c.sourceLayerIndex,c.featureIndex,o,i.layers,i.availableImages,t,r,n,((t,r,n)=>(p||(p=ws(t)),r.queryIntersectsFeature({queryGeometry:s,feature:t,featureState:n,geometry:p,zoom:this.z,transform:e.transform,pixelsToTileUnits:a,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return f}loadMatchingFeature(e,t,r,n,i,a,o,s,l,u,c){const h=this.bucketLayerIDs[t];if(a&&!h.some((e=>a.has(e))))return;const p=this.sourceLayerCoder.decode(r),d=this.vtLayers[p].feature(n);if(i.needGeometry){const e=As(d,!0);if(!i.filter(new Ca(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!i.filter(new Ca(this.tileID.overscaledZ),d))return;const f=this.getId(d,p);for(let t=0;t<h.length;t++){const r=h[t];if(a&&!a.has(r))continue;const i=s[r];if(!i)continue;let p={};f&&u&&(p=u.getState(i.sourceLayer||"_geojsonTileLayer",f));const m=R({},l[r]);m.paint=xh(m.paint,i.paint,d,p,o),m.layout=xh(m.layout,i.layout,d,p,o);const g=!c||c(d,i,p);if(!g)continue;const y=new yh(d,this.z,this.x,this.y,f);y.layer=m;let v=e[r];void 0===v&&(v=e[r]=[]),v.push({featureIndex:n,feature:y,intersectionZ:g})}}lookupSymbolFeatures(e,t,r,n,i,a,o,s){const l={};this.loadVTLayers();const u=li(i);for(const i of e)this.loadMatchingFeature(l,r,n,i,u,a,o,s,t);return l}hasLayer(e){for(const t of this.bucketLayerIDs)for(const r of t)if(e===r)return!0;return!1}getId(e,t){var r;let n=e.id;return this.promoteId&&(n=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]],"boolean"==typeof n&&(n=Number(n)),void 0===n&&(null===(r=e.properties)||void 0===r?void 0:r.cluster)&&this.promoteId&&(n=Number(e.properties.cluster_id))),n}}function xh(e,t,r,n,i){return L(e,((e,a)=>{const o=t instanceof Pa?t.get(a):null;return o&&o.evaluate?o.evaluate(r,n,i):o}))}function _h(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(const a of e)t=Math.min(t,a.x),r=Math.min(r,a.y),n=Math.max(n,a.x),i=Math.max(i,a.y);return{minX:t,minY:r,maxX:n,maxY:i}}function bh(e,t){return t-e}function wh(e,t,r,n,i){const a=[];for(let o=0;o<e.length;o++){const s=e[o];let u;for(let e=0;e<s.length-1;e++){let o=s[e],c=s[e+1];o.x<t&&c.x<t||(o.x<t?o=new l(t,o.y+(t-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x<t&&(c=new l(t,o.y+(t-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y<r&&c.y<r||(o.y<r?o=new l(o.x+(r-o.y)/(c.y-o.y)*(c.x-o.x),r)._round():c.y<r&&(c=new l(o.x+(r-o.y)/(c.y-o.y)*(c.x-o.x),r)._round()),o.x>=n&&c.x>=n||(o.x>=n?o=new l(n,o.y+(n-o.x)/(c.x-o.x)*(c.y-o.y))._round():c.x>=n&&(c=new l(n,o.y+(n-o.x)/(c.x-o.x)*(c.y-o.y))._round()),o.y>=i&&c.y>=i||(o.y>=i?o=new l(o.x+(i-o.y)/(c.y-o.y)*(c.x-o.x),i)._round():c.y>=i&&(c=new l(o.x+(i-o.y)/(c.y-o.y)*(c.x-o.x),i)._round()),u&&o.equals(u[u.length-1])||(u=[o],a.push(u)),u.push(c)))))}}return a}na("FeatureIndex",vh,{omit:["rawTileData","sourceLayerCoder"]});class Ah extends l{constructor(e,t,r,n){super(e,t),this.angle=r,void 0!==n&&(this.segment=n)}clone(){return new Ah(this.x,this.y,this.angle,this.segment)}}function Ch(e,t,r,n,i){if(void 0===t.segment||0===r)return!0;let a=t,o=t.segment+1,s=0;for(;s>-r/2;){if(o--,o<0)return!1;s-=e[o].dist(a),a=e[o]}s+=e[o].dist(e[o+1]),o++;const l=[];let u=0;for(;s<r/2;){const t=e[o],r=e[o+1];if(!r)return!1;let a=e[o-1].angleTo(t)-t.angleTo(r);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:a}),u+=a;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;o++,s+=t.dist(r)}return!0}function Eh(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Mh(e,t,r){return e?.6*t*r:0}function Sh(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Dh(e,t,r,n,i,a){const o=Mh(r,i,a),s=Sh(r,n)*a;let l=0;const u=Eh(e)/2;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1],a=n.dist(i);if(l+a>u){const c=(u-l)/a,h=pr.number(n.x,i.x,c),p=pr.number(n.y,i.y,c),d=new Ah(h,p,i.angleTo(n),r);return d._round(),!o||Ch(e,d,s,o,t)?d:void 0}l+=a}}function Th(e,t,r,n,i,a,o,s,l){const u=Mh(n,a,o),c=Sh(n,i),h=c*o,p=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-h<t/4&&(t=h+t/4),Nh(e,p?t/2*s%t:(c/2+2*a)*o*s%t,t,u,r,h,p,!1,l)}function Nh(e,t,r,n,i,a,o,s,l){const u=a/2,c=Eh(e);let h=0,p=t-r,d=[];for(let t=0;t<e.length-1;t++){const o=e[t],s=e[t+1],f=o.dist(s),m=s.angleTo(o);for(;p+r<h+f;){p+=r;const g=(p-h)/f,y=pr.number(o.x,s.x,g),v=pr.number(o.y,s.y,g);if(y>=0&&y<l&&v>=0&&v<l&&p-u>=0&&p+u<=c){const r=new Ah(y,v,m,t);r._round(),n&&!Ch(e,r,a,n,i)||d.push(r)}}h+=f}return s||d.length||o||(d=Nh(e,h/2,r,n,i,a,o,!0,l)),d}na("Anchor",Ah);function Ih(e,t,r,n){const i=[],a=e.image,o=a.pixelRatio,s=a.paddedRect.w-2,u=a.paddedRect.h-2;let c={x1:e.left,y1:e.top,x2:e.right,y2:e.bottom};const h=a.stretchX||[[0,s]],p=a.stretchY||[[0,u]],d=(e,t)=>e+t[1]-t[0],f=h.reduce(d,0),m=p.reduce(d,0),g=s-f,y=u-m;let v=0,x=f,_=0,b=m,w=0,A=g,C=0,E=y;if(a.content&&n){const t=a.content,r=t[2]-t[0],n=t[3]-t[1];(a.textFitWidth||a.textFitHeight)&&(c=Mc(e)),v=Ph(h,0,t[0]),_=Ph(p,0,t[1]),x=Ph(h,t[0],t[2]),b=Ph(p,t[1],t[3]),w=t[0]-v,C=t[1]-_,A=r-x,E=n-b}const M=c.x1,S=c.y1,D=c.x2-M,T=c.y2-S,N=(e,n,i,s)=>{const u=Bh(e.stretch-v,x,D,M),c=kh(e.fixed-w,A,e.stretch,f),h=Bh(n.stretch-_,b,T,S),p=kh(n.fixed-C,E,n.stretch,m),d=Bh(i.stretch-v,x,D,M),g=kh(i.fixed-w,A,i.stretch,f),y=Bh(s.stretch-_,b,T,S),N=kh(s.fixed-C,E,s.stretch,m),I=new l(u,h),P=new l(d,h),z=new l(d,y),B=new l(u,y),k=new l(c/o,p/o),F=new l(g/o,N/o),R=t*Math.PI/180;if(R){const e=Math.sin(R),t=Math.cos(R),r=[t,-e,e,t];I._matMult(r),P._matMult(r),B._matMult(r),z._matMult(r)}const O=e.stretch+e.fixed,L=n.stretch+n.fixed;return{tl:I,tr:P,bl:B,br:z,tex:{x:a.paddedRect.x+1+O,y:a.paddedRect.y+1+L,w:i.stretch+i.fixed-O,h:s.stretch+s.fixed-L},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:k,pixelOffsetBR:F,minFontScaleX:A/o/D,minFontScaleY:E/o/T,isSDF:r}};if(n&&(a.stretchX||a.stretchY)){const e=zh(h,g,f),t=zh(p,y,m);for(let r=0;r<e.length-1;r++){const n=e[r],a=e[r+1];for(let e=0;e<t.length-1;e++)i.push(N(n,t[e],a,t[e+1]))}}else i.push(N({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:u+1}));return i}function Ph(e,t,r){let n=0;for(const i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function zh(e,t,r){const n=[{fixed:-1,stretch:0}];for(const[t,r]of e){const e=n[n.length-1];n.push({fixed:t-e.stretch,stretch:e.stretch}),n.push({fixed:t-e.stretch,stretch:e.stretch+(r-t)})}return n.push({fixed:t+1,stretch:r}),n}function Bh(e,t,r,n){return e/t*r+n}function kh(e,t,r,n){return e-t*r/n}class Fh{constructor(e,t,r,n,i,a,o,s,u,c){var h;if(this.boxStartIndex=e.length,u){let e=a.top,t=a.bottom;const r=a.collisionPadding;r&&(e-=r[1],t+=r[3]);let n=t-e;n>0&&(n=Math.max(10,n),this.circleDiameter=n)}else{const u=(null===(h=a.image)||void 0===h?void 0:h.content)&&(a.image.textFitWidth||a.image.textFitHeight)?Mc(a):{x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};u.y1=u.y1*o-s[0],u.y2=u.y2*o+s[2],u.x1=u.x1*o-s[3],u.x2=u.x2*o+s[1];const p=a.collisionPadding;if(p&&(u.x1-=p[0]*o,u.y1-=p[1]*o,u.x2+=p[2]*o,u.y2+=p[3]*o),c){const e=new l(u.x1,u.y1),t=new l(u.x2,u.y1),r=new l(u.x1,u.y2),n=new l(u.x2,u.y2),i=c*Math.PI/180;e._rotate(i),t._rotate(i),r._rotate(i),n._rotate(i),u.x1=Math.min(e.x,t.x,r.x,n.x),u.x2=Math.max(e.x,t.x,r.x,n.x),u.y1=Math.min(e.y,t.y,r.y,n.y),u.y2=Math.max(e.y,t.y,r.y,n.y)}e.emplaceBack(t.x,t.y,u.x1,u.y1,u.x2,u.y2,r,n,i)}this.boxEndIndex=e.length}}class Rh{constructor(e=[],t=(e,t)=>e<t?-1:e>t?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,a=t[i];if(r(n,a)>=0)break;t[e]=a,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1);const a=n+1;if(a<this.length&&r(t[a],t[n])<0&&(n=a),r(t[n],i)>=0)break;t[e]=t[n],e=n}t[e]=i}}function Oh(e,t=1,r=!1){let n=1/0,i=1/0,a=-1/0,o=-1/0;const s=e[0];for(let e=0;e<s.length;e++){const t=s[e];(!e||t.x<n)&&(n=t.x),(!e||t.y<i)&&(i=t.y),(!e||t.x>a)&&(a=t.x),(!e||t.y>o)&&(o=t.y)}const u=Math.min(a-n,o-i);let c=u/2;const h=new Rh([],Lh);if(0===u)return new l(n,i);for(let t=n;t<a;t+=u)for(let r=i;r<o;r+=u)h.push(new qh(t+c,r+c,c,e));let p=function(e){let t=0,r=0,n=0;const i=e[0];for(let e=0,a=i.length,o=a-1;e<a;o=e++){const a=i[e],s=i[o],l=a.x*s.y-s.x*a.y;r+=(a.x+s.x)*l,n+=(a.y+s.y)*l,t+=3*l}return new qh(r/t,n/t,0,e)}(e),d=h.length;for(;h.length;){const n=h.pop();(n.d>p.d||!p.d)&&(p=n,r&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,d)),n.max-p.d<=t||(c=n.h/2,h.push(new qh(n.p.x-c,n.p.y-c,c,e)),h.push(new qh(n.p.x+c,n.p.y-c,c,e)),h.push(new qh(n.p.x-c,n.p.y+c,c,e)),h.push(new qh(n.p.x+c,n.p.y+c,c,e)),d+=4)}return r&&(console.log(`num probes: ${d}`),console.log(`best distance: ${p.d}`)),p.p}function Lh(e,t){return t.max-e.max}function qh(e,t,r,n){this.p=new l(e,t),this.h=r,this.d=function(e,t){let r=!1,n=1/0;for(let i=0;i<t.length;i++){const a=t[i];for(let t=0,i=a.length,o=i-1;t<i;o=t++){const i=a[t],s=a[o];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(r=!r),n=Math.min(n,Bs(e,i,s))}}return(r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}var jh;e.aB=void 0,(jh=e.aB||(e.aB={}))[jh.center=1]="center",jh[jh.left=2]="left",jh[jh.right=3]="right",jh[jh.top=4]="top",jh[jh.bottom=5]="bottom",jh[jh["top-left"]=6]="top-left",jh[jh["top-right"]=7]="top-right",jh[jh["bottom-left"]=8]="bottom-left",jh[jh["bottom-right"]=9]="bottom-right";const Uh=Number.POSITIVE_INFINITY;function Vh(e,t){return t[1]!==Uh?function(e,t,r){let n=0,i=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,i]}(e,t[0],t[1]):function(e,t){let r=0,n=0;t<0&&(t=0);const i=t/Math.SQRT2;switch(e){case"top-right":case"top-left":n=i-7;break;case"bottom-right":case"bottom-left":n=7-i;break;case"bottom":n=7-t;break;case"top":n=t-7}switch(e){case"top-right":case"bottom-right":r=-i;break;case"top-left":case"bottom-left":r=i;break;case"left":r=t;break;case"right":r=-t}return[r,n]}(e,t[0])}function Zh(e,t,r){var n;const i=e.layout,a=null===(n=i.get("text-variable-anchor-offset"))||void 0===n?void 0:n.evaluate(t,{},r);if(a){const e=a.values,t=[];for(let r=0;r<e.length;r+=2){const n=t[r]=e[r],i=e[r+1].map((e=>e*Wu));n.startsWith("top")?i[1]-=7:n.startsWith("bottom")&&(i[1]+=7),t[r+1]=i}return new kt(t)}const o=i.get("text-variable-anchor");if(o){let n;n=void 0!==e._unevaluatedLayout.getValue("text-radial-offset")?[i.get("text-radial-offset").evaluate(t,{},r)*Wu,Uh]:i.get("text-offset").evaluate(t,{},r).map((e=>e*Wu));const a=[];for(const e of o)a.push(e,Vh(e,n));return new kt(a)}return null}function $h(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Gh(t,r,n,i,a,o,s,l,u,c,h,p){let d=o.textMaxSize.evaluate(r,{});void 0===d&&(d=s);const f=t.layers[0].layout,m=f.get("icon-offset").evaluate(r,{},h),g=Wh(n.horizontal),y=s/24,v=t.tilePixelRatio*y,x=t.tilePixelRatio*d/24,_=t.tilePixelRatio*l,b=t.tilePixelRatio*f.get("symbol-spacing"),w=f.get("text-padding")*t.tilePixelRatio,A=function(e,t,r,n=1){const i=e.get("icon-padding").evaluate(t,{},r),a=i&&i.values;return[a[0]*n,a[1]*n,a[2]*n,a[3]*n]}(f,r,h,t.tilePixelRatio),C=f.get("text-max-angle")/180*Math.PI,E="viewport"!==f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),M="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),S=f.get("symbol-placement"),T=b/2,N=f.get("icon-text-fit");let I;i&&"none"!==N&&(t.allowVerticalPlacement&&n.vertical&&(I=Sc(i,n.vertical,N,f.get("icon-text-fit-padding"),m,y)),g&&(i=Sc(i,g,N,f.get("icon-text-fit-padding"),m,y)));const P=h?p.line.getGranularityForZoomLevel(h.z):1,z=(l,p)=>{p.x<0||p.x>=D||p.y<0||p.y>=D||function(t,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,x,_,b,w,A,C,E){const M=t.addToLineVertexArray(r,n);let S,D,T,N,I=0,P=0,z=0,B=0,k=-1,F=-1;const R={};let O=es("");if(t.allowVerticalPlacement&&i.vertical){const e=l.layout.get("text-rotate").evaluate(b,{},C)+90;T=new Fh(u,r,c,h,p,i.vertical,d,f,m,e),s&&(N=new Fh(u,r,c,h,p,s,y,v,m,e))}if(a){const n=l.layout.get("icon-rotate").evaluate(b,{}),i="none"!==l.layout.get("icon-text-fit"),o=Ih(a,n,A,i),d=s?Ih(s,n,A,i):void 0;D=new Fh(u,r,c,h,p,a,y,v,!1,n),I=4*o.length;const f=t.iconSizeData;let m=null;"source"===f.kind?(m=[Dc*l.layout.get("icon-size").evaluate(b,{})],m[0]>Tc&&V(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===f.kind&&(m=[Dc*w.compositeIconSizes[0].evaluate(b,{},C),Dc*w.compositeIconSizes[1].evaluate(b,{},C)],(m[0]>Tc||m[1]>Tc)&&V(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),t.addSymbols(t.icon,o,m,_,x,b,e.al.none,r,M.lineStartIndex,M.lineLength,-1,C),k=t.icon.placedSymbolArray.length-1,d&&(P=4*d.length,t.addSymbols(t.icon,d,m,_,x,b,e.al.vertical,r,M.lineStartIndex,M.lineLength,-1,C),F=t.icon.placedSymbolArray.length-1)}const L=Object.keys(i.horizontal);for(const n of L){const a=i.horizontal[n];if(!S){O=es(a.text);const e=l.layout.get("text-rotate").evaluate(b,{},C);S=new Fh(u,r,c,h,p,a,d,f,m,e)}const s=1===a.positionedLines.length;if(z+=Hh(t,r,a,o,l,m,b,g,M,i.vertical?e.al.horizontal:e.al.horizontalOnly,s?L:[n],R,k,w,C),s)break}i.vertical&&(B+=Hh(t,r,i.vertical,o,l,m,b,g,M,e.al.vertical,["vertical"],R,F,w,C));const q=S?S.boxStartIndex:t.collisionBoxArray.length,j=S?S.boxEndIndex:t.collisionBoxArray.length,U=T?T.boxStartIndex:t.collisionBoxArray.length,Z=T?T.boxEndIndex:t.collisionBoxArray.length,$=D?D.boxStartIndex:t.collisionBoxArray.length,G=D?D.boxEndIndex:t.collisionBoxArray.length,H=N?N.boxStartIndex:t.collisionBoxArray.length,W=N?N.boxEndIndex:t.collisionBoxArray.length;let X=-1;const Y=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t;X=Y(S,X),X=Y(T,X),X=Y(D,X),X=Y(N,X);const K=X>-1?1:0;K&&(X*=E/Wu),t.glyphOffsetArray.length>=Lc.MAX_GLYPHS&&V("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey);const J=Zh(l,b,C),[Q,ee]=function(t,r){const n=t.length,i=null==r?void 0:r.values;if((null==i?void 0:i.length)>0)for(let r=0;r<i.length;r+=2){const n=i[r+1];t.emplaceBack(e.aB[i[r]],n[0],n[1])}return[n,t.length]}(t.textAnchorOffsets,J);t.symbolInstances.emplaceBack(r.x,r.y,R.right>=0?R.right:-1,R.center>=0?R.center:-1,R.left>=0?R.left:-1,R.vertical||-1,k,F,O,q,j,U,Z,$,G,H,W,c,z,B,I,P,K,0,d,X,Q,ee)}(t,p,l,n,i,a,I,t.layers[0],t.collisionBoxArray,r.index,r.sourceLayerIndex,t.index,v,[w,w,w,w],E,u,_,A,M,m,r,o,c,h,s)};if("line"===S)for(const e of wh(r.geometry,0,0,D,D)){const r=jl(e,P),a=Th(r,b,C,n.vertical||g,i,24,x,t.overscaling,D);for(const e of a)g&&Xh(t,g.text,T,e)||z(r,e)}else if("line-center"===S){for(const e of r.geometry)if(e.length>1){const t=jl(e,P),r=Dh(t,C,n.vertical||g,i,24,x);r&&z(t,r)}}else if("Polygon"===r.type)for(const e of Kr(r.geometry,0)){const t=Oh(e,16);z(jl(e[0],P,!0),new Ah(t.x,t.y,0))}else if("LineString"===r.type)for(const e of r.geometry){const t=jl(e,P);z(t,new Ah(t[0].x,t[0].y,0))}else if("Point"===r.type)for(const e of r.geometry)for(const t of e)z([t],new Ah(t.x,t.y,0))}function Hh(e,t,r,n,i,a,o,s,u,c,h,p,d,f,m){const g=function(e,t,r,n,i,a,o,s){const u=n.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,c=[];for(const e of t.positionedLines)for(const n of e.positionedGlyphs){if(!n.rect)continue;const a=n.rect||{};let h=4,p=!0,d=1,f=0;const m=(i||s)&&n.vertical,g=n.metrics.advance*n.scale/2;if(s&&t.verticalizable&&(f=e.lineOffset/2-(n.imageName?-(Wu-n.metrics.width*n.scale)/2:(n.scale-1)*Wu)),n.imageName){const e=o[n.imageName];p=e.sdf,d=e.pixelRatio,h=1/d}const y=i?[n.x+g,n.y]:[0,0];let v=i?[0,0]:[n.x+g+r[0],n.y+r[1]-f],x=[0,0];m&&(x=v,v=[0,0]);const _=n.metrics.isDoubleResolution?2:1,b=(n.metrics.left-h)*n.scale-g+v[0],w=(-n.metrics.top-h)*n.scale+v[1],A=b+a.w/_*n.scale/d,C=w+a.h/_*n.scale/d,E=new l(b,w),M=new l(A,w),S=new l(b,C),D=new l(A,C);if(m){const e=new l(-g,g-ac),t=-Math.PI/2,r=12-g,i=new l(22-r,-(n.imageName?r:0)),a=new l(...x);E._rotateAround(t,e)._add(i)._add(a),M._rotateAround(t,e)._add(i)._add(a),S._rotateAround(t,e)._add(i)._add(a),D._rotateAround(t,e)._add(i)._add(a)}if(u){const e=Math.sin(u),t=Math.cos(u),r=[t,-e,e,t];E._matMult(r),M._matMult(r),S._matMult(r),D._matMult(r)}const T=new l(0,0),N=new l(0,0);c.push({tl:E,tr:M,bl:S,br:D,tex:a,writingMode:t.writingMode,glyphOffset:y,sectionIndex:n.sectionIndex,isSDF:p,pixelOffsetTL:T,pixelOffsetBR:N,minFontScaleX:0,minFontScaleY:0})}return c}(0,r,s,i,a,o,n,e.allowVerticalPlacement),y=e.textSizeData;let v=null;"source"===y.kind?(v=[Dc*i.layout.get("text-size").evaluate(o,{})],v[0]>Tc&&V(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===y.kind&&(v=[Dc*f.compositeTextSizes[0].evaluate(o,{},m),Dc*f.compositeTextSizes[1].evaluate(o,{},m)],(v[0]>Tc||v[1]>Tc)&&V(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),e.addSymbols(e.text,g,v,s,a,o,c,t,u.lineStartIndex,u.lineLength,d,m);for(const t of h)p[t]=e.text.placedSymbolArray.length-1;return 4*g.length}function Wh(e){for(const t in e)return e[t];return null}function Xh(e,t,r,n){const i=e.compareText;if(t in i){const e=i[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<r)return!0}else i[t]=[];return i[t].push(n),!1}const Yh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Kh{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,r]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=r>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const i=Yh[15&r];if(!i)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,2,1),[o]=new Uint32Array(e,4,1);return new Kh(o,a,i,e)}constructor(e,t=64,r=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=Yh.indexOf(this.ArrayType),a=2*e*this.ArrayType.BYTES_PER_ELEMENT,o=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-o%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+a+o+s),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Jh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:a,nodeSize:o}=this,s=[0,i.length-1,0],l=[];for(;s.length;){const u=s.pop()||0,c=s.pop()||0,h=s.pop()||0;if(c-h<=o){for(let o=h;o<=c;o++){const s=a[2*o],u=a[2*o+1];s>=e&&s<=r&&u>=t&&u<=n&&l.push(i[o])}continue}const p=h+c>>1,d=a[2*p],f=a[2*p+1];d>=e&&d<=r&&f>=t&&f<=n&&l.push(i[p]),(0===u?e<=d:t<=f)&&(s.push(h),s.push(p-1),s.push(1-u)),(0===u?r>=d:n>=f)&&(s.push(p+1),s.push(c),s.push(1-u))}return l}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:i,nodeSize:a}=this,o=[0,n.length-1,0],s=[],l=r*r;for(;o.length;){const u=o.pop()||0,c=o.pop()||0,h=o.pop()||0;if(c-h<=a){for(let r=h;r<=c;r++)rp(i[2*r],i[2*r+1],e,t)<=l&&s.push(n[r]);continue}const p=h+c>>1,d=i[2*p],f=i[2*p+1];rp(d,f,e,t)<=l&&s.push(n[p]),(0===u?e-r<=d:t-r<=f)&&(o.push(h),o.push(p-1),o.push(1-u)),(0===u?e+r>=d:t+r>=f)&&(o.push(p+1),o.push(c),o.push(1-u))}return s}}function Jh(e,t,r,n,i,a){if(i-n<=r)return;const o=n+i>>1;Qh(e,t,o,n,i,a),Jh(e,t,r,n,o-1,1-a),Jh(e,t,r,o+1,i,1-a)}function Qh(e,t,r,n,i,a){for(;i>n;){if(i-n>600){const o=i-n+1,s=r-n+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);Qh(e,t,r,Math.max(n,Math.floor(r-s*u/o+c)),Math.min(i,Math.floor(r+(o-s)*u/o+c)),a)}const o=t[2*r+a];let s=n,l=i;for(ep(e,t,n,r),t[2*i+a]>o&&ep(e,t,n,i);s<l;){for(ep(e,t,s,l),s++,l--;t[2*s+a]<o;)s++;for(;t[2*l+a]>o;)l--}t[2*n+a]===o?ep(e,t,n,l):(l++,ep(e,t,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function ep(e,t,r,n){tp(e,r,n),tp(t,2*r,2*n),tp(t,2*r+1,2*n+1)}function tp(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function rp(e,t,r,n){const i=e-r,a=t-n;return i*i+a*a}var np;e.co=void 0,(np=e.co||(e.co={})).create="create",np.load="load",np.fullLoad="fullLoad";let ip=null,ap=[];const op=1e3/60,sp="loadTime",lp="fullLoadTime",up={mark(e){performance.mark(e)},frame(e){const t=e;null!=ip&&ap.push(t-ip),ip=t},clearMetrics(){ip=null,ap=[],performance.clearMeasures(sp),performance.clearMeasures(lp);for(const t in e.co)performance.clearMarks(e.co[t])},getPerformanceMetrics(){performance.measure(sp,e.co.create,e.co.load),performance.measure(lp,e.co.create,e.co.fullLoad);const t=performance.getEntriesByName(sp)[0].duration,r=performance.getEntriesByName(lp)[0].duration,n=ap.length,i=1/(ap.reduce(((e,t)=>e+t),0)/n/1e3),a=ap.filter((e=>e>op)).reduce(((e,t)=>e+(t-op)/op),0);return{loadTime:t,fullLoadTime:r,fps:i,percentDroppedFrames:a/(n+a)*100,totalFrames:n}}};e.$=uh,e.A=g,e.B=pr,e.C=Ca,e.D=za,e.E=ge,e.F=Ki,e.G=function(e){if(null==G){const t=e.navigator?e.navigator.userAgent:null;G=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return G},e.H=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Jc((()=>this.process())),this.subscription=J(this.target,"message",(e=>this.receive(e)),!1),this.globalScope=$(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}sendAsync(e,t){return new Promise(((r,n)=>{const i=Math.round(1e18*Math.random()).toString(36).substring(0,10),a=t?J(t.signal,"abort",(()=>{null==a||a.unsubscribe(),delete this.resolveRejects[i];const t={id:i,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(t)}),Qc):null;this.resolveRejects[i]={resolve:e=>{null==a||a.unsubscribe(),r(e)},reject:e=>{null==a||a.unsubscribe(),n(e)}};const o=[],s=Object.assign(Object.assign({},e),{id:i,sourceMapId:this.mapId,origin:location.origin,data:sa(e.data,o)});this.target.postMessage(s,{transfer:o})}))}receive(e){const t=e.data,r=t.id;if(!("file://"!==t.origin&&"file://"!==location.origin&&"resource://android"!==t.origin&&"resource://android"!==location.origin&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if("<cancel>"===t.type){delete this.tasks[r];const e=this.abortControllers[r];return delete this.abortControllers[r],void(e&&e.abort())}if($(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(0===this.taskQueue.length)return;const e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}processTask(e,r){return t(this,void 0,void 0,(function*(){if("<response>"===r.type){const t=this.resolveRejects[e];if(delete this.resolveRejects[e],!t)return;return void(r.error?t.reject(la(r.error)):t.resolve(la(r.data)))}if(!this.messageHandlers[r.type])return void this.completeTask(e,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const t=la(r.data),n=new AbortController;this.abortControllers[e]=n;try{const i=yield this.messageHandlers[r.type](r.sourceMapId,t,n);this.completeTask(e,null,i)}catch(t){this.completeTask(e,t)}}))}completeTask(e,t,r){const n=[];delete this.abortControllers[e];const i={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?sa(t):null,data:sa(r,n)};this.target.postMessage(i,{transfer:n})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.I=rc,e.J=se,e.K=function(){var e=new g(16);return g!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.L=function(e,t,r){var n,i,a,o,s,l,u,c,h,p,d,f,m=r[0],g=r[1],y=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],p=t[9],d=t[10],f=t[11],e[0]=n=t[0],e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=p,e[10]=d,e[11]=f,e[12]=n*m+s*g+h*y+t[12],e[13]=i*m+l*g+p*y+t[13],e[14]=a*m+u*g+d*y+t[14],e[15]=o*m+c*g+f*y+t[15]),e},e.M=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.N=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],p=t[9],d=t[10],f=t[11],m=t[12],g=t[13],y=t[14],v=t[15],x=r[0],_=r[1],b=r[2],w=r[3];return e[0]=x*n+_*s+b*h+w*m,e[1]=x*i+_*l+b*p+w*g,e[2]=x*a+_*u+b*d+w*y,e[3]=x*o+_*c+b*f+w*v,e[4]=(x=r[4])*n+(_=r[5])*s+(b=r[6])*h+(w=r[7])*m,e[5]=x*i+_*l+b*p+w*g,e[6]=x*a+_*u+b*d+w*y,e[7]=x*o+_*c+b*f+w*v,e[8]=(x=r[8])*n+(_=r[9])*s+(b=r[10])*h+(w=r[11])*m,e[9]=x*i+_*l+b*p+w*g,e[10]=x*a+_*u+b*d+w*y,e[11]=x*o+_*c+b*f+w*v,e[12]=(x=r[12])*n+(_=r[13])*s+(b=r[14])*h+(w=r[15])*m,e[13]=x*i+_*l+b*p+w*g,e[14]=x*a+_*u+b*d+w*y,e[15]=x*o+_*c+b*f+w*v,e},e.O=function(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];i in e&&(r[i]=e[i])}return r},e.P=l,e.Q=th,e.R=Qs,e.S=ah,e.T=Sa,e.U=ih,e.V=d,e.W=f,e.X=X,e.Y=dh,e.Z=D,e._=t,e.a=ae,e.a$=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+u*n,e[5]=o*i+c*n,e[6]=s*i+h*n,e[7]=l*i+p*n,e[8]=u*i-a*n,e[9]=c*i-o*n,e[10]=h*i-s*n,e[11]=p*i-l*n,e},e.a0=25,e.a1=hh,e.a2=e=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((r=>{t.onloadstart=()=>{r(t)};for(const r of e){const e=window.document.createElement("source");he(r)||(t.crossOrigin="Anonymous"),e.src=r,t.appendChild(e)}}))},e.a3=Te,e.a4=function(){return O++},e.a5=yo,e.a6=Lc,e.a7=li,e.a8=As,e.a9=yh,e.aA=function(e,t,r,n,i=!1){if(!r[0]&&!r[1])return[0,0];const a=i?"map"===n?-e.bearingInRadians:0:"viewport"===n?e.bearingInRadians:0;if(a){const e=Math.sin(a),t=Math.cos(a);r=[r[0]*t-r[1]*e,r[0]*e+r[1]*t]}return[i?r[0]:T(t,r[0],e.zoom),i?r[1]:T(t,r[1],e.zoom)]},e.aC=Ic,e.aD=$h,e.aE=vc,e.aF=Kh,e.aG=Za,e.aH=Fl,e.aI=Do,e.aJ=Zo,e.aK=qo,e.aL=F,e.aM=ee,e.aN=lh,e.aO=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.aP=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},e.aQ=function(e){var t=new g(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.aR=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},e.aS=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},e.aT=function(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e},e.aU=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2];return e[0]=i*l-a*s,e[1]=a*o-n*l,e[2]=n*s-i*o,e},e.aV=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.aW=ph,e.aX=fh,e.aY=function(e,t,r,n,i){var a,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+n)*(a=1/(n-i)),e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e},e.aZ=function(e){var t=new g(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.a_=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+u*n,e[1]=o*i+c*n,e[2]=s*i+h*n,e[3]=l*i+p*n,e[4]=u*i-a*n,e[5]=c*i-o*n,e[6]=h*i-s*n,e[7]=p*i-l*n,e},e.aa=function(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,r,n,i)=>{const a=n||i;return t[r]=!a||a.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t},e.ab=Q,e.ac=function(e){return Math.pow(2,e)},e.ad=v,e.ae=k,e.af=85.051129,e.ag=oh,e.ah=function(e){return Math.log(e)/Math.LN2},e.ai=function(e){var t=e[0],r=e[1];return t*t+r*r},e.aj=function(e,t){const r=[];for(const n in e)n in t||r.push(n);return r},e.ak=function(e,t){let r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:i,minZoom:a,maxZoom:o}=e,s=i?k(cr.interpolationFactor(i,t,a,o),0,1):0;"camera"===e.kind?n=pr.number(e.minSize,e.maxSize,s):r=s}return{uSizeT:r,uSize:n}},e.am=function(e,{uSize:t,uSizeT:r},{lowerSize:n,upperSize:i}){return"source"===e.kind?n/Dc:"composite"===e.kind?pr.number(n/Dc,i/Dc,r):t},e.an=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],p=t[10],d=t[11],f=t[12],m=t[13],g=t[14],y=t[15],v=r*s-n*o,x=r*l-i*o,_=r*u-a*o,b=n*l-i*s,w=n*u-a*s,A=i*u-a*l,C=c*m-h*f,E=c*g-p*f,M=c*y-d*f,S=h*g-p*m,D=h*y-d*m,T=p*y-d*g,N=v*T-x*D+_*S+b*M-w*E+A*C;return N?(e[0]=(s*T-l*D+u*S)*(N=1/N),e[1]=(i*D-n*T-a*S)*N,e[2]=(m*A-g*w+y*b)*N,e[3]=(p*w-h*A-d*b)*N,e[4]=(l*M-o*T-u*E)*N,e[5]=(r*T-i*M+a*E)*N,e[6]=(g*_-f*A-y*x)*N,e[7]=(c*A-p*_+d*x)*N,e[8]=(o*D-s*M+u*C)*N,e[9]=(n*M-r*D-a*C)*N,e[10]=(f*w-m*_+y*v)*N,e[11]=(h*_-c*w-d*v)*N,e[12]=(s*E-o*S-l*C)*N,e[13]=(r*S-n*E+i*C)*N,e[14]=(m*x-f*b-g*v)*N,e[15]=(c*b-h*x+p*v)*N,e):null},e.ao=M,e.ap=function(e){return Math.hypot(e[0],e[1])},e.aq=function(e){return e[0]=0,e[1]=0,e},e.ar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},e.as=kc,e.at=C,e.au=function(e,t,r,n){const i=t.y-e.y,a=t.x-e.x,o=n.y-r.y,s=n.x-r.x,u=o*a-s*i;if(0===u)return null;const c=(s*(e.y-r.y)-o*(e.x-r.x))/u;return new l(e.x+c*a,e.y+c*i)},e.av=wh,e.aw=Ss,e.ax=function(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(const a of e)t=Math.min(t,a.x),r=Math.min(r,a.y),n=Math.max(n,a.x),i=Math.max(i,a.y);return[t,r,n,i]},e.ay=Wu,e.az=T,e.b=H,e.b$=class extends fo{},e.b0=function(){const e=new Float32Array(16);return v(e),e},e.b1=function(){const e=new Float64Array(16);return v(e),e},e.b2=function(){return new Float64Array(16)},e.b3=function(e,t,r){const n=new Float64Array(4);return function(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),s=Math.sin(r),l=Math.cos(r),u=Math.sin(n),c=Math.cos(n);e[0]=a*l*c-o*s*u,e[1]=o*s*c+a*l*u,e[2]=o*l*u-a*s*c,e[3]=o*l*c+a*s*u}(n,e,t-90,r),n},e.b4=function(e,t,r,n){var i,a,o,s,l,u=t[0],c=t[1],h=t[2],p=t[3],d=r[0],f=r[1],g=r[2],y=r[3];return(a=u*d+c*f+h*g+p*y)<0&&(a=-a,d=-d,f=-f,g=-g,y=-y),1-a>m?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-n)*i)/o,l=Math.sin(n*i)/o):(s=1-n,l=n),e[0]=s*u+l*d,e[1]=s*c+l*f,e[2]=s*h+l*g,e[3]=s*p+l*y,e},e.b5=function(e){const t=new Float64Array(9);var r,n,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,x;h=(i=(n=e)[0])*(l=i+i),p=(a=n[1])*l,f=(o=n[2])*l,m=o*(u=a+a),y=(s=n[3])*l,v=s*u,x=s*(c=o+o),(r=t)[0]=1-(d=a*u)-(g=o*c),r[3]=p-x,r[6]=f+v,r[1]=p+x,r[4]=1-h-g,r[7]=m-y,r[2]=f-v,r[5]=m+y,r[8]=1-h-d;const _=ee(-Math.asin(k(t[2],-1,1)));let b,w;return Math.hypot(t[5],t[8])<.001?(b=0,w=-ee(Math.atan2(t[3],t[4]))):(b=ee(0===t[5]&&0===t[8]?0:Math.atan2(t[5],t[8])),w=ee(0===t[1]&&0===t[0]?0:Math.atan2(t[1],t[0]))),{roll:b,pitch:_+90,bearing:w}},e.b6=function(e,t){return e.roll==t.roll&&e.pitch==t.pitch&&e.bearing==t.bearing},e.b7=Et,e.b8=os,e.b9=Rl,e.bA=function(e){if("custom"===e.type)return new Kc(e);switch(e.type){case"background":return new Hc(e);case"circle":return new Zs(e);case"fill":return new Xl(e);case"fill-extrusion":return new _u(e);case"heatmap":return new rl(e);case"hillshade":return new al(e);case"line":return new Fu(e);case"raster":return new Yc(e);case"symbol":return new Zc(e)}},e.bB=j,e.bC=function(e,t){if(!e)return[{command:"setStyle",args:[t]}];let r=[];try{if(!_e(e.version,t.version))return[{command:"setStyle",args:[t]}];_e(e.center,t.center)||r.push({command:"setCenter",args:[t.center]}),_e(e.state,t.state)||r.push({command:"setGlobalState",args:[t.state]}),_e(e.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),_e(e.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),_e(e.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),_e(e.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),_e(e.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),_e(e.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),_e(e.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),_e(e.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),_e(e.light,t.light)||r.push({command:"setLight",args:[t.light]}),_e(e.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),_e(e.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),_e(e.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const n={},i=[];!function(e,t,r,n){let i;for(i in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,i)&&(Object.prototype.hasOwnProperty.call(t,i)||Ae(i,r,n));for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(e,i)?_e(e[i],t[i])||("geojson"===e[i].type&&"geojson"===t[i].type&&Ee(e,t,i)?be(r,{command:"setGeoJSONSourceData",args:[i,t[i].data]}):Ce(i,t,r,n)):we(i,t,r))}(e.sources,t.sources,i,n);const a=[];e.layers&&e.layers.forEach((e=>{"source"in e&&n[e.source]?r.push({command:"removeLayer",args:[e.id]}):a.push(e)})),r=r.concat(i),function(e,t,r){t=t||[];const n=(e=e||[]).map(Se),i=t.map(Se),a=e.reduce(De,{}),o=t.reduce(De,{}),s=n.slice(),l=Object.create(null);let u,c,h,p,d;for(let e=0,t=0;e<n.length;e++)u=n[e],Object.prototype.hasOwnProperty.call(o,u)?t++:(be(r,{command:"removeLayer",args:[u]}),s.splice(s.indexOf(u,t),1));for(let e=0,t=0;e<i.length;e++)u=i[i.length-1-e],s[s.length-1-e]!==u&&(Object.prototype.hasOwnProperty.call(a,u)?(be(r,{command:"removeLayer",args:[u]}),s.splice(s.lastIndexOf(u,s.length-t),1)):t++,p=s[s.length-e],be(r,{command:"addLayer",args:[o[u],p]}),s.splice(s.length-e,0,u),l[u]=!0);for(let e=0;e<i.length;e++)if(u=i[e],c=a[u],h=o[u],!l[u]&&!_e(c,h))if(_e(c.source,h.source)&&_e(c["source-layer"],h["source-layer"])&&_e(c.type,h.type)){for(d in Me(c.layout,h.layout,r,u,null,"setLayoutProperty"),Me(c.paint,h.paint,r,u,null,"setPaintProperty"),_e(c.filter,h.filter)||be(r,{command:"setFilter",args:[u,h.filter]}),_e(c.minzoom,h.minzoom)&&_e(c.maxzoom,h.maxzoom)||be(r,{command:"setLayerZoomRange",args:[u,h.minzoom,h.maxzoom]}),c)Object.prototype.hasOwnProperty.call(c,d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?Me(c[d],h[d],r,u,d.slice(6),"setPaintProperty"):_e(c[d],h[d])||be(r,{command:"setLayerProperty",args:[u,d,h[d]]}));for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&!Object.prototype.hasOwnProperty.call(c,d)&&"layout"!==d&&"paint"!==d&&"filter"!==d&&"metadata"!==d&&"minzoom"!==d&&"maxzoom"!==d&&(0===d.indexOf("paint.")?Me(c[d],h[d],r,u,d.slice(6),"setPaintProperty"):_e(c[d],h[d])||be(r,{command:"setLayerProperty",args:[u,d,h[d]]}))}else be(r,{command:"removeLayer",args:[u]}),p=s[s.lastIndexOf(u)+1],be(r,{command:"addLayer",args:[h,p]})}(a,t.layers,r)}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:"setStyle",args:[t]}]}return r},e.bD=function(e){const t=[],r=e.id;return void 0===r&&t.push({message:`layers.${r}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${r}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},e.bE=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(!e(t[n],r[n]))return!1;return!0}return t===r},e.bF=L,e.bG=q,e.bH=class extends as{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.bI=ls,e.bJ=class extends as{constructor(e,t){super(e,t),this.current=us}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.bK=ss,e.bL=class extends as{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.bM=class extends as{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.bN=y,e.bO=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.bP=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},e.bQ=function(e,t,r,n,i,a,o){var s=1/(t-r),l=1/(n-i),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(o+a)*u,e[15]=1,e},e.bR=class extends as{constructor(e,t){super(e,t),this.current=new Array}set(e){if(e!=this.current){this.current=e;const t=new Float32Array(4*e.length);for(let r=0;r<e.length;r++)t[4*r]=e[r].r,t[4*r+1]=e[r].g,t[4*r+2]=e[r].b,t[4*r+3]=e[r].a;this.gl.uniform4fv(this.location,t)}}},e.bS=class extends as{constructor(e,t){super(e,t),this.current=new Array}set(e){if(e!=this.current){this.current=e;const t=new Float32Array(e);this.gl.uniform1fv(this.location,t)}}},e.bT=class extends io{},e.bU=Uu,e.bV=class extends oo{},e.bW=tl,e.bX=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.bY=el,e.bZ=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/(o=o||1),e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},e.b_=class extends Wa{},e.ba=Ol,e.bb=kl,e.bc=I,e.bd=P,e.be=Rt,e.bf=function(e,t,r,n,i){return I(n,i,k((e-t)/(r-t),0,1))},e.bg=N,e.bh=function(){return new Float64Array(3)},e.bi=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},e.bj=A,e.bk=function(){return new Float64Array(4)},e.bl=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.bm=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.bn=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e},e.bo=_,e.bp=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],h=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-u*n,e[1]=o*i-c*n,e[2]=s*i-h*n,e[3]=l*i-p*n,e[8]=a*n+u*i,e[9]=o*n+c*i,e[10]=s*n+h*i,e[11]=l*n+p*i,e},e.bq=function(e,t){const r=N(e,360),n=N(t,360),i=n-r,a=n>r?i-360:i+360;return Math.abs(i)<Math.abs(a)?i:a},e.br=function(e){return e[0]=0,e[1]=0,e[2]=0,e},e.bs=function(e,t,r,n){const i=Math.sqrt(e*e+t*t),a=Math.sqrt(r*r+n*n);e/=i,t/=i,r/=a,n/=a;const o=Math.acos(e*r+t*n);return-t*r+e*n>0?o:-o},e.bt=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]},e.bu=eh,e.bv=function(e,t){const r=N(e,2*Math.PI),n=N(t,2*Math.PI);return Math.min(Math.abs(r-n),Math.abs(r-n+2*Math.PI),Math.abs(r-n-2*Math.PI))},e.bw=function(){const e={},t=ye.$version;for(const r in ye.$root){const n=ye.$root[r];if(n.required){let i=null;i="version"===r?t:"array"===n.type?[]:{},null!=i&&(e[r]=i)}}return e},e.bx=ua,e.by=ue,e.bz=function(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=xe(e[r],t[e[r].ref]));return e},e.c=ie,e.c0=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},e.c1=function(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],d=e[11],f=e[12],g=e[13],y=e[14],v=e[15],x=t[0],_=t[1],b=t[2],w=t[3],A=t[4],C=t[5],E=t[6],M=t[7],S=t[8],D=t[9],T=t[10],N=t[11],I=t[12],P=t[13],z=t[14],B=t[15];return Math.abs(r-x)<=m*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(n-_)<=m*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-b)<=m*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(a-w)<=m*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(o-A)<=m*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(s-C)<=m*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(l-E)<=m*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(u-M)<=m*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-S)<=m*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(h-D)<=m*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(p-T)<=m*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(d-N)<=m*Math.max(1,Math.abs(d),Math.abs(N))&&Math.abs(f-I)<=m*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(g-P)<=m*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(y-z)<=m*Math.max(1,Math.abs(y),Math.abs(z))&&Math.abs(v-B)<=m*Math.max(1,Math.abs(v),Math.abs(B))},e.c2=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.c3=e=>"symbol"===e.type,e.c4=e=>"circle"===e.type,e.c5=e=>"heatmap"===e.type,e.c6=e=>"line"===e.type,e.c7=e=>"fill"===e.type,e.c8=e=>"fill-extrusion"===e.type,e.c9=e=>"hillshade"===e.type,e.cA=$l,e.cB=fu,e.cC=cu,e.cD=Ku,e.cE=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.cF=function(e,r,n,i,a){return t(this,void 0,void 0,(function*(){if(f())try{return yield X(e,r,n,i,a)}catch(e){}return function(e,t,r,n,i){const a=e.width,o=e.height;Y&&K||(Y=new OffscreenCanvas(a,o),K=Y.getContext("2d",{willReadFrequently:!0})),Y.width=a,Y.height=o,K.drawImage(e,0,0,a,o);const s=K.getImageData(t,r,n,i);return K.clearRect(0,0,a,o),s.data}(e,r,n,i,a)}))},e.cG=mh,e.cH=r,e.cI=a,e.cJ=uu,e.cK=Yu,e.cL=ei,e.cM=Aa,e.ca=e=>"raster"===e.type,e.cb=e=>"background"===e.type,e.cc=e=>"custom"===e.type,e.cd=z,e.ce=function(e,t,r){const n=S(t.x-r.x,t.y-r.y),i=S(e.x-r.x,e.y-r.y);var a,o;return ee(Math.atan2(n[0]*i[1]-n[1]*i[0],(a=n)[0]*(o=i)[0]+a[1]*o[1]))},e.cf=B,e.cg=function(e,t){return re[t]&&(e instanceof MouseEvent||e instanceof WheelEvent)},e.ch=function(e,t){return te[t]&&"touches"in e},e.ci=function(e){return te[e]||re[e]},e.cj=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},e.ck=function(e,t){const{x:r,y:n}=uh.fromLngLat(t);return!(e<0||e>25||n<0||n>=1||r<0||r>=1)},e.cl=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.cm=class extends Ha{},e.cn=up,e.cp=function(e){return e.message===ne},e.cq=le,e.cr=function(e,t){ae.REGISTERED_PROTOCOLS[e]=t},e.cs=function(e){delete ae.REGISTERED_PROTOCOLS[e]},e.ct=function(e,t){const r={};for(let n=0;n<e.length;n++){const i=t&&t[e[n].id]||yi(e[n]);t&&(t[e[n].id]=i);let a=r[i];a||(a=r[i]=[]),a.push(e[n])}const n=[];for(const e in r)n.push(r[e]);return n},e.cu=na,e.cv=gh,e.cw=vh,e.cx=nc,e.cy=function(t){t.bucket.createArrays(),t.bucket.tilePixelRatio=D/(512*t.bucket.overscaling),t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;const r=t.bucket.layers[0],n=r.layout,i=r._unevaluatedLayout._values,a={layoutIconSize:i["icon-size"].possiblyEvaluate(new Ca(t.bucket.zoom+1),t.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new Ca(t.bucket.zoom+1),t.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new Ca(18))};if("composite"===t.bucket.textSizeData.kind){const{minZoom:e,maxZoom:r}=t.bucket.textSizeData;a.compositeTextSizes=[i["text-size"].possiblyEvaluate(new Ca(e),t.canonical),i["text-size"].possiblyEvaluate(new Ca(r),t.canonical)]}if("composite"===t.bucket.iconSizeData.kind){const{minZoom:e,maxZoom:r}=t.bucket.iconSizeData;a.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new Ca(e),t.canonical),i["icon-size"].possiblyEvaluate(new Ca(r),t.canonical)]}const o=n.get("text-line-height")*Wu,s="viewport"!==n.get("text-rotation-alignment")&&"point"!==n.get("symbol-placement"),l=n.get("text-keep-upright"),u=n.get("text-size");for(const i of t.bucket.features){const c=n.get("text-font").evaluate(i,{},t.canonical).join(","),h=u.evaluate(i,{},t.canonical),p=a.layoutTextSize.evaluate(i,{},t.canonical),d=a.layoutIconSize.evaluate(i,{},t.canonical),f={horizontal:{},vertical:void 0},m=i.text;let g,y=[0,0];if(m){const a=m.toString(),u=n.get("text-letter-spacing").evaluate(i,{},t.canonical)*Wu,d=pa(a)?u:0,g=n.get("text-anchor").evaluate(i,{},t.canonical),v=Zh(r,i,t.canonical);if(!v){const e=n.get("text-radial-offset").evaluate(i,{},t.canonical);y=e?Vh(g,[e*Wu,Uh]):n.get("text-offset").evaluate(i,{},t.canonical).map((e=>e*Wu))}let x=s?"center":n.get("text-justify").evaluate(i,{},t.canonical);const _="point"===n.get("symbol-placement")?n.get("text-max-width").evaluate(i,{},t.canonical)*Wu:1/0,b=()=>{t.bucket.allowVerticalPlacement&&ha(a)&&(f.vertical=lc(m,t.glyphMap,t.glyphPositions,t.imagePositions,c,_,o,g,"left",d,y,e.al.vertical,!0,p,h))};if(!s&&v){const r=new Set;if("auto"===x)for(let e=0;e<v.values.length;e+=2)r.add($h(v.values[e]));else r.add(x);let n=!1;for(const i of r)if(!f.horizontal[i])if(n)f.horizontal[i]=f.horizontal[0];else{const r=lc(m,t.glyphMap,t.glyphPositions,t.imagePositions,c,_,o,"center",i,d,y,e.al.horizontal,!1,p,h);r&&(f.horizontal[i]=r,n=1===r.positionedLines.length)}b()}else{"auto"===x&&(x=$h(g));const r=lc(m,t.glyphMap,t.glyphPositions,t.imagePositions,c,_,o,g,x,d,y,e.al.horizontal,!1,p,h);r&&(f.horizontal[x]=r),b(),ha(a)&&s&&l&&(f.vertical=lc(m,t.glyphMap,t.glyphPositions,t.imagePositions,c,_,o,g,x,d,y,e.al.vertical,!1,p,h))}}let v=!1;if(i.icon&&i.icon.name){const e=t.imageMap[i.icon.name];e&&(g=Ec(t.imagePositions[i.icon.name],n.get("icon-offset").evaluate(i,{},t.canonical),n.get("icon-anchor").evaluate(i,{},t.canonical)),v=!!e.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=v:t.bucket.sdfIcons!==v&&V("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.bucket.pixelRatio||0!==n.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0))}const x=Wh(f.horizontal)||f.vertical;t.bucket.iconsInText=!!x&&x.iconsInText,(x||g)&&Gh(t.bucket,i,f,g,t.imageMap,a,p,d,y,v,t.canonical,t.subdivisionGranularity)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.cz=Nu,e.d=he,e.e=R,e.f=e=>t(void 0,void 0,void 0,(function*(){if(0===e.byteLength)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(e)],{type:"image/png"});try{return createImageBitmap(t)}catch(e){throw new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),e.g=oe,e.h=e=>new Promise(((t,r)=>{const n=new Image;n.onload=()=>{t(n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame((()=>{n.src=W}))},n.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?URL.createObjectURL(i):W})),e.i=$,e.j=(e,t)=>ce(R(e,{type:"json"}),t),e.k=me,e.l=fe,e.m=ce,e.n=(e,t)=>ce(R(e,{type:"arrayBuffer"}),t),e.o=function(e){return new Ku(e).readFields(Ju,[])},e.p=tc,e.q=Js,e.r=Oa,e.s=J,e.t=Yi,e.u=ca,e.v=ye,e.w=V,e.x=ea,e.y=Xi,e.z=function([e,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:e*Math.cos(t)*Math.sin(r),y:e*Math.sin(t)*Math.sin(r),z:e*Math.cos(r)}}})),r("worker",0,(function(e){class t{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,r){for(const r of t){this._layerConfigs[r.id]=r;const t=this._layers[r.id]=e.bA(r);t._featureFilter=e.a7(t.filter),this.keyCache[r.id]&&delete this.keyCache[r.id]}for(const e of r)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const n=e.ct(Object.values(this._layerConfigs),this.keyCache);for(const e of n){const t=e.map((e=>this._layers[e.id])),r=t[0];if("none"===r.visibility)continue;const n=r.source||"";let i=this.familiesBySource[n];i||(i=this.familiesBySource[n]={});const a=r.sourceLayer||"_geojsonTileLayer";let o=i[a];o||(o=i[a]=[]),o.push(t)}}}class r{constructor(t){const r={},n=[];for(const e in t){const i=t[e],a=r[e]={};for(const e in i){const t=i[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const r={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};n.push(r),a[e]={rect:r,metrics:t.metrics}}}const{w:i,h:a}=e.p(n),o=new e.q({width:i||1,height:a||1});for(const n in t){const i=t[n];for(const t in i){const a=i[+t];if(!a||0===a.bitmap.width||0===a.bitmap.height)continue;const s=r[n][t].rect;e.q.copy(a.bitmap,o,{x:0,y:0},{x:s.x+1,y:s.y+1},a.bitmap)}}this.image=o,this.positions=r}}e.cu("GlyphAtlas",r);class n{constructor(t){this.tileID=new e.Y(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}parse(t,n,a,o,s){return e._(this,void 0,void 0,(function*(){this.status="parsing",this.data=t,this.collisionBoxArray=new e.a5;const l=new e.cv(Object.keys(t.layers).sort()),u=new e.cw(this.tileID,this.promoteId);u.bucketLayerIDs=[];const c={},h={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:a,subdivisionGranularity:s},p=n.familiesBySource[this.source];for(const r in p){const n=t.layers[r];if(!n)continue;1===n.version&&e.w(`Vector tile source "${this.source}" layer "${r}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const o=l.encode(r),s=[];for(let e=0;e<n.length;e++){const t=n.feature(e),i=u.getId(t,r);s.push({feature:t,id:i,index:e,sourceLayerIndex:o})}for(const t of p[r]){const r=t[0];r.source!==this.source&&e.w(`layer.source = ${r.source} does not equal this.source = ${this.source}`),r.minzoom&&this.zoom<Math.floor(r.minzoom)||r.maxzoom&&this.zoom>=r.maxzoom||"none"!==r.visibility&&(i(t,this.zoom,a),(c[r.id]=r.createBucket({index:u.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:o,sourceID:this.source})).populate(s,h,this.tileID.canonical),u.bucketLayerIDs.push(t.map((e=>e.id))))}}const d=e.bF(h.glyphDependencies,(e=>Object.keys(e).map(Number)));this.inFlightDependencies.forEach((e=>null==e?void 0:e.abort())),this.inFlightDependencies=[];let f=Promise.resolve({});if(Object.keys(d).length){const e=new AbortController;this.inFlightDependencies.push(e),f=o.sendAsync({type:"GG",data:{stacks:d,source:this.source,tileID:this.tileID,type:"glyphs"}},e)}const m=Object.keys(h.iconDependencies);let g=Promise.resolve({});if(m.length){const e=new AbortController;this.inFlightDependencies.push(e),g=o.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"icons"}},e)}const y=Object.keys(h.patternDependencies);let v=Promise.resolve({});if(y.length){const e=new AbortController;this.inFlightDependencies.push(e),v=o.sendAsync({type:"GI",data:{icons:y,source:this.source,tileID:this.tileID,type:"patterns"}},e)}const[x,_,b]=yield Promise.all([f,g,v]),w=new r(x),A=new e.cx(_,b);for(const t in c){const r=c[t];r instanceof e.a6?(i(r.layers,this.zoom,a),e.cy({bucket:r,glyphMap:x,glyphPositions:w.positions,imageMap:_,imagePositions:A.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:h.subdivisionGranularity})):r.hasPattern&&(r instanceof e.cz||r instanceof e.cA||r instanceof e.cB)&&(i(r.layers,this.zoom,a),r.addFeatures(h,this.tileID.canonical,A.patternPositions))}return this.status="done",{buckets:Object.values(c).filter((e=>!e.isEmpty())),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:w.image,imageAtlas:A,glyphMap:this.returnDependencies?x:null,iconMap:this.returnDependencies?_:null,glyphPositions:this.returnDependencies?w.positions:null}}))}}function i(t,r,n){const i=new e.C(r);for(const e of t)e.recalculate(i,n)}class a{constructor(e,t,r){this.actor=e,this.layerIndex=t,this.availableImages=r,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(t,r){return e._(this,void 0,void 0,(function*(){const n=yield e.n(t.request,r);try{return{vectorTile:new e.cC.VectorTile(new e.cD(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(e){const r=new Uint8Array(n.data);let i=`Unable to parse the tile at ${t.request.url}, `;throw i+=31===r[0]&&139===r[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${e.message}`,new Error(i)}}))}loadTile(t){return e._(this,void 0,void 0,(function*(){const r=t.uid,i=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.cE(t.request),a=new n(t);this.loading[r]=a;const o=new AbortController;a.abort=o;try{const n=yield this.loadVectorTile(t,o);if(delete this.loading[r],!n)return null;const s=n.rawData,l={};n.expires&&(l.expires=n.expires),n.cacheControl&&(l.cacheControl=n.cacheControl);const u={};if(i){const e=i.finish();e&&(u.resourceTiming=JSON.parse(JSON.stringify(e)))}a.vectorTile=n.vectorTile;const c=a.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity);this.loaded[r]=a,this.fetching[r]={rawTileData:s,cacheControl:l,resourceTiming:u};try{const t=yield c;return e.e({rawTileData:s.slice(0)},t,l,u)}finally{delete this.fetching[r]}}catch(e){throw delete this.loading[r],a.status="done",this.loaded[r]=a,e}}))}reloadTile(t){return e._(this,void 0,void 0,(function*(){const r=t.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const n=this.loaded[r];if(n.showCollisionBoxes=t.showCollisionBoxes,"parsing"===n.status){const i=yield n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity);let a;if(this.fetching[r]){const{rawTileData:t,cacheControl:n,resourceTiming:o}=this.fetching[r];delete this.fetching[r],a=e.e({rawTileData:t.slice(0)},i,n,o)}else a=i;return a}if("done"===n.status&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor,t.subdivisionGranularity)}))}abortTile(t){return e._(this,void 0,void 0,(function*(){const e=this.loading,r=t.uid;e&&e[r]&&e[r].abort&&(e[r].abort.abort(),delete e[r])}))}removeTile(t){return e._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]}))}}class o{constructor(){this.loaded={}}loadTile(t){return e._(this,void 0,void 0,(function*(){const{uid:r,encoding:n,rawImageData:i,redFactor:a,greenFactor:o,blueFactor:s,baseShift:l}=t,u=i.width+2,c=i.height+2,h=e.b(i)?new e.R({width:u,height:c},yield e.cF(i,-1,-1,u,c)):i,p=new e.cG(r,h,n,a,o,s,l);return this.loaded=this.loaded||{},this.loaded[r]=p,p}))}removeTile(e){const t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]}}var s,l,u=function(){if(l)return s;function e(e,r){if(0!==e.length){t(e[0],r);for(var n=1;n<e.length;n++)t(e[n],!r)}}function t(e,t){for(var r=0,n=0,i=0,a=e.length,o=a-1;i<a;o=i++){var s=(e[i][0]-e[o][0])*(e[o][1]+e[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!t&&e.reverse()}return l=1,s=function t(r,n){var i,a=r&&r.type;if("FeatureCollection"===a)for(i=0;i<r.features.length;i++)t(r.features[i],n);else if("GeometryCollection"===a)for(i=0;i<r.geometries.length;i++)t(r.geometries[i],n);else if("Feature"===a)t(r.geometry,n);else if("Polygon"===a)e(r.coordinates,n);else if("MultiPolygon"===a)for(i=0;i<r.coordinates.length;i++)e(r.coordinates[i],n);return r}}(),c=e.cH(u);const h=e.cC.VectorTileFeature.prototype.toGeoJSON;class p{constructor(t){this._feature=t,this.extent=e.Z,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const r of this._feature.geometry)t.push([new e.P(r[0],r[1])]);return t}{const t=[];for(const r of this._feature.geometry){const n=[];for(const t of r)n.push(new e.P(t[0],t[1]));t.push(n)}return t}}toGeoJSON(e,t,r){return h.call(this,e,t,r)}}class d{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.Z,this.length=t.length,this._features=t}feature(e){return new p(this._features[e])}}var f,m,g,y={exports:{}},v=function(){if(g)return y.exports;g=1;var t=e.cK(),r=function(){if(m)return f;m=1;var t=e.cI(),r=e.cJ().VectorTileFeature;function n(e,t){this.options=t||{},this.features=e,this.length=e.length}function i(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}return f=n,n.prototype.feature=function(e){return new i(this.features[e],this.options.extent)},i.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var r=0;r<e.length;r++){for(var n=e[r],i=[],a=0;a<n.length;a++)i.push(new t(n[a][0],n[a][1]));this.geometry.push(i)}return this.geometry},i.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,a=0;a<e.length;a++)for(var o=e[a],s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[t,n,r,i]},i.prototype.toGeoJSON=r.prototype.toGeoJSON,f}();function n(e){var r=new t;return function(e,t){for(var r in e.layers)t.writeMessage(3,i,e.layers[r])}(e,r),r.finish()}function i(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,a,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)t.writeMessage(4,c,o[r])}function a(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,o,e),t.writeVarintField(3,r.type),t.writeMessage(4,u,r)}function o(e,t){var r=e.feature,n=e.keys,i=e.values,a=e.keycache,o=e.valuecache;for(var s in r.properties){var l=r.properties[s],u=a[s];if(null!==l){void 0===u&&(n.push(s),a[s]=u=n.length-1),t.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var h=c+":"+l,p=o[h];void 0===p&&(i.push(l),o[h]=p=i.length-1),t.writeVarint(p)}}}function s(e,t){return(t<<3)+(7&e)}function l(e){return e<<1^e>>31}function u(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,a=0,o=r.length,u=0;u<o;u++){var c=r[u],h=1;1===n&&(h=c.length),t.writeVarint(s(1,h));for(var p=3===n?c.length-1:c.length,d=0;d<p;d++){1===d&&1!==n&&t.writeVarint(s(2,p-1));var f=c[d].x-i,m=c[d].y-a;t.writeVarint(l(f)),t.writeVarint(l(m)),i+=f,a+=m}3===n&&t.writeVarint(s(7,1))}}function c(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}return y.exports=n,y.exports.fromVectorTileJs=n,y.exports.fromGeojsonVt=function(e,t){t=t||{};var i={};for(var a in e)i[a]=new r(e[a].features,t),i[a].name=a,i[a].version=t.version,i[a].extent=t.extent;return n({layers:i})},y.exports.GeoJSONWrapper=r,y.exports}(),x=e.cH(v);const _={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},b=Math.fround||(w=new Float32Array(1),e=>(w[0]=+e,w[0]));var w;class A{constructor(e){this.options=Object.assign(Object.create(_),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:r,maxZoom:n}=this.options;t&&console.time("total time");const i=`prepare ${e.length} points`;t&&console.time(i),this.points=e;const a=[];for(let t=0;t<e.length;t++){const r=e[t];if(!r.geometry)continue;const[n,i]=r.geometry.coordinates,o=b(M(n)),s=b(S(i));a.push(o,s,1/0,t,-1,1),this.options.reduce&&a.push(0)}let o=this.trees[n+1]=this._createTree(a);t&&console.timeEnd(i);for(let e=n;e>=r;e--){const r=+Date.now();o=this.trees[e]=this._createTree(this._cluster(o,e)),t&&console.log("z%d: %d clusters in %dms",e,o.numItems,+Date.now()-r)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){const e=this.getClusters([r,n,180,a],t),o=this.getClusters([-180,n,i,a],t);return e.concat(o)}const o=this.trees[this._limitZoom(t)],s=o.range(M(r),S(a),M(i),S(n)),l=o.data,u=[];for(const e of s){const t=this.stride*e;u.push(l[t+5]>1?C(l,t,this.clusterProps):this.points[l[t+3]])}return u}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);const a=i.data;if(t*this.stride>=a.length)throw new Error(n);const o=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=i.within(a[t*this.stride],a[t*this.stride+1],o),l=[];for(const t of s){const r=t*this.stride;a[r+4]===e&&l.push(a[r+5]>1?C(a,r,this.clusterProps):this.points[a[r+3]])}if(0===l.length)throw new Error(n);return l}getLeaves(e,t,r){const n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n}getTile(e,t,r){const n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:a,radius:o}=this.options,s=o/a,l=(r-s)/i,u=(r+1+s)/i,c={features:[]};return this._addTileFeatures(n.range((t-s)/i,l,(t+1+s)/i,u),n.data,t,r,i,c),0===t&&this._addTileFeatures(n.range(1-s/i,l,1,u),n.data,i,r,i,c),t===i-1&&this._addTileFeatures(n.range(0,l,s/i,u),n.data,-1,r,i,c),c.features.length?c:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,n,i){const a=this.getChildren(t);for(const t of a){const a=t.properties;if(a&&a.cluster?i+a.point_count<=n?i+=a.point_count:i=this._appendLeaves(e,a.cluster_id,r,n,i):i<n?i++:e.push(t),e.length===r)break}return i}_createTree(t){const r=new e.aF(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)r.add(t[e],t[e+1]);return r.finish(),r.data=t,r}_addTileFeatures(e,t,r,n,i,a){for(const o of e){const e=o*this.stride,s=t[e+5]>1;let l,u,c;if(s)l=E(t,e,this.clusterProps),u=t[e],c=t[e+1];else{const r=this.points[t[e+3]];l=r.properties;const[n,i]=r.geometry.coordinates;u=M(n),c=S(i)}const h={type:1,geometry:[[Math.round(this.options.extent*(u*i-r)),Math.round(this.options.extent*(c*i-n))]],tags:l};let p;p=s||this.options.generateId?t[e+3]:this.points[t[e+3]].id,void 0!==p&&(h.id=p),a.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:r,extent:n,reduce:i,minPoints:a}=this.options,o=r/(n*Math.pow(2,t)),s=e.data,l=[],u=this.stride;for(let r=0;r<s.length;r+=u){if(s[r+2]<=t)continue;s[r+2]=t;const n=s[r],c=s[r+1],h=e.within(s[r],s[r+1],o),p=s[r+5];let d=p;for(const e of h){const r=e*u;s[r+2]>t&&(d+=s[r+5])}if(d>p&&d>=a){let e,a=n*p,o=c*p,f=-1;const m=(r/u<<5)+(t+1)+this.points.length;for(const n of h){const l=n*u;if(s[l+2]<=t)continue;s[l+2]=t;const c=s[l+5];a+=s[l]*c,o+=s[l+1]*c,s[l+4]=m,i&&(e||(e=this._map(s,r,!0),f=this.clusterProps.length,this.clusterProps.push(e)),i(e,this._map(s,l)))}s[r+4]=m,l.push(a/d,o/d,1/0,m,-1,d),i&&l.push(f)}else{for(let e=0;e<u;e++)l.push(s[r+e]);if(d>1)for(const e of h){const r=e*u;if(!(s[r+2]<=t)){s[r+2]=t;for(let e=0;e<u;e++)l.push(s[r+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,r){if(e[t+5]>1){const n=this.clusterProps[e[t+6]];return r?Object.assign({},n):n}const n=this.points[e[t+3]].properties,i=this.options.map(n);return r&&i===n?Object.assign({},i):i}}function C(e,t,r){return{type:"Feature",id:e[t+3],properties:E(e,t,r),geometry:{type:"Point",coordinates:[(n=e[t],360*(n-.5)),D(e[t+1])]}};var n}function E(e,t,r){const n=e[t+5],i=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?Math.round(n/100)/10+"k":n,a=e[t+6],o=-1===a?{}:Object.assign({},r[a]);return Object.assign(o,{cluster:!0,cluster_id:e[t+3],point_count:n,point_count_abbreviated:i})}function M(e){return e/360+.5}function S(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function D(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function T(e,t,r,n){let i=n;const a=t+(r-t>>1);let o,s=r-t;const l=e[t],u=e[t+1],c=e[r],h=e[r+1];for(let n=t+3;n<r;n+=3){const t=N(e[n],e[n+1],l,u,c,h);if(t>i)o=n,i=t;else if(t===i){const e=Math.abs(n-a);e<s&&(o=n,s=e)}}i>n&&(o-t>3&&T(e,t,o,n),e[o+2]=i,r-o>3&&T(e,o,r,n))}function N(e,t,r,n,i,a){let o=i-r,s=a-n;if(0!==o||0!==s){const l=((e-r)*o+(t-n)*s)/(o*o+s*s);l>1?(r=i,n=a):l>0&&(r+=o*l,n+=s*l)}return o=e-r,s=t-n,o*o+s*s}function I(e,t,r,n){const i={id:null==e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===t||"MultiPoint"===t||"LineString"===t)P(i,r);else if("Polygon"===t)P(i,r[0]);else if("MultiLineString"===t)for(const e of r)P(i,e);else if("MultiPolygon"===t)for(const e of r)P(i,e[0]);return i}function P(e,t){for(let r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function z(e,t,r,n){if(!t.geometry)return;const i=t.geometry.coordinates;if(i&&0===i.length)return;const a=t.geometry.type,o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2);let s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),"Point"===a)B(i,s);else if("MultiPoint"===a)for(const e of i)B(e,s);else if("LineString"===a)k(i,s,o,!1);else if("MultiLineString"===a){if(r.lineMetrics){for(const r of i)s=[],k(r,s,o,!1),e.push(I(l,"LineString",s,t.properties));return}F(i,s,o,!1)}else if("Polygon"===a)F(i,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(const i of t.geometry.geometries)z(e,{id:l,geometry:i,properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const e of i){const t=[];F(e,t,o,!0),s.push(t)}}e.push(I(l,a,s,t.properties))}function B(e,t){t.push(R(e[0]),O(e[1]),0)}function k(e,t,r,n){let i,a,o=0;for(let r=0;r<e.length;r++){const s=R(e[r][0]),l=O(e[r][1]);t.push(s,l,0),r>0&&(o+=n?(i*l-s*a)/2:Math.sqrt(Math.pow(s-i,2)+Math.pow(l-a,2))),i=s,a=l}const s=t.length-3;t[2]=1,T(t,0,s,r),t[s+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function F(e,t,r,n){for(let i=0;i<e.length;i++){const a=[];k(e[i],a,r,n),t.push(a)}}function R(e){return e/360+.5}function O(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function L(e,t,r,n,i,a,o,s){if(n/=t,a>=(r/=t)&&o<n)return e;if(o<r||a>=n)return null;const l=[];for(const t of e){const e=t.geometry;let a=t.type;const o=0===i?t.minX:t.minY,u=0===i?t.maxX:t.maxY;if(o>=r&&u<n){l.push(t);continue}if(u<r||o>=n)continue;let c=[];if("Point"===a||"MultiPoint"===a)q(e,c,r,n,i);else if("LineString"===a)j(e,c,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===a)V(e,c,r,n,i,!1);else if("Polygon"===a)V(e,c,r,n,i,!0);else if("MultiPolygon"===a)for(const t of e){const e=[];V(t,e,r,n,i,!0),e.length&&c.push(e)}if(c.length){if(s.lineMetrics&&"LineString"===a){for(const e of c)l.push(I(t.id,a,e,t.tags));continue}"LineString"!==a&&"MultiLineString"!==a||(1===c.length?(a="LineString",c=c[0]):a="MultiLineString"),"Point"!==a&&"MultiPoint"!==a||(a=3===c.length?"Point":"MultiPoint"),l.push(I(t.id,a,c,t.tags))}}return l.length?l:null}function q(e,t,r,n,i){for(let a=0;a<e.length;a+=3){const o=e[a+i];o>=r&&o<=n&&Z(t,e[a],e[a+1],e[a+2])}}function j(e,t,r,n,i,a,o){let s=U(e);const l=0===i?$:G;let u,c,h=e.start;for(let p=0;p<e.length-3;p+=3){const d=e[p],f=e[p+1],m=e[p+2],g=e[p+3],y=e[p+4],v=0===i?d:f,x=0===i?g:y;let _=!1;o&&(u=Math.sqrt(Math.pow(d-g,2)+Math.pow(f-y,2))),v<r?x>r&&(c=l(s,d,f,g,y,r),o&&(s.start=h+u*c)):v>n?x<n&&(c=l(s,d,f,g,y,n),o&&(s.start=h+u*c)):Z(s,d,f,m),x<r&&v>=r&&(c=l(s,d,f,g,y,r),_=!0),x>n&&v<=n&&(c=l(s,d,f,g,y,n),_=!0),!a&&_&&(o&&(s.end=h+u*c),t.push(s),s=U(e)),o&&(h+=u)}let p=e.length-3;const d=e[p],f=e[p+1],m=0===i?d:f;m>=r&&m<=n&&Z(s,d,f,e[p+2]),p=s.length-3,a&&p>=3&&(s[p]!==s[0]||s[p+1]!==s[1])&&Z(s,s[0],s[1],s[2]),s.length&&t.push(s)}function U(e){const t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function V(e,t,r,n,i,a){for(const o of e)j(o,t,r,n,i,a,!1)}function Z(e,t,r,n){e.push(t,r,n)}function $(e,t,r,n,i,a){const o=(a-t)/(n-t);return Z(e,a,r+(i-r)*o,1),o}function G(e,t,r,n,i,a){const o=(a-r)/(i-r);return Z(e,t+(n-t)*o,a,1),o}function H(e,t){const r=[];for(let n=0;n<e.length;n++){const i=e[n],a=i.type;let o;if("Point"===a||"MultiPoint"===a||"LineString"===a)o=W(i.geometry,t);else if("MultiLineString"===a||"Polygon"===a){o=[];for(const e of i.geometry)o.push(W(e,t))}else if("MultiPolygon"===a){o=[];for(const e of i.geometry){const r=[];for(const n of e)r.push(W(n,t));o.push(r)}}r.push(I(i.id,a,o,i.tags))}return r}function W(e,t){const r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(let n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function X(e,t){if(e.transformed)return e;const r=1<<e.z,n=e.x,i=e.y;for(const a of e.features){const e=a.geometry,o=a.type;if(a.geometry=[],1===o)for(let o=0;o<e.length;o+=2)a.geometry.push(Y(e[o],e[o+1],t,r,n,i));else for(let o=0;o<e.length;o++){const s=[];for(let a=0;a<e[o].length;a+=2)s.push(Y(e[o][a],e[o][a+1],t,r,n,i));a.geometry.push(s)}}return e.transformed=!0,e}function Y(e,t,r,n,i,a){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-a))]}function K(e,t,r,n,i){const a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:e.length,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const t of e)J(o,t,a,i);return o}function J(e,t,r,n){const i=t.geometry,a=t.type,o=[];if(e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),"Point"===a||"MultiPoint"===a)for(let t=0;t<i.length;t+=3)o.push(i[t],i[t+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)Q(o,i,e,r,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(let t=0;t<i.length;t++)Q(o,i[t],e,r,"Polygon"===a,0===t);else if("MultiPolygon"===a)for(let t=0;t<i.length;t++){const n=i[t];for(let t=0;t<n.length;t++)Q(o,n[t],e,r,!0,0===t)}if(o.length){let r=t.tags||null;if("LineString"===a&&n.lineMetrics){r={};for(const e in t.tags)r[e]=t.tags[e];r.mapbox_clip_start=i.start/i.size,r.mapbox_clip_end=i.end/i.size}const s={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:r};null!==t.id&&(s.id=t.id),e.features.push(s)}}function Q(e,t,r,n,i,a){const o=n*n;if(n>0&&t.size<(i?o:n))return void(r.numPoints+=t.length/3);const s=[];for(let e=0;e<t.length;e+=3)(0===n||t[e+2]>o)&&(r.numSimplified++,s.push(t[e],t[e+1])),r.numPoints++;i&&function(e,t){let r=0;for(let t=0,n=e.length,i=n-2;t<n;i=t,t+=2)r+=(e[t]-e[i])*(e[t+1]+e[i+1]);if(r>0===t)for(let t=0,r=e.length;t<r/2;t+=2){const n=e[t],i=e[t+1];e[t]=e[r-2-t],e[t+1]=e[r-1-t],e[r-2-t]=n,e[r-1-t]=i}}(s,a),e.push(s)}const ee={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class te{constructor(e,t){const r=(t=this.options=function(e,t){for(const r in t)e[r]=t[r];return e}(Object.create(ee),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");let n=function(e,t){const r=[];if("FeatureCollection"===e.type)for(let n=0;n<e.features.length;n++)z(r,e.features[n],t,n);else z(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=function(e,t){const r=t.buffer/t.extent;let n=e;const i=L(e,1,-1-r,r,0,-1,2,t),a=L(e,1,1-r,2+r,0,-1,2,t);return(i||a)&&(n=L(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=H(i,1).concat(n)),a&&(n=n.concat(H(a,-1)))),n}(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(e,t,r,n,i,a,o){const s=[e,t,r,n],l=this.options,u=l.debug;for(;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();const c=1<<t,h=re(t,r,n);let p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=K(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));const e=`z${t}`;this.stats[e]=(this.stats[e]||0)+1,this.total++}if(p.source=e,null==i){if(t===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue}else{if(t===l.maxZoom||t===i)continue;if(null!=i){const e=i-t;if(r!==a>>e||n!==o>>e)continue}}if(p.source=null,0===e.length)continue;u>1&&console.time("clipping");const d=.5*l.buffer/l.extent,f=.5-d,m=.5+d,g=1+d;let y=null,v=null,x=null,_=null,b=L(e,c,r-d,r+m,0,p.minX,p.maxX,l),w=L(e,c,r+f,r+g,0,p.minX,p.maxX,l);e=null,b&&(y=L(b,c,n-d,n+m,1,p.minY,p.maxY,l),v=L(b,c,n+f,n+g,1,p.minY,p.maxY,l),b=null),w&&(x=L(w,c,n-d,n+m,1,p.minY,p.maxY,l),_=L(w,c,n+f,n+g,1,p.minY,p.maxY,l),w=null),u>1&&console.timeEnd("clipping"),s.push(y||[],t+1,2*r,2*n),s.push(v||[],t+1,2*r,2*n+1),s.push(x||[],t+1,2*r+1,2*n),s.push(_||[],t+1,2*r+1,2*n+1)}}getTile(e,t,r){e=+e,t=+t,r=+r;const n=this.options,{extent:i,debug:a}=n;if(e<0||e>24)return null;const o=1<<e,s=re(e,t=t+o&o-1,r);if(this.tiles[s])return X(this.tiles[s],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);let l,u=e,c=t,h=r;for(;!l&&u>0;)u--,c>>=1,h>>=1,l=this.tiles[re(u,c,h)];return l&&l.source?(a>1&&(console.log("found parent tile z%d-%d-%d",u,c,h),console.time("drilling down")),this.splitTile(l.source,u,c,h,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[s]?X(this.tiles[s],i):null):null}}function re(e,t,r){return 32*((1<<e)*r+t)+e}function ne(e,t){return t?e.properties[t]:e.id}function ie(e,t){if(null==e)return!0;if("Feature"===e.type)return null!=ne(e,t);if("FeatureCollection"===e.type){const r=new Set;for(const n of e.features){const e=ne(n,t);if(null==e)return!1;if(r.has(e))return!1;r.add(e)}return!0}return!1}function ae(e,t){const r=new Map;if(null==e);else if("Feature"===e.type)r.set(ne(e,t),e);else for(const n of e.features)r.set(ne(n,t),n);return r}class oe extends a{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(t,r){return e._(this,void 0,void 0,(function*(){const e=t.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const r=this._geoJSONIndex.getTile(e.z,e.x,e.y);if(!r)return null;const n=new d(r.features);let i=x(n);return 0===i.byteOffset&&i.byteLength===i.buffer.byteLength||(i=new Uint8Array(i)),{vectorTile:n,rawData:i.buffer}}))}loadData(t){return e._(this,void 0,void 0,(function*(){var r;null===(r=this._pendingRequest)||void 0===r||r.abort();const n=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.cE(t.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(t,this._pendingRequest),this._geoJSONIndex=t.cluster?new A(function({superclusterOptions:t,clusterProperties:r}){if(!r||!t)return t;const n={},i={},a={accumulated:null,zoom:0},o={properties:null},s=Object.keys(r);for(const t of s){const[a,o]=r[t],s=e.cL(o),l=e.cL("string"==typeof a?[a,["accumulated"],["get",t]]:a);n[t]=s.value,i[t]=l.value}return t.map=e=>{o.properties=e;const t={};for(const e of s)t[e]=n[e].evaluate(a,o);return t},t.reduce=(e,t)=>{o.properties=t;for(const t of s)a.accumulated=e[t],e[t]=i[t].evaluate(a,o)},t}(t)).load((yield this._pendingData).features):(i=yield this._pendingData,new te(i,t.geojsonVtOptions)),this.loaded={};const r={};if(n){const e=n.finish();e&&(r.resourceTiming={},r.resourceTiming[t.source]=JSON.parse(JSON.stringify(e)))}return r}catch(t){if(delete this._pendingRequest,e.cp(t))return{abandoned:!0};throw t}var i}))}getData(){return e._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(e){const t=this.loaded;return t&&t[e.uid]?super.reloadTile(e):this.loadTile(e)}loadAndProcessGeoJSON(t,r){return e._(this,void 0,void 0,(function*(){let n=yield this.loadGeoJSON(t,r);if(delete this._pendingRequest,"object"!=typeof n)throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);if(c(n,!0),t.filter){const r=e.cL(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));const i=n.features.filter((e=>r.value.evaluate({zoom:0},e)));n={type:"FeatureCollection",features:i}}return n}))}loadGeoJSON(t,r){return e._(this,void 0,void 0,(function*(){const{promoteId:n}=t;if(t.request){const i=yield e.j(t.request,r);return this._dataUpdateable=ie(i.data,n)?ae(i.data,n):void 0,i.data}if("string"==typeof t.data)try{const e=JSON.parse(t.data);return this._dataUpdateable=ie(e,n)?ae(e,n):void 0,e}catch(e){throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`)}if(!t.dataDiff)throw new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${t.source}`);return function(e,t,r){var n,i,a,o;if(t.removeAll&&e.clear(),t.remove)for(const r of t.remove)e.delete(r);if(t.add)for(const n of t.add){const t=ne(n,r);null!=t&&e.set(t,n)}if(t.update)for(const r of t.update){let t=e.get(r.id);if(null==t)continue;const s=!r.removeAllProperties&&((null===(n=r.removeProperties)||void 0===n?void 0:n.length)>0||(null===(i=r.addOrUpdateProperties)||void 0===i?void 0:i.length)>0);if((r.newGeometry||r.removeAllProperties||s)&&(t=Object.assign({},t),e.set(r.id,t),s&&(t.properties=Object.assign({},t.properties))),r.newGeometry&&(t.geometry=r.newGeometry),r.removeAllProperties)t.properties={};else if((null===(a=r.removeProperties)||void 0===a?void 0:a.length)>0)for(const e of r.removeProperties)Object.prototype.hasOwnProperty.call(t.properties,e)&&delete t.properties[e];if((null===(o=r.addOrUpdateProperties)||void 0===o?void 0:o.length)>0)for(const{key:e,value:n}of r.addOrUpdateProperties)t.properties[e]=n}}(this._dataUpdateable,t.dataDiff,n),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(t){return e._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(e){return this._geoJSONIndex.getClusterExpansionZoom(e.clusterId)}getClusterChildren(e){return this._geoJSONIndex.getChildren(e.clusterId)}getClusterLeaves(e){return this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset)}}class se{constructor(t){this.self=t,this.actor=new e.H(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(e,t)=>{if(this.externalWorkerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.externalWorkerSourceTypes[e]=t},this.self.addProtocol=e.cr,this.self.removeProtocol=e.cs,this.self.registerRTLTextPlugin=t=>{e.cM.setMethods(t)},this.actor.registerMessageHandler("LDT",((e,t)=>this._getDEMWorkerSource(e,t.source).loadTile(t))),this.actor.registerMessageHandler("RDT",((t,r)=>e._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(t,r.source).removeTile(r)})))),this.actor.registerMessageHandler("GCEZ",((t,r)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterExpansionZoom(r)})))),this.actor.registerMessageHandler("GCC",((t,r)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterChildren(r)})))),this.actor.registerMessageHandler("GCL",((t,r)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(t,r.type,r.source).getClusterLeaves(r)})))),this.actor.registerMessageHandler("LD",((e,t)=>this._getWorkerSource(e,t.type,t.source).loadData(t))),this.actor.registerMessageHandler("GD",((e,t)=>this._getWorkerSource(e,t.type,t.source).getData())),this.actor.registerMessageHandler("LT",((e,t)=>this._getWorkerSource(e,t.type,t.source).loadTile(t))),this.actor.registerMessageHandler("RT",((e,t)=>this._getWorkerSource(e,t.type,t.source).reloadTile(t))),this.actor.registerMessageHandler("AT",((e,t)=>this._getWorkerSource(e,t.type,t.source).abortTile(t))),this.actor.registerMessageHandler("RMT",((e,t)=>this._getWorkerSource(e,t.type,t.source).removeTile(t))),this.actor.registerMessageHandler("RS",((t,r)=>e._(this,void 0,void 0,(function*(){if(!this.workerSources[t]||!this.workerSources[t][r.type]||!this.workerSources[t][r.type][r.source])return;const e=this.workerSources[t][r.type][r.source];delete this.workerSources[t][r.type][r.source],void 0!==e.removeSource&&e.removeSource(r)})))),this.actor.registerMessageHandler("RM",(t=>e._(this,void 0,void 0,(function*(){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t]})))),this.actor.registerMessageHandler("SR",((t,r)=>e._(this,void 0,void 0,(function*(){this.referrer=r})))),this.actor.registerMessageHandler("SRPS",((e,t)=>this._syncRTLPluginState(e,t))),this.actor.registerMessageHandler("IS",((t,r)=>e._(this,void 0,void 0,(function*(){this.self.importScripts(r)})))),this.actor.registerMessageHandler("SI",((e,t)=>this._setImages(e,t))),this.actor.registerMessageHandler("UL",((t,r)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(t).update(r.layers,r.removedIds)})))),this.actor.registerMessageHandler("SL",((t,r)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(t).replace(r)}))))}_setImages(t,r){return e._(this,void 0,void 0,(function*(){this.availableImages[t]=r;for(const e in this.workerSources[t]){const n=this.workerSources[t][e];for(const e in n)n[e].availableImages=r}}))}_syncRTLPluginState(t,r){return e._(this,void 0,void 0,(function*(){return yield e.cM.syncState(r,this.self.importScripts)}))}_getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}_getLayerIndex(e){let r=this.layerIndexes[e];return r||(r=this.layerIndexes[e]=new t),r}_getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){const n={sendAsync:(t,r)=>(t.targetMapId=e,this.actor.sendAsync(t,r))};switch(t){case"vector":this.workerSources[e][t][r]=new a(n,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][t][r]=new oe(n,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][t][r]=new this.externalWorkerSourceTypes[t](n,this._getLayerIndex(e),this._getAvailableImages(e))}}return this.workerSources[e][t][r]}_getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new o),this.demWorkerSources[e][t]}}return e.i(self)&&(self.worker=new se(self)),se})),r("index",0,(function(e,t){var r="5.5.0";function n(){var e=new t.A(4);return t.A!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}let i,a;const o={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(e,r,n){const i=requestAnimationFrame((e=>{a(),r(e)})),{unsubscribe:a}=t.s(e.signal,"abort",(()=>{a(),cancelAnimationFrame(i),n(t.c())}),!1)},frameAsync(e){return new Promise(((t,r)=>{this.frame(e,t,r)}))},getImageData(e,t=0){return this.getImageCanvasContext(e).getImageData(-t,-t,e.width+2*t,e.height+2*t)},getImageCanvasContext(e){const t=window.document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0,e.width,e.height),r},resolveURL:e=>(i||(i=document.createElement("a")),i.href=e,i.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==a&&(a=matchMedia("(prefers-reduced-motion: reduce)")),a.matches)}};class s{static testProp(e){if(!s.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in s.docStyle)return e[t];return e[0]}static create(e,t,r){const n=window.document.createElement(e);return void 0!==t&&(n.className=t),r&&r.appendChild(n),n}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){s.docStyle&&s.selectProp&&(s.userSelect=s.docStyle[s.selectProp],s.docStyle[s.selectProp]="none")}static enableDrag(){s.docStyle&&s.selectProp&&(s.docStyle[s.selectProp]=s.userSelect)}static setTransform(e,t){e.style[s.transformProp]=t}static addEventListener(e,t,r,n={}){e.addEventListener(t,r,"passive"in n?n:n.capture)}static removeEventListener(e,t,r,n={}){e.removeEventListener(t,r,"passive"in n?n:n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",s.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",s.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",s.suppressClickInternal,!0)}),0)}static getScale(e){const t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,r,n){const i=r.boundingClientRect;return new t.P((n.clientX-i.left)/r.x-e.clientLeft,(n.clientY-i.top)/r.y-e.clientTop)}static mousePos(e,t){const r=s.getScale(e);return s.getPoint(e,r,t)}static touchPos(e,t){const r=[],n=s.getScale(e);for(let i=0;i<t.length;i++)r.push(s.getPoint(e,n,t[i]));return r}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const t=(new DOMParser).parseFromString(e,"text/html").body||document.createElement("body"),r=t.querySelectorAll("script");for(const e of r)e.remove();return s.clean(t),t.innerHTML}static isPossiblyDangerous(e,t){const r=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!r.includes("javascript:")&&!r.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const t=e.children;for(const e of t)s.removeAttributes(e),s.clean(e)}static removeAttributes(e){for(const{name:t,value:r}of e.attributes)s.isPossiblyDangerous(t,r)&&e.removeAttribute(t)}}s.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,s.selectProp=s.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),s.transformProp=s.testProp(["transform","WebkitTransform"]);const l={supported:!1,testSupport:function(e){!h&&c&&(p?d(e):u=e)}};let u,c,h=!1,p=!1;function d(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,c),e.isContextLost())return;l.supported=!0}catch(e){}e.deleteTexture(t),h=!0}var f;"undefined"!=typeof document&&(c=document.createElement("img"),c.onload=()=>{u&&d(u),u=null,p=!0},c.onerror=()=>{h=!0,u=null},c.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(e){let r,n,i,a;e.resetRequestQueue=()=>{r=[],n=0,i=0,a={}},e.addThrottleControl=e=>{const t=i++;return a[t]=e,t},e.removeThrottleControl=e=>{delete a[e],s()},e.getImage=(e,n,i=!0)=>new Promise(((a,o)=>{l.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),t.e(e,{type:"image"}),r.push({abortController:n,requestParameters:e,supportImageRefresh:i,state:"queued",onError:e=>{o(e)},onSuccess:e=>{a(e)}}),s()}));const o=e=>t._(this,void 0,void 0,(function*(){e.state="running";const{requestParameters:r,supportImageRefresh:i,onError:a,onSuccess:o,abortController:l}=e,c=!1===i&&!t.i(self)&&!t.g(r.url)&&(!r.headers||Object.keys(r.headers).reduce(((e,t)=>e&&"accept"===t),!0));n++;const h=c?u(r,l):t.m(r,l);try{const r=yield h;delete e.abortController,e.state="completed",r.data instanceof HTMLImageElement||t.b(r.data)?o(r):r.data&&o({data:yield(p=r.data,"function"==typeof createImageBitmap?t.f(p):t.h(p)),cacheControl:r.cacheControl,expires:r.expires})}catch(t){delete e.abortController,a(t)}finally{n--,s()}var p})),s=()=>{const e=(()=>{for(const e of Object.keys(a))if(a[e]())return!0;return!1})()?t.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:t.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let t=n;t<e&&r.length>0;t++){const e=r.shift();e.abortController.signal.aborted?t--:o(e)}},u=(e,r)=>new Promise(((n,i)=>{const a=new Image,o=e.url,s=e.credentials;s&&"include"===s?a.crossOrigin="use-credentials":(s&&"same-origin"===s||!t.d(o))&&(a.crossOrigin="anonymous"),r.signal.addEventListener("abort",(()=>{a.src="",i(t.c())})),a.fetchPriority="high",a.onload=()=>{a.onerror=a.onload=null,n({data:a})},a.onerror=()=>{a.onerror=a.onload=null,r.signal.aborted||i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},a.src=o}))}(f||(f={})),f.resetRequestQueue();class m{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function g(e){const t=[];if("string"==typeof e)t.push({id:"default",url:e});else if(e&&e.length>0){const r=[];for(const{id:n,url:i}of e){const e=`${n}${i}`;-1===r.indexOf(e)&&(r.push(e),t.push({id:n,url:i}))}}return t}function y(e,t,r){try{const n=new URL(e);return n.pathname+=`${t}${r}`,n.toString()}catch(t){throw new Error(`Invalid sprite URL "${e}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class v{constructor(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,r,n){const{width:i,height:a}=e,o=!(this.size&&this.size[0]===i&&this.size[1]===a||n),{context:s}=this,{gl:l}=s;if(this.useMipmap=Boolean(r&&r.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!r||!1!==r.premultiply)),o)this.size=[i,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.b(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,i,a,0,this.format,l.UNSIGNED_BYTE,e.data);else{const{x:r,y:o}=n||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.b(e)?l.texSubImage2D(l.TEXTURE_2D,0,r,o,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,r,o,i,a,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D),s.pixelStoreUnpackFlipY.setDefault(),s.pixelStoreUnpack.setDefault(),s.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,t,r){const{context:n}=this,{gl:i}=n;i.bindTexture(i.TEXTURE_2D,this.texture),r!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=i.LINEAR),e!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function x(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class _ extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,promiseResolve:t}of this.requestors)t(this._getImagesForIds(e));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const e=r.spriteData;r.data=new t.R({width:e.width,height:e.height},e.context.getImageData(e.x,e.y,e.width,e.height).data),r.spriteData=null}return r}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(e,r){let n=!0;const i=r.data||r.spriteData;return this._validateStretch(r.stretchX,i&&i.width)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "stretchX" value`))),n=!1),this._validateStretch(r.stretchY,i&&i.height)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "stretchY" value`))),n=!1),this._validateContent(r.content,r)||(this.fire(new t.k(new Error(`Image "${e}" has invalid "content" value`))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let r=0;for(const n of e){if(n[0]<r||n[1]<n[0]||t<n[1])return!1;r=n[1]}return!0}_validateContent(e,t){if(!e)return!0;if(4!==e.length)return!1;const r=t.spriteData,n=r&&r.width||t.data.width,i=r&&r.height||t.data.height;return!(e[0]<0||n<e[0]||e[1]<0||i<e[1]||e[2]<0||n<e[2]||e[3]<0||i<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t,r=!0){const n=this.getImage(e);if(r&&(n.data.width!==t.data.width||n.data.height!==t.data.height))throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=n.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((t,r)=>{let n=!0;if(!this.isLoaded())for(const t of e)this.images[t]||(n=!1);this.isLoaded()||n?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})}))}_getImagesForIds(e){const r={};for(const n of e){let e=this.getImage(n);e||(this.fire(new t.l("styleimagemissing",{id:n})),e=this.getImage(n)),e?r[n]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,textFitWidth:e.textFitWidth,textFitHeight:e.textFitHeight,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.w(`Image "${n}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){const r=this.patterns[e],n=this.getImage(e);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{const r={w:n.data.width+2,h:n.data.height+2,x:0,y:0},i=new t.I(r,n);this.patterns[e]={bin:r,position:i}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:r,h:n}=t.p(e),i=this.atlasImage;i.resize({width:r||1,height:n||1});for(const e in this.patterns){const{bin:r}=this.patterns[e],n=r.x+1,a=r.y+1,o=this.getImage(e).data,s=o.width,l=o.height;t.R.copy(o,i,{x:0,y:0},{x:n,y:a},{width:s,height:l}),t.R.copy(o,i,{x:0,y:l-1},{x:n,y:a-1},{width:s,height:1}),t.R.copy(o,i,{x:0,y:0},{x:n,y:a+l},{width:s,height:1}),t.R.copy(o,i,{x:s-1,y:0},{x:n-1,y:a},{width:1,height:l}),t.R.copy(o,i,{x:0,y:0},{x:n+s,y:a},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const e=this.getImage(r);e||t.w(`Image with ID: "${r}" was not found`),x(e)&&this.updateImage(r,e)}}}const b=1e20;function w(e,t,r,n,i,a,o,s,l){for(let u=t;u<t+n;u++)A(e,r*a+u,a,i,o,s,l);for(let u=r;u<r+i;u++)A(e,u*a+t,1,n,o,s,l)}function A(e,t,r,n,i,a,o){a[0]=0,o[0]=-1e20,o[1]=b,i[0]=e[t];for(let s=1,l=0,u=0;s<n;s++){i[s]=e[t+s*r];const n=s*s;do{const e=a[l];u=(i[s]-i[e]+n-e*e)/(s-e)/2}while(u<=o[l]&&--l>-1);l++,a[l]=s,o[l]=u,o[l+1]=b}for(let s=0,l=0;s<n;s++){for(;o[l+1]<s;)l++;const n=a[l],u=s-n;e[t+s*r]=i[n]+u*u}}class C{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return t._(this,void 0,void 0,(function*(){const t=[];for(const r in e)for(const n of e[r])t.push(this._getAndCacheGlyphsPromise(r,n));const r=yield Promise.all(t),n={};for(const{stack:e,id:t,glyph:i}of r)n[e]||(n[e]={}),n[e][t]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics};return n}))}_getAndCacheGlyphsPromise(e,r){return t._(this,void 0,void 0,(function*(){let t=this.entries[e];t||(t=this.entries[e]={glyphs:{},requests:{},ranges:{}});let n=t.glyphs[r];if(void 0!==n)return{stack:e,id:r,glyph:n};if(n=this._tinySDF(t,e,r),n)return t.glyphs[r]=n,{stack:e,id:r,glyph:n};const i=Math.floor(r/256);if(256*i>65535)throw new Error("glyphs > 65535 not supported");if(t.ranges[i])return{stack:e,id:r,glyph:n};if(!this.url)throw new Error("glyphsUrl is not set");if(!t.requests[i]){const r=C.loadGlyphRange(e,i,this.url,this.requestManager);t.requests[i]=r}const a=yield t.requests[i];for(const e in a)this._doesCharSupportLocalGlyph(+e)||(t.glyphs[+e]=a[+e]);return t.ranges[i]=!0,{stack:e,id:r,glyph:a[r]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(e))||t.u["CJK Unified Ideographs"](e)||t.u["Hangul Syllables"](e)||t.u.Hiragana(e)||t.u.Katakana(e)||t.u["CJK Symbols and Punctuation"](e)||t.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,n){const i=this.localIdeographFontFamily;if(!i)return;if(!this._doesCharSupportLocalGlyph(n))return;let a=e.tinySDF;if(!a){let t="400";/bold/i.test(r)?t="900":/medium/i.test(r)?t="500":/light/i.test(r)&&(t="200"),a=e.tinySDF=new C.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:i,fontWeight:t})}const o=a.draw(String.fromCharCode(n));return{id:n,bitmap:new t.q({width:o.width||60,height:o.height||60},o.data),metrics:{width:o.glyphWidth/2||24,height:o.glyphHeight/2||24,left:o.glyphLeft/2+.5||0,top:o.glyphTop/2-27.5||-8,advance:o.glyphAdvance/2||24,isDoubleResolution:!0}}}}C.loadGlyphRange=function(e,r,n,i){return t._(this,void 0,void 0,(function*(){const a=256*r,o=a+255,s=i.transformRequest(n.replace("{fontstack}",e).replace("{range}",`${a}-${o}`),"Glyphs"),l=yield t.n(s,new AbortController);if(!l||!l.data)throw new Error(`Could not load glyph range. range: ${r}, ${a}-${o}`);const u={};for(const e of t.o(l.data))u[e.id]=e;return u}))},C.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:n=.25,fontFamily:i="sans-serif",fontWeight:a="normal",fontStyle:o="normal"}={}){this.buffer=t,this.cutoff=n,this.radius=r;const s=this.size=e+4*t,l=this._createCanvas(s),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${o} ${a} ${e}px ${i}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:i,actualBoundingBoxRight:a}=this.ctx.measureText(e),o=Math.ceil(r),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-i))),l=Math.min(this.size-this.buffer,o+Math.ceil(n)),u=s+2*this.buffer,c=l+2*this.buffer,h=Math.max(u*c,0),p=new Uint8ClampedArray(h),d={data:p,width:u,height:c,glyphWidth:s,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===s||0===l)return d;const{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;f.clearRect(m,m,s,l),f.fillText(e,m,m+o);const v=f.getImageData(m,m,s,l);y.fill(b,0,h),g.fill(0,0,h);for(let e=0;e<l;e++)for(let t=0;t<s;t++){const r=v.data[4*(e*s+t)+3]/255;if(0===r)continue;const n=(e+m)*u+t+m;if(1===r)y[n]=0,g[n]=b;else{const e=.5-r;y[n]=e>0?e*e:0,g[n]=e<0?e*e:0}}w(y,0,0,u,c,u,this.f,this.v,this.z),w(g,m,m,s,l,u,this.f,this.v,this.z);for(let e=0;e<h;e++){const t=Math.sqrt(y[e])-Math.sqrt(g[e]);p[e]=Math.round(255-255*(t/this.radius+this.cutoff))}return d}};class E{constructor(){this.specification=t.v.light.position}possiblyEvaluate(e,r){return t.z(e.expression.evaluate(r))}interpolate(e,r,n){return{x:t.B.number(e.x,r.x,n),y:t.B.number(e.y,r.y,n),z:t.B.number(e.z,r.z,n)}}}let M;class S extends t.E{constructor(e){super(),M=M||new t.r({anchor:new t.D(t.v.light.anchor),position:new E,color:new t.D(t.v.light.color),intensity:new t.D(t.v.light.intensity)}),this._transitionable=new t.T(M),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(t.t,e,r))for(const t in e){const r=e[t];t.endsWith("-transition")?this._transitionable.setTransition(t.slice(0,-11),r):this._transitionable.setValue(t,r)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n){return(!n||!1!==n.validate)&&t.x(this,e.call(t.y,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.v}))}}const D=new t.r({"sky-color":new t.D(t.v.sky["sky-color"]),"horizon-color":new t.D(t.v.sky["horizon-color"]),"fog-color":new t.D(t.v.sky["fog-color"]),"fog-ground-blend":new t.D(t.v.sky["fog-ground-blend"]),"horizon-fog-blend":new t.D(t.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new t.D(t.v.sky["sky-horizon-blend"]),"atmosphere-blend":new t.D(t.v.sky["atmosphere-blend"])});class T extends t.E{constructor(e){super(),this._transitionable=new t.T(D),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new t.C(0))}setSky(e,r={}){if(!this._validate(t.F,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const t in e){const r=e[t];t.endsWith("-transition")?this._transitionable.setTransition(t.slice(0,-11),r):this._transitionable.setValue(t,r)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,n={}){return!1!==(null==n?void 0:n.validate)&&t.x(this,e.call(t.y,t.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:t.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class N{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){const r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]}getDashRanges(e,t,r){const n=[];let i=e.length%2==1?-e[e.length-1]*r:0,a=e[0]*r,o=!0;n.push({left:i,right:a,isDash:o,zeroLength:0===e[0]});let s=e[0];for(let t=1;t<e.length;t++){o=!o;const l=e[t];i=s*r,s+=l,a=s*r,n.push({left:i,right:a,isDash:o,zeroLength:0===l})}return n}addRoundDash(e,t,r){const n=t/2;for(let t=-r;t<=r;t++){const i=this.width*(this.nextRow+r+t);let a=0,o=e[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++a]);const l=Math.abs(s-o.left),u=Math.abs(s-o.right),c=Math.min(l,u);let h;const p=t/r*(n+1);if(o.isDash){const e=n-Math.abs(p);h=Math.sqrt(c*c+e*e)}else h=n-Math.sqrt(c*c+p*p);this.data[i+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e){for(let t=e.length-1;t>=0;--t){const r=e[t],n=e[t+1];r.zeroLength?e.splice(t,1):n&&n.isDash===r.isDash&&(n.left=r.left,e.splice(t,1))}const t=e[0],r=e[e.length-1];t.isDash===r.isDash&&(t.left=r.left-this.width,r.right=t.right+this.width);const n=this.width*this.nextRow;let i=0,a=e[i];for(let t=0;t<this.width;t++){t/a.right>1&&(a=e[++i]);const r=Math.abs(t-a.left),o=Math.abs(t-a.right),s=Math.min(r,o);this.data[n+t]=Math.max(0,Math.min(255,(a.isDash?s:-s)+128))}}addDash(e,r){const n=r?7:0,i=2*n+1;if(this.nextRow+i>this.height)return t.w("LineAtlas out of space"),null;let a=0;for(let t=0;t<e.length;t++)a+=e[t];if(0!==a){const t=this.width/a,i=this.getDashRanges(e,this.width,t);r?this.addRoundDash(i,t,n):this.addRegularDash(i)}const o={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:a};return this.nextRow+=i,this.dirty=!0,o}bind(e){const t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}}const I="maplibre_preloaded_worker_pool";class P{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<P.workerCount;)this.workers.push(new Worker(t.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[I]}numActive(){return Object.keys(this.active).length}}const z=Math.floor(o.hardwareConcurrency/2);let B,k;function F(){return B||(B=new P),B}P.workerCount=t.G(globalThis)?Math.max(Math.min(z,3),1):1;class R{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const n=this.workerPool.acquire(r);for(let e=0;e<n.length;e++){const i=new t.H(n[e],r);i.name=`Worker ${e}`,this.actors.push(i)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){const r=[];for(const n of this.actors)r.push(n.sendAsync({type:e,data:t}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((e=>{e.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(const r of this.actors)r.registerMessageHandler(e,t)}}function O(){return k||(k=new R(F(),t.J),k.registerMessageHandler("GR",((e,r,n)=>t.m(r,n)))),k}function L(e,r){const n=t.K();return t.L(n,n,[1,1,0]),t.M(n,n,[.5*e.width,.5*e.height,1]),e.calculatePosMatrix?t.N(n,n,e.calculatePosMatrix(r.toUnwrapped())):n}function q(e,t,r,n,i,a,o){var s;const l=function(e,t,r){if(e)for(const n of e){const e=t[n];if(e&&e.source===r&&"fill-extrusion"===e.type)return!0}else for(const e in t){const n=t[e];if(n.source===r&&"fill-extrusion"===n.type)return!0}return!1}(null!==(s=null==i?void 0:i.layers)&&void 0!==s?s:null,t,e.id),u=a.maxPitchScaleFactor(),c=e.tilesIn(n,u,l);c.sort(j);const h=[];for(const n of c)h.push({wrappedTileID:n.tileID.wrapped().key,queryResults:n.tile.queryRenderedFeatures(t,r,e._state,n.queryGeometry,n.cameraQueryGeometry,n.scale,i,a,u,L(e.transform,n.tileID),o?(e,t)=>o(n.tileID,e,t):void 0)});return function(e,t){for(const r in e)for(const n of e[r])U(n,t);return e}(function(e){const t={},r={};for(const n of e){const e=n.queryResults,i=n.wrappedTileID,a=r[i]=r[i]||{};for(const r in e){const n=e[r],i=a[r]=a[r]||{},o=t[r]=t[r]||[];for(const e of n)i[e.featureIndex]||(i[e.featureIndex]=!0,o.push(e))}}return t}(h),e)}function j(e,t){const r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}function U(e,t){const r=e.feature,n=t.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n}function V(e,r,n){return t._(this,void 0,void 0,(function*(){let i=e;if(e.url?i=(yield t.j(r.transformRequest(e.url,"Source"),n)).data:yield o.frameAsync(n),!i)return null;const a=t.O(t.e(i,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in i&&i.vector_layers&&(a.vectorLayerIds=i.vector_layers.map((e=>e.id))),a}))}class Z{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof t.Q?new t.Q(e.lng,e.lat):t.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof t.Q?new t.Q(e.lng,e.lat):t.Q.convert(e),this}extend(e){const r=this._sw,n=this._ne;let i,a;if(e instanceof t.Q)i=e,a=e;else{if(!(e instanceof Z))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Z.convert(e)):this.extend(t.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(t.Q.convert(e)):this;if(i=e._sw,a=e._ne,!i||!a)return this}return r||n?(r.lng=Math.min(i.lng,r.lng),r.lat=Math.min(i.lat,r.lat),n.lng=Math.max(a.lng,n.lng),n.lat=Math.max(a.lat,n.lat)):(this._sw=new t.Q(i.lng,i.lat),this._ne=new t.Q(a.lng,a.lat)),this}getCenter(){return new t.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new t.Q(this.getWest(),this.getNorth())}getSouthEast(){return new t.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:n}=t.Q.convert(e);let i=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&i}static convert(e){return e instanceof Z?e:e?new Z(e):e}static fromLngLat(e,r=0){const n=360*r/40075017,i=n/Math.cos(Math.PI/180*e.lat);return new Z(new t.Q(e.lng-i,e.lat-n),new t.Q(e.lng+i,e.lat+n))}adjustAntiMeridian(){const e=new t.Q(this._sw.lng,this._sw.lat),r=new t.Q(this._ne.lng,this._ne.lat);return new Z(e,e.lng>r.lng?new t.Q(r.lng+360,r.lat):r)}}class ${constructor(e,t,r){this.bounds=Z.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=r||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),n=Math.floor(t.U(this.bounds.getWest())*r),i=Math.floor(t.S(this.bounds.getNorth())*r),a=Math.ceil(t.U(this.bounds.getEast())*r),o=Math.ceil(t.S(this.bounds.getSouth())*r);return e.x>=n&&e.x<a&&e.y>=i&&e.y<o}}class G extends t.E{constructor(e,r,n,i){if(super(),this.id=e,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.e(this,t.O(r,["url","scheme","tileSize","promoteId"])),this._options=t.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield V(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(t.e(this,e),e.bounds&&(this.tileBounds=new $(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.k(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return t.e({},this._options)}loadTile(e){return t._(this,void 0,void 0,(function*(){const t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};r.request.collectResourceTiming=this._collectResourceTiming;let n="RT";if(e.actor&&"expired"!==e.state){if("loading"===e.state)return new Promise(((t,r)=>{e.reloadPromise={resolve:t,reject:r}}))}else e.actor=this.dispatcher.getActor(),n="LT";e.abortController=new AbortController;try{const t=yield e.actor.sendAsync({type:n,data:r},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,t)}catch(t){if(delete e.abortController,e.aborted)return;if(t&&404!==t.status)throw t;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){const t=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(t.resolve).catch(t.reject)}}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class H extends t.E{constructor(e,r,n,i){super(),this.id=e,this.dispatcher=n,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.e({type:"raster"},r),t.e(this,t.O(r,["url","scheme","tileSize"]))}load(){return t._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield V(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(t.e(this,r),r.bounds&&(this.tileBounds=new $(r.bounds,this.minzoom,this.maxzoom)),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(e){this._tileJSONRequest=null,this.fire(new t.k(e))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return t.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return t._(this,void 0,void 0,(function*(){const t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const r=yield f.getImage(this.map._requestManager.transformRequest(t,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(r&&r.data){this.map._refreshExpiredTiles&&(r.cacheControl||r.expires)&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const t=this.map.painter.context,n=t.gl,i=r.data;e.texture=this.map.painter.getTileTexture(i.width),e.texture?e.texture.update(i,{useMipmap:!0}):(e.texture=new v(t,i,n.RGBA,{useMipmap:!0}),e.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE,n.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}}))}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class W extends H{constructor(e,r,n,i){super(e,r,n,i),this.type="raster-dem",this.maxzoom=22,this._options=t.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return t._(this,void 0,void 0,(function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const r=yield f.getImage(n,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(r&&r.data){const n=r.data;this.map._refreshExpiredTiles&&(r.cacheControl||r.expires)&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});const i=t.b(n)&&t.V()?n:yield this.readImageNow(n),a={type:this.type,uid:e.uid,source:this.id,rawImageData:i,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||"expired"===e.state){e.actor=this.dispatcher.getActor();const t=yield e.actor.sendAsync({type:"LDT",data:a});e.dem=t,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}}))}readImageNow(e){return t._(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&t.W()){const r=e.width+2,n=e.height+2;try{return new t.R({width:r,height:n},yield t.X(e,-1,-1,r,n))}catch(e){}}return o.getImageData(e,1)}))}_getNeighboringTiles(e){const r=e.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,a=0===r.x?e.wrap-1:e.wrap,o=(r.x+1+n)%n,s=r.x+1===n?e.wrap+1:e.wrap,l={};return l[new t.Y(e.overscaledZ,a,r.z,i,r.y).key]={backfilled:!1},l[new t.Y(e.overscaledZ,s,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(l[new t.Y(e.overscaledZ,a,r.z,i,r.y-1).key]={backfilled:!1},l[new t.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new t.Y(e.overscaledZ,s,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new t.Y(e.overscaledZ,a,r.z,i,r.y+1).key]={backfilled:!1},l[new t.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new t.Y(e.overscaledZ,s,r.z,o,r.y+1).key]={backfilled:!1}),l}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class X extends t.E{constructor(e,r,n,i){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=n.getActor(),this.setEventedParent(i),this._data=r.data,this._options=t.e({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,void 0!==r.clusterMaxZoom&&this.maxzoom<=r.clusterMaxZoom&&t.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=t.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(void 0!==r.buffer?r.buffer:128),tolerance:this._pixelsToTileUnits(void 0!==r.tolerance?r.tolerance:.375),extent:t.Z,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.Z,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(t.Z/this.tileSize)}load(){return t._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return t._(this,void 0,void 0,(function*(){const e=t.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getCoordinatesFromGeometry(e){return"GeometryCollection"===e.type?e.geometries.map((e=>e.coordinates)).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return t._(this,void 0,void 0,(function*(){const e=new Z,t=yield this.getData();let r;switch(t.type){case"FeatureCollection":r=t.features.map((e=>this.getCoordinatesFromGeometry(e.geometry))).flat(1/0);break;case"Feature":r=this.getCoordinatesFromGeometry(t.geometry);break;default:r=this.getCoordinatesFromGeometry(t)}if(0==r.length)return e;for(let t=0;t<r.length-1;t+=2)e.extend([r[t],r[t+1]]);return e}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(void 0!==e.clusterRadius&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),void 0!==e.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,r){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:r}})}_updateWorkerData(e){return t._(this,void 0,void 0,(function*(){const r=t.e({type:this.type},this.workerOptions);e?r.dataDiff=e:"string"==typeof this._data?(r.request=this.map._requestManager.transformRequest(o.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new t.l("dataloading",{dataType:"source"}));try{const e=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||e.abandoned)return void this.fire(new t.l("dataabort",{dataType:"source"}));let n=null;e.resourceTiming&&e.resourceTiming[this.id]&&(n=e.resourceTiming[this.id].slice(0));const i={dataType:"source"};this._collectResourceTiming&&n&&n.length>0&&t.e(i,{resourceTiming:n}),this.fire(new t.l("data",Object.assign(Object.assign({},i),{sourceDataType:"metadata"}))),this.fire(new t.l("data",Object.assign(Object.assign({},i),{sourceDataType:"content"})))}catch(e){if(this._pendingLoads--,this._removed)return void this.fire(new t.l("dataabort",{dataType:"source"}));this.fire(new t.k(e))}}))}loaded(){return 0===this._pendingLoads}loadTile(e){return t._(this,void 0,void 0,(function*(){const t=e.actor?"RT":"LT";e.actor=this.actor;const r={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const n=yield this.actor.sendAsync({type:t,data:r},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(n,this.map.painter,"RT"===t)}))}abortTile(e){return t._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return t._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return t.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Y extends t.E{constructor(e,t,r,n){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t}load(e){return t._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new t.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const t=yield f.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(e){this._request=null,this._loaded=!0,this.fire(new t.k(e))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(t.$.fromLngLat);var n;return this.tileID=function(e){let r=1/0,n=1/0,i=-1/0,a=-1/0;for(const t of e)r=Math.min(r,t.x),n=Math.min(n,t.y),i=Math.max(i,t.x),a=Math.max(a,t.y);const o=Math.max(i-r,a-n),s=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),l=Math.pow(2,s);return new t.a1(s,Math.floor((r+i)/2*l),Math.floor((n+a)/2*l))}(r),this.terrainTileRanges=this._getOverlappingTileRanges(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map((e=>this.tileID.getTilePoint(e)._round())),this.flippedWindingOrder=((n=this.tileCoords)[1].x-n[0].x)*(n[2].y-n[0].y)-(n[1].y-n[0].y)*(n[2].x-n[0].x)<0,this.fire(new t.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new v(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let n=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,n=!0)}n&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return t._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){let r=1/0,n=1/0,i=-1/0,a=-1/0;for(const t of e)r=Math.min(r,t.x),n=Math.min(n,t.y),i=Math.max(i,t.x),a=Math.max(a,t.y);const o={};for(let e=0;e<=t.a0;e++){const t=Math.pow(2,e),s=Math.floor(r*t),l=Math.floor(n*t),u=Math.floor(i*t),c=Math.floor(a*t);o[e]={minTileX:s,minTileY:l,maxTileX:u,maxTileY:c}}return o}}class K extends Y{constructor(e,t,r,n){super(e,t,r,n),this.roundZoom=!0,this.type="video",this.options=t}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{const e=yield t.a2(this.urls);if(this._loaded=!0,!e)return;this.video=e,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(e){this.fire(new t.k(e))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new t.k(new t.a3(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new v(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let n=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,n=!0)}n&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class J extends Y{constructor(e,r,n,i){super(e,r,n,i),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new t.k(new t.a3(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.k(new t.a3(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.k(new t.a3(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof HTMLCanvasElement||this.fire(new t.k(new t.a3(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.k(new t.a3(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){return t._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const r=this.map.painter.context,n=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v(r,this.canvas,n.RGBA,{premultiply:!0});let i=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,i=!0)}i&&this.fire(new t.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Q={},ee=e=>{switch(e){case"geojson":return X;case"image":return Y;case"raster":return H;case"raster-dem":return W;case"vector":return G;case"video":return K;case"canvas":return J}return Q[e]},te="RTLPluginLoaded";class re extends t.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=O()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((e=>{throw this.status="error",e}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return t._(this,arguments,void 0,(function*(e,t=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=o.resolveURL(e),!this.url)throw new Error(`requested url ${e} is invalid`);if("unavailable"===this.status){if(!t)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()}))}_requestImport(){return t._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new t.l(te))}))}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let ne=null;function ie(){return ne||(ne=new re),ne}class ae{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=t.a4(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const t=e+this.timeAdded;t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const r={};if(!t)return r;for(const n of e){const e=n.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)r[t.id]=n}}return r}(e.buckets,null==r?void 0:r.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const r=this.buckets[e];if(r instanceof t.a6){if(this.hasSymbolBuckets=!0,!n)break;r.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const r=this.buckets[e];if(r instanceof t.a6&&r.hasRTLText){this.hasRTLText=!0,ie().lazyLoad();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(e).queryRadius(t))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const t in this.buckets){const r=this.buckets[t];r.uploadPending()&&r.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new v(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new v(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,n,i,a,o,s,l,u,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:i,scale:a,tileSize:this.tileSize,pixelPosMatrix:u,transform:s,params:o,queryPadding:this.queryPadding*l,getElevation:c},e,t,r):{}}querySourceFeatures(e,r){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const i=n.loadVTLayers(),a=r&&r.sourceLayer?r.sourceLayer:"",o=i._geojsonTileLayer||i[a];if(!o)return;const s=t.a7(r&&r.filter),{z:l,x:u,y:c}=this.tileID.canonical,h={z:l,x:u,y:c};for(let r=0;r<o.length;r++){const i=o.feature(r);if(s.needGeometry){const e=t.a8(i,!0);if(!s.filter(new t.C(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!s.filter(new t.C(this.tileID.overscaledZ),i))continue;const p=n.getId(i,a),d=new t.a9(i,l,u,c,p);d.tile=h,e.push(d)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const r=t.aa(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(r)if(this.expirationTime<r)t=!0;else{const n=this.expirationTime-r;n?this.expirationTime=e+Math.max(n,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;const r=this.latestFeatureIndex.loadVTLayers();for(const n in this.buckets){if(!t.style.hasLayer(n))continue;const i=this.buckets[n],a=i.layers[0].sourceLayer||"_geojsonTileLayer",o=r[a],s=e[a];if(!o||!s||0===Object.keys(s).length)continue;i.update(s,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=t&&t.style&&t.style.getLayer(n);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(i)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=o.now()+e}setDependencies(e,t){const r={};for(const e of t)r[e]=!0;this.dependencies[e]=r}hasDependency(e,t){for(const r of e){const e=this.dependencies[r];if(e)for(const r of t)if(e[r])return!0}return!1}}class oe{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){const n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const i={value:t,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout((()=>{this.remove(e,i)}),r)),this.data[n].push(i),this.order.push(n),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const r in this.data)for(const n of this.data[r])e(n.value)||t.push(n);for(const e of t)this.remove(e.value.tileID,e)}}class se{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,n){const i=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},t.e(this.stateChanges[e][i],n),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==i&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][i]){this.deletedStates[e][i]={};for(const t in this.state[e][i])n[t]||(this.deletedStates[e][i][t]=null)}else for(const t in n)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][t]&&delete this.deletedStates[e][i][t]}removeFeatureState(e,t,r){if(null===this.deletedStates[e])return;const n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,r){const n=String(r),i=t.e({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const t=this.deletedStates[e][r];if(null===t)return{};for(const e in t)delete i[e]}return i}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,r){const n={};for(const e in this.stateChanges){this.state[e]=this.state[e]||{};const r={};for(const n in this.stateChanges[e])this.state[e][n]||(this.state[e][n]={}),t.e(this.state[e][n],this.stateChanges[e][n]),r[n]=this.state[e][n];n[e]=r}for(const e in this.deletedStates){this.state[e]=this.state[e]||{};const r={};if(null===this.deletedStates[e])for(const t in this.state[e])r[t]={},this.state[e][t]={};else for(const t in this.deletedStates[e]){if(null===this.deletedStates[e][t])this.state[e][t]={};else for(const r of Object.keys(this.deletedStates[e][t]))delete this.state[e][t][r];r[t]=this.state[e][t]}n[e]=n[e]||{},t.e(n[e],r)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const t in e)e[t].setFeatureState(n,r)}}const le=89.25;function ue(e,r){const n=t.ae(r.lat,-85.051129,t.af);return new t.P(t.U(r.lng)*e,t.S(n)*e)}function ce(e,r){return new t.$(r.x/e,r.y/e).toLngLat()}function he(e){return e.cameraToCenterDistance*Math.min(.85*Math.tan(t.ab(90-e.pitch)),Math.tan(t.ab(le-e.pitch)))}function pe(e,r){const n=e.canonical,i=r/t.ac(n.z),a=n.x+Math.pow(2,n.z)*e.wrap,o=t.ad(new Float64Array(16));return t.L(o,o,[a*i,n.y*i,0]),t.M(o,o,[i/t.Z,i/t.Z,1]),o}function de(e,r,n,i,a){const o=t.$.fromLngLat(e,r),s=a*t.ag(1,e.lat),l=s*Math.cos(t.ab(n)),u=Math.sqrt(s*s-l*l),c=u*Math.sin(t.ab(-i)),h=u*Math.cos(t.ab(-i));return new t.$(o.x+c,o.y+h,o.z+l)}function fe(e,t,r){const n=t.intersectsFrustum(e);if(!r)return n;const i=t.intersectsPlane(r);return 0===n||0===i?0:2===n&&2===i?2:1}function me(e,t,r){let n=0;const i=(r-t)/10;for(let a=0;a<10;a++)n+=i*Math.pow(Math.cos(t+(a+.5)/10*(r-t)),e);return n}function ge(e,r){return function(n,i,a,o,s){const l=2*((e-1)/t.ah(Math.cos(t.ab(le-s))/Math.cos(t.ab(le)))-1),u=Math.acos(a/o),c=2*me(l-1,0,t.ab(s/2)),h=Math.min(t.ab(le),u+t.ab(s/2)),p=me(l-1,Math.min(h,u-t.ab(s/2)),h),d=Math.atan(i/a),f=Math.hypot(i,a);let m=n;return m+=t.ah(o/f/Math.max(.5,Math.cos(t.ab(s/2)))),m+=l*t.ah(Math.cos(d))/2,m-=t.ah(Math.max(1,p/c/r))/2,m}}const ye=ge(9.314,3);function ve(e,r){const n=(r.roundZoom?Math.round:Math.floor)(e.zoom+t.ah(e.tileSize/r.tileSize));return Math.max(0,n)}function xe(e,r){const n=e.getCameraFrustum(),i=e.getClippingPlane(),a=e.screenPointToMercatorCoordinate(e.getCameraPoint()),o=t.$.fromLngLat(e.center,e.elevation);a.z=o.z+Math.cos(e.pitchInRadians)*e.cameraToCenterDistance/e.worldSize;const s=e.getCoveringTilesDetailsProvider(),l=s.allowVariableZoom(e,r),u=ve(e,r),c=r.minzoom||0,h=void 0!==r.maxzoom?r.maxzoom:e.maxZoom,p=Math.min(Math.max(0,u),h),d=Math.pow(2,p),f=[d*a.x,d*a.y,0],m=[d*o.x,d*o.y,0],g=Math.hypot(o.x-a.x,o.y-a.y),y=Math.abs(o.z-a.z),v=Math.hypot(g,y),x=e=>({zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),_=[],b=[];if(e.renderWorldCopies&&s.allowWorldCopies())for(let e=1;e<=3;e++)_.push(x(-e)),_.push(x(e));for(_.push(x(0));_.length>0;){const d=_.pop(),g=d.x,x=d.y;let w=d.fullyVisible;const A={x:g,y:x,z:d.zoom},C=s.getTileAABB(A,d.wrap,e.elevation,r);if(!w){const e=fe(n,C,i);if(0===e)continue;w=2===e}const E=s.distanceToTile2d(a.x,a.y,A,C);let M=u;l&&(M=(r.calculateTileZoom||ye)(e.zoom+t.ah(e.tileSize/r.tileSize),E,y,v,e.fov)),M=(r.roundZoom?Math.round:Math.floor)(M),M=Math.max(0,M);const S=Math.min(M,h);if(d.wrap=s.getWrap(o,A,d.wrap),d.zoom>=S){if(d.zoom<c)continue;const e=p-d.zoom,n=f[0]-.5-(g<<e),i=f[1]-.5-(x<<e),a=r.reparseOverscaled?Math.max(d.zoom,M):d.zoom;b.push({tileID:new t.Y(d.zoom===h?a:d.zoom,d.wrap,d.zoom,g,x),distanceSq:t.ai([m[0]-.5-g,m[1]-.5-x]),tileDistanceToCamera:Math.sqrt(n*n+i*i)})}else for(let e=0;e<4;e++)_.push({zoom:d.zoom+1,x:(g<<1)+e%2,y:(x<<1)+(e>>1),wrap:d.wrap,fullyVisible:w})}return b.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}class _e extends t.E{constructor(e,t,r){super(),this.id=e,this.dispatcher=r,this.on("data",(e=>this._dataHandler(e))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((e,t,r,n)=>{const i=new(ee(t.type))(e,t,r,n);if(i.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${i.id}`);return i})(e,t,r,this),this._tiles={},this._cache=new oe(0,(e=>this._unloadTile(e))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new se,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,n){return t._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,n)}catch(r){e.state="errored",404!==r.status?this._source.fire(new t.k(r,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new t.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(be).map((e=>e.key))}getRenderableIds(e){const r=[];for(const t in this._tiles)this._isIdRenderable(t,e)&&r.push(this._tiles[t]);return e?r.sort(((e,r)=>{const n=e.tileID,i=r.tileID,a=new t.P(n.canonical.x,n.canonical.y)._rotate(-this.transform.bearingInRadians),o=new t.P(i.canonical.x,i.canonical.y)._rotate(-this.transform.bearingInRadians);return n.overscaledZ-i.overscaledZ||o.y-a.y||o.x-a.x})).map((e=>e.tileID.key)):r.map((e=>e.tileID)).sort(be).map((e=>e.key))}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)(e||"errored"!==this._tiles[t].state)&&this._reloadTile(t,"reloading")}}_reloadTile(e,r){return t._(this,void 0,void 0,(function*(){const t=this._tiles[e];t&&("loading"!==t.state&&(t.state=r),yield this._loadTile(t,e,r))}))}_tileLoaded(e,r,n){e.timeAdded=o.now(),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const t=this.getRenderableIds();for(let n=0;n<t.length;n++){const i=t[n];if(e.neighboringTiles&&e.neighboringTiles[i]){const t=this.getTileByID(i);r(e,t),r(t,e)}}function r(e,t){e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let r=t.tileID.canonical.x-e.tileID.canonical.x;const n=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,r,n){for(const i in this._tiles){let a=this._tiles[i];if(n[i]||!a.hasData()||a.tileID.overscaledZ<=t||a.tileID.overscaledZ>r)continue;let o=a.tileID;for(;a&&a.tileID.overscaledZ>t+1;){const e=a.tileID.scaledTo(a.tileID.overscaledZ-1);a=this._tiles[e.key],a&&a.hasData()&&(o=e)}let s=o;for(;s.overscaledZ>t;)if(s=s.scaledTo(s.overscaledZ-1),e[s.key]||e[s.canonical.key]){n[o.key]=o;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(let r=e.overscaledZ-1;r>=t;r--){const t=e.scaledTo(r),n=this._getLoadedTile(t);if(n)return n}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,n=Math.ceil(e.height/this._source.tileSize)+1,i=Math.floor(r*n*(null===this._maxTileCacheZoomLevels?t.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(a)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const r in this._tiles){const n=this._tiles[r];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),e[n.tileID.key]=n}this._tiles=e;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(e,this._tiles[e])}}_updateCoveredAndRetainedTiles(e,t,r,n,i,a){const s={},l={},u=Object.keys(e),c=o.now();for(const r of u){const n=e[r],i=this._tiles[r];if(!i||0!==i.fadeEndTime&&i.fadeEndTime<=c)continue;const a=this.findLoadedParent(n,t),o=this.findLoadedSibling(n),u=a||o||null;u&&(this._addTile(u.tileID),s[u.tileID.key]=u.tileID),l[r]=n}this._retainLoadedChildren(l,n,r,e);for(const t in s)e[t]||(this._coveredTiles[t]=!0,e[t]=s[t]);if(a){const t={},r={};for(const e of i)this._tiles[e.key].hasData()?t[e.key]=e:r[e.key]=e;for(const n in r){const i=r[n].children(this._source.maxzoom);this._tiles[i[0].key]&&this._tiles[i[1].key]&&this._tiles[i[2].key]&&this._tiles[i[3].key]&&(t[i[0].key]=e[i[0].key]=i[0],t[i[1].key]=e[i[1].key]=i[1],t[i[2].key]=e[i[2].key]=i[2],t[i[3].key]=e[i[3].key]=i[3],delete r[n])}for(const n in r){const i=r[n],a=this.findLoadedParent(i,this._source.minzoom),o=this.findLoadedSibling(i),s=a||o||null;if(s){t[s.tileID.key]=e[s.tileID.key]=s.tileID;for(const e in t)t[e].isChildOf(s.tileID)&&delete t[e]}}for(const e in this._tiles)t[e]||(this._coveredTiles[e]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;let n;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?n=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((e=>new t.Y(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y))):(n=xe(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(n=n.filter((e=>this._source.hasTile(e))))):n=[];const i=ve(e,this._source),a=Math.max(i-_e.maxOverzooming,this._source.minzoom),o=Math.max(i+_e.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const e={};for(const t of n)if(t.canonical.z>this._source.minzoom){const r=t.scaledTo(t.canonical.z-1);e[r.key]=r;const n=t.scaledTo(Math.max(this._source.minzoom,Math.min(t.canonical.z,5)));e[n.key]=n}n=n.concat(Object.values(e))}const s=0===n.length&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new t.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const l=this._updateRetainedTiles(n,i);we(this._source.type)&&this._updateCoveredAndRetainedTiles(l,a,o,i,n,r);for(const e in l)this._tiles[e].clearFadeHold();const u=t.aj(this._tiles,l);for(const e of u){const t=this._tiles[e];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(e)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){var r;const n={},i={},a=Math.max(t-_e.maxOverzooming,this._source.minzoom),o=Math.max(t+_e.maxUnderzooming,this._source.minzoom),s={};for(const r of e){const e=this._addTile(r);n[r.key]=r,e.hasData()||t<this._source.maxzoom&&(s[r.key]=r)}this._retainLoadedChildren(s,t,o,n);for(const o of e){let e=this._tiles[o.key];if(e.hasData())continue;if(t+1>this._source.maxzoom){const e=o.children(this._source.maxzoom)[0],t=this.getTile(e);if(t&&t.hasData()){n[e.key]=e;continue}}else{const e=o.children(this._source.maxzoom);if(n[e[0].key]&&n[e[1].key]&&n[e[2].key]&&n[e[3].key])continue}let s=e.wasRequested();for(let t=o.overscaledZ-1;t>=a;--t){const a=o.scaledTo(t);if(i[a.key])break;if(i[a.key]=!0,e=this.getTile(a),!e&&s&&(e=this._addTile(a)),e){const t=e.hasData();if((t||!(null===(r=this.map)||void 0===r?void 0:r.cancelPendingTileRequestsWhileZooming)||s)&&(n[a.key]=a),s=e.wasRequested(),t)break}}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let r,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}t.push(n.key);const e=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(e),r)break;n=e}for(const e of t)this._loadedParentTiles[e]=r}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const t=this._tiles[e].tileID,r=this._getLoadedTile(t);this._loadedSiblingTiles[t.key]=r}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const n=r;return r||(r=new ae(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,n||this._source.fire(new t.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),r))}refreshTiles(e){for(const t in this._tiles)this._isIdRenderable(t)&&e.some((e=>e.equals(this._tiles[t].tileID.canonical)))&&this._reloadTile(t,"expired")}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){const t=e.sourceDataType;"source"===e.dataType&&"metadata"===t&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===t&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,n){const i=[],a=this.transform;if(!a)return i;const o=n?a.getCameraQueryGeometry(e):e,s=e.map((e=>a.screenPointToMercatorCoordinate(e,this.terrain))),l=o.map((e=>a.screenPointToMercatorCoordinate(e,this.terrain))),u=this.getIds();let c=1/0,h=1/0,p=-1/0,d=-1/0;for(const e of l)c=Math.min(c,e.x),h=Math.min(h,e.y),p=Math.max(p,e.x),d=Math.max(d,e.y);for(let e=0;e<u.length;e++){const n=this._tiles[u[e]];if(n.holdingForFade())continue;const o=a.getCoveringTilesDetailsProvider().allowWorldCopies()?n.tileID:n.tileID.unwrapTo(0),f=Math.pow(2,a.zoom-n.tileID.overscaledZ),m=r*n.queryPadding*t.Z/n.tileSize/f,g=[o.getTilePoint(new t.$(c,h)),o.getTilePoint(new t.$(p,d))];if(g[0].x-m<t.Z&&g[0].y-m<t.Z&&g[1].x+m>=0&&g[1].y+m>=0){const e=s.map((e=>o.getTilePoint(e))),t=l.map((e=>o.getTilePoint(e)));i.push({tile:n,tileID:o,queryGeometry:e,cameraQueryGeometry:t,scale:f})}}return i}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map((e=>this._tiles[e].tileID));return this.transform&&this.transform.populateCache(t),t}hasTransition(){if(this._source.hasTransition())return!0;if(we(this._source.type)){const e=o.now();for(const t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)}removeFeatureState(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,r){const n=this._tiles[e];n&&n.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(const r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter((r=>!r.hasDependency(e,t)))}}function be(e,t){const r=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function we(e){return"raster"===e||"image"===e||"video"===e}_e.maxOverzooming=10,_e.maxUnderzooming=3;class Ae{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let e=1;e<this.points.length;e++)this._distances[e]=this._distances[e-1]+this.points[e].dist(this.points[e-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.ae(e,0,1);let r=1,n=this._distances[r];const i=e*this.paddedLength+this.padding;for(;n<i&&r<this._distances.length;)n=this._distances[++r];const a=r-1,o=this._distances[a],s=n-o,l=s>0?(i-o)/s:0;return this.points[a].mult(1-l).add(this.points[r].mult(l))}}function Ce(e,t){let r=!0;return"always"===e||"never"!==e&&"never"!==t||(r=!1),r}class Ee{constructor(e,t,r){const n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let e=0;e<this.xCellCount*this.yCellCount;e++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}insertCircle(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}_insertBoxCell(e,t,r,n,i,a){this.boxCells[i].push(a)}_insertCircleCell(e,t,r,n,i,a){this.circleCells[i].push(a)}_query(e,t,r,n,i,a,o){if(r<0||e>this.width||n<0||t>this.height)return[];const s=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return[{key:null,x1:e,y1:t,x2:r,y2:n}];for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],r=this.circles[3*e+1],n=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:t-n,y1:r-n,x2:t+n,y2:r+n})}}else this._forEachCell(e,t,r,n,this._queryCell,s,{hitTest:i,overlapMode:a,seenUids:{box:{},circle:{}}},o);return s}query(e,t,r,n){return this._query(e,t,r,n,!1,null)}hitTest(e,t,r,n,i,a){return this._query(e,t,r,n,!0,i,a).length>0}hitTestCircle(e,t,r,n,i){const a=e-r,o=e+r,s=t-r,l=t+r;if(o<0||a>this.width||l<0||s>this.height)return!1;const u=[];return this._forEachCell(a,s,o,l,this._queryCellCircle,u,{hitTest:!0,overlapMode:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},i),u.length>0}_queryCell(e,t,r,n,i,a,o,s){const{seenUids:l,hitTest:u,overlapMode:c}=o,h=this.boxCells[i];if(null!==h){const i=this.bboxes;for(const o of h)if(!l.box[o]){l.box[o]=!0;const h=4*o,p=this.boxKeys[o];if(e<=i[h+2]&&t<=i[h+3]&&r>=i[h+0]&&n>=i[h+1]&&(!s||s(p))&&(!u||!Ce(c,p.overlapMode))&&(a.push({key:p,x1:i[h],y1:i[h+1],x2:i[h+2],y2:i[h+3]}),u))return!0}}const p=this.circleCells[i];if(null!==p){const i=this.circles;for(const o of p)if(!l.circle[o]){l.circle[o]=!0;const h=3*o,p=this.circleKeys[o];if(this._circleAndRectCollide(i[h],i[h+1],i[h+2],e,t,r,n)&&(!s||s(p))&&(!u||!Ce(c,p.overlapMode))){const e=i[h],t=i[h+1],r=i[h+2];if(a.push({key:p,x1:e-r,y1:t-r,x2:e+r,y2:t+r}),u)return!0}}}return!1}_queryCellCircle(e,t,r,n,i,a,o,s){const{circle:l,seenUids:u,overlapMode:c}=o,h=this.boxCells[i];if(null!==h){const e=this.bboxes;for(const t of h)if(!u.box[t]){u.box[t]=!0;const r=4*t,n=this.boxKeys[t];if(this._circleAndRectCollide(l.x,l.y,l.radius,e[r+0],e[r+1],e[r+2],e[r+3])&&(!s||s(n))&&!Ce(c,n.overlapMode))return a.push(!0),!0}}const p=this.circleCells[i];if(null!==p){const e=this.circles;for(const t of p)if(!u.circle[t]){u.circle[t]=!0;const r=3*t,n=this.circleKeys[t];if(this._circlesCollide(e[r],e[r+1],e[r+2],l.x,l.y,l.radius)&&(!s||s(n))&&!Ce(c,n.overlapMode))return a.push(!0),!0}}}_forEachCell(e,t,r,n,i,a,o,s){const l=this._convertToXCellCoord(e),u=this._convertToYCellCoord(t),c=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n);for(let p=l;p<=c;p++)for(let l=u;l<=h;l++)if(i.call(this,e,t,r,n,this.xCellCount*l+p,a,o,s))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,n,i,a){const o=n-e,s=i-t,l=r+a;return l*l>o*o+s*s}_circleAndRectCollide(e,t,r,n,i,a,o){const s=(a-n)/2,l=Math.abs(e-(n+s));if(l>s+r)return!1;const u=(o-i)/2,c=Math.abs(t-(i+u));if(c>u+r)return!1;if(l<=s||c<=u)return!0;const h=l-s,p=c-u;return h*h+p*p<=r*r}}function Me(e,r,i){const a=t.K();if(!e){const{vecSouth:e,vecEast:t}=De(r),i=n();i[0]=t[0],i[1]=t[1],i[2]=e[0],i[3]=e[1],o=i,(p=(l=(s=i)[0])*(h=s[3])-(c=s[2])*(u=s[1]))&&(o[0]=h*(p=1/p),o[1]=-u*p,o[2]=-c*p,o[3]=l*p),a[0]=i[0],a[1]=i[1],a[4]=i[2],a[5]=i[3]}var o,s,l,u,c,h,p;return t.M(a,a,[1/i,1/i,1]),a}function Se(e,r,n,i){if(e){const e=t.K();if(!r){const{vecSouth:t,vecEast:r}=De(n);e[0]=r[0],e[1]=r[1],e[4]=t[0],e[5]=t[1]}return t.M(e,e,[i,i,1]),e}return n.pixelsToClipSpaceMatrix}function De(e){const r=Math.cos(e.rollInRadians),n=Math.sin(e.rollInRadians),i=Math.cos(e.pitchInRadians),a=Math.cos(e.bearingInRadians),o=Math.sin(e.bearingInRadians),s=t.ao();s[0]=-a*i*n-o*r,s[1]=-o*i*n+a*r;const l=t.ap(s);l<1e-9?t.aq(s):t.ar(s,s,1/l);const u=t.ao();u[0]=a*i*r-o*n,u[1]=o*i*r+a*n;const c=t.ap(u);return c<1e-9?t.aq(u):t.ar(u,u,1/c),{vecEast:u,vecSouth:s}}function Te(e,r,n,i){let a;i?(a=[e,r,i(e,r),1],t.at(a,a,n)):(a=[e,r,0,1],Ge(a,a,n));const o=a[3];return{point:new t.P(a[0]/o,a[1]/o),signedDistanceFromCamera:o,isOccluded:!1}}function Ne(e,t){return.5+e/t*.5}function Ie(e,t){return e.x>=-t[0]&&e.x<=t[0]&&e.y>=-t[1]&&e.y<=t[1]}function Pe(e,r,n,i,a,o,s,l,u,c,h,p,d){const f=n?e.textSizeData:e.iconSizeData,m=t.ak(f,r.transform.zoom),g=[256/r.width*2+1,256/r.height*2+1],y=n?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;y.clear();const v=e.lineVertexArray,x=n?e.text.placedSymbolArray:e.icon.placedSymbolArray,_=r.transform.width/r.transform.height;let b=!1;for(let n=0;n<x.length;n++){const w=x.get(n);if(w.hidden||w.writingMode===t.al.vertical&&!b){$e(w.numGlyphs,y);continue}b=!1;const A=new t.P(w.anchorX,w.anchorY),C={getElevation:d,pitchedLabelPlaneMatrix:i,lineVertexArray:v,pitchWithMap:o,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:r.transform,tileAnchorPoint:A,unwrappedTileID:u,width:c,height:h,translation:p},E=qe(w.anchorX,w.anchorY,C);if(!Ie(E.point,g)){$e(w.numGlyphs,y);continue}const M=Ne(r.transform.cameraToCenterDistance,E.signedDistanceFromCamera),S=t.am(f,m,w),D=o?S*r.transform.getPitchedTextCorrection(w.anchorX,w.anchorY,u)/M:S*M,T=ke({projectionContext:C,pitchedLabelPlaneMatrixInverse:a,symbol:w,fontSize:D,flip:!1,keepUpright:s,glyphOffsetArray:e.glyphOffsetArray,dynamicLayoutVertexArray:y,aspectRatio:_,rotateToLine:l});b=T.useVertical,(T.notEnoughRoom||b||T.needsFlipping&&ke({projectionContext:C,pitchedLabelPlaneMatrixInverse:a,symbol:w,fontSize:D,flip:!0,keepUpright:s,glyphOffsetArray:e.glyphOffsetArray,dynamicLayoutVertexArray:y,aspectRatio:_,rotateToLine:l}).notEnoughRoom)&&$e(w.numGlyphs,y)}n?e.text.dynamicLayoutVertexBuffer.updateData(y):e.icon.dynamicLayoutVertexBuffer.updateData(y)}function ze(e,t,r,n,i,a,o,s){const l=a.glyphStartIndex+a.numGlyphs,u=a.lineStartIndex,c=a.lineStartIndex+a.lineLength,h=t.getoffsetX(a.glyphStartIndex),p=t.getoffsetX(l-1),d=Ve(e*h,r,n,i,a.segment,u,c,s,o);if(!d)return null;const f=Ve(e*p,r,n,i,a.segment,u,c,s,o);return f?s.projectionCache.anyProjectionOccluded?null:{first:d,last:f}:null}function Be(e,r,n,i){return e===t.al.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*i?{useVertical:!0}:(e===t.al.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function ke(e){const{projectionContext:r,pitchedLabelPlaneMatrixInverse:n,symbol:i,fontSize:a,flip:o,keepUpright:s,glyphOffsetArray:l,dynamicLayoutVertexArray:u,aspectRatio:c,rotateToLine:h}=e,p=a/24,d=i.lineOffsetX*p,f=i.lineOffsetY*p;let m;if(i.numGlyphs>1){const e=i.glyphStartIndex+i.numGlyphs,t=i.lineStartIndex,a=i.lineStartIndex+i.lineLength,u=ze(p,l,d,f,o,i,h,r);if(!u)return{notEnoughRoom:!0};const g=Le(u.first.point.x,u.first.point.y,r,n),y=Le(u.last.point.x,u.last.point.y,r,n);if(s&&!o){const e=Be(i.writingMode,g,y,c);if(e)return e}m=[u.first];for(let n=i.glyphStartIndex+1;n<e-1;n++)m.push(Ve(p*l.getoffsetX(n),d,f,o,i.segment,t,a,r,h));m.push(u.last)}else{if(s&&!o){const e=Oe(r.tileAnchorPoint.x,r.tileAnchorPoint.y,r).point,a=i.lineStartIndex+i.segment+1,o=new t.P(r.lineVertexArray.getx(a),r.lineVertexArray.gety(a)),s=Oe(o.x,o.y,r),l=s.signedDistanceFromCamera>0?s.point:Fe(r.tileAnchorPoint,o,e,1,r),u=Le(e.x,e.y,r,n),h=Le(l.x,l.y,r,n),p=Be(i.writingMode,u,h,c);if(p)return p}const e=Ve(p*l.getoffsetX(i.glyphStartIndex),d,f,o,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,r,h);if(!e||r.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};m=[e]}for(const e of m)t.as(u,e.point,e.angle);return{}}function Fe(e,t,r,n,i){const a=e.add(e.sub(t)._unit()),o=Oe(a.x,a.y,i).point,s=r.sub(o);return r.add(s._mult(n/s.mag()))}function Re(e,r,n){const i=r.projectionCache;if(i.projections[e])return i.projections[e];const a=new t.P(r.lineVertexArray.getx(e),r.lineVertexArray.gety(e)),o=Oe(a.x,a.y,r);if(o.signedDistanceFromCamera>0)return i.projections[e]=o.point,i.anyProjectionOccluded=i.anyProjectionOccluded||o.isOccluded,o.point;const s=e-n.direction;return Fe(0===n.distanceFromAnchor?r.tileAnchorPoint:new t.P(r.lineVertexArray.getx(s),r.lineVertexArray.gety(s)),a,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,r)}function Oe(e,t,r){const n=e+r.translation[0],i=t+r.translation[1];let a;return r.pitchWithMap?(a=Te(n,i,r.pitchedLabelPlaneMatrix,r.getElevation),a.isOccluded=!1):(a=r.transform.projectTileCoordinates(n,i,r.unwrappedTileID,r.getElevation),a.point.x=(.5*a.point.x+.5)*r.width,a.point.y=(.5*-a.point.y+.5)*r.height),a}function Le(e,r,n,i){if(n.pitchWithMap){const a=[e,r,0,1];return t.at(a,a,i),n.transform.projectTileCoordinates(a[0]/a[3],a[1]/a[3],n.unwrappedTileID,n.getElevation).point}return{x:e/n.width*2-1,y:r/n.height*2-1}}function qe(e,t,r){return r.transform.projectTileCoordinates(e,t,r.unwrappedTileID,r.getElevation)}function je(e,t,r){return e._unit()._perp()._mult(t*r)}function Ue(e,r,n,i,a,o,s,l,u){if(l.projectionCache.offsets[e])return l.projectionCache.offsets[e];const c=n.add(r);if(e+u.direction<i||e+u.direction>=a)return l.projectionCache.offsets[e]=c,c;const h=Re(e+u.direction,l,u),p=je(h.sub(n),s,u.direction),d=n.add(p),f=h.add(p);return l.projectionCache.offsets[e]=t.au(o,c,d,f)||c,l.projectionCache.offsets[e]}function Ve(e,t,r,n,i,a,o,s,l){const u=n?e-t:e+t;let c=u>0?1:-1,h=0;n&&(c*=-1,h=Math.PI),c<0&&(h+=Math.PI);let p,d=c>0?a+i:a+i+1;s.projectionCache.cachedAnchorPoint?p=s.projectionCache.cachedAnchorPoint:(p=Oe(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,s.projectionCache.cachedAnchorPoint=p);let f,m,g=p,y=p,v=0,x=0;const _=Math.abs(u),b=[];let w;for(;v+x<=_;){if(d+=c,d<a||d>=o)return null;v+=x,y=g,m=f;const e={absOffsetX:_,direction:c,distanceFromAnchor:v,previousVertex:y};if(g=Re(d,s,e),0===r)b.push(y),w=g.sub(y);else{let t;const n=g.sub(y);t=0===n.mag()?je(Re(d+c,s,e).sub(g),r,c):je(n,r,c),m||(m=y.add(t)),f=Ue(d,t,g,a,o,m,r,s,e),b.push(m),w=f.sub(m)}x=w.mag()}const A=w._mult((_-v)/x)._add(m||y),C=h+Math.atan2(g.y-y.y,g.x-y.x);return b.push(A),{point:A,angle:l?C:0,path:b}}const Ze=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function $e(e,t){for(let r=0;r<e;r++){const e=t.length;t.resize(e+4),t.float32.set(Ze,3*e)}}function Ge(e,t,r){const n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e[3]=r[3]*n+r[7]*i+r[15],e}const He=100;class We{constructor(e,t=new Ee(e.width+200,e.height+200,25),r=new Ee(e.width+200,e.height+200,25)){this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+He,this.screenBottomBoundary=e.height+He,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,r,n,i,a,o,s,l,u,c,h){const p=this.projectAndGetPerspectiveRatio(e.anchorPointX+s[0],e.anchorPointY+s[1],i,u,h),d=r*p.perspectiveRatio;let f;if(a||o)f=this._projectCollisionBox(e,d,n,i,a,o,s,p,u,c,h);else{const t=p.x+(c?c.x*d:0),r=p.y+(c?c.y*d:0);f={allPointsOccluded:!1,box:[t+e.x1*d,r+e.y1*d,t+e.x2*d,r+e.y2*d]}}const[m,g,y,v]=f.box,x=a?f.allPointsOccluded:p.isOccluded;let _=x;return _||(_=p.perspectiveRatio<this.perspectiveRatioCutoff),_||(_=!this.isInsideGrid(m,g,y,v)),_||"always"!==t&&this.grid.hitTest(m,g,y,v,t,l)?{box:[m,g,y,v],placeable:!1,offscreen:!1,occluded:x}:{box:[m,g,y,v],placeable:!0,offscreen:this.isOffscreen(m,g,y,v),occluded:x}}placeCollisionCircles(e,r,n,i,a,o,s,l,u,c,h,p,d,f){const m=[],g=new t.P(r.anchorX,r.anchorY),y=this.getPerspectiveRatio(g.x,g.y,o,f),v=(u?a*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,o)/y:a*y)/t.ay,x={getElevation:f,pitchedLabelPlaneMatrix:s,lineVertexArray:n,pitchWithMap:u,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:g,unwrappedTileID:o,width:this.transform.width,height:this.transform.height,translation:d},_=ze(v,i,r.lineOffsetX*v,r.lineOffsetY*v,!1,r,!1,x);let b=!1,w=!1,A=!0;if(_){const r=.5*h*y+p,n=new t.P(-100,-100),i=new t.P(this.screenRightBoundary,this.screenBottomBoundary),a=new Ae,o=_.first,s=_.last;let d=[];for(let e=o.path.length-1;e>=1;e--)d.push(o.path[e]);for(let e=1;e<s.path.length;e++)d.push(s.path[e]);const f=2.5*r;if(u){const e=this.projectPathToScreenSpace(d,x);d=e.some((e=>e.signedDistanceFromCamera<=0))?[]:e.map((e=>e.point))}let g=[];if(d.length>0){const e=d[0].clone(),r=d[0].clone();for(let t=1;t<d.length;t++)e.x=Math.min(e.x,d[t].x),e.y=Math.min(e.y,d[t].y),r.x=Math.max(r.x,d[t].x),r.y=Math.max(r.y,d[t].y);g=e.x>=n.x&&r.x<=i.x&&e.y>=n.y&&r.y<=i.y?[d]:r.x<n.x||e.x>i.x||r.y<n.y||e.y>i.y?[]:t.av([d],n.x,n.y,i.x,i.y)}for(const t of g){a.reset(t,.25*r);let n=0;n=a.length<=.5*r?1:Math.ceil(a.paddedLength/f)+1;for(let t=0;t<n;t++){const i=t/Math.max(n-1,1),o=a.lerp(i),s=o.x+He,u=o.y+He;m.push(s,u,r,0);const h=s-r,p=u-r,d=s+r,f=u+r;if(A=A&&this.isOffscreen(h,p,d,f),w=w||this.isInsideGrid(h,p,d,f),"always"!==e&&this.grid.hitTestCircle(s,u,r,e,c)&&(b=!0,!l))return{circles:[],offscreen:!1,collisionDetected:b}}}}return{circles:!l&&b||!w||y<this.perspectiveRatioCutoff?[]:m,offscreen:A,collisionDetected:b}}projectPathToScreenSpace(e,r){const n=function(e,r){const n=t.K();return t.an(n,r.pitchedLabelPlaneMatrix),e.map((e=>{const t=Te(e.x,e.y,n,r.getElevation),i=r.transform.projectTileCoordinates(t.point.x,t.point.y,r.unwrappedTileID,r.getElevation);return i.point.x=(.5*i.point.x+.5)*r.width,i.point.y=(.5*-i.point.y+.5)*r.height,i}))}(e,r);return function(e){let t=0,r=0,n=0,i=0;for(let a=0;a<e.length;a++)e[a].isOccluded?(n=a+1,i=0):(i++,i>r&&(r=i,t=n));return e.slice(t,t+r)}(n)}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const r=[];let n=1/0,i=1/0,a=-1/0,o=-1/0;for(const s of e){const e=new t.P(s.x+He,s.y+He);n=Math.min(n,e.x),i=Math.min(i,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y),r.push(e)}const s=this.grid.query(n,i,a,o).concat(this.ignoredGrid.query(n,i,a,o)),l={},u={};for(const e of s){const n=e.key;if(void 0===l[n.bucketInstanceId]&&(l[n.bucketInstanceId]={}),l[n.bucketInstanceId][n.featureIndex])continue;const i=[new t.P(e.x1,e.y1),new t.P(e.x2,e.y1),new t.P(e.x2,e.y2),new t.P(e.x1,e.y2)];t.aw(r,i)&&(l[n.bucketInstanceId][n.featureIndex]=!0,void 0===u[n.bucketInstanceId]&&(u[n.bucketInstanceId]=[]),u[n.bucketInstanceId].push(n.featureIndex))}return u}insertCollisionBox(e,t,r,n,i,a){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:a,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,n,i,a){const o=r?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:i,collisionGroupID:a,overlapMode:t};for(let t=0;t<e.length;t+=4)o.insertCircle(s,e[t],e[t+1],e[t+2])}projectAndGetPerspectiveRatio(e,r,n,i,a){if(a){let n;i?(n=[e,r,i(e,r),1],t.at(n,n,a)):(n=[e,r,0,1],Ge(n,n,a));const o=n[3];return{x:(n[0]/o+1)/2*this.transform.width+He,y:(-n[1]/o+1)/2*this.transform.height+He,perspectiveRatio:.5+this.transform.cameraToCenterDistance/o*.5,isOccluded:!1,signedDistanceFromCamera:o}}{const t=this.transform.projectTileCoordinates(e,r,n,i);return{x:(t.point.x+1)/2*this.transform.width+He,y:(1-t.point.y)/2*this.transform.height+He,perspectiveRatio:.5+this.transform.cameraToCenterDistance/t.signedDistanceFromCamera*.5,isOccluded:t.isOccluded,signedDistanceFromCamera:t.signedDistanceFromCamera}}}getPerspectiveRatio(e,t,r,n){const i=this.transform.projectTileCoordinates(e,t,r,n);return.5+this.transform.cameraToCenterDistance/i.signedDistanceFromCamera*.5}isOffscreen(e,t,r,n){return r<He||e>=this.screenRightBoundary||n<He||t>this.screenBottomBoundary}isInsideGrid(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const e=t.ad([]);return t.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,n,i,a,o,s,l,u,c,h){let p=1,d=0,f=0,m=1;const g=e.anchorPointX+s[0],y=e.anchorPointY+s[1];if(o&&!a){const e=this.projectAndGetPerspectiveRatio(g+1,y,i,u,h),t=e.x-l.x,r=Math.atan((e.y-l.y)/t)+(t<0?Math.PI:0),n=Math.sin(r),a=Math.cos(r);p=a,d=n,f=-n,m=a}else if(!o&&a){const e=De(this.transform);p=e.vecEast[0],d=e.vecEast[1],f=e.vecSouth[0],m=e.vecSouth[1]}let v=l.x,x=l.y,_=r;a&&(v=g,x=y,_=Math.pow(2,-(this.transform.zoom-n.overscaledZ)),_*=this.transform.getPitchedTextCorrection(g,y,i),c||(_*=t.ae(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),c&&(v+=p*c.x*_+f*c.y*_,x+=d*c.x*_+m*c.y*_);const b=e.x1*_,w=e.x2*_,A=(b+w)/2,C=e.y1*_,E=e.y2*_,M=(C+E)/2,S=[{offsetX:b,offsetY:C},{offsetX:A,offsetY:C},{offsetX:w,offsetY:C},{offsetX:w,offsetY:M},{offsetX:w,offsetY:E},{offsetX:A,offsetY:E},{offsetX:b,offsetY:E},{offsetX:b,offsetY:M}];let D=[];for(const{offsetX:e,offsetY:r}of S)D.push(new t.P(v+p*e+f*r,x+d*e+m*r));let T=!1;if(a){const e=D.map((e=>this.projectAndGetPerspectiveRatio(e.x,e.y,i,u,h)));T=e.some((e=>!e.isOccluded)),D=e.map((e=>new t.P(e.x,e.y)))}else T=!0;return{box:t.ax(D),allPointsOccluded:!T}}}class Xe{constructor(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r}isHidden(){return 0===this.opacity&&!this.placed}}class Ye{constructor(e,t,r,n,i){this.text=new Xe(e?e.text:null,t,r,i),this.icon=new Xe(e?e.icon:null,t,n,i)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ke{constructor(e,t,r){this.text=e,this.icon=t,this.skipFade=r}}class Je{constructor(e,t,r,n,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}}class Qe{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function et(e,r,n,i,a){const{horizontalAlign:o,verticalAlign:s}=t.aE(e);return new t.P(-(o-.5)*r+i[0]*a,-(s-.5)*n+i[1]*a)}class tt{constructor(e,t,r,n,i){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new We(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Qe(n),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const t=this.terrain;return t?(r,n)=>t.getElevation(e,r,n):null}getBucketParts(e,r,n,i){const a=n.getBucket(r),o=n.latestFeatureIndex;if(!a||!o||r.id!==a.layerIds[0])return;const s=n.collisionBoxArray,l=a.layers[0].layout,u=a.layers[0].paint,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),h=n.tileSize/t.Z,p=n.tileID.toUnwrapped(),d="map"===l.get("text-rotation-alignment"),f=t.az(n,1,this.transform.zoom),m=t.aA(this.collisionIndex.transform,n,u.get("text-translate"),u.get("text-translate-anchor")),g=t.aA(this.collisionIndex.transform,n,u.get("icon-translate"),u.get("icon-translate-anchor")),y=Me(d,this.transform,f);this.retainedQueryData[a.bucketInstanceId]=new Je(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,n.tileID);const v={bucket:a,layout:l,translationText:m,translationIcon:g,unwrappedTileID:p,pitchedLabelPlaneMatrix:y,scale:c,textPixelRatio:h,holdingForFade:n.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.ak(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(i)for(const t of a.sortKeyRanges){const{sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i}=t;e.push({sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i,parameters:v})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:v})}attemptAnchorPlacement(e,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,x,_){const b=t.aB[e.textAnchor],w=[e.textOffset0,e.textOffset1],A=et(b,n,i,w,a),C=this.collisionIndex.placeCollisionBox(r,p,l,u,c,s,o,g,h.predicate,x,A,_);if((!v||this.collisionIndex.placeCollisionBox(v,p,l,u,c,s,o,y,h.predicate,x,A,_).placeable)&&C.placeable){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID].text&&(e=this.prevPlacement.variableOffsets[d.crossTileID].anchor),0===d.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[d.crossTileID]={textOffset:w,width:n,height:i,anchor:b,textBoxScale:a,prevAnchor:e},this.markUsedJustification(f,b,d,m),f.allowVerticalPlacement&&(this.markUsedOrientation(f,m,d),this.placedOrientations[d.crossTileID]=m),{shift:A,placedGlyphBoxes:C}}}placeLayerBucketPart(e,r,n){const{bucket:i,layout:a,translationText:o,translationIcon:s,unwrappedTileID:l,pitchedLabelPlaneMatrix:u,textPixelRatio:c,holdingForFade:h,collisionBoxArray:p,partiallyEvaluatedTextSize:d,collisionGroup:f}=e.parameters,m=a.get("text-optional"),g=a.get("icon-optional"),y=t.aC(a,"text-overlap","text-allow-overlap"),v="always"===y,x=t.aC(a,"icon-overlap","icon-allow-overlap"),_="always"===x,b="map"===a.get("text-rotation-alignment"),w="map"===a.get("text-pitch-alignment"),A="none"!==a.get("icon-text-fit"),C="viewport-y"===a.get("symbol-z-order"),E=v&&(_||!i.hasIconData()||g),M=_&&(v||!i.hasTextData()||m);!i.collisionArrays&&p&&i.deserializeCollisionBoxes(p);const S=this.retainedQueryData[i.bucketInstanceId].tileID,D=this._getTerrainElevationFunc(S),T=this.transform.getFastPathSimpleProjectionMatrix(S),N=(e,p,_)=>{var C,N;if(r[e.crossTileID])return;if(h)return void(this.placements[e.crossTileID]=new Ke(!1,!1,!1));let I=!1,P=!1,z=!0,B=null,k={box:null,placeable:!1,offscreen:null,occluded:!1},F={placeable:!1},R=null,O=null,L=null,q=0,j=0,U=0;p.textFeatureIndex?q=p.textFeatureIndex:e.useRuntimeCollisionCircles&&(q=e.featureIndex),p.verticalTextFeatureIndex&&(j=p.verticalTextFeatureIndex);const V=p.textBox;if(V){const r=r=>{let n=t.al.horizontal;if(i.allowVerticalPlacement&&!r&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,n=t,this.markUsedOrientation(i,n,e))}return n},a=(r,n)=>{if(i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&p.verticalTextBox){for(const e of i.writingModes)if(e===t.al.vertical?(k=n(),F=k):k=r(),k&&k.placeable)break}else k=r()},u=e.textAnchorOffsetStartIndex,h=e.textAnchorOffsetEndIndex;if(h===u){const n=(t,r)=>{const n=this.collisionIndex.placeCollisionBox(t,y,c,S,l,w,b,o,f.predicate,D,void 0,T);return n&&n.placeable&&(this.markUsedOrientation(i,r,e),this.placedOrientations[e.crossTileID]=r),n};a((()=>n(V,t.al.horizontal)),(()=>{const r=p.verticalTextBox;return i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&r?n(r,t.al.vertical):{box:null,offscreen:null}})),r(k&&k.placeable)}else{let d=t.aB[null===(N=null===(C=this.prevPlacement)||void 0===C?void 0:C.variableOffsets[e.crossTileID])||void 0===N?void 0:N.anchor];const m=(t,r,a)=>{const p=t.x2-t.x1,m=t.y2-t.y1,g=e.textBoxScale,v=A&&"never"===x?r:null;let _=null,C="never"===y?1:2,E="never";d&&C++;for(let r=0;r<C;r++){for(let r=u;r<h;r++){const n=i.textAnchorOffsets.get(r);if(d&&n.textAnchor!==d)continue;const u=this.attemptAnchorPlacement(n,t,p,m,g,b,w,c,S,l,f,E,e,i,a,o,s,v,D);if(u&&(_=u.placedGlyphBoxes,_&&_.placeable))return I=!0,B=u.shift,_}d?d=null:E=y}return n&&!_&&(_={box:this.collisionIndex.placeCollisionBox(V,"always",c,S,l,w,b,o,f.predicate,D,void 0,T).box,offscreen:!1,placeable:!1,occluded:!1}),_};a((()=>m(V,p.iconBox,t.al.horizontal)),(()=>{const r=p.verticalTextBox;return i.allowVerticalPlacement&&(!k||!k.placeable)&&e.numVerticalGlyphVertices>0&&r?m(r,p.verticalIconBox,t.al.vertical):{box:null,occluded:!0,offscreen:null}})),k&&(I=k.placeable,z=k.offscreen);const g=r(k&&k.placeable);if(!I&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(i,t.anchor,e,g))}}}if(R=k,I=R&&R.placeable,z=R&&R.offscreen,e.useRuntimeCollisionCircles){const r=i.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),s=t.am(i.textSizeData,d,r),c=a.get("text-padding");O=this.collisionIndex.placeCollisionCircles(y,r,i.lineVertexArray,i.glyphOffsetArray,s,l,u,n,w,f.predicate,e.collisionCircleDiameter,c,o,D),O.circles.length&&O.collisionDetected&&!n&&t.w("Collisions detected, but collision boxes are not shown"),I=v||O.circles.length>0&&!O.collisionDetected,z=z&&O.offscreen}if(p.iconFeatureIndex&&(U=p.iconFeatureIndex),p.iconBox){const e=e=>this.collisionIndex.placeCollisionBox(e,x,c,S,l,w,b,s,f.predicate,D,A&&B?B:void 0,T);F&&F.placeable&&p.verticalIconBox?(L=e(p.verticalIconBox),P=L.placeable):(L=e(p.iconBox),P=L.placeable),z=z&&L.offscreen}const Z=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,$=g||0===e.numIconVertices;Z||$?$?Z||(P=P&&I):I=P&&I:P=I=P&&I;const G=P&&L.placeable;if(I&&R.placeable&&this.collisionIndex.insertCollisionBox(R.box,y,a.get("text-ignore-placement"),i.bucketInstanceId,F&&F.placeable&&j?j:q,f.ID),G&&this.collisionIndex.insertCollisionBox(L.box,x,a.get("icon-ignore-placement"),i.bucketInstanceId,U,f.ID),O&&I&&this.collisionIndex.insertCollisionCircles(O.circles,y,a.get("text-ignore-placement"),i.bucketInstanceId,q,f.ID),n&&this.storeCollisionData(i.bucketInstanceId,_,p,R,L,O),0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===i.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new Ke((I||E)&&!(null==R?void 0:R.occluded),(P||M)&&!(null==L?void 0:L.occluded),z||i.justReloaded),r[e.crossTileID]=!0};if(C){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const t=i.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let e=t.length-1;e>=0;--e){const r=t[e];N(i.symbolInstances.get(r),i.collisionArrays[r],r)}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)N(i.symbolInstances.get(t),i.collisionArrays[t],t);i.justReloaded=!1}storeCollisionData(e,t,r,n,i,a){if(r.textBox||r.iconBox){let a,o;this.collisionBoxArrays.has(e)?a=this.collisionBoxArrays.get(e):(a=new Map,this.collisionBoxArrays.set(e,a)),a.has(t)?o=a.get(t):(o={text:null,icon:null},a.set(t,o)),r.textBox&&(o.text=n.box),r.iconBox&&(o.icon=i.box)}if(a){let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=[]);for(let e=0;e<a.circles.length;e+=4)t.push(a.circles[e+0]-He),t.push(a.circles[e+1]-He),t.push(a.circles[e+2]),t.push(a.collisionDetected?1:0)}}markUsedJustification(e,r,n,i){let a;a=i===t.al.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[t.aD(r)];const o=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(const t of o)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=a>=0&&t!==a?0:n.crossTileID)}markUsedOrientation(e,r,n){const i=r===t.al.horizontal||r===t.al.horizontalOnly?r:0,a=r===t.al.vertical?r:0,o=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(const t of o)e.text.placedSymbolArray.get(t).placedOrientation=i;n.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const n=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},a=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(const e in this.placements){const t=this.placements[e],a=i[e];a?(this.opacities[e]=new Ye(a,n,t.text,t.icon),r=r||t.text!==a.text.placed||t.icon!==a.icon.placed):(this.opacities[e]=new Ye(null,n,t.text,t.icon,t.skipFade),r=r||t.text||t.icon)}for(const e in i){const t=i[e];if(!this.opacities[e]){const i=new Ye(t,n,!1,!1);i.isHidden()||(this.opacities[e]=i,r=r||t.text.placed||t.icon.placed)}}for(const e in a)this.variableOffsets[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.variableOffsets[e]=a[e]);for(const e in o)this.placedOrientations[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.placedOrientations[e]=o[e]);if(t&&void 0===t.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const r={};for(const n of t){const t=n.getBucket(e);t&&n.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,n.tileID,r,n.collisionBoxArray)}}updateBucketOpacities(e,r,n,i){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const a=e.layers[0],o=a.layout,s=new Ye(null,0,!1,!1,!0),l=o.get("text-allow-overlap"),u=o.get("icon-allow-overlap"),c=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h="map"===o.get("text-rotation-alignment"),p="map"===o.get("text-pitch-alignment"),d="none"!==o.get("icon-text-fit"),f=new Ye(null,0,l&&(u||!e.hasIconData()||o.get("icon-optional")),u&&(l||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const m=(e,t,r)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r);e.hasVisibleVertices=e.hasVisibleVertices||r!==ht},g=this.collisionBoxArrays.get(e.bucketInstanceId);for(let r=0;r<e.symbolInstances.length;r++){const i=e.symbolInstances.get(r),{numHorizontalGlyphVertices:a,numVerticalGlyphVertices:o,crossTileID:l}=i;let u=this.opacities[l];n[l]?u=s:u||(u=f,this.opacities[l]=u),n[l]=!0;const y=i.numIconVertices>0,v=this.placedOrientations[i.crossTileID],x=v===t.al.vertical,_=v===t.al.horizontal||v===t.al.horizontalOnly;if(a>0||o>0){const t=ct(u.text);m(e.text,a,x?ht:t),m(e.text,o,_?ht:t);const r=u.text.isHidden();[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=r||x?1:0)})),i.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).hidden=r||_?1:0);const n=this.variableOffsets[i.crossTileID];n&&this.markUsedJustification(e,n.anchor,i,v);const s=this.placedOrientations[i.crossTileID];s&&(this.markUsedJustification(e,"left",i,s),this.markUsedOrientation(e,s,i))}if(y){const t=ct(u.icon),r=!(d&&i.verticalPlacedIconSymbolIndex&&x);i.placedIconSymbolIndex>=0&&(m(e.icon,i.numIconVertices,r?t:ht),e.icon.placedSymbolArray.get(i.placedIconSymbolIndex).hidden=u.icon.isHidden()),i.verticalPlacedIconSymbolIndex>=0&&(m(e.icon,i.numVerticalIconVertices,r?ht:t),e.icon.placedSymbolArray.get(i.verticalPlacedIconSymbolIndex).hidden=u.icon.isHidden())}const b=g&&g.has(r)?g.get(r):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[r];if(n){let r=new t.P(0,0);if(n.textBox||n.verticalTextBox){let t=!0;if(c){const e=this.variableOffsets[l];e?(r=et(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),h&&r._rotate(p?-this.transform.bearingInRadians:this.transform.bearingInRadians)):t=!1}if(n.textBox||n.verticalTextBox){let i;n.textBox&&(i=x),n.verticalTextBox&&(i=_),rt(e.textCollisionBox.collisionVertexArray,u.text.placed,!t||i,b.text,r.x,r.y)}}if(n.iconBox||n.verticalIconBox){const t=Boolean(!_&&n.verticalIconBox);let i;n.iconBox&&(i=t),n.verticalIconBox&&(i=!t),rt(e.iconCollisionBox.collisionVertexArray,u.icon.placed,i,b.icon,d?r.x:0,d?r.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}}function rt(e,t,r,n,i,a){n&&0!==n.length||(n=[0,0,0,0]);const o=n[0]-He,s=n[1]-He,l=n[2]-He,u=n[3]-He;e.emplaceBack(t?1:0,r?1:0,i||0,a||0,o,s),e.emplaceBack(t?1:0,r?1:0,i||0,a||0,l,s),e.emplaceBack(t?1:0,r?1:0,i||0,a||0,l,u),e.emplaceBack(t?1:0,r?1:0,i||0,a||0,o,u)}const nt=Math.pow(2,25),it=Math.pow(2,24),at=Math.pow(2,17),ot=Math.pow(2,16),st=Math.pow(2,9),lt=Math.pow(2,8),ut=Math.pow(2,1);function ct(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*nt+t*it+r*at+t*ot+r*st+t*lt+r*ut+t}const ht=0;class pt{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,n,i){const a=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(a,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<a.length;)if(t.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,i())return!0;return!1}}class dt{constructor(e,t,r,n,i,a,o,s){this.placement=new tt(e,t,a,o,s),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,t,r){const n=o.now(),i=()=>!this._forceFullPlacement&&o.now()-n>2;for(;this._currentPlacementIndex>=0;){const n=t[e[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===n.type&&(!n.minzoom||n.minzoom<=a)&&(!n.maxzoom||n.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new pt(n)),this._inProgressLayer.continuePlacement(r[n.source],this.placement,this._showCollisionBoxes,n,i))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const ft=512/t.Z/2;class mt{constructor(e,r,n){this.tileID=e,this.bucketInstanceId=n,this._symbolsByKey={};const i=new Map;for(let e=0;e<r.length;e++){const t=r.get(e),n=t.key,a=i.get(n);a?a.push(t):i.set(n,[t])}for(const[e,r]of i){const n={positions:r.map((e=>({x:Math.floor(e.anchorX*ft),y:Math.floor(e.anchorY*ft)}))),crossTileIDs:r.map((e=>e.crossTileID))};if(n.positions.length>128){const e=new t.aF(n.positions.length,16,Uint16Array);for(const{x:t,y:r}of n.positions)e.add(t,r);e.finish(),delete n.positions,n.index=e}this._symbolsByKey[e]=n}}getScaledCoordinates(e,r){const{x:n,y:i,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=r.canonical,u=ft/Math.pow(2,l-a),c=(s*t.Z+e.anchorY)*u,h=i*t.Z*ft;return{x:Math.floor((o*t.Z+e.anchorX)*u-n*t.Z*ft),y:Math.floor(c-h)}}findMatches(e,t,r){const n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let i=0;i<e.length;i++){const a=e.get(i);if(a.crossTileID)continue;const o=this._symbolsByKey[a.key];if(!o)continue;const s=this.getScaledCoordinates(a,t);if(o.index){const e=o.index.range(s.x-n,s.y-n,s.x+n,s.y+n).sort();for(const t of e){const e=o.crossTileIDs[t];if(!r[e]){r[e]=!0,a.crossTileID=e;break}}}else if(o.positions)for(let e=0;e<o.positions.length;e++){const t=o.positions[e],i=o.crossTileIDs[e];if(Math.abs(t.x-s.x)<=n&&Math.abs(t.y-s.y)<=n&&!r[i]){r[i]=!0,a.crossTileID=i;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class gt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class yt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const e in this.indexes){const r=this.indexes[e],n={};for(const e in r){const i=r[e];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),n[i.tileID.key]=i}this.indexes[e]=n}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let e=0;e<t.symbolInstances.length;e++)t.symbolInstances.get(e).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const n=this.usedCrossTileIDs[e.overscaledZ];for(const r in this.indexes){const i=this.indexes[r];if(Number(r)>e.overscaledZ)for(const r in i){const a=i[r];a.tileID.isChildOf(e)&&a.findMatches(t.symbolInstances,e,n)}else{const a=i[e.scaledTo(Number(r)).key];a&&a.findMatches(t.symbolInstances,e,n)}}for(let e=0;e<t.symbolInstances.length;e++){const i=t.symbolInstances.get(e);i.crossTileID||(i.crossTileID=r.generate(),n[i.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new mt(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const r of t.getCrossTileIDsLists())for(const t of r)delete this.usedCrossTileIDs[e][t]}removeStaleBuckets(e){let t=!1;for(const r in this.indexes){const n=this.indexes[r];for(const i in n)e[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],t=!0)}return t}}class vt{constructor(){this.layerIndexes={},this.crossTileIDs=new gt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r){let n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new yt);let i=!1;const a={};n.handleWrapJump(r);for(const r of t){const t=r.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(r.tileID,t,this.crossTileIDs)&&(i=!0),a[t.bucketInstanceId]=!0)}return n.removeStaleBuckets(a)&&(i=!0),i}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const e in this.layerIndexes)t[e]||delete this.layerIndexes[e]}}var xt="void main() {fragColor=vec4(1.0);}";const _t={prelude:bt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nout highp vec4 fragColor;","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c\n);}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\n#ifdef GLOBE\nif ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}\n#endif\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;"),projectionMercator:bt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:bt("","#define GLOBE_RADIUS 6371008.8\nuniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos\n);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); \nif (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len\n);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}"),background:bt("uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:bt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:bt("in vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {\n#ifdef GLOBE\nvec3 center_vector=projectToSphere(circle_center);\n#endif\nfloat angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {\n#ifdef GLOBE\nvec4 projected_center=interpolateProjection(circle_center,center_vector,ele);\n#else\nvec4 projected_center=projectTileWithElevation(circle_center,ele);\n#endif\ncorner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}\n#ifdef GLOBE\nvec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);\n#else\ngl_Position=projectTileWithElevation(corner_position,ele);\n#endif\n} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:bt(xt,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:bt("uniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);\n#ifdef GLOBE\nvec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);\n#else\ngl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));\n#endif\n}"),heatmapTexture:bt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:bt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:bt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:bt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:bt(xt,"in vec2 a_pos;void main() {\n#ifdef GLOBE\ngl_Position=projectTileFor3D(a_pos,0.0);\n#else\ngl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);\n#endif\n}"),fill:bt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nfragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_fill_translate;in vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);}"),fillOutline:bt("in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillOutlinePattern:bt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillPattern:bt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:bt("in vec4 v_color;void main() {fragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\nout vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);\n#ifdef GLOBE\nmat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);\n#endif\ndirectional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:bt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\n#ifdef GLOBE\nout vec3 v_sphere_pos;\n#endif\nout vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nvec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:bt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:bt("uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];\n#define PI 3.141592653589793\n#define STANDARD 0\n#define COMBINED 1\n#define IGOR 2\n#define MULTIDIRECTIONAL 3\n#define BASIC 4\nfloat get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else\n{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else\n{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;switch(u_method){case BASIC:\nbasic_hillshade(deriv);break;case COMBINED:\ncombined_hillshade(deriv);break;case IGOR:\nigor_hillshade(deriv);break;case MULTIDIRECTIONAL:\nmultidirectional_hillshade(deriv);break;case STANDARD:\ndefault:\nstandard_hillshade(deriv);break;}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:bt("uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:bt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:bt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:bt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:bt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;\n#ifdef GLOBE\nif (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}\n#endif\nv_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:bt("uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:bt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:bt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:bt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:bt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:bt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:bt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:bt("in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758\n);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}","in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:bt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function bt(e,t){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/in ([\w]+) ([\w]+)/g),i=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(i):i,s={};return{fragmentSource:e=e.replace(r,((e,t,r,n,i)=>(s[i]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nin ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = u_${i};\n#endif\n`))),vertexSource:t=t.replace(r,((e,t,r,n,i)=>{const a="float"===n?"vec2":"vec4",o=i.match(/color/)?"color":a;return s[i]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nin ${r} ${a} a_${i};\nout ${r} ${n} ${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${i} = unpack_mix_${o}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${i}\nuniform lowp float u_${i}_t;\nin ${r} ${a} a_${i};\n#else\nuniform ${r} ${n} u_${i};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = a_${i};\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${i}\n    ${r} ${n} ${i} = unpack_mix_${o}(a_${i}, u_${i}_t);\n#else\n    ${r} ${n} ${i} = u_${i};\n#endif\n`})),staticAttributes:n,staticUniforms:o}}class wt{constructor(e,t,r){this.vertexBuffer=e,this.indexBuffer=t,this.segments=r}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var At=t.aG([{name:"a_pos",type:"Int16",components:2}]);const Ct="#define PROJECTION_MERCATOR",Et="mercator";class Mt{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Et}get shaderDefine(){return Ct}get shaderPreludeCode(){return _t.projectionMercator}get vertexShaderPreludeCode(){return _t.projectionMercator.vertexSource}get subdivisionGranularity(){return t.aH.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,n,i,a){if(this._cachedMesh)return this._cachedMesh;const o=new t.aI;o.emplaceBack(0,0),o.emplaceBack(t.Z,0),o.emplaceBack(0,t.Z),o.emplaceBack(t.Z,t.Z);const s=e.createVertexBuffer(o,At.members),l=t.aJ.simpleSegment(0,0,4,2),u=new t.aK;u.emplaceBack(1,0,2),u.emplaceBack(1,2,3);const c=e.createIndexBuffer(u);return this._cachedMesh=new wt(s,c,l),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class St{constructor(e=0,t=0,r=0,n=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n}interpolate(e,r,n){return null!=r.top&&null!=e.top&&(this.top=t.B.number(e.top,r.top,n)),null!=r.bottom&&null!=e.bottom&&(this.bottom=t.B.number(e.bottom,r.bottom,n)),null!=r.left&&null!=e.left&&(this.left=t.B.number(e.left,r.left,n)),null!=r.right&&null!=e.right&&(this.right=t.B.number(e.right,r.right,n)),this}getCenter(e,r){const n=t.ae((this.left+e-this.right)/2,0,e),i=t.ae((this.top+r-this.bottom)/2,0,r);return new t.P(n,i)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new St(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Dt(e,t){if(!e.renderWorldCopies||e.lngRange)return;const r=t.lng-e.center.lng;t.lng+=r>180?-360:r<-180?360:0}function Tt(e){return Math.max(0,Math.floor(e))}class Nt{constructor(e,r,n,i,a,o){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=void 0===o||!!o,this._minZoom=r||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==a?60:a,this.setMaxBounds(),this._width=0,this._height=0,this._center=new t.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Tt(this._zoom),this._scale=t.ac(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new St,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,n){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Tt(this._zoom),this._scale=t.ac(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new St(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!n&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=t.aL(e,-180,180)*Math.PI/180;var i,a,o,s,l,u,c,h,p;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=n(),i=this._rotationMatrix,o=-this._bearingInRadians,s=(a=this._rotationMatrix)[0],l=a[1],u=a[2],c=a[3],h=Math.sin(o),p=Math.cos(o),i[0]=s*p+u*h,i[1]=l*p+c*h,i[2]=s*-h+u*p,i[3]=l*-h+c*p)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=t.ae(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const t=e/180*Math.PI;this._rollInRadians!==t&&(this._unmodified=!1,this._rollInRadians=t,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return t.aM(this._fovInRadians)}setFov(e){e=t.ae(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=t.ab(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=t.ac(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,t){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=t,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()}resize(e,t,r=!0){this._width=e,this._height=t,r&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&2===this._latRange.length&&this._lngRange&&2===this._lngRange.length?new Z([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,t.af])}getConstrained(e,t){return this._callbacks.getConstrained(e,t)}getCameraQueryGeometry(e,r){if(1===r.length)return[r[0],e];{let n=e.x,i=e.y,a=e.x,o=e.y;for(const e of r)n=Math.min(n,e.x),i=Math.min(i,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y);return[new t.P(n,i),new t.P(a,i),new t.P(a,o),new t.P(n,o),new t.P(n,i)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:t,zoom:r}=this.getConstrained(this.center,this.zoom);this.setCenter(t),this.setZoom(r),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=t.ad(new Float64Array(16));t.M(e,e,[this._width/2,-this._height/2,1]),t.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=t.ad(new Float64Array(16)),t.M(e,e,[1,-1,1]),t.L(e,e,[-1,-1,0]),t.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,n,i){const a=void 0!==n?n:this.bearing,o=i=void 0!==i?i:this.pitch,s=t.$.fromLngLat(e,r),l=-Math.cos(t.ab(o)),u=Math.sin(t.ab(o)),c=u*Math.sin(t.ab(a)),h=-u*Math.cos(t.ab(a));let p=this.elevation;const d=r-p;let f;l*d>=0||Math.abs(l)<.1?(f=1e4,p=r+f*l):f=-d/l;let m,g,y=t.aN(1,s.y),v=0;do{if(v+=1,v>10)break;g=f/y,m=new t.$(s.x+c*g,s.y+h*g),y=1/m.meterInMercatorCoordinateUnits()}while(Math.abs(f-g*y)>1e-12);return{center:m.toLngLat(),elevation:p,zoom:t.ah(this.height/2/Math.tan(this.fovInRadians/2)/g/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=t.ag(1,this.center.lat)*this.worldSize,n=this.cameraToCenterDistance/r,i=t.$.fromLngLat(this.center,this.elevation),a=de(this.center,this.elevation,this.pitch,this.bearing,n);this._elevation=e;const o=this.calculateCenterFromCameraLngLatAlt(a.toLngLat(),t.aN(a.z,i.y),this.bearing,this.pitch);this._elevation=o.elevation,this._center=o.center,this.setZoom(o.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=t.ag(1,this.center.lat)*this.worldSize;return de(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/t.Z,1/r/t.Z]}}class It{constructor(e,r){this.min=e,this.max=r,this.center=t.aO([],t.aP([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],n=t.aQ(this.min),i=t.aQ(this.max);for(let e=0;e<r.length;e++)n[e]=r[e]?this.min[e]:this.center[e],i[e]=r[e]?this.center[e]:this.max[e];return i[2]=this.max[2],new It(n,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let t=!0;for(let r=0;r<e.planes.length;r++){const n=this.intersectsPlane(e.planes[r]);if(0===n)return 0;1===n&&(t=!1)}return t?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let t=e[3],r=e[3];for(let n=0;n<3;n++)e[n]>0?(t+=e[n]*this.min[n],r+=e[n]*this.max[n]):(r+=e[n]*this.min[n],t+=e[n]*this.max[n]);return t>=0?2:r<0?0:1}}class Pt{distanceToTile2d(e,t,r,n){const i=n.distanceX([e,t]),a=n.distanceY([e,t]);return Math.hypot(i,a)}getWrap(e,t,r){return r}getTileAABB(e,r,n,i){var a,o;let s=n,l=n;if(i.terrain){const u=new t.Y(e.z,r,e.z,e.x,e.y),c=i.terrain.getMinMaxElevation(u);s=null!==(a=c.minElevation)&&void 0!==a?a:n,l=null!==(o=c.maxElevation)&&void 0!==o?o:n}const u=1<<e.z;return new It([r+e.x/u,e.y/u,s],[r+(e.x+1)/u,(e.y+1)/u,l])}allowVariableZoom(e,r){const n=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,i=t.ae(78.5-n/2,0,60);return!!r.terrain||e.pitch>i}allowWorldCopies(){return!0}recalculateCache(){}}class zt{constructor(e,t,r){this.points=e,this.planes=t,this.aabb=r}static fromInvProjectionMatrix(e,r=1,n=0){const i=Math.pow(2,n),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((n=>{const a=1/(n=t.at([],n,e))[3]/r*i;return t.aR(n,n,[a,a,1/n[3],a])})),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const r=t.aS([],a[e[0]],a[e[1]]),n=t.aS([],a[e[2]],a[e[1]]),i=t.aT([],t.aU([],r,n)),o=-t.aV(i,a[e[1]]);return i.concat(o)})),s=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],l=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const e of a)for(let t=0;t<3;t++)s[t]=Math.min(s[t],e[t]),l[t]=Math.max(l[t],e[t]);return new zt(a,o,new It(s,l))}}class Bt{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t,r=!0){this._helper.resize(e,t,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,t){}constructor(e,t,r,n,i){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Nt({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,t)=>this.getConstrained(e,t)},e,t,r,n,i),this._coveringTilesDetailsProvider=new Pt}clone(){const e=new Bt;return e.apply(this),e}apply(e,t,r){this._helper.apply(e,t,r)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new t.aW(0,e)];if(this._helper._renderWorldCopies){const n=this.screenPointToMercatorCoordinate(new t.P(0,0)),i=this.screenPointToMercatorCoordinate(new t.P(this._helper._width,0)),a=this.screenPointToMercatorCoordinate(new t.P(this._helper._width,this._helper._height)),o=this.screenPointToMercatorCoordinate(new t.P(0,this._helper._height)),s=Math.floor(Math.min(n.x,i.x,a.x,o.x)),l=Math.floor(Math.max(n.x,i.x,a.x,o.x)),u=1;for(let n=s-u;n<=l+u;n++)0!==n&&r.push(new t.aW(n,e))}return r}getCameraFrustum(){return zt.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const t=this.screenPointToLocation(this.centerPoint,e),r=e?e.getElevationForLngLatZoom(t,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(r)}setLocationAtPoint(e,r){const n=t.ag(this.elevation,this.center.lat),i=this.screenPointToMercatorCoordinateAtZ(r,n),a=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,n),o=t.$.fromLngLat(e),s=new t.$(o.x-(i.x-a.x),o.y-(i.y-a.y));this.setCenter(null==s?void 0:s.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(t.$.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(t.$.fromLngLat(e))}screenPointToLocation(e,t){var r;return null===(r=this.screenPointToMercatorCoordinate(e,t))||void 0===r?void 0:r.toLngLat()}screenPointToMercatorCoordinate(e,t){if(t){const r=t.pointCoordinate(e);if(null!=r)return r}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const n=r||0,i=[e.x,e.y,0,1],a=[e.x,e.y,1,1];t.at(i,i,this._pixelMatrixInverse),t.at(a,a,this._pixelMatrixInverse);const o=i[3],s=a[3],l=i[1]/o,u=a[1]/s,c=i[2]/o,h=a[2]/s,p=c===h?0:(n-c)/(h-c);return new t.$(t.B.number(i[0]/o,a[0]/s,p)/this.worldSize,t.B.number(l,u,p)/this.worldSize,n)}coordinatePoint(e,r=0,n=this._pixelMatrix){const i=[e.x*this.worldSize,e.y*this.worldSize,r,1];return t.at(i,i,n),new t.P(i[0]/i[3],i[1]/i[3])}getBounds(){const e=Math.max(0,this._helper._height/2-he(this));return(new Z).extend(this.screenPointToLocation(new t.P(0,e))).extend(this.screenPointToLocation(new t.P(this._helper._width,e))).extend(this.screenPointToLocation(new t.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new t.P(0,this._helper._height)))}isPointOnMapSurface(e,t){return t?null!=t.pointCoordinate(e):e.y>this.height/2-he(this)}calculatePosMatrix(e,r=!1,n){var i;const a=null!==(i=e.key)&&void 0!==i?i:t.aX(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),o=r?this._alignedPosMatrixCache:this._posMatrixCache;if(o.has(a)){const e=o.get(a);return n?e.f32:e.f64}const s=pe(e,this.worldSize);t.N(s,r?this._alignedProjMatrix:this._viewProjMatrix,s);const l={f64:s,f32:new Float32Array(s)};return o.set(a,l),n?l.f32:l.f64}calculateFogMatrix(e){const r=e.key,n=this._fogMatrixCacheF32;if(n.has(r))return n.get(r);const i=pe(e,this.worldSize);return t.N(i,this._fogMatrix,i),n.set(r,new Float32Array(i)),n.get(r)}getConstrained(e,r){r=t.ae(+r,this.minZoom,this.maxZoom);const n={center:new t.Q(e.lng,e.lat),zoom:r};let i=this._helper._lngRange;this._helper._renderWorldCopies||null!==i||(i=[-179.9999999999,180-1e-10]);const a=this.tileSize*t.ac(n.zoom);let o=0,s=a,l=0,u=a,c=0,h=0;const{x:p,y:d}=this.size;if(this._helper._latRange){const e=this._helper._latRange;o=t.S(e[1])*a,s=t.S(e[0])*a,s-o<d&&(c=d/(s-o))}i&&(l=t.aL(t.U(i[0])*a,0,a),u=t.aL(t.U(i[1])*a,0,a),u<l&&(u+=a),u-l<p&&(h=p/(u-l)));const{x:f,y:m}=ue(a,e);let g,y;const v=Math.max(h||0,c||0);if(v){const e=new t.P(h?(u+l)/2:f,c?(s+o)/2:m);return n.center=ce(a,e).wrap(),n.zoom+=t.ah(v),n}if(this._helper._latRange){const e=d/2;m-e<o&&(y=o+e),m+e>s&&(y=s-e)}if(i){const e=(l+u)/2;let r=f;this._helper._renderWorldCopies&&(r=t.aL(f,e-a/2,e+a/2));const n=p/2;r-n<l&&(g=l+n),r+n>u&&(g=u-n)}if(void 0!==g||void 0!==y){const e=new t.P(null!=g?g:f,null!=y?y:m);n.center=ce(a,e).wrap()}return n}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}_calculateNearFarZIfNeeded(e,r,n){if(!this._helper.autoCalculateNearFarZ)return;const i=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),a=e-i*this._helper._pixelPerMeter/Math.cos(r),o=i<0?a:e,s=Math.PI/2+this.pitchInRadians,l=t.ab(this.fov)*(Math.abs(Math.cos(t.ab(this.roll)))*this.height+Math.abs(Math.sin(t.ab(this.roll)))*this.width)/this.height*(.5+n.y/this.height),u=Math.sin(l)*o/Math.sin(t.ae(Math.PI-s-l,.01,Math.PI-.01)),c=he(this),h=Math.atan(c/this._helper.cameraToCenterDistance),p=t.ab(.75),d=h>p?2*h*(.5+n.y/(2*c)):p,f=Math.sin(d)*o/Math.sin(t.ae(Math.PI-s-d,.01,Math.PI-.01)),m=Math.min(u,f);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*m+o),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=ue(this.worldSize,this.center),n=r.x,i=r.y;this._helper._pixelPerMeter=t.ag(1,this.center.lat)*this.worldSize;const a=t.ab(Math.min(this.pitch,le)),o=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(a));let s;this._calculateNearFarZIfNeeded(o,a,e),s=new Float64Array(16),t.aY(s,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),t.an(this._invProjMatrix,s),s[8]=2*-e.x/this._helper._width,s[9]=2*e.y/this._helper._height,this._projectionMatrix=t.aZ(s),t.M(s,s,[1,-1,1]),t.L(s,s,[0,0,-this._helper.cameraToCenterDistance]),t.a_(s,s,-this.rollInRadians),t.a$(s,s,this.pitchInRadians),t.a_(s,s,-this.bearingInRadians),t.L(s,s,[-n,-i,0]),this._mercatorMatrix=t.M([],s,[this.worldSize,this.worldSize,this.worldSize]),t.M(s,s,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=t.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,s),t.L(s,s,[0,0,-this.elevation]),this._viewProjMatrix=s,this._invViewProjMatrix=t.an([],s);const l=[0,0,-1,1];t.at(l,l,this._invViewProjMatrix),this._cameraPosition=[l[0]/l[3],l[1]/l[3],l[2]/l[3]],this._fogMatrix=new Float64Array(16),t.aY(this._fogMatrix,this.fovInRadians,this.width/this.height,o,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,t.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),t.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),t.a_(this._fogMatrix,this._fogMatrix,-this.rollInRadians),t.a$(this._fogMatrix,this._fogMatrix,this.pitchInRadians),t.a_(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),t.L(this._fogMatrix,this._fogMatrix,[-n,-i,0]),t.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),t.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=t.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,s);const u=this._helper._width%2/2,c=this._helper._height%2/2,h=Math.cos(this.bearingInRadians),p=Math.sin(-this.bearingInRadians),d=n-Math.round(n)+h*u+p*c,f=i-Math.round(i)+h*c+p*u,m=new Float64Array(s);if(t.L(m,m,[d>.5?d-1:d,f>.5?f-1:f,0]),this._alignedProjMatrix=m,s=t.an(new Float64Array(16),this._pixelMatrix),!s)throw new Error("failed to invert matrix");this._pixelMatrixInverse=s,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new t.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.at(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=t.ag(1,this.center.lat)*this.worldSize;return de(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const n=t.$.fromLngLat(e),i=[n.x*this.worldSize,n.y*this.worldSize,r,1];return t.at(i,i,this._viewProjMatrix),i[2]/i[3]}getProjectionData(e){const{overscaledTileID:r,aligned:n,applyTerrainMatrix:i}=e,a=this._helper.getMercatorTileCoordinates(r),o=r?this.calculatePosMatrix(r,n,!0):null;let s;return s=r&&r.terrainRttPosMatrix32f&&i?r.terrainRttPosMatrix32f:o||t.b0(),{mainMatrix:s,tileMercatorCoords:a,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:s}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,t,r){return 1}transformLightDirection(e){return t.aQ(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,n,i){const a=this.calculatePosMatrix(n);let o;i?(o=[e,r,i(e,r),1],t.at(o,o,a)):(o=[e,r,0,1],Ge(o,o,a));const s=o[3];return{point:new t.P(o[0]/s,o[1]/s),signedDistanceFromCamera:s,isOccluded:!1}}populateCache(e){for(const t of e)this.calculatePosMatrix(t)}getMatrixForModel(e,r){const n=t.$.fromLngLat(e,r),i=n.meterInMercatorCoordinateUnits(),a=t.b1();return t.L(a,a,[n.x,n.y,n.z]),t.a_(a,a,Math.PI),t.a$(a,a,Math.PI/2),t.M(a,a,[-i,i,i]),a}getProjectionDataForCustomLayer(e=!0){const r=new t.Y(0,0,0,0,0),n=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),i=pe(r,this.worldSize);t.N(i,this._viewProjMatrix,i),n.tileMercatorCoords=[0,0,1,1];const a=[t.Z,t.Z,this.worldSize/this._helper.pixelsPerMeter],o=t.b2();return t.M(o,i,a),n.fallbackMatrix=o,n.mainMatrix=o,n}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function kt(){t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ft(e){if(e.useSlerp)if(e.k<1){const r=t.b3(e.startEulerAngles.roll,e.startEulerAngles.pitch,e.startEulerAngles.bearing),n=t.b3(e.endEulerAngles.roll,e.endEulerAngles.pitch,e.endEulerAngles.bearing),i=new Float64Array(4);t.b4(i,r,n,e.k);const a=t.b5(i);e.tr.setRoll(a.roll),e.tr.setPitch(a.pitch),e.tr.setBearing(a.bearing)}else e.tr.setRoll(e.endEulerAngles.roll),e.tr.setPitch(e.endEulerAngles.pitch),e.tr.setBearing(e.endEulerAngles.bearing);else e.tr.setRoll(t.B.number(e.startEulerAngles.roll,e.endEulerAngles.roll,e.k)),e.tr.setPitch(t.B.number(e.startEulerAngles.pitch,e.endEulerAngles.pitch,e.k)),e.tr.setBearing(t.B.number(e.startEulerAngles.bearing,e.endEulerAngles.bearing,e.k))}function Rt(e,r,n,i,a){const o=a.padding,s=ue(a.worldSize,n.getNorthWest()),l=ue(a.worldSize,n.getNorthEast()),u=ue(a.worldSize,n.getSouthEast()),c=ue(a.worldSize,n.getSouthWest()),h=t.ab(-i),p=s.rotate(h),d=l.rotate(h),f=u.rotate(h),m=c.rotate(h),g=new t.P(Math.max(p.x,d.x,m.x,f.x),Math.max(p.y,d.y,m.y,f.y)),y=new t.P(Math.min(p.x,d.x,m.x,f.x),Math.min(p.y,d.y,m.y,f.y)),v=g.sub(y),x=(a.width-(o.left+o.right+r.left+r.right))/v.x,_=(a.height-(o.top+o.bottom+r.top+r.bottom))/v.y;if(_<0||x<0)return void kt();const b=Math.min(t.ah(a.scale*Math.min(x,_)),e.maxZoom),w=t.P.convert(e.offset),A=new t.P((r.left-r.right)/2,(r.top-r.bottom)/2).rotate(t.ab(i)),C=w.add(A).mult(a.scale/t.ac(b));return{center:ce(a.worldSize,s.add(u).div(2).sub(C)),zoom:b,bearing:i}}class Ot{get useGlobeControls(){return!1}handlePanInertia(e,t){return{easingOffset:e,easingCenter:t.center}}handleMapControlsRollPitchBearingZoom(e,t){e.bearingDelta&&t.setBearing(t.bearing+e.bearingDelta),e.pitchDelta&&t.setPitch(t.pitch+e.pitchDelta),e.rollDelta&&t.setRoll(t.roll+e.rollDelta),e.zoomDelta&&t.setZoom(t.zoom+e.zoomDelta)}handleMapControlsPan(e,t,r){e.around.distSqr(t.centerPoint)<.01||t.setLocationAtPoint(r,e.around)}cameraForBoxAndBearing(e,t,r,n,i){return Rt(e,t,r,n,i)}handleJumpToCenterZoom(e,r){e.zoom!==(void 0!==r.zoom?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),void 0!==r.center&&e.setCenter(t.Q.convert(r.center))}handleEaseTo(e,r){const n=e.zoom,i=e.padding,a={roll:e.roll,pitch:e.pitch,bearing:e.bearing},o={roll:void 0===r.roll?e.roll:r.roll,pitch:void 0===r.pitch?e.pitch:r.pitch,bearing:void 0===r.bearing?e.bearing:r.bearing},s=void 0!==r.zoom,l=!e.isPaddingEqual(r.padding);let u=!1;const c=s?+r.zoom:e.zoom;let h=e.centerPoint.add(r.offsetAsPoint);const p=e.screenPointToLocation(h),{center:d,zoom:f}=e.getConstrained(t.Q.convert(r.center||p),null!=c?c:n);Dt(e,d);const m=ue(e.worldSize,p),g=ue(e.worldSize,d).sub(m),y=t.ac(f-n);return u=f!==n,{easeFunc:s=>{if(u&&e.setZoom(t.B.number(n,f,s)),t.b6(a,o)||Ft({startEulerAngles:a,endEulerAngles:o,tr:e,k:s,useSlerp:a.roll!=o.roll}),l&&(e.interpolatePadding(i,r.padding,s),h=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const r=t.ac(e.zoom-n),i=f>n?Math.min(2,y):Math.max(.5,y),a=Math.pow(i,1-s),o=ce(e.worldSize,m.add(g.mult(s*a)).mult(r));e.setLocationAtPoint(e.renderWorldCopies?o.wrap():o,h)}},isZooming:u,elevationCenter:d}}handleFlyTo(e,r){const n=void 0!==r.zoom,i=e.zoom,a=e.getConstrained(t.Q.convert(r.center||r.locationAtOffset),n?+r.zoom:i),o=a.center,s=a.zoom;Dt(e,o);const l=ue(e.worldSize,r.locationAtOffset),u=ue(e.worldSize,o).sub(l),c=u.mag(),h=t.ac(s-i);let p;if(void 0!==r.minZoom){const n=Math.min(+r.minZoom,i,s),a=e.getConstrained(o,n).zoom;p=t.ac(a-i)}return{easeFunc:(r,n,a,c)=>{e.setZoom(1===r?s:i+t.ah(n));const h=1===r?o:ce(e.worldSize,l.add(u.mult(a)).mult(n));e.setLocationAtPoint(e.renderWorldCopies?h.wrap():h,c)},scaleOfZoom:h,targetCenter:o,scaleOfMinZoom:p,pixelPathLength:c}}}class Lt{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}}Lt.Replace=[1,0],Lt.disabled=new Lt(Lt.Replace,t.b7.transparent,[!1,!1,!1,!1]),Lt.unblended=new Lt(Lt.Replace,t.b7.transparent,[!0,!0,!0,!0]),Lt.alphaBlended=new Lt([1,771],t.b7.transparent,[!0,!0,!0,!0]);const qt=2305;class jt{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}}jt.disabled=new jt(!1,1029,qt),jt.backCCW=new jt(!0,1029,qt),jt.frontCCW=new jt(!0,1028,qt);class Ut{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}}Ut.ReadOnly=!1,Ut.ReadWrite=!0,Ut.disabled=new Ut(519,Ut.ReadOnly,[0,1]);const Vt=7680;class Zt{constructor(e,t,r,n,i,a){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=i,this.pass=a}}Zt.disabled=new Zt({func:519,mask:0},0,0,Vt,Vt,Vt);const $t=new WeakMap;function Gt(e){var t;if($t.has(e))return $t.get(e);{const r=null===(t=e.getParameter(e.VERSION))||void 0===t?void 0:t.startsWith("WebGL 2.0");return $t.set(e,r),r}}class Ht{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,n=r.gl;this._texFormat=n.RGBA,this._texType=n.UNSIGNED_BYTE;const i=new t.aI;i.emplaceBack(-1,-1),i.emplaceBack(2,-1),i.emplaceBack(-1,2);const a=new t.aK;a.emplaceBack(0,1,2),this._fullscreenTriangle=new wt(r.createVertexBuffer(i,At.members),r.createIndexBuffer(a),t.aJ.simpleSegment(0,0,i.length,a.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(n.TEXTURE1);const o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texImage2D(n.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(o),Gt(n)&&(this._pbo=n.createBuffer(),n.bindBuffer(n.PIXEL_PACK_BUFFER,this._pbo),n.bufferData(n.PIXEL_PACK_BUFFER,4,n.STREAM_READ),n.bindBuffer(n.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,t){const r=this._updateCount;return this._readbackQueue?r>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():r>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,t),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,t=e.gl;e.activeTexture.set(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const n=this._cachedRenderContext.context,i=n.gl;if(this._bindFramebuffer(),n.viewport.set([0,0,this._texWidth,this._texHeight]),n.clear({color:t.b7.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(n,i.TRIANGLES,Ut.disabled,Zt.disabled,Lt.unblended,jt.disabled,((e,t)=>({u_input:e,u_output_expected:t}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Gt(i)){i.bindBuffer(i.PIXEL_PACK_BUFFER,this._pbo),i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),i.bindBuffer(i.PIXEL_PACK_BUFFER,null);const e=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);i.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:e}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Gt(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return t.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ht._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let t=0;return t+=e[0]/256,t+=e[1]/65536,t+=e[2]/16777216,e[3]<127&&(t=-t),t/128}}const Wt=t.Z/128;function Xt(e,r){const n=void 0!==e.granularity?Math.max(e.granularity,1):1,i=n+(e.generateBorders?2:0),a=n+(e.extendToNorthPole||e.generateBorders?1:0)+(e.extendToSouthPole||e.generateBorders?1:0),o=i+1,s=a+1,l=e.generateBorders?-1:0,u=e.generateBorders||e.extendToNorthPole?-1:0,c=n+(e.generateBorders?1:0),h=n+(e.generateBorders||e.extendToSouthPole?1:0),p=o*s,d=i*a*6,f=o*s>65536;if(f&&"16bit"===r)throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const m=f||"32bit"===r,g=new Int16Array(2*p);let y=0;for(let r=u;r<=h;r++)for(let i=l;i<=c;i++){let a=i/n*t.Z;-1===i&&(a=-64),i===n+1&&(a=t.Z+Wt);let o=r/n*t.Z;-1===r&&(o=e.extendToNorthPole?t.b9:-64),r===n+1&&(o=e.extendToSouthPole?t.ba:t.Z+Wt),g[y++]=a,g[y++]=o}const v=m?new Uint32Array(d):new Uint16Array(d);let x=0;for(let e=0;e<a;e++)for(let t=0;t<i;t++){const r=t+1+e*o,n=t+(e+1)*o,i=t+1+(e+1)*o;v[x++]=t+e*o,v[x++]=n,v[x++]=r,v[x++]=r,v[x++]=n,v[x++]=i}return{vertices:g.buffer.slice(0),indices:v.buffer.slice(0),uses32bitIndices:m}}const Yt=new t.aH({fill:new t.bb(128,2),line:new t.bb(512,0),tile:new t.bb(128,32),stencil:new t.bb(128,1),circle:3});class Kt{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return _t.projectionGlobe}get vertexShaderPreludeCode(){return _t.projectionMercator.vertexSource}get subdivisionGranularity(){return Yt}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Ht(e));const r=t.S(this._errorQueryLatitudeDegrees),n=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,i=this._errorMeasurement.updateErrorLoop(r,n),a=o.now();i!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=i,this._errorMeasurementLastChangeTime=a);const s=Math.min(Math.max((a-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=t.bc(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,t.bd(s))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,t,r,n,i){const a=("stencil"===i?Yt.stencil:Yt.tile).getGranularityForZoomLevel(t.z);return this._getMesh(e,{granularity:a,generateBorders:r,extendToNorthPole:0===t.y&&n,extendToSouthPole:t.y===(1<<t.z)-1&&n})}_getMesh(e,r){const n=this._getMeshKey(r);if(n in this._tileMeshCache)return this._tileMeshCache[n];const i=function(e,r){const n=Xt(r,"16bit"),i=t.aI.deserialize({arrayBuffer:n.vertices,length:n.vertices.byteLength/2/2}),a=t.aK.deserialize({arrayBuffer:n.indices,length:n.indices.byteLength/2/3});return new wt(e.createVertexBuffer(i,At.members),e.createIndexBuffer(a),t.aJ.simpleSegment(0,0,i.length,a.length))}(e,r);return this._tileMeshCache[n]=i,i}recalculate(e){}hasTransition(){const e=o.now();let t=!1;return t=t||(e-this._errorMeasurementLastChangeTime)/1e3<.7,t=t||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,t}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Jt=new t.r({type:new t.D(t.v.projection.type)});class Qt extends t.E{constructor(e){super(),this._transitionable=new t.T(Jt),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new t.C(0)),this._mercatorProjection=new Mt,this._verticalPerspectiveProjection=new Kt}get transitionState(){const e=this.properties.get("type");if("string"==typeof e&&"mercator"===e)return 0;if("string"==typeof e&&"vertical-perspective"===e)return 1;if(e instanceof t.be){if("vertical-perspective"===e.from&&"mercator"===e.to)return 1-e.transition;if("mercator"===e.from&&"vertical-perspective"===e.to)return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,t,r,n,i){return this.currentProjection.getMeshFromTileID(e,t,r,n,i)}setProjection(e){this._transitionable.setValue("type",(null==e?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function er(e){const t=nr(e.worldSize,e.center.lat);return 2*Math.PI*t}function tr(e,r,n,i,a){const o=1/(1<<a),s=r/t.Z*o+i*o,l=t.bg((e/t.Z*o+n*o)*Math.PI*2+Math.PI,2*Math.PI),u=2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-.5*Math.PI,c=Math.cos(u),h=new Float64Array(3);return h[0]=Math.sin(l)*c,h[1]=Math.sin(u),h[2]=Math.cos(l)*c,h}function rr(e){return function(e,t){const r=Math.cos(t),n=new Float64Array(3);return n[0]=Math.sin(e)*r,n[1]=Math.sin(t),n[2]=Math.cos(e)*r,n}(e.lng*Math.PI/180,e.lat*Math.PI/180)}function nr(e,t){return e/(2*Math.PI)/Math.cos(t*Math.PI/180)}function ir(e){const r=Math.asin(e[1])/Math.PI*180,n=Math.sqrt(e[0]*e[0]+e[2]*e[2]);if(n>1e-6){const i=e[0]/n,a=Math.acos(e[2]/n),o=(i>0?a:-a)/Math.PI*180;return new t.Q(t.aL(o,-180,180),r)}return new t.Q(0,r)}function ar(e){return Math.cos(e*Math.PI/180)}function or(e,r){const n=ar(e),i=ar(r);return t.ah(i/n)}function sr(e,r){const n=e.rotate(r.bearingInRadians),i=r.zoom+or(r.center.lat,0),a=t.bc(1/ar(r.center.lat),1/ar(Math.min(Math.abs(r.center.lat),60)),t.bf(i,7,3,0,1)),o=360/er({worldSize:r.worldSize,center:{lat:r.center.lat}});return new t.Q(r.center.lng-n.x*o*a,t.ae(r.center.lat+n.y*o,-85.051129,t.af))}function lr(e){const t=.5*e,r=Math.sin(t),n=Math.cos(t);return Math.log(r+n)-Math.log(n-r)}function ur(e,r,n,i){const a=e.lat+n*i;if(Math.abs(n)>1){const o=(Math.sign(e.lat+n)!==Math.sign(e.lat)?-Math.abs(e.lat):Math.abs(e.lat))*Math.PI/180,s=Math.abs(e.lat+n)*Math.PI/180,l=lr(o+i*(s-o)),u=lr(o),c=lr(s);return new t.Q(e.lng+r*((l-u)/(c-u)),a)}return new t.Q(e.lng+r*i,a)}class cr{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,t,r,n){const i=`${e.z}_${e.x}_${e.y}`,a=this._cache.get(i);if(a)return a;const o=this._cachePrevious.get(i);if(o)return this._cache.set(i,o),o;const s=this._aabbFactory(e,t,r,n);return this._cache.set(i,s),this._hadAnyChanges=!0,s}}function hr(e,t,r){const n=e-t;return n<0?-n:Math.max(0,n-r)}function pr(e,t,r,n,i){const a=e-r;let o;return o=a<0?Math.min(-a,1+a-i):a>1?Math.min(Math.max(a-i,0),1-a):0,Math.max(o,hr(t,n,i))}class dr{constructor(){this._aabbCache=new cr(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,t,r,n){const i=1<<r.z,a=1/i,o=r.x/i,s=r.y/i;let l=2;return l=Math.min(l,pr(e,t,o,s,a)),l=Math.min(l,pr(e,t,o+.5,-s-a,a)),l=Math.min(l,pr(e,t,o+.5,2-s-a,a)),l}getWrap(e,t,r){const n=1<<t.z,i=1/n,a=t.x/n,o=hr(e.x,a,i),s=hr(e.x,a-1,i),l=hr(e.x,a+1,i),u=Math.min(o,s,l);return u===l?1:u===s?-1:0}allowVariableZoom(e,t){return ve(e,t)>4}allowWorldCopies(){return!1}getTileAABB(e,t,r,n){return this._aabbCache.getTileAABB(e,t,r,n)}_computeTileAABB(e,r,n,i){if(e.z<=0)return new It([-1,-1,-1],[1,1,1]);if(1===e.z)return new It([0===e.x?-1:0,0===e.y?0:-1,-1],[0===e.x?0:1,0===e.y?1:0,1]);{const r=[tr(0,0,e.x,e.y,e.z),tr(t.Z,0,e.x,e.y,e.z),tr(t.Z,t.Z,e.x,e.y,e.z),tr(0,t.Z,e.x,e.y,e.z)],n=[1,1,1],i=[-1,-1,-1];for(const e of r)for(let t=0;t<3;t++)n[t]=Math.min(n[t],e[t]),i[t]=Math.max(i[t],e[t]);if(0===e.y||e.y===(1<<e.z)-1){const t=[0,0===e.y?1:-1,0];for(let e=0;e<3;e++)n[e]=Math.min(n[e],t[e]),i[e]=Math.max(i[e],t[e])}return new It(n,i)}}}class fr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t){this._helper.resize(e,t)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=t.bk(),this._projectionMatrix=t.b1(),this._globeViewProjMatrix32f=t.b0(),this._globeViewProjMatrixNoCorrection=t.b1(),this._globeViewProjMatrixNoCorrectionInverted=t.b1(),this._globeProjMatrixInverted=t.b1(),this._cameraPosition=t.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Nt({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,t)=>this.getConstrained(e,t)}),this._coveringTilesDetailsProvider=new dr}clone(){const e=new fr;return e.apply(this),e}apply(e,t){this._globeLatitudeErrorCorrectionRadians=t||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=t.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:t,applyGlobeMatrix:r}=e,n=this._helper.getMercatorTileCoordinates(t);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:n,clippingPlane:this._cachedClippingPlane,projectionTransition:r?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,n=this.cameraToCenterDistance/e,i=Math.sin(r)*n,a=Math.cos(r)*n+1,o=1/Math.sqrt(i*i+a*a)*1;let s=-i,l=a;const u=Math.sqrt(s*s+l*l);s/=u,l/=u;const c=[0,s,l];t.bl(c,c,[0,0,0],-this.bearingInRadians),t.bm(c,c,[0,0,0],-1*this.center.lat*Math.PI/180),t.bn(c,c,[0,0,0],this.center.lng*Math.PI/180);const h=1/t.bo(c);return t.aO(c,c,h),[...c,-o*h]}isLocationOccluded(e){return!this.isSurfacePointVisible(rr(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,n=this._helper._center.lat*Math.PI/180,i=Math.cos(n),a=[Math.sin(r)*i,Math.sin(n),Math.cos(r)*i],o=[a[2],0,-a[0]],s=[0,0,0];t.aU(s,o,a),t.aT(o,o),t.aT(s,s);const l=[0,0,0];return t.aT(l,[o[0]*e[0]+s[0]*e[1]+a[0]*e[2],o[1]*e[0]+s[1]*e[1]+a[1]*e[2],o[2]*e[0]+s[2]*e[1]+a[2]*e[2]]),l}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,n){const i=function(e,r,n){const i=1/(1<<n.z);return new t.$(e/t.Z*i+n.x*i,r/t.Z*i+n.y*i)}(e,r,n.canonical),a=(o=i.y,[t.bg(i.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI]);var o;return this.getCircleRadiusCorrection()/Math.cos(a[1])}projectTileCoordinates(e,r,n,i){const a=n.canonical,o=tr(e,r,a.x,a.y,a.z),s=1+(i?i(e,r):0)/t.bu,l=[o[0]*s,o[1]*s,o[2]*s,1];t.at(l,l,this._globeViewProjMatrixNoCorrection);const u=this._cachedClippingPlane,c=u[0]*o[0]+u[1]*o[1]+u[2]*o[2]+u[3]<0;return{point:new t.P(l[0]/l[3],l[1]/l[3]),signedDistanceFromCamera:l[3],isOccluded:c}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=nr(this.worldSize,this.center.lat),r=t.b2(),n=t.b2();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),t.aY(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const i=this.centerOffset;r[8]=2*-i.x/this._helper._width,r[9]=2*i.y/this._helper._height,this._projectionMatrix=t.aZ(r),this._globeProjMatrixInverted=t.b2(),t.an(this._globeProjMatrixInverted,r),t.L(r,r,[0,0,-this.cameraToCenterDistance]),t.a_(r,r,this.rollInRadians),t.a$(r,r,-this.pitchInRadians),t.a_(r,r,this.bearingInRadians),t.L(r,r,[0,0,-e]);const a=t.bh();a[0]=e,a[1]=e,a[2]=e,t.a$(n,r,this.center.lat*Math.PI/180),t.bp(n,n,-this.center.lng*Math.PI/180),t.M(n,n,a),this._globeViewProjMatrixNoCorrection=n,t.a$(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),t.bp(r,r,-this.center.lng*Math.PI/180),t.M(r,r,a),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=t.b2(),t.an(this._globeViewProjMatrixNoCorrectionInverted,n);const o=t.bh();this._cameraPosition=t.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,t.bl(this._cameraPosition,this._cameraPosition,o,-this.rollInRadians),t.bm(this._cameraPosition,this._cameraPosition,o,this.pitchInRadians),t.bl(this._cameraPosition,this._cameraPosition,o,-this.bearingInRadians),t.aP(this._cameraPosition,this._cameraPosition,[0,0,1]),t.bm(this._cameraPosition,this._cameraPosition,o,-this.center.lat*Math.PI/180),t.bn(this._cameraPosition,this._cameraPosition,o,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const s=t.aZ(this._globeViewProjMatrixNoCorrectionInverted);t.M(s,s,[1,1,-1]),this._cachedFrustum=zt.fromInvProjectionMatrix(s)}calculateFogMatrix(e){t.w("calculateFogMatrix is not supported on globe projection.");const r=t.b2();return t.ad(r),r}getVisibleUnwrappedCoordinates(e){return[new t.aW(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&t.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const n=rr(e);t.aO(n,n,1+r/t.bu);const i=t.bk();return t.at(i,[n[0],n[1],n[2],1],this._globeViewProjMatrixNoCorrection),i[2]/i[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,n=[new t.P(0,0),new t.P(e,0),new t.P(this.width,0),new t.P(this.width,r),new t.P(this.width,this.height),new t.P(e,this.height),new t.P(0,this.height),new t.P(0,r)],i=[];for(const e of n)i.push(this.unprojectScreenPoint(e));let a=0,o=0,s=0,l=0;const u=this.center;for(const e of i){const r=t.bq(u.lng,e.lng),n=t.bq(u.lat,e.lat);r<o&&(o=r),r>a&&(a=r),n<l&&(l=n),n>s&&(s=n)}const c=[u.lng+o,u.lat+l,u.lng+a,u.lat+s];return this.isSurfacePointOnScreen([0,1,0])&&(c[3]=90,c[0]=-180,c[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(c[1]=-90,c[0]=-180,c[2]=180),new Z(c)}getConstrained(e,r){const n=t.ae(e.lat,-85.051129,t.af),i=t.ae(+r,this.minZoom+or(0,n),this.maxZoom);return{center:new t.Q(e.lng,n),zoom:i}}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}setLocationAtPoint(e,r){const n=rr(this.unprojectScreenPoint(r)),i=rr(e),a=t.bh();t.br(a);const o=t.bh();t.bn(o,n,a,-this.center.lng*Math.PI/180),t.bm(o,o,a,this.center.lat*Math.PI/180);const s=i[0]*i[0]+i[2]*i[2],l=o[0]*o[0];if(s<l)return;const u=Math.sqrt(s-l),c=-u,h=t.bs(i[0],i[2],o[0],u),p=t.bs(i[0],i[2],o[0],c),d=t.bh();t.bn(d,i,a,-h);const f=t.bs(d[1],d[2],o[1],o[2]),m=t.bh();t.bn(m,i,a,-p);const g=t.bs(m[1],m[2],o[1],o[2]),y=.5*Math.PI,v=f>=-y&&f<=y,x=g>=-y&&g<=y;let _,b;if(v&&x){const e=this.center.lng*Math.PI/180,r=this.center.lat*Math.PI/180;t.bv(h,e)+t.bv(f,r)<t.bv(p,e)+t.bv(g,r)?(_=h,b=f):(_=p,b=g)}else if(v)_=h,b=f;else{if(!x)return;_=p,b=g}const w=_/Math.PI*180,A=b/Math.PI*180,C=this.center.lat;this.setCenter(new t.Q(w,t.ae(A,-90,90))),this.setZoom(this.zoom+or(C,this.center.lat))}locationToScreenPoint(e,r){const n=rr(e);if(r){const i=r.getElevationForLngLatZoom(e,this._helper._tileZoom);t.aO(n,n,1+i/t.bu)}return this._projectSurfacePointToScreen(n)}_projectSurfacePointToScreen(e){const r=t.bk();return t.at(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new t.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const t=r.pointCoordinate(e);if(t)return t}return t.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,t){var r;return null===(r=this.screenPointToMercatorCoordinate(e,t))||void 0===r?void 0:r.toLngLat()}isPointOnMapSurface(e,t){const r=this._cameraPosition,n=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(r,n)}getRayDirectionFromPixel(e){const r=t.bk();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,t.at(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const n=t.bh();n[0]=r[0]-this._cameraPosition[0],n[1]=r[1]-this._cameraPosition[1],n[2]=r[2]-this._cameraPosition[2];const i=t.bh();return t.aT(i,n),i}isSurfacePointVisible(e){const t=this._cachedClippingPlane;return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=t.bk();return t.at(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const n=t.aV(e,r),i=t.bh(),a=t.bh();t.aO(a,r,n),t.aS(i,e,a);const o=1-t.aV(i,i);if(o<0)return null;const s=t.aV(e,e)-1,l=-n+(n<0?1:-1)*Math.sqrt(o),u=s/l,c=l;return{tMin:Math.min(u,c),tMax:Math.max(u,c)}}unprojectScreenPoint(e){const r=this._cameraPosition,n=this.getRayDirectionFromPixel(e),i=this.rayPlanetIntersection(r,n);if(i){const e=t.bh();t.aP(e,r,[n[0]*i.tMin,n[1]*i.tMin,n[2]*i.tMin]);const a=t.bh();return t.aT(a,e),ir(a)}const a=this._cachedClippingPlane,o=a[0]*n[0]+a[1]*n[1]+a[2]*n[2],s=-t.bt(a,r)/o,l=t.bh();if(s>0)t.aP(l,r,[n[0]*s,n[1]*s,n[2]*s]);else{const e=t.bh();t.aP(e,r,[2*n[0],2*n[1],2*n[2]]);const i=t.bt(this._cachedClippingPlane,e);t.aS(l,e,[this._cachedClippingPlane[0]*i,this._cachedClippingPlane[1]*i,this._cachedClippingPlane[2]*i])}const u=function(e){const r=t.bh();return r[0]=e[0]*-e[3],r[1]=e[1]*-e[3],r[2]=e[2]*-e[3],{center:r,radius:Math.sqrt(1-e[3]*e[3])}}(a);return ir(function(e,r,n){const i=t.bh();t.aS(i,n,e);const a=t.bh();return t.bi(a,e,i,r/t.bj(i)),a}(u.center,u.radius,l))}getMatrixForModel(e,r){const n=t.Q.convert(e),i=1/t.bu,a=t.b1();return t.bp(a,a,n.lng/180*Math.PI),t.a$(a,a,-n.lat/180*Math.PI),t.L(a,a,[0,0,1+r/t.bu]),t.a$(a,a,.5*Math.PI),t.M(a,a,[i,i,i]),a}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new t.Y(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class mr{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,t,r){return this._helper.interpolatePadding(e,t,r)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,t,r=!0){this._helper.resize(e,t,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,t){this._helper.overrideNearFarZ(e,t)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,t){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=t,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Nt({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,t)=>this.getConstrained(e,t)}),this._globeness=1,this._mercatorTransform=new Bt,this._verticalPerspectiveTransform=new fr}clone(){const e=new mr;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const t=this._mercatorTransform.getProjectionData(e),r=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?r.mainMatrix:t.mainMatrix,clippingPlane:r.clippingPlane,tileMercatorCoords:r.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:t.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return t.bc(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return t.bc(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,n){const i=this._mercatorTransform.getPitchedTextCorrection(e,r,n),a=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,n);return t.bc(i,a,this._globeness)}projectTileCoordinates(e,t,r,n){return this.currentTransform.projectTileCoordinates(e,t,r,n)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,t){return this.currentTransform.lngLatToCameraDepth(e,t)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,t){return this.currentTransform.getConstrained(e,t)}calculateCenterFromCameraLngLatAlt(e,t,r,n){return this._helper.calculateCenterFromCameraLngLatAlt(e,t,r,n)}setLocationAtPoint(e,t){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,t),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,t),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,t){return this.currentTransform.locationToScreenPoint(e,t)}screenPointToMercatorCoordinate(e,t){return this.currentTransform.screenPointToMercatorCoordinate(e,t)}screenPointToLocation(e,t){return this.currentTransform.screenPointToLocation(e,t)}isPointOnMapSurface(e,t){return this.currentTransform.isPointOnMapSurface(e,t)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,t){return this.currentTransform.getMatrixForModel(e,t)}getProjectionDataForCustomLayer(e=!0){const t=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return t;const r=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return r.fallbackMatrix=t.mainMatrix,r}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class gr{get useGlobeControls(){return!0}handlePanInertia(e,r){const n=sr(e,r);return Math.abs(n.lng-r.center.lng)>180&&(n.lng=r.center.lng+179.5*Math.sign(n.lng-r.center.lng)),{easingCenter:n,easingOffset:new t.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const n=e.around,i=r.screenPointToLocation(n);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const a=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const o=r.zoom-a;if(0===o)return;const s=t.bq(r.center.lng,i.lng),l=s/(Math.abs(s/180)+1),u=t.bq(r.center.lat,i.lat),c=r.getRayDirectionFromPixel(n),h=r.cameraPosition,p=-1*t.aV(h,c),d=t.bh();t.aP(d,h,[c[0]*p,c[1]*p,c[2]*p]);const f=t.bo(d)-1,m=Math.exp(.5*-Math.max(f-.3,0)),g=nr(r.worldSize,r.center.lat)/Math.min(r.width,r.height),y=t.bf(g,.9,.5,1,.25),v=(1-t.ac(-o))*Math.min(m,y),x=r.center.lat,_=r.zoom,b=new t.Q(r.center.lng+l*v,t.ae(r.center.lat+u*v,-85.051129,t.af));r.setLocationAtPoint(i,n);const w=r.center,A=t.bf(Math.abs(s),45,85,0,1),C=t.bf(g,.75,.35,0,1),E=Math.pow(Math.max(A,C),.25),M=t.bq(w.lng,b.lng),S=t.bq(w.lat,b.lat);r.setCenter(new t.Q(w.lng+M*E,w.lat+S*E).wrap()),r.setZoom(_+or(x,r.center.lat))}handleMapControlsPan(e,t,r){if(!e.panDelta)return;const n=t.center.lat,i=t.zoom;t.setCenter(sr(e.panDelta,t).wrap()),t.setZoom(i+or(n,t.center.lat))}cameraForBoxAndBearing(e,r,n,i,a){const o=Rt(e,r,n,i,a),s=r.left/a.width*2-1,l=(a.width-r.right)/a.width*2-1,u=r.top/a.height*-2+1,c=(a.height-r.bottom)/a.height*-2+1,h=t.bq(n.getWest(),n.getEast())<0,p=h?n.getEast():n.getWest(),d=h?n.getWest():n.getEast(),f=Math.max(n.getNorth(),n.getSouth()),m=Math.min(n.getNorth(),n.getSouth()),g=p+.5*t.bq(p,d),y=f+.5*t.bq(f,m),v=a.clone();v.setCenter(o.center),v.setBearing(o.bearing),v.setPitch(0),v.setRoll(0),v.setZoom(o.zoom);const x=v.modelViewProjectionMatrix,_=[rr(n.getNorthWest()),rr(n.getNorthEast()),rr(n.getSouthWest()),rr(n.getSouthEast()),rr(new t.Q(d,y)),rr(new t.Q(p,y)),rr(new t.Q(g,f)),rr(new t.Q(g,m))],b=rr(o.center);let w=Number.POSITIVE_INFINITY;for(const e of _)s<0&&(w=gr.getLesserNonNegativeNonNull(w,gr.solveVectorScale(e,b,x,"x",s))),l>0&&(w=gr.getLesserNonNegativeNonNull(w,gr.solveVectorScale(e,b,x,"x",l))),u>0&&(w=gr.getLesserNonNegativeNonNull(w,gr.solveVectorScale(e,b,x,"y",u))),c<0&&(w=gr.getLesserNonNegativeNonNull(w,gr.solveVectorScale(e,b,x,"y",c)));if(Number.isFinite(w)&&0!==w)return o.zoom=v.zoom+t.ah(w),o;kt()}handleJumpToCenterZoom(e,r){const n=e.center.lat,i=e.getConstrained(r.center?t.Q.convert(r.center):e.center,e.zoom).center;e.setCenter(i.wrap());const a=void 0!==r.zoom?+r.zoom:e.zoom+or(n,i.lat);e.zoom!==a&&e.setZoom(a)}handleEaseTo(e,r){const n=e.zoom,i=e.center,a=e.padding,o={roll:e.roll,pitch:e.pitch,bearing:e.bearing},s={roll:void 0===r.roll?e.roll:r.roll,pitch:void 0===r.pitch?e.pitch:r.pitch,bearing:void 0===r.bearing?e.bearing:r.bearing},l=void 0!==r.zoom,u=!e.isPaddingEqual(r.padding);let c=!1;const h=r.center?t.Q.convert(r.center):i,p=e.getConstrained(h,n).center;Dt(e,p);const d=e.clone();d.setCenter(p),d.setZoom(l?+r.zoom:n+or(i.lat,h.lat)),d.setBearing(r.bearing);const f=new t.P(t.ae(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),t.ae(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));d.setLocationAtPoint(p,f);const m=(r.offset&&r.offsetAsPoint.mag())>0?d.center:p,g=l?+r.zoom:n+or(i.lat,m.lat),y=n+or(i.lat,0),v=g+or(m.lat,0),x=t.bq(i.lng,m.lng),_=t.bq(i.lat,m.lat),b=t.ac(v-y);return c=g!==n,{easeFunc:n=>{if(t.b6(o,s)||Ft({startEulerAngles:o,endEulerAngles:s,tr:e,k:n,useSlerp:o.roll!=s.roll}),u&&e.interpolatePadding(a,r.padding,n),r.around)t.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const t=v>y?Math.min(2,b):Math.max(.5,b),r=Math.pow(t,1-n),a=ur(i,x,_,n*r);e.setCenter(a.wrap())}if(c){const r=t.B.number(y,v,n)+or(0,e.center.lat);e.setZoom(r)}},isZooming:c,elevationCenter:m}}handleFlyTo(e,r){const n=void 0!==r.zoom,i=e.center,a=e.zoom,o=e.padding,s=!e.isPaddingEqual(r.padding),l=e.getConstrained(t.Q.convert(r.center||r.locationAtOffset),a).center,u=n?+r.zoom:e.zoom+or(e.center.lat,l.lat),c=e.clone();c.setCenter(l),c.setZoom(u),c.setBearing(r.bearing);const h=new t.P(t.ae(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),t.ae(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));c.setLocationAtPoint(l,h);const p=c.center;Dt(e,p);const d=function(e,r,n){const i=rr(r),a=rr(n),o=t.aV(i,a),s=Math.acos(o),l=er(e);return s/(2*Math.PI)*l}(e,i,p),f=a+or(i.lat,0),m=u+or(p.lat,0),g=t.ac(m-f);let y;if("number"==typeof r.minZoom){const n=+r.minZoom+or(p.lat,0),i=Math.min(n,f,m)+or(0,p.lat),a=e.getConstrained(p,i).zoom+or(p.lat,0);y=t.ac(a-f)}const v=t.bq(i.lng,p.lng),x=t.bq(i.lat,p.lat);return{easeFunc:(n,a,l,c)=>{const h=ur(i,v,x,l);s&&e.interpolatePadding(o,r.padding,n);const d=1===n?p:h;e.setCenter(d.wrap());const m=f+t.ah(a);e.setZoom(1===n?u:m+or(0,d.lat))},scaleOfZoom:g,targetCenter:p,scaleOfMinZoom:y,pixelPathLength:d}}static solveVectorScale(e,t,r,n,i){const a="x"===n?[r[0],r[4],r[8],r[12]]:[r[1],r[5],r[9],r[13]],o=[r[3],r[7],r[11],r[15]],s=e[0]*a[0]+e[1]*a[1]+e[2]*a[2],l=e[0]*o[0]+e[1]*o[1]+e[2]*o[2],u=t[0]*a[0]+t[1]*a[1]+t[2]*a[2],c=t[0]*o[0]+t[1]*o[1]+t[2]*o[2];return u+i*l===s+i*c||o[3]*(s-u)+a[3]*(c-l)+s*c==u*l?null:(u+a[3]-i*c-i*o[3])/(u-s-i*c+i*l)}static getLesserNonNegativeNonNull(e,t){return null!==t&&t>=0&&t<e?t:e}}class yr{constructor(e){this._globe=e,this._mercatorCameraHelper=new Ot,this._verticalPerspectiveCameraHelper=new gr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,t){return this.currentHelper.handlePanInertia(e,t)}handleMapControlsRollPitchBearingZoom(e,t){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,t)}handleMapControlsPan(e,t,r){this.currentHelper.handleMapControlsPan(e,t,r)}cameraForBoxAndBearing(e,t,r,n,i){return this.currentHelper.cameraForBoxAndBearing(e,t,r,n,i)}handleJumpToCenterZoom(e,t){this.currentHelper.handleJumpToCenterZoom(e,t)}handleEaseTo(e,t){return this.currentHelper.handleEaseTo(e,t)}handleFlyTo(e,t){return this.currentHelper.handleFlyTo(e,t)}}const vr=(e,r)=>t.x(e,r&&r.filter((e=>"source.canvas"!==e.identifier))),xr=t.bw();class _r extends t.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(const e in this.sourceCaches){const t=this.sourceCaches[e].getSource().type;"vector"!==t&&"geojson"!==t||this.sourceCaches[e].reload()}},this.map=e,this.dispatcher=new R(F(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((e,t)=>this.getGlyphs(e,t))),this.dispatcher.registerMessageHandler("GI",((e,t)=>this.getImages(e,t))),this.imageManager=new _,this.imageManager.setEventedParent(this),this.glyphManager=new C(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new N(256,512),this.crossTileSymbolIndex=new vt,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.bx,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",t.by()),ie().on(te,this._rtlPluginLoaded),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.sourceCaches[e.sourceId];if(!t)return;const r=t.getSource();if(r&&r.vectorLayerIds)for(const e in this._layers){const t=this._layers[e];t.source===r.id&&this._validateLayer(t)}}))}loadURL(e,r={},n){this.fire(new t.l("dataloading",{dataType:"style"})),r.validate="boolean"!=typeof r.validate||r.validate;const i=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const a=this._loadStyleRequest;t.j(i,this._loadStyleRequest).then((e=>{this._loadStyleRequest=null,this._load(e.data,r,n)})).catch((e=>{this._loadStyleRequest=null,e&&!a.signal.aborted&&this.fire(new t.k(e))}))}loadJSON(e,r={},n){this.fire(new t.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,o.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,r.validate=!1!==r.validate,this._load(e,r,n)})).catch((()=>{}))}loadEmpty(){this.fire(new t.l("dataloading",{dataType:"style"})),this._load(xr,{validate:!1})}_load(e,r,n){var i,a;const o=r.transformStyle?r.transformStyle(n,e):e;if(!r.validate||!vr(this,t.y(o))){this._loaded=!0,this.stylesheet=o;for(const e in o.sources)this.addSource(e,o.sources[e],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs),this._createLayers(),this.light=new S(this.stylesheet.light),this._setProjectionInternal((null===(i=this.stylesheet.projection)||void 0===i?void 0:i.type)||"mercator"),this.sky=new T(this.stylesheet.sky),this.map.setTerrain(null!==(a=this.stylesheet.terrain)&&void 0!==a?a:null),this.fire(new t.l("data",{dataType:"style"})),this.fire(new t.l("style.load"))}}_createLayers(){const e=t.bz(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map((e=>e.id)),this._layers={},this._serializedLayers=null;for(const r of e){const e=t.bA(r);e.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=e}}_loadSprite(e,r=!1,n=void 0){let i;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(e,r,n,i){return t._(this,void 0,void 0,(function*(){const a=g(e),s=n>1?"@2x":"",l={},u={};for(const{id:e,url:n}of a){const a=r.transformRequest(y(n,s,".json"),"SpriteJSON");l[e]=t.j(a,i);const o=r.transformRequest(y(n,s,".png"),"SpriteImage");u[e]=f.getImage(o,i)}return yield Promise.all([...Object.values(l),...Object.values(u)]),function(e,r){return t._(this,void 0,void 0,(function*(){const t={};for(const n in e){t[n]={};const i=o.getImageCanvasContext((yield r[n]).data),a=(yield e[n]).data;for(const e in a){const{width:r,height:o,x:s,y:l,sdf:u,pixelRatio:c,stretchX:h,stretchY:p,content:d,textFitWidth:f,textFitHeight:m}=a[e];t[n][e]={data:null,pixelRatio:c,sdf:u,stretchX:h,stretchY:p,content:d,textFitWidth:f,textFitHeight:m,spriteData:{width:r,height:o,x:s,y:l,context:i}}}}return t}))}(l,u)}))}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((e=>{if(this._spriteRequest=null,e)for(const t in e){this._spritesImagesIds[t]=[];const n=this._spritesImagesIds[t]?this._spritesImagesIds[t].filter((t=>!(t in e))):[];for(const e of n)this.imageManager.removeImage(e),this._changedImages[e]=!0;for(const n in e[t]){const i="default"===t?n:`${t}:${n}`;this._spritesImagesIds[t].push(i),i in this.imageManager.images?this.imageManager.updateImage(i,e[t][n],!1):this.imageManager.addImage(i,e[t][n]),r&&(this._changedImages[i]=!0)}}})).catch((e=>{this._spriteRequest=null,i=e,this.fire(new t.k(i))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"})),n&&n(i)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const n=e.sourceLayer;if(!n)return;const i=r.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new t.k(new Error(`Source layer "${n}" does not exist on source "${i.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const n=this._serializedAllLayers();if(!e||0===e.length)return Object.values(r?t.bB(n):n);const i=[];for(const a of e)if(n[a]){const e=r?t.bB(n[a]):n[a];i.push(e)}return i}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const t=Object.keys(this._layers);for(const r of t){const t=this._layers[r];"custom"!==t.type&&(e[r]=t.serialize())}return e}hasTransitions(){var e,t,r;if(null===(e=this.light)||void 0===e?void 0:e.hasTransition())return!0;if(null===(t=this.sky)||void 0===t?void 0:t.hasTransition())return!0;if(null===(r=this.projection)||void 0===r?void 0:r.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const t=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);(t.length||r.length)&&this._updateWorkerLayers(t,r);for(const e in this._updatedSources){const t=this._updatedSources[e];if("reload"===t)this._reloadSource(e);else{if("clear"!==t)throw new Error(`Invalid action ${t}`);this._clearSource(e)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const t in this._updatedPaintProps)this._layers[t].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const n={};for(const e in this.sourceCaches){const t=this.sourceCaches[e];n[e]=t.used,t.used=!1}for(const t of this._order){const r=this._layers[t];r.recalculate(e,this._availableImages),!r.isHidden(e.zoom)&&r.source&&(this.sourceCaches[r.source].used=!0)}for(const e in n){const r=this.sourceCaches[e];!!n[e]!=!!r.used&&r.fire(new t.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:e}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new t.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var n;this._checkLoaded();const i=this.serialize();if(e=r.transformStyle?r.transformStyle(i,e):e,(null===(n=r.validate)||void 0===n||n)&&vr(this,t.y(e)))return!1;(e=t.bB(e)).layers=t.bz(e.layers);const a=t.bC(i,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error(`Unimplemented: ${o.unimplemented.join(", ")}.`);if(0===o.operations.length)return!1;for(const e of o.operations)e();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const t=[],r=[];for(const n of e)switch(n.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":t.push((()=>this.addLayer.apply(this,n.args)));break;case"removeLayer":t.push((()=>this.removeLayer.apply(this,n.args)));break;case"setPaintProperty":t.push((()=>this.setPaintProperty.apply(this,n.args)));break;case"setLayoutProperty":t.push((()=>this.setLayoutProperty.apply(this,n.args)));break;case"setFilter":t.push((()=>this.setFilter.apply(this,n.args)));break;case"addSource":t.push((()=>this.addSource.apply(this,n.args)));break;case"removeSource":t.push((()=>this.removeSource.apply(this,n.args)));break;case"setLayerZoomRange":t.push((()=>this.setLayerZoomRange.apply(this,n.args)));break;case"setLight":t.push((()=>this.setLight.apply(this,n.args)));break;case"setGeoJSONSourceData":t.push((()=>this.setGeoJSONSourceData.apply(this,n.args)));break;case"setGlyphs":t.push((()=>this.setGlyphs.apply(this,n.args)));break;case"setSprite":t.push((()=>this.setSprite.apply(this,n.args)));break;case"setTerrain":t.push((()=>this.map.setTerrain.apply(this,n.args)));break;case"setSky":t.push((()=>this.setSky.apply(this,n.args)));break;case"setProjection":this.setProjection.apply(this,n.args);break;case"setTransition":t.push((()=>{}));break;default:r.push(n.command)}return{operations:t,unimplemented:r}}addImage(e,r){if(this.getImage(e))return this.fire(new t.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new t.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,n={}){if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(t.y.source,`sources.${e}`,r,null,n))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const i=this.sourceCaches[e]=new _e(e,r,this.dispatcher);i.style=this,i.setEventedParent(this,(()=>({isSourceLoaded:i.loaded(),source:i.serialize(),sourceId:e}))),i.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===e)return this.fire(new t.k(new Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error(`There is no source with this ID=${e}`);const r=this.sourceCaches[e].getSource();if("geojson"!==r.type)throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,n={}){this._checkLoaded();const i=e.id;if(this.getLayer(i))return void this.fire(new t.k(new Error(`Layer "${i}" already exists on this map.`)));let a;if("custom"===e.type){if(vr(this,t.bD(e)))return;a=t.bA(e)}else{if("source"in e&&"object"==typeof e.source&&(this.addSource(i,e.source),e=t.bB(e),e=t.e(e,{source:i})),this._validate(t.y.layer,`layers.${i}`,e,{arrayIndex:-1},n))return;a=t.bA(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:i}})}const o=r?this._order.indexOf(r):this._order.length;if(r&&-1===o)this.fire(new t.k(new Error(`Cannot add layer "${i}" before non-existing layer "${r}".`)));else{if(this._order.splice(o,0,i),this._layerOrderChanged=!0,this._layers[i]=a,this._removedLayers[i]&&a.source&&"custom"!==a.type){const e=this._removedLayers[i];delete this._removedLayers[i],e.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const n=this._order.indexOf(e);this._order.splice(n,1);const i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new t.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new t.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,n){this._checkLoaded();const i=this.getLayer(e);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new t.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,n={}){this._checkLoaded();const i=this.getLayer(e);if(i){if(!t.bE(i.filter,r))return null==r?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.y.filter,`layers.${i.id}.filter`,r,null,n)||(i.filter=t.bB(r),this._updateLayer(i)))}else this.fire(new t.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return t.bB(this.getLayer(e).filter)}setLayoutProperty(e,r,n,i={}){this._checkLoaded();const a=this.getLayer(e);a?t.bE(a.getLayoutProperty(r),n)||(a.setLayoutProperty(r,n,i),this._updateLayer(a)):this.fire(new t.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const n=this.getLayer(e);if(n)return n.getLayoutProperty(r);this.fire(new t.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,n,i={}){this._checkLoaded();const a=this.getLayer(e);a?t.bE(a.getPaintProperty(r),n)||(a.setPaintProperty(r,n,i)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new t.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,r){this._checkLoaded();const n=e.source,i=e.sourceLayer,a=this.sourceCaches[n];if(void 0===a)return void this.fire(new t.k(new Error(`The source '${n}' does not exist in the map's style.`)));const o=a.getSource().type;"geojson"===o&&i?this.fire(new t.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||i?(void 0===e.id&&this.fire(new t.k(new Error("The feature id parameter must be provided."))),a.setFeatureState(i,e.id,r)):this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const n=e.source,i=this.sourceCaches[n];if(void 0===i)return void this.fire(new t.k(new Error(`The source '${n}' does not exist in the map's style.`)));const a=i.getSource().type,o="vector"===a?e.sourceLayer:void 0;"vector"!==a||o?r&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.k(new Error("A feature id is required to remove its specific state property."))):i.removeFeatureState(o,e.id,r):this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,n=e.sourceLayer,i=this.sourceCaches[r];if(void 0!==i)return"vector"!==i.getSource().type||n?(void 0===e.id&&this.fire(new t.k(new Error("The feature id parameter must be provided."))),i.getFeatureState(n,e.id)):void this.fire(new t.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return t.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=t.bF(this.sourceCaches,(e=>e.serialize())),r=this._serializeByIds(this._order,!0),n=this.map.getTerrain()||void 0,i=this.stylesheet;return t.bG({version:i.version,name:i.name,metadata:i.metadata,light:i.light,sky:i.sky,center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,sprite:i.sprite,glyphs:i.glyphs,transition:i.transition,projection:i.projection,sources:e,layers:r,terrain:n},(e=>void 0!==e))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,r={},n=[];for(let i=this._order.length-1;i>=0;i--){const a=this._order[i];if(t(a)){r[a]=i;for(const t of e){const e=t[a];if(e)for(const t of e)n.push(t)}}}n.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const i=[];for(let a=this._order.length-1;a>=0;a--){const o=this._order[a];if(t(o))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(r[t.layer.id]<a)break;i.push(t),n.pop()}else for(const t of e){const e=t[o];if(e)for(const t of e)i.push(t.feature)}}return i}queryRenderedFeatures(e,r,n){r&&r.filter&&this._validate(t.y.filter,"queryRenderedFeatures.filter",r.filter,null,r);const i={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new t.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const e of r.layers){const r=this._layers[e];if(!r)return this.fire(new t.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];i[r.source]=!0}}const a=[];r.availableImages=this._availableImages;const o=this._serializedAllLayers(),s=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,l=Object.assign(Object.assign({},r),{layers:s});for(const t in this.sourceCaches)r.layers&&!i[t]||a.push(q(this.sourceCaches[t],this._layers,o,e,l,n,this.map.terrain?(e,t,r)=>this.map.terrain.getElevation(e,t,r):void 0));return this.placement&&a.push(function(e,t,r,n,i,a,o){const s={},l=a.queryRenderedSymbols(n),u=[];for(const e of Object.keys(l).map(Number))u.push(o[e]);u.sort(j);for(const r of u){const n=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,i.filter,i.layers,i.availableImages,e);for(const e in n){const t=s[e]=s[e]||[],i=n[e];i.sort(((e,t)=>{const n=r.featureSortOrder;if(n){const r=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-r}return t.featureIndex-e.featureIndex}));for(const e of i)t.push(e)}}return function(e,t,r){for(const n in e)for(const i of e[n])U(i,r[t[n].source]);return e}(s,e,r)}(this._layers,o,this.sourceCaches,e,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,r){r&&r.filter&&this._validate(t.y.filter,"querySourceFeatures.filter",r.filter,null,r);const n=this.sourceCaches[e];return n?function(e,t){const r=e.getRenderableIds().map((t=>e.getTileByID(t))),n=[],i={};for(let e=0;e<r.length;e++){const a=r[e],o=a.tileID.canonical.key;i[o]||(i[o]=!0,a.querySourceFeatures(n,t))}return n}(n,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const n=this.light.getLight();let i=!1;for(const r in e)if(!t.bE(e[r],n[r])){i=!0;break}if(!i)return;const a={now:o.now(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(a)}getProjection(){var e;return null===(e=this.stylesheet)||void 0===e?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return null===(e=this.stylesheet)||void 0===e?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const n=this.getSky();let i=!1;if(!e&&!n)return;if(e&&!n)i=!0;else if(!e&&n)i=!0;else for(const r in e)if(!t.bE(e[r],n[r])){i=!0;break}if(!i)return;const a={now:o.now(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(a)}_setProjectionInternal(e){const r=function(e){if(Array.isArray(e)){const t=new Qt({type:e});return{projection:t,transform:new mr,cameraHelper:new yr(t)}}switch(e){case"mercator":return{projection:new Mt,transform:new Bt,cameraHelper:new Ot};case"globe":{const e=new Qt({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:e,transform:new mr,cameraHelper:new yr(e)}}case"vertical-perspective":return{projection:new Kt,transform:new fr,cameraHelper:new gr};default:return t.w(`Unknown projection name: ${e}. Falling back to mercator projection.`),{projection:new Mt,transform:new Bt,cameraHelper:new Ot}}}(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const e in this.sourceCaches)this.sourceCaches[e].reload()}_validate(e,r,n,i,a={}){return(!a||!1!==a.validate)&&vr(this,e.call(t.y,t.e({key:r,style:this.serialize(),value:n,styleSpec:t.v},i)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ie().off(te,this._rtlPluginLoaded);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this.sourceCaches){const t=this.sourceCaches[e];t.setEventedParent(null),t.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,t,r,n,i=!1){let a=!1,s=!1;const l={};for(const t of this._order){const r=this._layers[t];if("symbol"!==r.type)continue;if(!l[r.source]){const e=this.sourceCaches[r.source];l[r.source]=e.getRenderableIds(!0).map((t=>e.getTileByID(t))).sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const n=this.crossTileSymbolIndex.addLayer(r,l[r.source],e.center.lng);a=a||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((i=i||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.now(),e.zoom))&&(this.pauseablePlacement=new dt(e,this.map.terrain,this._order,i,t,r,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(const e of this._order){const t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,l[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return t._(this,void 0,void 0,(function*(){const e=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const t=this.sourceCaches[r.source];return t&&t.setDependencies(r.tileID.key,r.type,r.icons),e}))}getGlyphs(e,r){return t._(this,void 0,void 0,(function*(){const e=yield this.glyphManager.getGlyphs(r.stacks),t=this.sourceCaches[r.source];return t&&t.setDependencies(r.tileID.key,r.type,[""]),e}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(t.y.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,n={},i){this._checkLoaded();const a=[{id:e,url:r}],o=[...g(this.stylesheet.sprite),...a];this._validate(t.y.sprite,"sprite",o,null,n)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,i))}removeSprite(e){this._checkLoaded();const r=g(this.stylesheet.sprite);if(r.find((t=>t.id===e))){if(this._spritesImagesIds[e])for(const t of this._spritesImagesIds[e])this.imageManager.removeImage(t),this._changedImages[t]=!0;r.splice(r.findIndex((t=>t.id===e)),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.l("data",{dataType:"style"}))}else this.fire(new t.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return g(this.stylesheet.sprite)}setSprite(e,r={},n){this._checkLoaded(),e&&this._validate(t.y.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,n):(this._unloadSprite(),n&&n(null)))}}var br=t.aG([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class wr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,r,n,i,a,o,s,l){this.context=e;let u=this.boundPaintVertexBuffers.length!==n.length;for(let e=0;!u&&e<n.length;e++)this.boundPaintVertexBuffers[e]!==n[e]&&(u=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||u||this.boundIndexBuffer!==i||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==s||this.boundDynamicVertexBuffer3!==l?this.freshBind(t,r,n,i,a,o,s,l):(e.bindVertexArray.set(this.vao),o&&o.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind(),l&&l.bind())}freshBind(e,t,r,n,i,a,o,s){const l=e.numAttributes,u=this.context,c=u.gl;this.vao&&this.destroy(),this.vao=u.createVertexArray(),u.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=s,t.enableAttributes(c,e);for(const t of r)t.enableAttributes(c,e);a&&a.enableAttributes(c,e),o&&o.enableAttributes(c,e),s&&s.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,i);for(const t of r)t.bind(),t.setVertexAttribPointers(c,e,i);a&&(a.bind(),a.setVertexAttribPointers(c,e,i)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(c,e,i)),s&&(s.bind(),s.setVertexAttribPointers(c,e,i)),u.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Ar=(e,r,n,i,a)=>({u_texture:0,u_ele_delta:e,u_fog_matrix:r,u_fog_color:n?n.properties.get("fog-color"):t.b7.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:a?0:n?n.calculateFogBlendOpacity(i):0,u_horizon_color:n?n.properties.get("horizon-color"):t.b7.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:a?1:0}),Cr={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Er(e){const t=[];for(let r=0;r<e.length;r++){if(null===e[r])continue;const n=e[r].split(" ");t.push(n.pop())}return t}class Mr{constructor(e,r,n,i,a,o,s,l,u=[]){const c=e.gl;this.program=c.createProgram();const h=Er(r.staticAttributes),p=n?n.getBinderAttributes():[],d=h.concat(p),f=_t.prelude.staticUniforms?Er(_t.prelude.staticUniforms):[],m=s.staticUniforms?Er(s.staticUniforms):[],g=r.staticUniforms?Er(r.staticUniforms):[],y=n?n.getBinderUniforms():[],v=f.concat(m).concat(g).concat(y),x=[];for(const e of v)x.indexOf(e)<0&&x.push(e);const _=n?n.defines():[];Gt(c)&&_.unshift("#version 300 es"),a&&_.push("#define OVERDRAW_INSPECTOR;"),o&&_.push("#define TERRAIN3D;"),l&&_.push(l),u&&_.push(...u);let b=_.concat(_t.prelude.fragmentSource,s.fragmentSource,r.fragmentSource).join("\n"),w=_.concat(_t.prelude.vertexSource,s.vertexSource,r.vertexSource).join("\n");Gt(c)||(b=function(e){return e.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(b),w=function(e){return e.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(w));const A=c.createShader(c.FRAGMENT_SHADER);if(c.isContextLost())return void(this.failedToCreate=!0);if(c.shaderSource(A,b),c.compileShader(A),!c.getShaderParameter(A,c.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${c.getShaderInfoLog(A)}`);c.attachShader(this.program,A);const C=c.createShader(c.VERTEX_SHADER);if(c.isContextLost())return void(this.failedToCreate=!0);if(c.shaderSource(C,w),c.compileShader(C),!c.getShaderParameter(C,c.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${c.getShaderInfoLog(C)}`);c.attachShader(this.program,C),this.attributes={};const E={};this.numAttributes=d.length;for(let e=0;e<this.numAttributes;e++)d[e]&&(c.bindAttribLocation(this.program,e,d[e]),this.attributes[d[e]]=e);if(c.linkProgram(this.program),!c.getProgramParameter(this.program,c.LINK_STATUS))throw new Error(`Program failed to link: ${c.getProgramInfoLog(this.program)}`);c.deleteShader(C),c.deleteShader(A);for(let e=0;e<x.length;e++){const t=x[e];if(t&&!E[t]){const e=c.getUniformLocation(this.program,t);e&&(E[t]=e)}}this.fixedUniforms=i(e,E),this.terrainUniforms=((e,r)=>({u_depth:new t.bH(e,r.u_depth),u_terrain:new t.bH(e,r.u_terrain),u_terrain_dim:new t.b8(e,r.u_terrain_dim),u_terrain_matrix:new t.bJ(e,r.u_terrain_matrix),u_terrain_unpack:new t.bK(e,r.u_terrain_unpack),u_terrain_exaggeration:new t.b8(e,r.u_terrain_exaggeration)}))(e,E),this.projectionUniforms=((e,r)=>({u_projection_matrix:new t.bJ(e,r.u_projection_matrix),u_projection_tile_mercator_coords:new t.bK(e,r.u_projection_tile_mercator_coords),u_projection_clipping_plane:new t.bK(e,r.u_projection_clipping_plane),u_projection_transition:new t.b8(e,r.u_projection_transition),u_projection_fallback_matrix:new t.bJ(e,r.u_projection_fallback_matrix)}))(e,E),this.binderUniforms=n?n.getUniforms(e,E):[]}draw(e,t,r,n,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v){const x=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(i),e.setCullFace(a),s){e.activeTexture.set(x.TEXTURE2),x.bindTexture(x.TEXTURE_2D,s.depthTexture),e.activeTexture.set(x.TEXTURE3),x.bindTexture(x.TEXTURE_2D,s.texture);for(const e in this.terrainUniforms)this.terrainUniforms[e].set(s[e])}if(l)for(const e in l)this.projectionUniforms[Cr[e]].set(l[e]);if(o)for(const e in this.fixedUniforms)this.fixedUniforms[e].set(o[e]);m&&m.setUniforms(e,this.binderUniforms,d,{zoom:f});let _=0;switch(t){case x.LINES:_=2;break;case x.TRIANGLES:_=3;break;case x.LINE_STRIP:_=1}for(const r of p.get()){const n=r.vaos||(r.vaos={});(n[u]||(n[u]=new wr)).bind(e,this,c,m?m.getPaintVertexBuffers():[],h,r.vertexOffset,g,y,v),x.drawElements(t,r.primitiveLength*_,x.UNSIGNED_SHORT,r.primitiveOffset*_*2)}}}function Sr(e,r,n){const i=1/t.az(n,1,r.transform.tileZoom),a=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,r.transform.tileZoom)/a,s=o*(n.tileID.canonical.x+n.tileID.wrap*a),l=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[s>>16,l>>16],u_pixel_coord_lower:[65535&s,65535&l]}}const Dr=(e,r,n,i)=>{const a=e.style.light,o=a.properties.get("position"),s=[o.x,o.y,o.z],l=t.bN();"viewport"===a.properties.get("anchor")&&t.bO(l,e.transform.bearingInRadians),t.bP(s,s,l);const u=e.transform.transformLightDirection(s),c=a.properties.get("color");return{u_lightpos:s,u_lightpos_globe:u,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+r,u_opacity:n,u_fill_translate:i}},Tr=(e,r,n,i,a,o,s)=>t.e(Dr(e,r,n,i),Sr(o,e,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8}),Nr=(e,r,n,i)=>t.e(Sr(r,e,n),{u_fill_translate:i}),Ir=(e,t)=>({u_world:e,u_fill_translate:t}),Pr=(e,r,n,i,a)=>t.e(Nr(e,r,n,a),{u_world:i}),zr=(e,r,n,i,a)=>{const o=e.transform;let s,l,u=0;if("map"===n.paint.get("circle-pitch-alignment")){const e=t.az(r,1,o.zoom);s=!0,l=[e,e],u=e/(t.Z*Math.pow(2,r.tileID.overscaledZ))*2*Math.PI*a}else s=!1,l=o.pixelsToGLUnits;return{u_camera_to_center_distance:o.cameraToCenterDistance,u_scale_with_map:+("map"===n.paint.get("circle-pitch-scale")),u_pitch_with_map:+s,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:l,u_globe_extrude_scale:u,u_translate:i}},Br=e=>({u_pixel_extrude_scale:[1/e.width,1/e.height]}),kr=e=>({u_viewport_size:[e.width,e.height]}),Fr=(e,t=1)=>({u_color:e,u_overlay:0,u_overlay_scale:t}),Rr=(e,r,n,i)=>{const a=t.az(e,1,r)/(t.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*i;return{u_extrude_scale:t.az(e,1,r),u_intensity:n,u_globe_extrude_scale:a}},Or=(e,r,n,i)=>{const a=t.K();t.bQ(a,0,e.width,e.height,0,0,1);const o=e.context.gl;return{u_matrix:a,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:n,u_color_ramp:i,u_opacity:r.paint.get("heatmap-opacity")}},Lr=(e,t,r)=>{const n=r.paint.get("hillshade-accent-color");let i;switch(r.paint.get("hillshade-method")){case"basic":i=4;break;case"combined":i=1;break;case"igor":i=2;break;case"multidirectional":i=3;break;default:i=0}const a=r.getIlluminationProperties();for(let t=0;t<a.directionRadians.length;t++)"viewport"===r.paint.get("hillshade-illumination-anchor")&&(a.directionRadians[t]+=e.transform.bearingInRadians);return{u_image:0,u_latrange:jr(0,t.tileID),u_exaggeration:r.paint.get("hillshade-exaggeration"),u_altitudes:a.altitudeRadians,u_azimuths:a.directionRadians,u_accent:n,u_method:i,u_highlights:a.highlightColor,u_shadows:a.shadowColor}},qr=(e,r)=>{const n=r.stride,i=t.K();return t.bQ(i,0,t.Z,-8192,0,0,1),t.L(i,i,[0,-8192,0]),{u_matrix:i,u_image:1,u_dimension:[n,n],u_zoom:e.overscaledZ,u_unpack:r.getUnpackVector()}};function jr(e,r){const n=Math.pow(2,r.canonical.z),i=r.canonical.y;return[new t.$(0,i/n).toLngLat().lat,new t.$(0,(i+1)/n).toLngLat().lat]}const Ur=(e,r,n,i)=>{const a=e.transform;return{u_translation:Hr(e,r,n),u_ratio:i/t.az(r,1,a.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Vr=(e,r,n,i,a)=>t.e(Ur(e,r,n,i),{u_image:0,u_image_height:a}),Zr=(e,r,n,i,a)=>{const o=e.transform,s=Gr(r,o);return{u_translation:Hr(e,r,n),u_texsize:r.imageAtlasTexture.size,u_ratio:i/t.az(r,1,o.zoom),u_device_pixel_ratio:e.pixelRatio,u_image:0,u_scale:[s,a.fromScale,a.toScale],u_fade:a.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},$r=(e,r,n,i,a,o)=>{const s=e.lineAtlas,l=Gr(r,e.transform),u="round"===n.layout.get("line-cap"),c=s.getDash(a.from,u),h=s.getDash(a.to,u),p=c.width*o.fromScale,d=h.width*o.toScale;return t.e(Ur(e,r,n,i),{u_patternscale_a:[l/p,-c.height/2],u_patternscale_b:[l/d,-h.height/2],u_sdfgamma:s.width/(256*Math.min(p,d)*e.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:h.y,u_mix:o.t})};function Gr(e,r){return 1/t.az(e,1,r.tileZoom)}function Hr(e,r,n){return t.aA(e.transform,r,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Wr=(e,t,r,n,i)=>{return{u_tl_parent:e,u_scale_parent:t,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:(o=n.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(a=n.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Xr(n.paint.get("raster-hue-rotate")),u_coords_top:[i[0].x,i[0].y,i[1].x,i[1].y],u_coords_bottom:[i[3].x,i[3].y,i[2].x,i[2].y]};var a,o};function Xr(e){e*=Math.PI/180;const t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}const Yr=(e,t,r,n,i,a,o,s,l,u,c,h,p)=>{const d=o.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:d.cameraToCenterDistance,u_pitch:d.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:d.width/d.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_label_plane_matrix:s,u_coord_matrix:l,u_is_text:+c,u_pitch_with_map:+n,u_is_along_line:i,u_is_variable_anchor:a,u_texsize:h,u_texture:0,u_translation:u,u_pitched_scale:p}},Kr=(e,r,n,i,a,o,s,l,u,c,h,p,d,f)=>{const m=s.transform;return t.e(Yr(e,r,n,i,a,o,s,l,u,c,h,p,f),{u_gamma_scale:i?Math.cos(m.pitch*Math.PI/180)*m.cameraToCenterDistance:1,u_device_pixel_ratio:s.pixelRatio,u_is_halo:1})},Jr=(e,r,n,i,a,o,s,l,u,c,h,p,d)=>t.e(Kr(e,r,n,i,a,o,s,l,u,c,!0,h,0,d),{u_texsize_icon:p,u_texture_icon:1}),Qr=(e,t)=>({u_opacity:e,u_color:t}),en=(e,r,n,i,a)=>t.e(function(e,r,n,i){const a=n.imageManager.getPattern(e.from.toString()),o=n.imageManager.getPattern(e.to.toString()),{width:s,height:l}=n.imageManager.getPixelSize(),u=Math.pow(2,i.tileID.overscaledZ),c=i.tileSize*Math.pow(2,n.transform.tileZoom)/u,h=c*(i.tileID.canonical.x+i.tileID.wrap*u),p=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:a.tl,u_pattern_br_a:a.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,l],u_mix:r.t,u_pattern_size_a:a.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:r.fromScale,u_scale_b:r.toScale,u_tile_units_to_pixels:1/t.az(i,1,n.transform.tileZoom),u_pixel_coord_upper:[h>>16,p>>16],u_pixel_coord_lower:[65535&h,65535&p]}}(n,a,r,i),{u_opacity:e}),tn=(e,t)=>{},rn={fillExtrusion:(e,r)=>({u_lightpos:new t.bL(e,r.u_lightpos),u_lightpos_globe:new t.bL(e,r.u_lightpos_globe),u_lightintensity:new t.b8(e,r.u_lightintensity),u_lightcolor:new t.bL(e,r.u_lightcolor),u_vertical_gradient:new t.b8(e,r.u_vertical_gradient),u_opacity:new t.b8(e,r.u_opacity),u_fill_translate:new t.bM(e,r.u_fill_translate)}),fillExtrusionPattern:(e,r)=>({u_lightpos:new t.bL(e,r.u_lightpos),u_lightpos_globe:new t.bL(e,r.u_lightpos_globe),u_lightintensity:new t.b8(e,r.u_lightintensity),u_lightcolor:new t.bL(e,r.u_lightcolor),u_vertical_gradient:new t.b8(e,r.u_vertical_gradient),u_height_factor:new t.b8(e,r.u_height_factor),u_opacity:new t.b8(e,r.u_opacity),u_fill_translate:new t.bM(e,r.u_fill_translate),u_image:new t.bH(e,r.u_image),u_texsize:new t.bM(e,r.u_texsize),u_pixel_coord_upper:new t.bM(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.bM(e,r.u_pixel_coord_lower),u_scale:new t.bL(e,r.u_scale),u_fade:new t.b8(e,r.u_fade)}),fill:(e,r)=>({u_fill_translate:new t.bM(e,r.u_fill_translate)}),fillPattern:(e,r)=>({u_image:new t.bH(e,r.u_image),u_texsize:new t.bM(e,r.u_texsize),u_pixel_coord_upper:new t.bM(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.bM(e,r.u_pixel_coord_lower),u_scale:new t.bL(e,r.u_scale),u_fade:new t.b8(e,r.u_fade),u_fill_translate:new t.bM(e,r.u_fill_translate)}),fillOutline:(e,r)=>({u_world:new t.bM(e,r.u_world),u_fill_translate:new t.bM(e,r.u_fill_translate)}),fillOutlinePattern:(e,r)=>({u_world:new t.bM(e,r.u_world),u_image:new t.bH(e,r.u_image),u_texsize:new t.bM(e,r.u_texsize),u_pixel_coord_upper:new t.bM(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.bM(e,r.u_pixel_coord_lower),u_scale:new t.bL(e,r.u_scale),u_fade:new t.b8(e,r.u_fade),u_fill_translate:new t.bM(e,r.u_fill_translate)}),circle:(e,r)=>({u_camera_to_center_distance:new t.b8(e,r.u_camera_to_center_distance),u_scale_with_map:new t.bH(e,r.u_scale_with_map),u_pitch_with_map:new t.bH(e,r.u_pitch_with_map),u_extrude_scale:new t.bM(e,r.u_extrude_scale),u_device_pixel_ratio:new t.b8(e,r.u_device_pixel_ratio),u_globe_extrude_scale:new t.b8(e,r.u_globe_extrude_scale),u_translate:new t.bM(e,r.u_translate)}),collisionBox:(e,r)=>({u_pixel_extrude_scale:new t.bM(e,r.u_pixel_extrude_scale)}),collisionCircle:(e,r)=>({u_viewport_size:new t.bM(e,r.u_viewport_size)}),debug:(e,r)=>({u_color:new t.bI(e,r.u_color),u_overlay:new t.bH(e,r.u_overlay),u_overlay_scale:new t.b8(e,r.u_overlay_scale)}),depth:tn,clippingMask:tn,heatmap:(e,r)=>({u_extrude_scale:new t.b8(e,r.u_extrude_scale),u_intensity:new t.b8(e,r.u_intensity),u_globe_extrude_scale:new t.b8(e,r.u_globe_extrude_scale)}),heatmapTexture:(e,r)=>({u_matrix:new t.bJ(e,r.u_matrix),u_world:new t.bM(e,r.u_world),u_image:new t.bH(e,r.u_image),u_color_ramp:new t.bH(e,r.u_color_ramp),u_opacity:new t.b8(e,r.u_opacity)}),hillshade:(e,r)=>({u_image:new t.bH(e,r.u_image),u_latrange:new t.bM(e,r.u_latrange),u_exaggeration:new t.b8(e,r.u_exaggeration),u_altitudes:new t.bS(e,r.u_altitudes),u_azimuths:new t.bS(e,r.u_azimuths),u_accent:new t.bI(e,r.u_accent),u_method:new t.bH(e,r.u_method),u_shadows:new t.bR(e,r.u_shadows),u_highlights:new t.bR(e,r.u_highlights)}),hillshadePrepare:(e,r)=>({u_matrix:new t.bJ(e,r.u_matrix),u_image:new t.bH(e,r.u_image),u_dimension:new t.bM(e,r.u_dimension),u_zoom:new t.b8(e,r.u_zoom),u_unpack:new t.bK(e,r.u_unpack)}),line:(e,r)=>({u_translation:new t.bM(e,r.u_translation),u_ratio:new t.b8(e,r.u_ratio),u_device_pixel_ratio:new t.b8(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.bM(e,r.u_units_to_pixels)}),lineGradient:(e,r)=>({u_translation:new t.bM(e,r.u_translation),u_ratio:new t.b8(e,r.u_ratio),u_device_pixel_ratio:new t.b8(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.bM(e,r.u_units_to_pixels),u_image:new t.bH(e,r.u_image),u_image_height:new t.b8(e,r.u_image_height)}),linePattern:(e,r)=>({u_translation:new t.bM(e,r.u_translation),u_texsize:new t.bM(e,r.u_texsize),u_ratio:new t.b8(e,r.u_ratio),u_device_pixel_ratio:new t.b8(e,r.u_device_pixel_ratio),u_image:new t.bH(e,r.u_image),u_units_to_pixels:new t.bM(e,r.u_units_to_pixels),u_scale:new t.bL(e,r.u_scale),u_fade:new t.b8(e,r.u_fade)}),lineSDF:(e,r)=>({u_translation:new t.bM(e,r.u_translation),u_ratio:new t.b8(e,r.u_ratio),u_device_pixel_ratio:new t.b8(e,r.u_device_pixel_ratio),u_units_to_pixels:new t.bM(e,r.u_units_to_pixels),u_patternscale_a:new t.bM(e,r.u_patternscale_a),u_patternscale_b:new t.bM(e,r.u_patternscale_b),u_sdfgamma:new t.b8(e,r.u_sdfgamma),u_image:new t.bH(e,r.u_image),u_tex_y_a:new t.b8(e,r.u_tex_y_a),u_tex_y_b:new t.b8(e,r.u_tex_y_b),u_mix:new t.b8(e,r.u_mix)}),raster:(e,r)=>({u_tl_parent:new t.bM(e,r.u_tl_parent),u_scale_parent:new t.b8(e,r.u_scale_parent),u_buffer_scale:new t.b8(e,r.u_buffer_scale),u_fade_t:new t.b8(e,r.u_fade_t),u_opacity:new t.b8(e,r.u_opacity),u_image0:new t.bH(e,r.u_image0),u_image1:new t.bH(e,r.u_image1),u_brightness_low:new t.b8(e,r.u_brightness_low),u_brightness_high:new t.b8(e,r.u_brightness_high),u_saturation_factor:new t.b8(e,r.u_saturation_factor),u_contrast_factor:new t.b8(e,r.u_contrast_factor),u_spin_weights:new t.bL(e,r.u_spin_weights),u_coords_top:new t.bK(e,r.u_coords_top),u_coords_bottom:new t.bK(e,r.u_coords_bottom)}),symbolIcon:(e,r)=>({u_is_size_zoom_constant:new t.bH(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.bH(e,r.u_is_size_feature_constant),u_size_t:new t.b8(e,r.u_size_t),u_size:new t.b8(e,r.u_size),u_camera_to_center_distance:new t.b8(e,r.u_camera_to_center_distance),u_pitch:new t.b8(e,r.u_pitch),u_rotate_symbol:new t.bH(e,r.u_rotate_symbol),u_aspect_ratio:new t.b8(e,r.u_aspect_ratio),u_fade_change:new t.b8(e,r.u_fade_change),u_label_plane_matrix:new t.bJ(e,r.u_label_plane_matrix),u_coord_matrix:new t.bJ(e,r.u_coord_matrix),u_is_text:new t.bH(e,r.u_is_text),u_pitch_with_map:new t.bH(e,r.u_pitch_with_map),u_is_along_line:new t.bH(e,r.u_is_along_line),u_is_variable_anchor:new t.bH(e,r.u_is_variable_anchor),u_texsize:new t.bM(e,r.u_texsize),u_texture:new t.bH(e,r.u_texture),u_translation:new t.bM(e,r.u_translation),u_pitched_scale:new t.b8(e,r.u_pitched_scale)}),symbolSDF:(e,r)=>({u_is_size_zoom_constant:new t.bH(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.bH(e,r.u_is_size_feature_constant),u_size_t:new t.b8(e,r.u_size_t),u_size:new t.b8(e,r.u_size),u_camera_to_center_distance:new t.b8(e,r.u_camera_to_center_distance),u_pitch:new t.b8(e,r.u_pitch),u_rotate_symbol:new t.bH(e,r.u_rotate_symbol),u_aspect_ratio:new t.b8(e,r.u_aspect_ratio),u_fade_change:new t.b8(e,r.u_fade_change),u_label_plane_matrix:new t.bJ(e,r.u_label_plane_matrix),u_coord_matrix:new t.bJ(e,r.u_coord_matrix),u_is_text:new t.bH(e,r.u_is_text),u_pitch_with_map:new t.bH(e,r.u_pitch_with_map),u_is_along_line:new t.bH(e,r.u_is_along_line),u_is_variable_anchor:new t.bH(e,r.u_is_variable_anchor),u_texsize:new t.bM(e,r.u_texsize),u_texture:new t.bH(e,r.u_texture),u_gamma_scale:new t.b8(e,r.u_gamma_scale),u_device_pixel_ratio:new t.b8(e,r.u_device_pixel_ratio),u_is_halo:new t.bH(e,r.u_is_halo),u_translation:new t.bM(e,r.u_translation),u_pitched_scale:new t.b8(e,r.u_pitched_scale)}),symbolTextAndIcon:(e,r)=>({u_is_size_zoom_constant:new t.bH(e,r.u_is_size_zoom_constant),u_is_size_feature_constant:new t.bH(e,r.u_is_size_feature_constant),u_size_t:new t.b8(e,r.u_size_t),u_size:new t.b8(e,r.u_size),u_camera_to_center_distance:new t.b8(e,r.u_camera_to_center_distance),u_pitch:new t.b8(e,r.u_pitch),u_rotate_symbol:new t.bH(e,r.u_rotate_symbol),u_aspect_ratio:new t.b8(e,r.u_aspect_ratio),u_fade_change:new t.b8(e,r.u_fade_change),u_label_plane_matrix:new t.bJ(e,r.u_label_plane_matrix),u_coord_matrix:new t.bJ(e,r.u_coord_matrix),u_is_text:new t.bH(e,r.u_is_text),u_pitch_with_map:new t.bH(e,r.u_pitch_with_map),u_is_along_line:new t.bH(e,r.u_is_along_line),u_is_variable_anchor:new t.bH(e,r.u_is_variable_anchor),u_texsize:new t.bM(e,r.u_texsize),u_texsize_icon:new t.bM(e,r.u_texsize_icon),u_texture:new t.bH(e,r.u_texture),u_texture_icon:new t.bH(e,r.u_texture_icon),u_gamma_scale:new t.b8(e,r.u_gamma_scale),u_device_pixel_ratio:new t.b8(e,r.u_device_pixel_ratio),u_is_halo:new t.bH(e,r.u_is_halo),u_translation:new t.bM(e,r.u_translation),u_pitched_scale:new t.b8(e,r.u_pitched_scale)}),background:(e,r)=>({u_opacity:new t.b8(e,r.u_opacity),u_color:new t.bI(e,r.u_color)}),backgroundPattern:(e,r)=>({u_opacity:new t.b8(e,r.u_opacity),u_image:new t.bH(e,r.u_image),u_pattern_tl_a:new t.bM(e,r.u_pattern_tl_a),u_pattern_br_a:new t.bM(e,r.u_pattern_br_a),u_pattern_tl_b:new t.bM(e,r.u_pattern_tl_b),u_pattern_br_b:new t.bM(e,r.u_pattern_br_b),u_texsize:new t.bM(e,r.u_texsize),u_mix:new t.b8(e,r.u_mix),u_pattern_size_a:new t.bM(e,r.u_pattern_size_a),u_pattern_size_b:new t.bM(e,r.u_pattern_size_b),u_scale_a:new t.b8(e,r.u_scale_a),u_scale_b:new t.b8(e,r.u_scale_b),u_pixel_coord_upper:new t.bM(e,r.u_pixel_coord_upper),u_pixel_coord_lower:new t.bM(e,r.u_pixel_coord_lower),u_tile_units_to_pixels:new t.b8(e,r.u_tile_units_to_pixels)}),terrain:(e,r)=>({u_texture:new t.bH(e,r.u_texture),u_ele_delta:new t.b8(e,r.u_ele_delta),u_fog_matrix:new t.bJ(e,r.u_fog_matrix),u_fog_color:new t.bI(e,r.u_fog_color),u_fog_ground_blend:new t.b8(e,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new t.b8(e,r.u_fog_ground_blend_opacity),u_horizon_color:new t.bI(e,r.u_horizon_color),u_horizon_fog_blend:new t.b8(e,r.u_horizon_fog_blend),u_is_globe_mode:new t.b8(e,r.u_is_globe_mode)}),terrainDepth:(e,r)=>({u_ele_delta:new t.b8(e,r.u_ele_delta)}),terrainCoords:(e,r)=>({u_texture:new t.bH(e,r.u_texture),u_terrain_coords_id:new t.b8(e,r.u_terrain_coords_id),u_ele_delta:new t.b8(e,r.u_ele_delta)}),projectionErrorMeasurement:(e,r)=>({u_input:new t.b8(e,r.u_input),u_output_expected:new t.b8(e,r.u_output_expected)}),atmosphere:(e,r)=>({u_sun_pos:new t.bL(e,r.u_sun_pos),u_atmosphere_blend:new t.b8(e,r.u_atmosphere_blend),u_globe_position:new t.bL(e,r.u_globe_position),u_globe_radius:new t.b8(e,r.u_globe_radius),u_inv_proj_matrix:new t.bJ(e,r.u_inv_proj_matrix)}),sky:(e,r)=>({u_sky_color:new t.bI(e,r.u_sky_color),u_horizon_color:new t.bI(e,r.u_horizon_color),u_horizon:new t.bM(e,r.u_horizon),u_horizon_normal:new t.bM(e,r.u_horizon_normal),u_sky_horizon_blend:new t.b8(e,r.u_sky_horizon_blend),u_sky_blend:new t.b8(e,r.u_sky_blend)})};class nn{constructor(e,t,r){this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const an={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class on{constructor(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;const i=e.gl;this.buffer=i.createBuffer(),e.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let r=0;r<this.attributes.length;r++){const n=t.attributes[this.attributes[r].name];void 0!==n&&e.enableVertexAttribArray(n)}}setVertexAttribPointers(e,t,r){for(let n=0;n<this.attributes.length;n++){const i=this.attributes[n],a=t.attributes[i.name];void 0!==a&&e.vertexAttribPointer(a,i.components,e[an[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class sn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ln extends sn{getDefault(){return t.b7.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class un extends sn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class cn extends sn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class hn extends sn{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class pn extends sn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class dn extends sn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class fn extends sn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class mn extends sn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class gn extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class yn extends sn{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class vn extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class xn extends sn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class _n extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class bn extends sn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class wn extends sn{getDefault(){return t.b7.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class An extends sn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Cn extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class En extends sn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Mn extends sn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Sn extends sn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Dn extends sn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Tn extends sn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Nn extends sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class In extends sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Pn extends sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class zn extends sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Bn extends sn{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class kn extends sn{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;const r=this.gl;Gt(r)?r.bindVertexArray(e):null===(t=r.getExtension("OES_vertex_array_object"))||void 0===t||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Fn extends sn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Rn extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class On extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Ln extends sn{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class qn extends Ln{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class jn extends Ln{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Un extends Ln{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const Vn="Framebuffer is not complete";class Zn{constructor(e,t,r,n,i){this.context=e,this.width=t,this.height=r;const a=e.gl,o=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new qn(e,o),n)this.depthAttachment=i?new Un(e,o):new jn(e,o);else if(i)throw new Error("Stencil cannot be set without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error(Vn)}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class $n{constructor(e){var t,r;if(this.gl=e,this.clearColor=new ln(this),this.clearDepth=new un(this),this.clearStencil=new cn(this),this.colorMask=new hn(this),this.depthMask=new pn(this),this.stencilMask=new dn(this),this.stencilFunc=new fn(this),this.stencilOp=new mn(this),this.stencilTest=new gn(this),this.depthRange=new yn(this),this.depthTest=new vn(this),this.depthFunc=new xn(this),this.blend=new _n(this),this.blendFunc=new bn(this),this.blendColor=new wn(this),this.blendEquation=new An(this),this.cullFace=new Cn(this),this.cullFaceSide=new En(this),this.frontFace=new Mn(this),this.program=new Sn(this),this.activeTexture=new Dn(this),this.viewport=new Tn(this),this.bindFramebuffer=new Nn(this),this.bindRenderbuffer=new In(this),this.bindTexture=new Pn(this),this.bindVertexBuffer=new zn(this),this.bindElementBuffer=new Bn(this),this.bindVertexArray=new kn(this),this.pixelStoreUnpack=new Fn(this),this.pixelStoreUnpackPremultiplyAlpha=new Rn(this),this.pixelStoreUnpackFlipY=new On(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Gt(e)){this.HALF_FLOAT=e.HALF_FLOAT;const n=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(t=e.RGBA16F)&&void 0!==t?t:null==n?void 0:n.RGBA16F_EXT,this.RGB16F=null!==(r=e.RGB16F)&&void 0!==r?r:null==n?void 0:n.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const t=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==t?void 0:t.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new nn(this,e,t)}createVertexBuffer(e,t,r){return new on(this,e,t,r)}createRenderbuffer(e,t,r){const n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),i}createFramebuffer(e,t,r,n){return new Zn(this,e,t,r,n)}clear({color:e,depth:t,stencil:r}){const n=this.gl;let i=0;e&&(i|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==t&&(i|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),void 0!==r&&(i|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),n.clear(i)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.bE(e.blendFunction,Lt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Gt(this.gl)?this.gl.createVertexArray():null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return Gt(this.gl)?this.gl.deleteVertexArray(e):null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Gn;function Hn(e,r,n,i,a){const o=e.context,s=e.transform,l=o.gl,u=e.useProgram("collisionBox"),c=[];let h=0,p=0;for(let t=0;t<i.length;t++){const d=i[t],f=r.getTile(d).getBucket(n);if(!f)continue;const m=a?f.textCollisionBox:f.iconCollisionBox,g=f.collisionCircleArray;g.length>0&&(c.push({circleArray:g,circleOffset:p,coord:d}),h+=g.length/4,p=h),m&&u.draw(o,l.LINES,Ut.disabled,Zt.disabled,e.colorModeForRenderPass(),jt.disabled,Br(e.transform),e.style.map.terrain&&e.style.map.terrain.getTerrainData(d),s.getProjectionData({overscaledTileID:d,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,e.transform.zoom,null,null,m.collisionVertexBuffer)}if(!a||!c.length)return;const d=e.useProgram("collisionCircle"),f=new t.bT;f.resize(4*h),f._trim();let m=0;for(const e of c)for(let t=0;t<e.circleArray.length/4;t++){const r=4*t,n=e.circleArray[r+0],i=e.circleArray[r+1],a=e.circleArray[r+2],o=e.circleArray[r+3];f.emplace(m++,n,i,a,o,0),f.emplace(m++,n,i,a,o,1),f.emplace(m++,n,i,a,o,2),f.emplace(m++,n,i,a,o,3)}(!Gn||Gn.length<2*h)&&(Gn=function(e){const r=2*e,n=new t.bV;n.resize(r),n._trim();for(let e=0;e<r;e++){const t=6*e;n.uint16[t+0]=4*e+0,n.uint16[t+1]=4*e+1,n.uint16[t+2]=4*e+2,n.uint16[t+3]=4*e+2,n.uint16[t+4]=4*e+3,n.uint16[t+5]=4*e+0}return n}(h));const g=o.createIndexBuffer(Gn,!0),y=o.createVertexBuffer(f,t.bU.members,!0);for(const r of c){const i=kr(e.transform);d.draw(o,l.TRIANGLES,Ut.disabled,Zt.disabled,e.colorModeForRenderPass(),jt.disabled,i,e.style.map.terrain&&e.style.map.terrain.getTerrainData(r.coord),null,n.id,y,g,t.aJ.simpleSegment(0,2*r.circleOffset,r.circleArray.length,r.circleArray.length/2),null,e.transform.zoom,null,null,null)}y.destroy(),g.destroy()}const Wn=t.ad(new Float32Array(16));function Xn(e,r,n,i,a,o){const{horizontalAlign:s,verticalAlign:l}=t.aE(e);return new t.P((-(s-.5)*r/a+i[0])*o,(-(l-.5)*n/a+i[1])*o)}function Yn(e,r,n,i,a,o){const s=r.tileAnchorPoint.add(new t.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let e=i.mult(o);n||(e=e.rotate(-a));const t=s.add(e);return Te(t.x,t.y,r.pitchedLabelPlaneMatrix,r.getElevation).point}if(n){const t=Oe(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(e),n=Math.atan(t.y/t.x)+(t.x<0?Math.PI:0);return e.add(i.rotate(n))}return e.add(i)}function Kn(e,r,n,i,a,o,s,l,u,c,h,p){const d=e.text.placedSymbolArray,f=e.text.dynamicLayoutVertexArray,m=e.icon.dynamicLayoutVertexArray,g={};f.clear();for(let m=0;m<d.length;m++){const y=d.get(m),v=y.hidden||!y.crossTileID||e.allowVerticalPlacement&&!y.placedOrientation?null:i[y.crossTileID];if(v){const i=new t.P(y.anchorX,y.anchorY),d={getElevation:p,width:a.width,height:a.height,pitchedLabelPlaneMatrix:o,pitchWithMap:n,transform:a,tileAnchorPoint:i,translation:c,unwrappedTileID:h},m=n?qe(i.x,i.y,d):Oe(i.x,i.y,d),x=Ne(a.cameraToCenterDistance,m.signedDistanceFromCamera);let _=t.am(e.textSizeData,l,y)*x/t.ay;n&&(_*=e.tilePixelRatio/s);const{width:b,height:w,anchor:A,textOffset:C,textBoxScale:E}=v,M=Xn(A,b,w,C,E,_),S=a.getPitchedTextCorrection(i.x+c[0],i.y+c[1],h),D=Yn(m.point,d,r,M,-a.bearingInRadians,S),T=e.allowVerticalPlacement&&y.placedOrientation===t.al.vertical?Math.PI/2:0;for(let e=0;e<y.numGlyphs;e++)t.as(f,D,T);u&&y.associatedIconIndex>=0&&(g[y.associatedIconIndex]={shiftedAnchor:D,angle:T})}else $e(y.numGlyphs,f)}if(u){m.clear();const r=e.icon.placedSymbolArray;for(let e=0;e<r.length;e++){const n=r.get(e);if(n.hidden)$e(n.numGlyphs,m);else{const r=g[e];if(r)for(let e=0;e<n.numGlyphs;e++)t.as(m,r.shiftedAnchor,r.angle);else $e(n.numGlyphs,m)}}e.icon.dynamicLayoutVertexBuffer.updateData(m)}e.text.dynamicLayoutVertexBuffer.updateData(f)}function Jn(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function Qn(e,r,n,i,a,o,s,l,u,c,h,p,d){const f=e.context,m=f.gl,g=e.transform,y="map"===l,v="map"===u,x="viewport"!==l&&"point"!==n.layout.get("symbol-placement"),_=y&&!v&&!x,b=!n.layout.get("symbol-sort-key").isConstant();let w=!1;const A=e.getDepthModeForSublayer(0,Ut.ReadOnly),C=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),E=[],M=g.getCircleRadiusCorrection();for(const l of i){const i=r.getTile(l),u=i.getBucket(n);if(!u)continue;const h=a?u.text:u.icon;if(!h||!h.segments.get().length||!h.hasVisibleVertices)continue;const p=h.programConfigurations.get(n.id),f=a||u.sdfIcons,A=a?u.textSizeData:u.iconSizeData,S=v||0!==g.pitch,D=e.useProgram(Jn(f,a,u),p),T=t.ak(A,g.zoom),N=e.style.map.terrain&&e.style.map.terrain.getTerrainData(l);let I,P,z,B,k=[0,0],F=null;if(a)P=i.glyphAtlasTexture,z=m.LINEAR,I=i.glyphAtlasTexture.size,u.iconsInText&&(k=i.imageAtlasTexture.size,F=i.imageAtlasTexture,B=S||e.options.rotating||e.options.zooming||"composite"===A.kind||"camera"===A.kind?m.LINEAR:m.NEAREST);else{const t=1!==n.layout.get("icon-size").constantOr(0)||u.iconsNeedLinear;P=i.imageAtlasTexture,z=f||e.options.rotating||e.options.zooming||t||S?m.LINEAR:m.NEAREST,I=i.imageAtlasTexture.size}const R=t.az(i,1,e.transform.zoom),O=Me(y,e.transform,R),L=t.K();t.an(L,O);const q=Se(v,y,e.transform,R),j=t.aA(g,i,o,s),U=g.getProjectionData({overscaledTileID:l,applyGlobeMatrix:!d,applyTerrainMatrix:!0}),V=C&&u.hasTextData(),Z="none"!==n.layout.get("icon-text-fit")&&V&&u.hasIconData();if(x){const t=e.style.map.terrain?(t,r)=>e.style.map.terrain.getElevation(l,t,r):null,r="map"===n.layout.get("text-rotation-alignment");Pe(u,e,a,O,L,v,c,r,l.toUnwrapped(),g.width,g.height,j,t)}const $=a&&C||Z,G=x||$?Wn:v?O:e.transform.clipSpaceToPixelsMatrix,H=f&&0!==n.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let W;W=f?u.iconsInText?Jr(A.kind,T,_,v,x,$,e,G,q,j,I,k,M):Kr(A.kind,T,_,v,x,$,e,G,q,j,a,I,0,M):Yr(A.kind,T,_,v,x,$,e,G,q,j,a,I,M);const X={program:D,buffers:h,uniformValues:W,projectionData:U,atlasTexture:P,atlasTextureIcon:F,atlasInterpolation:z,atlasInterpolationIcon:B,isSDF:f,hasHalo:H};if(b&&u.canOverlap){w=!0;const e=h.segments.get();for(const r of e)E.push({segments:new t.aJ([r]),sortKey:r.sortKey,state:X,terrainData:N})}else E.push({segments:h.segments,sortKey:0,state:X,terrainData:N})}w&&E.sort(((e,t)=>e.sortKey-t.sortKey));for(const t of E){const r=t.state;if(f.activeTexture.set(m.TEXTURE0),r.atlasTexture.bind(r.atlasInterpolation,m.CLAMP_TO_EDGE),r.atlasTextureIcon&&(f.activeTexture.set(m.TEXTURE1),r.atlasTextureIcon&&r.atlasTextureIcon.bind(r.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),r.isSDF){const i=r.uniformValues;r.hasHalo&&(i.u_is_halo=1,ei(r.buffers,t.segments,n,e,r.program,A,h,p,i,r.projectionData,t.terrainData)),i.u_is_halo=0}ei(r.buffers,t.segments,n,e,r.program,A,h,p,r.uniformValues,r.projectionData,t.terrainData)}}function ei(e,t,r,n,i,a,o,s,l,u,c){const h=n.context;i.draw(h,h.gl.TRIANGLES,a,o,s,jt.backCCW,l,c,u,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,n.transform.zoom,e.programConfigurations.get(r.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function ti(e,r,n,i,a){const o=e.context,s=o.gl,l=Zt.disabled,u=new Lt([s.ONE,s.ONE],t.b7.transparent,[!0,!0,!0,!0]),c=r.getBucket(n);if(!c)return;const h=i.key;let p=n.heatmapFbos.get(h);p||(p=ni(o,r.tileSize,r.tileSize),n.heatmapFbos.set(h,p)),o.bindFramebuffer.set(p.framebuffer),o.viewport.set([0,0,r.tileSize,r.tileSize]),o.clear({color:t.b7.transparent});const d=c.programConfigurations.get(n.id),f=e.useProgram("heatmap",d,!a),m=e.transform.getProjectionData({overscaledTileID:r.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),g=e.style.map.terrain.getTerrainData(i);f.draw(o,s.TRIANGLES,Ut.disabled,l,u,jt.disabled,Rr(r,e.transform.zoom,n.paint.get("heatmap-intensity"),1),g,m,n.id,c.layoutVertexBuffer,c.indexBuffer,c.segments,n.paint,e.transform.zoom,d)}function ri(e,t,r,n,i){const a=e.context,o=a.gl,s=e.transform;a.setColorMode(e.colorModeForRenderPass());const l=ii(a,t),u=r.key,c=t.heatmapFbos.get(u);if(!c)return;a.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,c.colorAttachment.get()),a.activeTexture.set(o.TEXTURE1),l.bind(o.LINEAR,o.CLAMP_TO_EDGE);const h=s.getProjectionData({overscaledTileID:r,applyTerrainMatrix:i,applyGlobeMatrix:!n});e.useProgram("heatmapTexture").draw(a,o.TRIANGLES,Ut.disabled,Zt.disabled,e.colorModeForRenderPass(),jt.disabled,Or(e,t,0,1),null,h,t.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments,t.paint,s.zoom),c.destroy(),t.heatmapFbos.delete(u)}function ni(e,t,r){var n,i;const a=e.gl,o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);const s=null!==(n=e.HALF_FLOAT)&&void 0!==n?n:a.UNSIGNED_BYTE,l=null!==(i=e.RGBA16F)&&void 0!==i?i:a.RGBA;a.texImage2D(a.TEXTURE_2D,0,l,t,r,0,a.RGBA,s,null);const u=e.createFramebuffer(t,r,!1,!1);return u.colorAttachment.set(o),u}function ii(e,t){return t.colorRampTexture||(t.colorRampTexture=new v(e,t.colorRamp,e.gl.RGBA)),t.colorRampTexture}function ai(e,t,r,n,i){if(!r||!n||!n.imageAtlas)return;const a=n.imageAtlas.patternPositions;let o=a[r.to.toString()],s=a[r.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){const e=i.getPaintProperty(t);o=a[e],s=a[e]}o&&s&&e.setConstantPatternPositions(o,s)}function oi(e,r,n,i,a,o,s,l){const u=e.context.gl,c="fill-pattern",h=n.paint.get(c),p=h&&h.constantOr(1),d=n.getCrossfadeParameters();let f,m,g,y,v;const x=e.transform,_=n.paint.get("fill-translate"),b=n.paint.get("fill-translate-anchor");s?(m=p&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",f=u.LINES):(m=p?"fillPattern":"fill",f=u.TRIANGLES);const w=h.constantOr(null);for(const h of i){const i=r.getTile(h);if(p&&!i.patternsLoaded())continue;const A=i.getBucket(n);if(!A)continue;const C=A.programConfigurations.get(n.id),E=e.useProgram(m,C),M=e.style.map.terrain&&e.style.map.terrain.getTerrainData(h);p&&(e.context.activeTexture.set(u.TEXTURE0),i.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),C.updatePaintBuffers(d)),ai(C,c,w,i,n);const S=x.getProjectionData({overscaledTileID:h,applyGlobeMatrix:!l,applyTerrainMatrix:!0}),D=t.aA(x,i,_,b);if(s){y=A.indexBuffer2,v=A.segments2;const t=[u.drawingBufferWidth,u.drawingBufferHeight];g="fillOutlinePattern"===m&&p?Pr(e,d,i,t,D):Ir(t,D)}else y=A.indexBuffer,v=A.segments,g=p?Nr(e,d,i,D):{u_fill_translate:D};const T=e.stencilModeForClipping(h);E.draw(e.context,f,a,T,o,jt.backCCW,g,M,S,n.id,A.layoutVertexBuffer,y,v,n.paint,e.transform.zoom,C)}}function si(e,r,n,i,a,o,s,l){const u=e.context,c=u.gl,h="fill-extrusion-pattern",p=n.paint.get(h),d=p.constantOr(1),f=n.getCrossfadeParameters(),m=n.paint.get("fill-extrusion-opacity"),g=p.constantOr(null),y=e.transform;for(const p of i){const i=r.getTile(p),v=i.getBucket(n);if(!v)continue;const x=e.style.map.terrain&&e.style.map.terrain.getTerrainData(p),_=v.programConfigurations.get(n.id),b=e.useProgram(d?"fillExtrusionPattern":"fillExtrusion",_);d&&(e.context.activeTexture.set(c.TEXTURE0),i.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),_.updatePaintBuffers(f));const w=y.getProjectionData({overscaledTileID:p,applyGlobeMatrix:!l,applyTerrainMatrix:!0});ai(_,h,g,i,n);const A=t.aA(y,i,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),C=n.paint.get("fill-extrusion-vertical-gradient"),E=d?Tr(e,C,m,A,p,f,i):Dr(e,C,m,A);b.draw(u,u.gl.TRIANGLES,a,o,s,jt.backCCW,E,x,w,n.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,n.paint,e.transform.zoom,_,e.style.map.terrain&&v.centroidVertexBuffer)}}function li(e,t,r,n,i,a,o,s,l){var u;const c=e.style.projection,h=e.context,p=e.transform,d=h.gl,f=[`#define NUM_ILLUMINATION_SOURCES ${r.paint.get("hillshade-highlight-color").values.length}`],m=e.useProgram("hillshade",null,!1,f),g=!e.options.moving;for(const f of n){const n=t.getTile(f),y=n.fbo;if(!y)continue;const v=c.getMeshFromTileID(h,f.canonical,s,!0,"raster"),x=null===(u=e.style.map.terrain)||void 0===u?void 0:u.getTerrainData(f);h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,y.colorAttachment.get());const _=p.getProjectionData({overscaledTileID:f,aligned:g,applyGlobeMatrix:!l,applyTerrainMatrix:!0});m.draw(h,d.TRIANGLES,a,i[f.overscaledZ],o,jt.backCCW,Lr(e,n,r),x,_,r.id,v.vertexBuffer,v.indexBuffer,v.segments)}}const ui=[new t.P(0,0),new t.P(t.Z,0),new t.P(t.Z,t.Z),new t.P(0,t.Z)];function ci(e,t,r,n,i,a,o,s,l=!1,u=!1){const c=n[n.length-1].overscaledZ,h=e.context,p=h.gl,d=e.useProgram("raster"),f=e.transform,m=e.style.projection,g=e.colorModeForRenderPass(),y=!e.options.moving;for(const v of n){const n=e.getDepthModeForSublayer(v.overscaledZ-c,1===r.paint.get("raster-opacity")?Ut.ReadWrite:Ut.ReadOnly,p.LESS),x=t.getTile(v);x.registerFadeDuration(r.paint.get("raster-fade-duration"));const _=t.findLoadedParent(v,0),b=t.findLoadedSibling(v),w=hi(x,_||b||null,t,r,e.transform,e.style.map.terrain);let A,C;const E="nearest"===r.paint.get("raster-resampling")?p.NEAREST:p.LINEAR;h.activeTexture.set(p.TEXTURE0),x.texture.bind(E,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(p.TEXTURE1),_?(_.texture.bind(E,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST),A=Math.pow(2,_.tileID.overscaledZ-x.tileID.overscaledZ),C=[x.tileID.canonical.x*A%1,x.tileID.canonical.y*A%1]):x.texture.bind(E,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST),x.texture.useMipmap&&h.extTextureFilterAnisotropic&&e.transform.pitch>20&&p.texParameterf(p.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax);const M=e.style.map.terrain&&e.style.map.terrain.getTerrainData(v),S=f.getProjectionData({overscaledTileID:v,aligned:y,applyGlobeMatrix:!u,applyTerrainMatrix:!0}),D=Wr(C||[0,0],A||1,w,r,s),T=m.getMeshFromTileID(h,v.canonical,a,o,"raster");d.draw(h,p.TRIANGLES,n,i?i[v.overscaledZ]:Zt.disabled,g,l?jt.frontCCW:jt.backCCW,D,M,S,r.id,T.vertexBuffer,T.indexBuffer,T.segments)}}function hi(e,r,n,i,a,s){const l=i.paint.get("raster-fade-duration");if(!s&&l>0){const i=o.now(),s=(i-e.timeAdded)/l,u=r?(i-r.timeAdded)/l:-1,c=n.getSource(),h=ve(a,{tileSize:c.tileSize,roundZoom:c.roundZoom}),p=!r||Math.abs(r.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),d=p&&e.refreshedUponExpiration?1:t.ae(p?s:1-u,0,1);return e.refreshedUponExpiration&&s>=1&&(e.refreshedUponExpiration=!1),r?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}const pi=new t.b7(1,0,0,1),di=new t.b7(0,1,0,1),fi=new t.b7(0,0,1,1),mi=new t.b7(1,0,1,1),gi=new t.b7(0,1,1,1);function yi(e,t,r,n){xi(e,0,t+r/2,e.transform.width,r,n)}function vi(e,t,r,n){xi(e,t-r/2,0,r,e.transform.height,n)}function xi(e,t,r,n,i,a){const o=e.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(t*e.pixelRatio,r*e.pixelRatio,n*e.pixelRatio,i*e.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}function _i(e,r,n){const i=e.context,a=i.gl,o=e.useProgram("debug"),s=Ut.disabled,l=Zt.disabled,u=e.colorModeForRenderPass(),c="$debug",h=e.style.map.terrain&&e.style.map.terrain.getTerrainData(n);i.activeTexture.set(a.TEXTURE0);const p=r.getTileByID(n.key).latestRawTileData,d=Math.floor((p&&p.byteLength||0)/1024),f=r.getTile(n).tileSize,m=512/Math.min(f,512)*(n.overscaledZ/e.transform.zoom)*.5;let g=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(g+=` => ${n.overscaledZ}`),function(e,t){e.initDebugOverlayCanvas();const r=e.debugOverlayCanvas,n=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,r.width,r.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(e,`${g} ${d}kB`);const y=e.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});o.draw(i,a.TRIANGLES,s,l,Lt.alphaBlended,jt.disabled,Fr(t.b7.transparent,m),null,y,c,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),o.draw(i,a.LINE_STRIP,s,l,u,jt.disabled,Fr(t.b7.red),h,y,c,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}function bi(e,t,r,n){const{isRenderingGlobe:i}=n,a=e.context,o=a.gl,s=e.transform,l=e.colorModeForRenderPass(),u=e.getDepthModeFor3D(),c=e.useProgram("terrain");a.bindFramebuffer.set(null),a.viewport.set([0,0,e.width,e.height]);for(const n of r){const r=t.getTerrainMesh(n.tileID),h=e.renderToTexture.getTexture(n),p=t.getTerrainData(n.tileID);a.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,h.texture);const d=t.getMeshFrameDelta(s.zoom),f=s.calculateFogMatrix(n.tileID.toUnwrapped()),m=Ar(d,f,e.style.sky,s.pitch,i),g=s.getProjectionData({overscaledTileID:n.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});c.draw(a,o.TRIANGLES,u,Zt.disabled,l,jt.backCCW,m,p,g,"terrain",r.vertexBuffer,r.indexBuffer,r.segments)}}function wi(e,r){if(!r.mesh){const n=new t.aI;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const i=new t.aK;i.emplaceBack(0,1,2),i.emplaceBack(0,2,3),r.mesh=new wt(e.createVertexBuffer(n,At.members),e.createIndexBuffer(i),t.aJ.simpleSegment(0,0,n.length,i.length))}return r.mesh}class Ai{constructor(e,r){this.context=new $n(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.ad(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=_e.maxUnderzooming+_e.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new vt}resize(e,t,r){if(this.width=Math.floor(e*r),this.height=Math.floor(t*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style._order)this.style._layers[e].resize()}setup(){const e=this.context,r=new t.aI;r.emplaceBack(0,0),r.emplaceBack(t.Z,0),r.emplaceBack(0,t.Z),r.emplaceBack(t.Z,t.Z),this.tileExtentBuffer=e.createVertexBuffer(r,At.members),this.tileExtentSegments=t.aJ.simpleSegment(0,0,4,2);const n=new t.aI;n.emplaceBack(0,0),n.emplaceBack(t.Z,0),n.emplaceBack(0,t.Z),n.emplaceBack(t.Z,t.Z),this.debugBuffer=e.createVertexBuffer(n,At.members),this.debugSegments=t.aJ.simpleSegment(0,0,4,5);const i=new t.b_;i.emplaceBack(0,0,0,0),i.emplaceBack(t.Z,0,t.Z,0),i.emplaceBack(0,t.Z,0,t.Z),i.emplaceBack(t.Z,t.Z,t.Z,t.Z),this.rasterBoundsBuffer=e.createVertexBuffer(i,br.members),this.rasterBoundsSegments=t.aJ.simpleSegment(0,0,4,2);const a=new t.aI;a.emplaceBack(0,0),a.emplaceBack(t.Z,0),a.emplaceBack(0,t.Z),a.emplaceBack(t.Z,t.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(a,At.members),this.rasterBoundsSegmentsPosOnly=t.aJ.simpleSegment(0,0,4,5);const o=new t.aI;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,At.members),this.viewportSegments=t.aJ.simpleSegment(0,0,4,2);const s=new t.b$;s.emplaceBack(0),s.emplaceBack(1),s.emplaceBack(3),s.emplaceBack(2),s.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(s);const l=new t.aK;l.emplaceBack(1,0,2),l.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(l);const u=this.context.gl;this.stencilClearMode=new Zt({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO),this.tileExtentMesh=new wt(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const n=t.K();t.bQ(n,0,this.width,this.height,0,0,1),t.M(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const i={mainMatrix:n,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:n};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,Ut.disabled,this.stencilClearMode,Lt.disabled,jt.disabled,null,null,i,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t,r){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source,this.nextStencilID+t.length>256&&this.clearStencil();const n=this.context;n.setColorMode(Lt.disabled),n.setDepthMode(Ut.disabled);const i={};for(const e of t)i[e.key]=this.nextStencilID++;this._renderTileMasks(i,t,r,!0),this._renderTileMasks(i,t,r,!1),this._tileClippingMaskIDs=i}_renderTileMasks(e,t,r,n){const i=this.context,a=i.gl,o=this.style.projection,s=this.transform,l=this.useProgram("clippingMask");for(const u of t){const t=e[u.key],c=this.style.map.terrain&&this.style.map.terrain.getTerrainData(u),h=o.getMeshFromTileID(this.context,u.canonical,n,!0,"stencil"),p=s.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!r,applyTerrainMatrix:!0});l.draw(i,a.TRIANGLES,Ut.disabled,new Zt({func:a.ALWAYS,mask:0},t,255,a.KEEP,a.KEEP,a.REPLACE),Lt.disabled,r?jt.disabled:jt.backCCW,null,c,p,"$clipping",h.vertexBuffer,h.indexBuffer,h.segments)}}_renderTilesDepthBuffer(){const e=this.context,t=e.gl,r=this.style.projection,n=this.transform,i=this.useProgram("depth"),a=this.getDepthModeFor3D(),o=xe(n,{tileSize:n.tileSize});for(const s of o){const o=this.style.map.terrain&&this.style.map.terrain.getTerrainData(s),l=r.getMeshFromTileID(this.context,s.canonical,!0,!0,"raster"),u=n.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!0,applyTerrainMatrix:!0});i.draw(e,t.TRIANGLES,a,Zt.disabled,Lt.disabled,jt.backCCW,null,o,u,"$clipping",l.vertexBuffer,l.indexBuffer,l.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new Zt({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){const t=this.context.gl;return new Zt({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const t=this.context.gl,r=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),n=r[r.length-1].overscaledZ,i=r[0].overscaledZ-n+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const e={};for(let r=0;r<i;r++)e[r+n]=new Zt({func:t.GEQUAL,mask:255},r+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=i,[e,r]}return[{[n]:Zt.disabled},r]}stencilConfigForOverlapTwoPass(e){const t=this.context.gl,r=e.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),n=r[r.length-1].overscaledZ,i=r[0].overscaledZ-n+1;if(this.clearStencil(),i>1){const e={},a={};for(let r=0;r<i;r++)e[r+n]=new Zt({func:t.GREATER,mask:255},i+1+r,255,t.KEEP,t.KEEP,t.REPLACE),a[r+n]=new Zt({func:t.GREATER,mask:255},1+r,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID=2*i+1,[e,a,r]}return this.nextStencilID=3,[{[n]:new Zt({func:t.GREATER,mask:255},2,255,t.KEEP,t.KEEP,t.REPLACE)},{[n]:new Zt({func:t.GREATER,mask:255},1,255,t.KEEP,t.KEEP,t.REPLACE)},r]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const r=1/8;return new Lt([e.CONSTANT_COLOR,e.ONE],new t.b7(r,r,r,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Lt.unblended:Lt.alphaBlended}getDepthModeForSublayer(e,t,r){if(!this.opaquePassEnabledForLayer())return Ut.disabled;const n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Ut(r||this.context.gl.LEQUAL,t,[n,n])}getDepthModeFor3D(){return new Ut(this.context.gl.LEQUAL,Ut.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var n,i;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(o.now()),this.imageManager.beginFrame();const a=this.style._order,s=this.style.sourceCaches,l={},u={},c={},h={isRenderingToTexture:!1,isRenderingGlobe:(null===(n=e.projection)||void 0===n?void 0:n.transitionState)>0};for(const e in s){const t=s[e];t.used&&t.prepare(this.context),l[e]=t.getVisibleCoordinates(!1),u[e]=l[e].slice().reverse(),c[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<a.length;e++)if(this.style._layers[a[e]].is3D()){this.opaquePassCutoff=e;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const e of a){const t=this.style._layers[e];if(!t.hasOffscreenPass()||t.isHidden(this.transform.zoom))continue;const r=u[t.source];("custom"===t.type||r.length)&&this.renderLayer(this,s[t.source],t,r,h)}if(null===(i=this.style.projection)||void 0===i||i.updateGPUdependent({context:this.context,useProgram:e=>this.useProgram(e)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?t.b7.black:t.b7.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(e,t){const r=e.context,n=r.gl,i=((e,t,r)=>{const n=Math.cos(t.rollInRadians),i=Math.sin(t.rollInRadians),a=he(t),o=t.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:e.properties.get("sky-color"),u_horizon_color:e.properties.get("horizon-color"),u_horizon:[(t.width/2-a*i)*r,(t.height/2+a*n)*r],u_horizon_normal:[-i,n],u_sky_horizon_blend:e.properties.get("sky-horizon-blend")*t.height/2*r,u_sky_blend:o}})(t,e.style.map.transform,e.pixelRatio),a=new Ut(n.LEQUAL,Ut.ReadWrite,[0,1]),o=Zt.disabled,s=e.colorModeForRenderPass(),l=e.useProgram("sky"),u=wi(r,t);l.draw(r,n.TRIANGLES,a,o,s,jt.disabled,i,null,void 0,"sky",u.vertexBuffer,u.indexBuffer,u.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[a[this.currentLayer]],t=s[e.source],r=l[e.source];this._renderTileClippingMasks(e,r,!1),this.renderLayer(this,t,e,r,h)}this.renderPass="translucent";let p=!1;for(this.currentLayer=0;this.currentLayer<a.length;this.currentLayer++){const e=this.style._layers[a[this.currentLayer]],t=s[e.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(e,h))continue;this.opaquePassEnabledForLayer()||p||(p=!0,h.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const r=("symbol"===e.type?c:u)[e.source];this._renderTileClippingMasks(e,l[e.source],!!this.renderToTexture),this.renderLayer(this,t,e,r,h)}if(h.isRenderingGlobe&&function(e,r,n){const i=e.context,a=i.gl,o=e.useProgram("atmosphere"),s=new Ut(a.LEQUAL,Ut.ReadOnly,[0,1]),l=e.transform,u=function(e,r){const n=e.properties.get("position"),i=[-n.x,-n.y,-n.z],a=t.ad(new Float64Array(16));return"map"===e.properties.get("anchor")&&(t.a_(a,a,r.rollInRadians),t.a$(a,a,-r.pitchInRadians),t.a_(a,a,r.bearingInRadians),t.a$(a,a,r.center.lat*Math.PI/180),t.bp(a,a,-r.center.lng*Math.PI/180)),t.bZ(i,i,a),i}(n,e.transform),c=l.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),h=r.properties.get("atmosphere-blend")*c.projectionTransition;if(0===h)return;const p=nr(l.worldSize,l.center.lat),d=l.inverseProjectionMatrix,f=new Float64Array(4);f[3]=1,t.at(f,f,l.modelViewProjectionMatrix),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[3]=1,t.at(f,f,d),f[0]/=f[3],f[1]/=f[3],f[2]/=f[3],f[3]=1;const m=((e,t,r,n,i)=>({u_sun_pos:e,u_atmosphere_blend:t,u_globe_position:r,u_globe_radius:n,u_inv_proj_matrix:i}))(u,h,[f[0],f[1],f[2]],p,d),g=wi(i,r);o.draw(i,a.TRIANGLES,s,Zt.disabled,Lt.alphaBlended,jt.disabled,m,null,null,"atmosphere",g.vertexBuffer,g.indexBuffer,g.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const e=function(e,t){let r=null;const n=Object.values(e._layers).flatMap((r=>r.source&&!r.isHidden(t)?[e.sourceCaches[r.source]]:[])),i=n.filter((e=>"vector"===e.getSource().type)),a=n.filter((e=>"vector"!==e.getSource().type)),o=e=>{(!r||r.getSource().maxzoom<e.getSource().maxzoom)&&(r=e)};return i.forEach((e=>o(e))),r||a.forEach((e=>o(e))),r}(this.style,this.transform.zoom);e&&function(e,t,r){for(let n=0;n<r.length;n++)_i(e,t,r[n])}(this,e,e.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;yi(e,e.transform.height-(t.top||0),3,pi),yi(e,t.bottom||0,3,di),vi(e,t.left||0,3,fi),vi(e,e.transform.width-(t.right||0),3,mi);const r=e.transform.centerPoint;!function(e,t,r,n){xi(e,t-1,r-10,2,20,n),xi(e,t-10,r-1,20,2,n)}(e,r.x,e.transform.height-r.y,gi)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,n=this.transform.modelViewProjectionMatrix;let i=this.terrainFacilitator.dirty;i||(i=e?!t.c0(r,n):!t.c1(r,n)),i||(i=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),i&&(t.c2(r,n),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,r){const n=e.context,i=n.gl,a=e.transform,o=Lt.unblended,s=new Ut(i.LEQUAL,Ut.ReadWrite,[0,1]),l=r.sourceCache.getRenderableTiles(),u=e.useProgram("terrainDepth");n.bindFramebuffer.set(r.getFramebuffer("depth").framebuffer),n.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),n.clear({color:t.b7.transparent,depth:1});for(const e of l){const t=r.getTerrainMesh(e.tileID),l=r.getTerrainData(e.tileID),c=a.getProjectionData({overscaledTileID:e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),h={u_ele_delta:r.getMeshFrameDelta(a.zoom)};u.draw(n,i.TRIANGLES,s,Zt.disabled,o,jt.backCCW,h,l,c,"terrain",t.vertexBuffer,t.indexBuffer,t.segments)}n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain),function(e,r){const n=e.context,i=n.gl,a=e.transform,o=Lt.unblended,s=new Ut(i.LEQUAL,Ut.ReadWrite,[0,1]),l=r.getCoordsTexture(),u=r.sourceCache.getRenderableTiles(),c=e.useProgram("terrainCoords");n.bindFramebuffer.set(r.getFramebuffer("coords").framebuffer),n.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),n.clear({color:t.b7.transparent,depth:1}),r.coordsIndex=[];for(const e of u){const t=r.getTerrainMesh(e.tileID),u=r.getTerrainData(e.tileID);n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture);const h={u_terrain_coords_id:(255-r.coordsIndex.length)/255,u_texture:0,u_ele_delta:r.getMeshFrameDelta(a.zoom)},p=a.getProjectionData({overscaledTileID:e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});c.draw(n,i.TRIANGLES,s,Zt.disabled,o,jt.backCCW,h,u,p,"terrain",t.vertexBuffer,t.indexBuffer,t.segments),r.coordsIndex.push(e.tileID.key)}n.bindFramebuffer.set(null),n.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain))}renderLayer(e,r,n,i,a){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||(i||[]).length)&&(this.id=n.id,t.c3(n)?function(e,r,n,i,a,o){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:s}=o,l=Zt.disabled,u=e.colorModeForRenderPass();(n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(e,r,n,i,a,o,s,l,u){const c=r.transform,h=r.style.map.terrain,p="map"===a,d="map"===o;for(const a of e){const e=i.getTile(a),o=e.getBucket(n);if(!o||!o.text||!o.text.segments.get().length)continue;const f=t.ak(o.textSizeData,c.zoom),m=t.az(e,1,r.transform.zoom),g=Me(p,r.transform,m),y="none"!==n.layout.get("icon-text-fit")&&o.hasIconData();if(f){const r=Math.pow(2,c.zoom-e.tileID.overscaledZ),n=h?(e,t)=>h.getElevation(a,e,t):null;Kn(o,p,d,u,c,g,r,f,y,t.aA(c,e,s,l),a.toUnwrapped(),n)}}}(i,e,n,r,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),a),0!==n.paint.get("icon-opacity").constantOr(1)&&Qn(e,r,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),l,u,s),0!==n.paint.get("text-opacity").constantOr(1)&&Qn(e,r,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),l,u,s),r.map.showCollisionBoxes&&(Hn(e,r,n,i,!0),Hn(e,r,n,i,!1))}(e,r,n,i,this.style.placement.variableOffsets,a):t.c4(n)?function(e,r,n,i,a){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:o}=a,s=n.paint.get("circle-opacity"),l=n.paint.get("circle-stroke-width"),u=n.paint.get("circle-stroke-opacity"),c=!n.layout.get("circle-sort-key").isConstant();if(0===s.constantOr(1)&&(0===l.constantOr(1)||0===u.constantOr(1)))return;const h=e.context,p=h.gl,d=e.transform,f=e.getDepthModeForSublayer(0,Ut.ReadOnly),m=Zt.disabled,g=e.colorModeForRenderPass(),y=[],v=d.getCircleRadiusCorrection();for(let a=0;a<i.length;a++){const s=i[a],l=r.getTile(s),u=l.getBucket(n);if(!u)continue;const h=n.paint.get("circle-translate"),p=n.paint.get("circle-translate-anchor"),f=t.aA(d,l,h,p),m=u.programConfigurations.get(n.id),g=e.useProgram("circle",m),x=u.layoutVertexBuffer,_=u.indexBuffer,b=e.style.map.terrain&&e.style.map.terrain.getTerrainData(s),w={programConfiguration:m,program:g,layoutVertexBuffer:x,indexBuffer:_,uniformValues:zr(e,l,n,f,v),terrainData:b,projectionData:d.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!o,applyTerrainMatrix:!0})};if(c){const e=u.segments.get();for(const r of e)y.push({segments:new t.aJ([r]),sortKey:r.sortKey,state:w})}else y.push({segments:u.segments,sortKey:0,state:w})}c&&y.sort(((e,t)=>e.sortKey-t.sortKey));for(const t of y){const{programConfiguration:r,program:i,layoutVertexBuffer:a,indexBuffer:o,uniformValues:s,terrainData:l,projectionData:u}=t.state;i.draw(h,p.TRIANGLES,f,m,g,jt.backCCW,s,l,u,n.id,a,o,t.segments,n.paint,e.transform.zoom,r)}}(e,r,n,i,a):t.c5(n)?function(e,r,n,i,a){if(0===n.paint.get("heatmap-opacity"))return;const o=e.context,{isRenderingToTexture:s,isRenderingGlobe:l}=a;if(e.style.map.terrain){for(const t of i){const i=r.getTile(t);r.hasRenderableParent(t)||("offscreen"===e.renderPass?ti(e,i,n,t,l):"translucent"===e.renderPass&&ri(e,n,t,s,l))}o.viewport.set([0,0,e.width,e.height])}else"offscreen"===e.renderPass?function(e,r,n,i){const a=e.context,o=a.gl,s=e.transform,l=Zt.disabled,u=new Lt([o.ONE,o.ONE],t.b7.transparent,[!0,!0,!0,!0]);(function(e,r,n){const i=e.gl;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,r.width/4,r.height/4]);let a=n.heatmapFbos.get(t.bW);a?(i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer)):(a=ni(e,r.width/4,r.height/4),n.heatmapFbos.set(t.bW,a))})(a,e,n),a.clear({color:t.b7.transparent});for(let t=0;t<i.length;t++){const c=i[t];if(r.hasRenderableParent(c))continue;const h=r.getTile(c),p=h.getBucket(n);if(!p)continue;const d=p.programConfigurations.get(n.id),f=e.useProgram("heatmap",d),m=s.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),g=s.getCircleRadiusCorrection();f.draw(a,o.TRIANGLES,Ut.disabled,l,u,jt.backCCW,Rr(h,s.zoom,n.paint.get("heatmap-intensity"),g),null,m,n.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,n.paint,s.zoom,d)}a.viewport.set([0,0,e.width,e.height])}(e,r,n,i):"translucent"===e.renderPass&&function(e,r){const n=e.context,i=n.gl;n.setColorMode(e.colorModeForRenderPass());const a=r.heatmapFbos.get(t.bW);a&&(n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1),ii(n,r).bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(n,i.TRIANGLES,Ut.disabled,Zt.disabled,e.colorModeForRenderPass(),jt.disabled,Or(e,r,0,1),null,null,r.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,r.paint,e.transform.zoom))}(e,n)}(e,r,n,i,a):t.c6(n)?function(e,r,n,i,a){if("translucent"!==e.renderPass)return;const{isRenderingToTexture:o}=a,s=n.paint.get("line-opacity"),l=n.paint.get("line-width");if(0===s.constantOr(1)||0===l.constantOr(1))return;const u=e.getDepthModeForSublayer(0,Ut.ReadOnly),c=e.colorModeForRenderPass(),h=n.paint.get("line-dasharray"),p=n.paint.get("line-pattern"),d=p.constantOr(1),f=n.paint.get("line-gradient"),m=n.getCrossfadeParameters(),g=d?"linePattern":h?"lineSDF":f?"lineGradient":"line",y=e.context,x=y.gl,_=e.transform;let b=!0;for(const a of i){const i=r.getTile(a);if(d&&!i.patternsLoaded())continue;const s=i.getBucket(n);if(!s)continue;const l=s.programConfigurations.get(n.id),w=e.context.program.get(),A=e.useProgram(g,l),C=b||A.program!==w,E=e.style.map.terrain&&e.style.map.terrain.getTerrainData(a),M=p.constantOr(null);if(M&&i.imageAtlas){const e=i.imageAtlas,t=e.patternPositions[M.to.toString()],r=e.patternPositions[M.from.toString()];t&&r&&l.setConstantPatternPositions(t,r)}const S=_.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!o,applyTerrainMatrix:!0}),D=_.getPixelScale(),T=d?Zr(e,i,n,D,m):h?$r(e,i,n,D,h,m):f?Vr(e,i,n,D,s.lineClipsArray.length):Ur(e,i,n,D);if(d)y.activeTexture.set(x.TEXTURE0),i.imageAtlasTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),l.updatePaintBuffers(m);else if(h&&(C||e.lineAtlas.dirty))y.activeTexture.set(x.TEXTURE0),e.lineAtlas.bind(y);else if(f){const i=s.gradients[n.id];let o=i.texture;if(n.gradientVersion!==i.version){let l=256;if(n.stepInterpolant){const n=r.getSource().maxzoom,i=a.canonical.z===n?Math.ceil(1<<e.transform.maxZoom-a.canonical.z):1;l=t.ae(t.bX(s.maxLineLength/t.Z*1024*i),256,y.maxTextureSize)}i.gradient=t.bY({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:i.gradient||void 0,clips:s.lineClipsArray}),i.texture?i.texture.update(i.gradient):i.texture=new v(y,i.gradient,x.RGBA),i.version=n.gradientVersion,o=i.texture}y.activeTexture.set(x.TEXTURE0),o.bind(n.stepInterpolant?x.NEAREST:x.LINEAR,x.CLAMP_TO_EDGE)}const N=e.stencilModeForClipping(a);A.draw(y,x.TRIANGLES,u,N,c,jt.disabled,T,E,S,n.id,s.layoutVertexBuffer,s.indexBuffer,s.segments,n.paint,e.transform.zoom,l,s.layoutVertexBuffer2),b=!1}}(e,r,n,i,a):t.c7(n)?function(e,r,n,i,a){const o=n.paint.get("fill-color"),s=n.paint.get("fill-opacity");if(0===s.constantOr(1))return;const{isRenderingToTexture:l}=a,u=e.colorModeForRenderPass(),c=n.paint.get("fill-pattern"),h=e.opaquePassEnabledForLayer()&&!c.constantOr(1)&&1===o.constantOr(t.b7.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(e.renderPass===h){const t=e.getDepthModeForSublayer(1,"opaque"===e.renderPass?Ut.ReadWrite:Ut.ReadOnly);oi(e,r,n,i,t,u,!1,l)}if("translucent"===e.renderPass&&n.paint.get("fill-antialias")){const t=e.getDepthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Ut.ReadOnly);oi(e,r,n,i,t,u,!0,l)}}(e,r,n,i,a):t.c8(n)?function(e,t,r,n,i){const a=r.paint.get("fill-extrusion-opacity");if(0===a)return;const{isRenderingToTexture:o}=i;if("translucent"===e.renderPass){const i=new Ut(e.context.gl.LEQUAL,Ut.ReadWrite,e.depthRangeFor3D);if(1!==a||r.paint.get("fill-extrusion-pattern").constantOr(1))si(e,t,r,n,i,Zt.disabled,Lt.disabled,o),si(e,t,r,n,i,e.stencilModeFor3D(),e.colorModeForRenderPass(),o);else{const a=e.colorModeForRenderPass();si(e,t,r,n,i,Zt.disabled,a,o)}}}(e,r,n,i,a):t.c9(n)?function(e,t,r,n,i){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const{isRenderingToTexture:a}=i,o=e.context,s=e.style.projection.useSubdivision,l=e.getDepthModeForSublayer(0,Ut.ReadOnly),u=e.colorModeForRenderPass();if("offscreen"===e.renderPass)!function(e,t,r,n,i,a,o){const s=e.context,l=s.gl;for(const u of r){const r=t.getTile(u),c=r.dem;if(!c||!c.data)continue;if(!r.needsHillshadePrepare)continue;const h=c.dim,p=c.stride,d=c.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||e.getTileTexture(p),r.demTexture){const e=r.demTexture;e.update(d,{premultiply:!1}),e.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else r.demTexture=new v(s,d,l.RGBA,{premultiply:!1}),r.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);let f=r.fbo;if(!f){const e=new v(s,{width:h,height:h,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),f=r.fbo=s.createFramebuffer(h,h,!0,!1),f.colorAttachment.set(e.texture)}s.bindFramebuffer.set(f.framebuffer),s.viewport.set([0,0,h,h]),e.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,i,a,o,jt.disabled,qr(r.tileID,c),null,null,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),r.needsHillshadePrepare=!1}}(e,t,n,r,l,Zt.disabled,u),o.viewport.set([0,0,e.width,e.height]);else if("translucent"===e.renderPass)if(s){const[i,o,s]=e.stencilConfigForOverlapTwoPass(n);li(e,t,r,s,i,l,u,!1,a),li(e,t,r,s,o,l,u,!0,a)}else{const[i,o]=e.getStencilConfigForOverlapAndUpdateStencilID(n);li(e,t,r,o,i,l,u,!1,a)}}(e,r,n,i,a):t.ca(n)?function(e,t,r,n,i){if("translucent"!==e.renderPass)return;if(0===r.paint.get("raster-opacity"))return;if(!n.length)return;const{isRenderingToTexture:a}=i,o=t.getSource(),s=e.style.projection.useSubdivision;if(o instanceof Y)ci(e,t,r,n,null,!1,!1,o.tileCoords,o.flippedWindingOrder,a);else if(s){const[i,o,s]=e.stencilConfigForOverlapTwoPass(n);ci(e,t,r,s,i,!1,!0,ui,!1,a),ci(e,t,r,s,o,!0,!0,ui,!1,a)}else{const[i,o]=e.getStencilConfigForOverlapAndUpdateStencilID(n);ci(e,t,r,o,i,!1,!0,ui,!1,a)}}(e,r,n,i,a):t.cb(n)?function(e,t,r,n,i){const a=r.paint.get("background-color"),o=r.paint.get("background-opacity");if(0===o)return;const{isRenderingToTexture:s}=i,l=e.context,u=l.gl,c=e.style.projection,h=e.transform,p=h.tileSize,d=r.paint.get("background-pattern");if(e.isPatternMissing(d))return;const f=!d&&1===a.a&&1===o&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==f)return;const m=Zt.disabled,g=e.getDepthModeForSublayer(0,"opaque"===f?Ut.ReadWrite:Ut.ReadOnly),y=e.colorModeForRenderPass(),v=e.useProgram(d?"backgroundPattern":"background"),x=n||xe(h,{tileSize:p,terrain:e.style.map.terrain});d&&(l.activeTexture.set(u.TEXTURE0),e.imageManager.bind(e.context));const _=r.getCrossfadeParameters();for(const t of x){const n=h.getProjectionData({overscaledTileID:t,applyGlobeMatrix:!s,applyTerrainMatrix:!0}),i=d?en(o,e,d,{tileID:t,tileSize:p},_):Qr(o,a),f=e.style.map.terrain&&e.style.map.terrain.getTerrainData(t),x=c.getMeshFromTileID(l,t.canonical,!1,!0,"raster");v.draw(l,u.TRIANGLES,g,m,y,jt.backCCW,i,f,n,r.id,x.vertexBuffer,x.indexBuffer,x.segments)}}(e,0,n,i,a):t.cc(n)&&function(e,t,r,n){const{isRenderingGlobe:i}=n,a=e.context,o=r.implementation,s=e.style.projection,l=e.transform,u=l.getProjectionDataForCustomLayer(i),c={farZ:l.farZ,nearZ:l.nearZ,fov:l.fov*Math.PI/180,modelViewProjectionMatrix:l.modelViewProjectionMatrix,projectionMatrix:l.projectionMatrix,shaderData:{variantName:s.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;\nuniform mat4 u_projection_matrix;\n${s.shaderPreludeCode.vertexSource}`,define:s.shaderDefine},defaultProjectionData:u},h=o.renderingMode?o.renderingMode:"2d";if("offscreen"===e.renderPass){const t=o.prerender;t&&(e.setCustomLayerDefaults(),a.setColorMode(e.colorModeForRenderPass()),t.call(o,a.gl,c),a.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),a.setColorMode(e.colorModeForRenderPass()),a.setStencilMode(Zt.disabled);const t="3d"===h?e.getDepthModeFor3D():e.getDepthModeForSublayer(0,Ut.ReadOnly);a.setDepthMode(t),o.render(a.gl,c),a.setDirty(),e.setBaseState(),a.bindFramebuffer.set(null)}}(e,0,n,a))}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r}useProgram(e,t,r=!1,n=[]){this.cache=this.cache||{};const i=!!this.style.map.terrain,a=this.style.projection,o=r?_t.projectionMercator:a.shaderPreludeCode,s=r?Ct:a.shaderDefine,l=e+(t?t.cacheKey:"")+`/${r?Et:a.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(i?"/terrain":"")+(n?`/${n.join("/")}`:"");return this.cache[l]||(this.cache[l]=new Mr(this.context,_t[e],t,rn[e],this._showOverdrawInspector,i,o,s,n)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new v(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}}function Ci(e,t){let r,n=!1,i=null,a=null;const o=()=>{i=null,n&&(e.apply(a,r),i=setTimeout(o,t),n=!1)};return(...e)=>(n=!0,a=this,r=e,i||o(),i)}class Ei{constructor(e){this._getCurrentHash=()=>{const e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map((e=>e.split("="))).forEach((e=>{e[0]===this._hashName&&(t=e)})),(t&&t[1]||"").split("/")}return e.split("/")},this._onHashChange=()=>{const e=this._getCurrentHash();if(!this._isValidHash(e))return!1;const t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0},this._updateHashUnthrottled=()=>{const e=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,e)},this._removeHash=()=>{const e=this._getCurrentHash();if(0===e.length)return;const t=e.join("/");let r=t;r.split("&").length>0&&(r=r.split("&")[0]),this._hashName&&(r=`${this._hashName}=${t}`);let n=window.location.hash.replace(r,"");n.startsWith("#&")?n=n.slice(0,1)+n.slice(2):"#"===n&&(n="");let i=window.location.href.replace(/(#.+)?$/,n);i=i.replace("&&","&"),window.history.replaceState(window.history.state,null,i)},this._updateHash=Ci(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const t=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,n),a=Math.round(t.lng*i)/i,o=Math.round(t.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch();let u="";if(u+=e?`/${a}/${o}/${r}`:`${r}/${o}/${a}`,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+=`/${Math.round(l)}`),this._hashName){const e=this._hashName;let t=!1;const r=window.location.hash.slice(1).split("&").map((r=>{const n=r.split("=")[0];return n===e?(t=!0,`${n}=${u}`):r})).filter((e=>e));return t||r.push(`${e}=${u}`),`#${r.join("&")}`}return`#${u}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new t.Q(+e[2],+e[1])}catch(e){return!1}const r=+e[0],n=+(e[3]||0),i=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&n>=-180&&n<=180&&i>=this._map.getMinPitch()&&i<=this._map.getMaxPitch()}}const Mi={linearity:.3,easing:t.cd(0,0,.3,1)},Si=t.e({deceleration:2500,maxSpeed:1400},Mi),Di=t.e({deceleration:20,maxSpeed:1400},Mi),Ti=t.e({deceleration:1e3,maxSpeed:360},Mi),Ni=t.e({deceleration:1e3,maxSpeed:90},Mi),Ii=t.e({deceleration:1e3,maxSpeed:360},Mi);class Pi{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,t=o.now();for(;e.length>0&&t-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)r.zoom+=e.zoomDelta||0,r.bearing+=e.bearingDelta||0,r.pitch+=e.pitchDelta||0,r.roll+=e.rollDelta||0,e.panDelta&&r.pan._add(e.panDelta),e.around&&(r.around=e.around),e.pinchAround&&(r.pinchAround=e.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(r.pan.mag()){const a=Bi(r.pan.mag(),n,t.e({},Si,e||{})),o=r.pan.mult(a.amount/r.pan.mag()),s=this._map.cameraHelper.handlePanInertia(o,this._map.transform);i.center=s.easingCenter,i.offset=s.easingOffset,zi(i,a)}if(r.zoom){const e=Bi(r.zoom,n,Di);i.zoom=this._map.transform.zoom+e.amount,zi(i,e)}if(r.bearing){const e=Bi(r.bearing,n,Ti);i.bearing=this._map.transform.bearing+t.ae(e.amount,-179,179),zi(i,e)}if(r.pitch){const e=Bi(r.pitch,n,Ni);i.pitch=this._map.transform.pitch+e.amount,zi(i,e)}if(r.roll){const e=Bi(r.roll,n,Ii);i.roll=this._map.transform.roll+t.ae(e.amount,-179,179),zi(i,e)}if(i.zoom||i.bearing){const e=void 0===r.pinchAround?r.around:r.pinchAround;i.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),t.e(i,{noMoveStart:!0})}}function zi(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Bi(e,r,n){const{maxSpeed:i,linearity:a,deceleration:o}=n,s=t.ae(e*a/(r/1e3),-i,i),l=Math.abs(s)/(o*a);return{easing:n.easing,duration:1e3*l,amount:s*(l/2)}}class ki extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n,i={}){n=n instanceof MouseEvent?n:new MouseEvent(e,n);const a=s.mousePos(r.getCanvas(),n),o=r.unproject(a);super(e,t.e({point:a,lngLat:o,originalEvent:n},i)),this._defaultPrevented=!1,this.target=r}}class Fi extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n){const i="touchend"===e?n.changedTouches:n.touches,a=s.touchPos(r.getCanvasContainer(),i),o=a.map((e=>r.unproject(e))),l=a.reduce(((e,t,r,n)=>e.add(t.div(n.length))),new t.P(0,0));super(e,{points:a,point:l,lngLats:o,lngLat:r.unproject(l),originalEvent:n}),this._defaultPrevented=!1}}class Ri extends t.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}}class Oi{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Ri(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new ki(e.type,this._map,e))}mouseup(e){this._map.fire(new ki(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new ki(e.type,this._map,e))}dblclick(e){return this._firePreventable(new ki(e.type,this._map,e))}mouseover(e){this._map.fire(new ki(e.type,this._map,e))}mouseout(e){this._map.fire(new ki(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Fi(e.type,this._map,e))}touchmove(e){this._map.fire(new Fi(e.type,this._map,e))}touchend(e){this._map.fire(new Fi(e.type,this._map,e))}touchcancel(e){this._map.fire(new Fi(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Li{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new ki(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ki("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new ki(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qi{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(t.P.convert(e),this._map.terrain)}}class ji{constructor(e,t){this._map=e,this._tr=new qi(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(s.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const r=t;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const n=this._startPos;this._lastPos=r,this._box||(this._box=s.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const i=Math.min(n.x,r.x),a=Math.max(n.x,r.x),o=Math.min(n.y,r.y),l=Math.max(n.y,r.y);s.setTransform(this._box,`translate(${i}px,${o}px)`),this._box.style.width=a-i+"px",this._box.style.height=l-o+"px"}mouseupWindow(e,r){if(!this._active)return;if(0!==e.button)return;const n=this._startPos,i=r;if(this.reset(),s.suppressClick(),n.x!==i.x||n.y!==i.y)return this._map.fire(new t.l("boxzoomend",{originalEvent:e})),{cameraAnimation:e=>e.fitScreenCoordinates(n,i,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(s.remove(this._box),this._box=null),s.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new t.l(e,{originalEvent:r}))}}function Ui(e,t){if(e.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${e.length}, points ${t.length}`);const r={};for(let n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}class Vi{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),n.length===this.numTouches&&(this.centroid=function(e){const r=new t.P(0,0);for(const t of e)r._add(t);return r.div(e.length)}(r),this.touches=Ui(n,r)))}touchmove(e,t,r){if(this.aborted||!this.centroid)return;const n=Ui(r,t);for(const e in this.touches){const t=n[e];(!t||t.dist(this.touches[e])>30)&&(this.aborted=!0)}}touchend(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class Zi{constructor(e){this.singleTap=new Vi(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){const n=this.singleTap.touchend(e,t,r);if(n){const t=e.timeStamp-this.lastTime<500,r=!this.lastTap||this.lastTap.dist(n)<30;if(t&&r||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class $i{constructor(e){this._tr=new qi(e),this._zoomIn=new Zi({numTouches:1,numTaps:2}),this._zoomOut=new Zi({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,t,r){const n=this._zoomIn.touchend(e,t,r),i=this._zoomOut.touchend(e,t,r),a=this._tr;return n?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(n)},{originalEvent:e})}):i?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(i)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gi{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const t=this._moveFunction(...e);if(t.bearingDelta||t.pitchDelta||t.rollDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(t)?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;const r=this._lastPoint;if(!r)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const n=Array.isArray(t)?t[0]:t;return!this._moved&&n.dist(r)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=n,this._move(r,n))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&s.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Hi={0:1,2:2};class Wi{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const t=s.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(e,t){const r=Hi[t];return void 0===e.buttons||(e.buttons&r)!==r}(e,this._eventButton)}isValidEndEvent(e){return s.mouseButton(e)===this._eventButton}}class Xi{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return 1===e.targetTouches.length}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Yi{constructor(e=new Wi({checkCorrectEvent:()=>!0}),t=new Xi){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=t}_executeRelevantHandler(e,t,r){return e instanceof MouseEvent?t(e):"undefined"!=typeof TouchEvent&&e instanceof TouchEvent?r(e):void 0}startMove(e){this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.startMove(e)),(e=>this.oneFingerTouchMoveStateManager.startMove(e)))}endMove(e){this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.endMove(e)),(e=>this.oneFingerTouchMoveStateManager.endMove(e)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.isValidStartEvent(e)),(e=>this.oneFingerTouchMoveStateManager.isValidStartEvent(e)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.isValidMoveEvent(e)),(e=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(e)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(e=>this.mouseMoveStateManager.isValidEndEvent(e)),(e=>this.oneFingerTouchMoveStateManager.isValidEndEvent(e)))}}const Ki=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=e=>{e.preventDefault()}};class Ji{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(e,t,r){if(this._active){if(!this._shouldBePrevented(r.length))return e.preventDefault(),this._calculateTransform(e,t,r);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&this._shouldBePrevented(r.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,n){n.length>0&&(this._active=!0);const i=Ui(n,r),a=new t.P(0,0),o=new t.P(0,0);let s=0;for(const e in i){const t=i[e],r=this._touches[e];r&&(a._add(t),o._add(t.sub(r)),s++,i[e]=t)}if(this._touches=i,this._shouldBePrevented(s)||!o.mag())return;const l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qi{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){if(!this._firstTwoTouches)return;e.preventDefault();const[n,i]=this._firstTwoTouches,a=ea(r,t,n),o=ea(r,t,i);if(!a||!o)return;const s=this._aroundCenter?null:a.add(o).div(2);return this._move([a,o],s,e)}touchend(e,t,r){if(!this._firstTwoTouches)return;const[n,i]=this._firstTwoTouches,a=ea(r,t,n),o=ea(r,t,i);a&&o||(this._active&&s.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ea(e,t,r){for(let n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function ta(e,t){return Math.log(e/t)/Math.LN2}class ra extends Qi{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(ta(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ta(this._distance,r),pinchAround:t}}}function na(e,t){return 180*e.angleWith(t)/Math.PI}class ia extends Qi{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,r){const n=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:na(this._vector,n),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,r=na(e,this._startVector);return Math.abs(r)<t}}function aa(e){return Math.abs(e.y)>Math.abs(e.x)}class oa extends Qi{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,r){super.touchstart(e,t,r),this._currentTouchCount=r.length}_start(e){this._lastPoints=e,aa(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const n=e[0].sub(this._lastPoints[0]),i=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,i,r.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+i.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,r){if(void 0!==this._valid)return this._valid;const n=e.mag()>=2,i=t.mag()>=2;if(!n&&!i)return;if(!n||!i)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;const a=e.y>0==t.y>0;return aa(e)&&aa(t)&&a}}const sa={panStep:100,bearingStep:15,pitchStep:10};class la{constructor(e){this._tr=new qi(e);const t=sa;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,r=0,n=0,i=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(r=0,n=0),{cameraAnimation:o=>{const s=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:ua,zoom:t?Math.round(s.zoom)+t*(e.shiftKey?2:1):s.zoom,bearing:s.bearing+r*this._bearingStep,pitch:s.pitch+n*this._pitchStep,offset:[-i*this._panStep,-a*this._panStep],center:s.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ua(e){return e*(2-e)}const ca=4.000244140625;class ha{constructor(e,t){this._onTimeout=e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},this._map=e,this._tr=new qi(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const r=o.now(),n=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==t&&t%ca==0?this._type="wheel":0!==t&&Math.abs(t)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t/=4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=s.mousePos(this._map.getCanvas(),e),n=this._tr;this._aroundPoint=this._aroundCenter?n.transform.locationToScreenPoint(t.Q.convert(n.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._tr.transform;if("number"==typeof this._lastExpectedZoom){const t=e.zoom-this._lastExpectedZoom;"number"==typeof this._startZoom&&(this._startZoom+=t),"number"==typeof this._targetZoom&&(this._targetZoom+=t)}if(0!==this._delta){const r="wheel"===this._type&&Math.abs(this._delta)>ca?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==n&&(n=1/n);const i="number"!=typeof this._targetZoom?e.scale:t.ac(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),t.ah(i*n)).zoom,"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r="number"!=typeof this._targetZoom?e.zoom:this._targetZoom,n=this._startZoom,i=this._easing;let a,s=!1;if("wheel"===this._type&&n&&i){const e=o.now()-this._lastWheelEventTime,l=Math.min((e+5)/200,1),u=i(l);a=t.B.number(n,r,u),l<1?this._frameId||(this._frameId=!0):s=!0}else a=r,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=a,{noInertia:!0,needsRenderFrame:!s,zoomDelta:a-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=t.cf;if(this._prevEase){const e=this._prevEase,n=(o.now()-e.start)/e.duration,i=e.easing(n+.01)-e.easing(n),a=.27/Math.sqrt(i*i+1e-4)*.01,s=Math.sqrt(.0729-a*a);r=t.cd(a,s,.25,1)}return this._prevEase={start:o.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class pa{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class da{constructor(e){this._tr=new qi(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fa{constructor(){this._tap=new Zi({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,r){if(!this._swipePoint)if(this._tapTime){const n=t[0],i=e.timeStamp-this._tapTime<500,a=this._tapPoint.dist(n)<30;i&&a?r.length>0&&(this._swipePoint=n,this._swipeTouch=r[0].identifier):this.reset()}else this._tap.touchstart(e,t,r)}touchmove(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const n=t[0],i=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(e,t,r)}touchend(e,t,r){if(this._tapTime)this._swipePoint&&0===r.length&&this.reset();else{const n=this._tap.touchend(e,t,r);n&&(this._tapTime=e.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ma{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ga{constructor(e,t,r,n){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=t,this._mousePitch=r,this._mouseRoll=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ya{constructor(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class va{constructor(e,t){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=s.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),n=document.createElement("div");n.className="maplibregl-desktop-message",n.textContent=t,this._container.appendChild(n);const i=document.createElement("div");i.className="maplibregl-mobile-message",i.textContent=r,this._container.appendChild(i),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(s.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new t.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const xa=e=>e.zoom||e.drag||e.roll||e.pitch||e.rotate;class _a extends t.l{}function ba(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta||e.rollDelta}class wa{constructor(e,r){this.handleWindowEvent=e=>{this.handleEvent(e,`${e.type}Window`)},this.handleEvent=(e,r)=>{if("blur"===e.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===e.type?void 0:e,i={needsRenderFrame:!1},a={},o={};for(const{handlerName:l,handler:u,allowed:c}of this._handlers){if(!u.isEnabled())continue;let h;if(this._blockedByActive(o,c,l))u.reset();else if(u[r||e.type]){if(t.cg(e,r||e.type)){const t=s.mousePos(this._map.getCanvas(),e);h=u[r||e.type](e,t)}else if(t.ch(e,r||e.type)){const t=this._getMapTouches(e.touches),n=s.touchPos(this._map.getCanvas(),t);h=u[r||e.type](e,n,t)}else t.ci(r||e.type)||(h=u[r||e.type](e));this.mergeHandlerResult(i,a,h,l,n),h&&h.needsRenderFrame&&this._triggerRenderFrame()}(h||u.isActive())&&(o[l]=u)}const l={};for(const e in this._previousActiveHandlers)o[e]||(l[e]=n);this._previousActiveHandlers=o,(Object.keys(l).length||ba(i))&&(this._changes.push([i,a,l]),this._triggerRenderFrame()),(Object.keys(o).length||ba(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=i;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Pi(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(const[e,t,r]of this._listeners)s.addEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}destroy(){for(const[e,t,r]of this._listeners)s.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(e){const r=this._map,n=r.getCanvasContainer();this._add("mapEvent",new Oi(r,e));const i=r.boxZoom=new ji(r,e);this._add("boxZoom",i),e.interactive&&e.boxZoom&&i.enable();const a=r.cooperativeGestures=new va(r,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();const o=new $i(r),l=new da(r);r.doubleClickZoom=new pa(l,o),this._add("tapZoom",o),this._add("clickZoom",l),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const u=new fa;this._add("tapDragZoom",u);const c=r.touchPitch=new oa(r);this._add("touchPitch",c),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const h=()=>r.project(r.getCenter()),p=function({enable:e,clickTolerance:r,aroundCenter:n=!0,minPixelCenterThreshold:i=100,rotateDegreesPerPixelMoved:a=.8},o){const l=new Wi({checkCorrectEvent:e=>0===s.mouseButton(e)&&e.ctrlKey||2===s.mouseButton(e)&&!e.ctrlKey});return new Gi({clickTolerance:r,move:(e,r)=>{const s=o();if(n&&Math.abs(s.y-e.y)>i)return{bearingDelta:t.ce(new t.P(e.x,r.y),r,s)};let l=(r.x-e.x)*a;return n&&r.y<s.y&&(l=-l),{bearingDelta:l}},moveStateManager:l,enable:e,assignEvents:Ki})}(e,h),d=function({enable:e,clickTolerance:t,pitchDegreesPerPixelMoved:r=-.5}){const n=new Wi({checkCorrectEvent:e=>0===s.mouseButton(e)&&e.ctrlKey||2===s.mouseButton(e)});return new Gi({clickTolerance:t,move:(e,t)=>({pitchDelta:(t.y-e.y)*r}),moveStateManager:n,enable:e,assignEvents:Ki})}(e),f=function({enable:e,clickTolerance:t,rollDegreesPerPixelMoved:r=.3},n){const i=new Wi({checkCorrectEvent:e=>2===s.mouseButton(e)&&e.ctrlKey});return new Gi({clickTolerance:t,move:(e,t)=>{const i=n();let a=(t.x-e.x)*r;return t.y<i.y&&(a=-a),{rollDelta:a}},moveStateManager:i,enable:e,assignEvents:Ki})}(e,h);r.dragRotate=new ga(e,p,d,f),this._add("mouseRotate",p,["mousePitch"]),this._add("mousePitch",d,["mouseRotate","mouseRoll"]),this._add("mouseRoll",f,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const m=function({enable:e,clickTolerance:t}){const r=new Wi({checkCorrectEvent:e=>0===s.mouseButton(e)&&!e.ctrlKey});return new Gi({clickTolerance:t,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:r,enable:e,assignEvents:Ki})}(e),g=new Ji(e,r);r.dragPan=new ma(n,m,g),this._add("mousePan",m),this._add("touchPan",g,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const y=new ia,v=new ra;r.touchZoomRotate=new ya(n,v,y,u),this._add("touchRotate",y,["touchPan","touchZoom"]),this._add("touchZoom",v,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const x=r.scrollZoom=new ha(r,(()=>this._triggerRenderFrame()));this._add("scrollZoom",x,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const _=r.keyboard=new la(r);this._add("keyboard",_),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new Li(r))}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(xa(this._eventsInProgress))||this.isZooming()}_blockedByActive(e,t,r){for(const n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}_getMapTouches(e){const t=[];for(const r of e)this._el.contains(r.target)&&t.push(r);return t}mergeHandlerResult(e,r,n,i,a){if(!n)return;t.e(e,n);const o={handlerName:i,originalEvent:n.originalEvent||a};void 0!==n.zoomDelta&&(r.zoom=o),void 0!==n.panDelta&&(r.drag=o),void 0!==n.rollDelta&&(r.roll=o),void 0!==n.pitchDelta&&(r.pitch=o),void 0!==n.bearingDelta&&(r.rotate=o)}_applyChanges(){const e={},r={},n={};for(const[i,a,o]of this._changes)i.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(i.panDelta)),i.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+i.pitchDelta),i.rollDelta&&(e.rollDelta=(e.rollDelta||0)+i.rollDelta),void 0!==i.around&&(e.around=i.around),void 0!==i.pinchAround&&(e.pinchAround=i.pinchAround),i.noInertia&&(e.noInertia=i.noInertia),t.e(r,a),t.e(n,o);this._updateMapTransform(e,r,n),this._changes=[]}_updateMapTransform(e,t,r){const n=this._map,i=n._getTransformForUpdate(),a=n.terrain;if(!(ba(e)||a&&this._terrainMovement))return this._fireEvents(t,r,!0);n._stop(!0);let{panDelta:o,zoomDelta:s,bearingDelta:l,pitchDelta:u,rollDelta:c,around:h,pinchAround:p}=e;void 0!==p&&(h=p),h=h||n.transform.centerPoint,a&&!i.isPointOnMapSurface(h)&&(h=i.centerPoint);const d={panDelta:o,zoomDelta:s,rollDelta:c,pitchDelta:u,bearingDelta:l,around:h};this._map.cameraHelper.useGlobeControls&&!i.isPointOnMapSurface(h)&&(h=i.centerPoint);const f=h.distSqr(i.centerPoint)<.01?i.center:i.screenPointToLocation(o?h.sub(o):h);a?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(d,i),this._terrainMovement||!t.drag&&!t.zoom?t.drag&&this._terrainMovement?i.setCenter(i.screenPointToLocation(i.centerPoint.sub(o))):this._map.cameraHelper.handleMapControlsPan(d,i,f):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(d,i,f))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(d,i),this._map.cameraHelper.handleMapControlsPan(d,i,f)),n._applyUpdatedTransform(i),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r,!0)}_fireEvents(e,r,n){const i=xa(this._eventsInProgress),a=xa(e),s={};for(const t in e){const{originalEvent:r}=e[t];this._eventsInProgress[t]||(s[`${t}start`]=r),this._eventsInProgress[t]=e[t]}!i&&a&&this._fireEvent("movestart",a.originalEvent);for(const e in s)this._fireEvent(e,s[e]);a&&this._fireEvent("move",a.originalEvent);for(const t in e){const{originalEvent:r}=e[t];this._fireEvent(t,r)}const l={};let u;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:n}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],u=r[t]||n,l[`${e}end`]=u)}for(const e in l)this._fireEvent(e,l[e]);const c=xa(this._eventsInProgress),h=(i||a)&&!c;if(h&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const e=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&e.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(e)}if(n&&h){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),r=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;!e||!e.essential&&o.prefersReducedMotion?(this._map.fire(new t.l("moveend",{originalEvent:u})),r(this._map.getBearing())&&this._map.resetNorth()):(r(e.bearing||this._map.getBearing())&&(e.bearing=0),e.freezeElevation=!0,this._map.easeTo(e,{originalEvent:u})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new t.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new _a("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Aa extends t.E{constructor(e,t,r){super(),this._renderFrameCallback=()=>{const e=Math.min((o.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=r.bearingSnap,this.cameraHelper=t,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,t){e.apply(this.transform),this.transform=e,this.cameraHelper=t}getCenter(){return new t.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,t){return this.jumpTo({elevation:e},t),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,n){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.e({offset:e},r),n)}panTo(e,r,n){return this.easeTo(t.e({center:e},r),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,r,n){return this.easeTo(t.e({zoom:e},r),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new t.l("movestart",r)).fire(new t.l("move",r)).fire(new t.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,r,n){return this.easeTo(t.e({bearing:e},r),n)}resetNorth(e,r){return this.rotateTo(0,t.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(t.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}getRoll(){return this.transform.roll}setRoll(e,t){return this.jumpTo({roll:e},t),this}cameraForBounds(e,t){e=Z.convert(e).adjustAntiMeridian();const r=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,t)}_cameraForBoxAndBearing(e,r,n,i){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=t.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const e=i.padding;i.padding={top:e,bottom:e,right:e,left:e}}const o=t.e(a,i.padding);i.padding=o;const s=this.transform,l=new Z(e,r);return this.cameraHelper.cameraForBoxAndBearing(i,o,l,n,s)}fitBounds(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}fitScreenCoordinates(e,r,n,i,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(t.P.convert(e)),this.transform.screenPointToLocation(t.P.convert(r)),n,i),i,a)}_fitInternal(e,r,n){return e?(delete(r=t.e(e,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}jumpTo(e,r){this.stop();const n=this._getTransformForUpdate();let i=!1,a=!1,o=!1;const s=n.zoom;this.cameraHelper.handleJumpToCenterZoom(n,e);const l=n.zoom!==s;return"elevation"in e&&n.elevation!==+e.elevation&&n.setElevation(+e.elevation),"bearing"in e&&n.bearing!==+e.bearing&&(i=!0,n.setBearing(+e.bearing)),"pitch"in e&&n.pitch!==+e.pitch&&(a=!0,n.setPitch(+e.pitch)),"roll"in e&&n.roll!==+e.roll&&(o=!0,n.setRoll(+e.roll)),null==e.padding||n.isPaddingEqual(e.padding)||n.setPadding(e.padding),this._applyUpdatedTransform(n),this.fire(new t.l("movestart",r)).fire(new t.l("move",r)),l&&this.fire(new t.l("zoomstart",r)).fire(new t.l("zoom",r)).fire(new t.l("zoomend",r)),i&&this.fire(new t.l("rotatestart",r)).fire(new t.l("rotate",r)).fire(new t.l("rotateend",r)),a&&this.fire(new t.l("pitchstart",r)).fire(new t.l("pitch",r)).fire(new t.l("pitchend",r)),o&&this.fire(new t.l("rollstart",r)).fire(new t.l("roll",r)).fire(new t.l("rollend",r)),this.fire(new t.l("moveend",r))}calculateCameraOptionsFromTo(e,r,n,i=0){const a=t.$.fromLngLat(e,r),o=t.$.fromLngLat(n,i),s=o.x-a.x,l=o.y-a.y,u=o.z-a.z,c=Math.hypot(s,l,u);if(0===c)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(s,l),p=t.ah(this.transform.cameraToCenterDistance/c/this.transform.tileSize),d=180*Math.atan2(s,-l)/Math.PI;let f=180*Math.acos(h/c)/Math.PI;return f=u<0?90-f:90+f,{center:o.toLngLat(),elevation:i,zoom:p,pitch:f,bearing:d}}calculateCameraOptionsFromCameraLngLatAltRotation(e,t,r,n,i){const a=this.transform.calculateCenterFromCameraLngLatAlt(e,t,r,n);return{center:a.center,elevation:a.elevation,zoom:a.zoom,bearing:r,pitch:n,roll:i}}easeTo(e,r){this._stop(!1,e.easeId),(!1===(e=t.e({offset:[0,0],duration:500,easing:t.cf},e)).animate||!e.essential&&o.prefersReducedMotion)&&(e.duration=0);const n=this._getTransformForUpdate(),i=this.getBearing(),a=n.pitch,s=n.roll,l="bearing"in e?this._normalizeBearing(e.bearing,i):i,u="pitch"in e?+e.pitch:a,c="roll"in e?this._normalizeBearing(e.roll,s):s,h="padding"in e?e.padding:n.padding,p=t.P.convert(e.offset);let d,f;e.around&&(d=t.Q.convert(e.around),f=n.locationToScreenPoint(d));const m={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},g=this.cameraHelper.handleEaseTo(n,{bearing:l,pitch:u,roll:c,padding:h,around:d,aroundPoint:f,offsetAsPoint:p,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||i!==l,this._pitching=this._pitching||u!==a,this._rolling=this._rolling||c!==s,this._padding=!n.isPaddingEqual(h),this._zooming=this._zooming||g.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,m),this.terrain&&this._prepareElevation(g.elevationCenter),this._ease((t=>{g.easeFunc(t),this.terrain&&!e.freezeElevation&&this._updateElevation(t),this._applyUpdatedTransform(n),this._fireMoveEvents(r)}),(t=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,t)}),e),this}_prepareEase(e,r,n={}){this._moving=!0,r||n.moving||this.fire(new t.l("movestart",e)),this._zooming&&!n.zooming&&this.fire(new t.l("zoomstart",e)),this._rotating&&!n.rotating&&this.fire(new t.l("rotatestart",e)),this._pitching&&!n.pitching&&this.fire(new t.l("pitchstart",e)),this._rolling&&!n.rolling&&this.fire(new t.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const t=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(t-(r-(t*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(t.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const t=e.getCameraLngLat(),r=e.getCameraAltitude(),n=this.terrain?this.terrain.getElevationForLngLatZoom(t,e.zoom):0;if(r<n){const r=this.calculateCameraOptionsFromTo(t,n,e.center,e.elevation);return{pitch:r.pitch,zoom:r.zoom}}return{}}_applyUpdatedTransform(e){const t=[];if(t.push((e=>this._elevateCameraIfInsideTerrain(e))),this.transformCameraUpdate&&t.push((e=>this.transformCameraUpdate(e))),!t.length)return;const r=e.clone();for(const e of t){const t=r.clone(),{center:n,zoom:i,roll:a,pitch:o,bearing:s,elevation:l}=e(t);n&&t.setCenter(n),void 0!==l&&t.setElevation(l),void 0!==i&&t.setZoom(i),void 0!==a&&t.setRoll(a),void 0!==o&&t.setPitch(o),void 0!==s&&t.setBearing(s),r.apply(t)}this.transform.apply(r)}_fireMoveEvents(e){this.fire(new t.l("move",e)),this._zooming&&this.fire(new t.l("zoom",e)),this._rotating&&this.fire(new t.l("rotate",e)),this._pitching&&this.fire(new t.l("pitch",e)),this._rolling&&this.fire(new t.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const n=this._zooming,i=this._rotating,a=this._pitching,o=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,n&&this.fire(new t.l("zoomend",e)),i&&this.fire(new t.l("rotateend",e)),a&&this.fire(new t.l("pitchend",e)),o&&this.fire(new t.l("rollend",e)),this.fire(new t.l("moveend",e))}flyTo(e,r){if(!e.essential&&o.prefersReducedMotion){const n=t.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(n,r)}this.stop(),e=t.e({offset:[0,0],speed:1.2,curve:1.42,easing:t.cf},e);const n=this._getTransformForUpdate(),i=n.bearing,a=n.pitch,s=n.roll,l=n.padding,u="bearing"in e?this._normalizeBearing(e.bearing,i):i,c="pitch"in e?+e.pitch:a,h="roll"in e?this._normalizeBearing(e.roll,s):s,p="padding"in e?e.padding:n.padding,d=t.P.convert(e.offset);let f=n.centerPoint.add(d);const m=n.screenPointToLocation(f),g=this.cameraHelper.handleFlyTo(n,{bearing:u,pitch:c,roll:h,padding:p,locationAtOffset:m,offsetAsPoint:d,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let y=e.curve;const v=Math.max(n.width,n.height),x=v/g.scaleOfZoom,_=g.pixelPathLength;"number"==typeof g.scaleOfMinZoom&&(y=Math.sqrt(v/g.scaleOfMinZoom/_*2));const b=y*y;function w(e){const t=(x*x-v*v+(e?-1:1)*b*b*_*_)/(2*(e?x:v)*b*_);return Math.log(Math.sqrt(t*t+1)-t)}function A(e){return(Math.exp(e)-Math.exp(-e))/2}function C(e){return(Math.exp(e)+Math.exp(-e))/2}const E=w(!1);let M=function(e){return C(E)/C(E+y*e)},S=function(e){return v*((C(E)*(A(t=E+y*e)/C(t))-A(E))/b)/_;var t},D=(w(!0)-E)/y;if(Math.abs(_)<2e-6||!isFinite(D)){if(Math.abs(v-x)<1e-6)return this.easeTo(e,r);const t=x<v?-1:1;D=Math.abs(Math.log(x/v))/y,S=()=>0,M=e=>Math.exp(t*y*e)}return e.duration="duration"in e?+e.duration:1e3*D/("screenSpeed"in e?+e.screenSpeed/y:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=i!==u,this._pitching=c!==a,this._rolling=h!==s,this._padding=!n.isPaddingEqual(p),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(g.targetCenter),this._ease((o=>{const m=o*D,y=1/M(m),v=S(m);this._rotating&&n.setBearing(t.B.number(i,u,o)),this._pitching&&n.setPitch(t.B.number(a,c,o)),this._rolling&&n.setRoll(t.B.number(s,h,o)),this._padding&&(n.interpolatePadding(l,p,o),f=n.centerPoint.add(d)),g.easeFunc(o,y,v,f),this.terrain&&!e.freezeElevation&&this._updateElevation(o),this._applyUpdatedTransform(n),this._fireMoveEvents(r)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){var r;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}return e||null===(r=this.handlers)||void 0===r||r.stop(!1),this}_ease(e,t,r){!1===r.animate||0===r.duration?(e(1),t()):(this._easeStart=o.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=t.aL(e,-180,180);const n=Math.abs(e-r);return Math.abs(e-360-r)<n&&(e-=360),Math.abs(e+360-r)<n&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(t.Q.convert(e),this.transform.tileZoom):null}}const Ca={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ea{constructor(e=Ca){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=e=>{!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType&&"terrain"!==e.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=s.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=s.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=s.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){s.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const r=this._map._getUIString(`AttributionControl.${t}`);e.title=r,e.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((e=>"string"!=typeof e?"":e))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style.sourceCaches;for(const r in t){const n=t[r];if(n.used||n.usedForTerrain){const t=n.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e=e.filter((e=>String(e).trim())),e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,r)=>{for(let n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0}));const r=e.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,e.length?(this._innerContainer.innerHTML=s.sanitize(r),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ma{constructor(e={}){this._updateCompact=()=>{const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&t.classList.add("maplibregl-compact"):t.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=s.create("div","maplibregl-ctrl");const t=s.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){s.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Sa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,r=t?this._queue.concat(t):this._queue;for(const t of r)if(t.id===e)return void(t.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const t=this._currentlyRunning=this._queue;this._queue=[];for(const r of t)if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Da=t.aG([{name:"a_pos3d",type:"Int16",components:3}]);class Ta extends t.E{constructor(e){super(),this._lastTilesetChange=o.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const n={};for(const i of xe(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))n[i.key]=!0,this._renderableTilesKeys.push(i.key),this._tiles[i.key]||(i.terrainRttPosMatrix32f=new Float64Array(16),t.bQ(i.terrainRttPosMatrix32f,0,t.Z,t.Z,0,0,1),this._tiles[i.key]=new ae(i,this.tileSize),this._lastTilesetChange=o.now());for(const e in this._tiles)n[e]||delete this._tiles[e]}freeRtt(e){for(const t in this._tiles){const r=this._tiles[t];(!e||r.tileID.equals(e)||r.tileID.isChildOf(e)||e.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,t){return t?this._getTerrainCoordsForTileRanges(e,t):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const r={};for(const n of this._renderableTilesKeys){const i=this._tiles[n].tileID,a=e.clone(),o=t.b2();if(i.canonical.equals(e.canonical))t.bQ(o,0,t.Z,t.Z,0,0,1);else if(i.canonical.isChildOf(e.canonical)){const r=i.canonical.z-e.canonical.z,n=i.canonical.x-(i.canonical.x>>r<<r),a=i.canonical.y-(i.canonical.y>>r<<r),s=t.Z>>r;t.bQ(o,0,s,s,0,0,1),t.L(o,o,[-n*s,-a*s,0])}else{if(!e.canonical.isChildOf(i.canonical))continue;{const r=e.canonical.z-i.canonical.z,n=e.canonical.x-(e.canonical.x>>r<<r),a=e.canonical.y-(e.canonical.y>>r<<r),s=t.Z>>r;t.bQ(o,0,t.Z,t.Z,0,0,1),t.L(o,o,[n*s,a*s,0]),t.M(o,o,[1/2**r,1/2**r,0])}}a.terrainRttPosMatrix32f=new Float32Array(o),r[n]=a}return r}_getTerrainCoordsForTileRanges(e,r){const n={};for(const i of this._renderableTilesKeys){const a=this._tiles[i].tileID;if(!this._isWithinTileRanges(a,r))continue;const o=e.clone(),s=t.b2();if(a.canonical.z===e.canonical.z){const r=e.canonical.x-a.canonical.x,n=e.canonical.y-a.canonical.y;t.bQ(s,0,t.Z,t.Z,0,0,1),t.L(s,s,[r*t.Z,n*t.Z,0])}else if(a.canonical.z>e.canonical.z){const r=a.canonical.z-e.canonical.z,n=a.canonical.x-(a.canonical.x>>r<<r),i=a.canonical.y-(a.canonical.y>>r<<r),o=e.canonical.x-(a.canonical.x>>r),l=e.canonical.y-(a.canonical.y>>r),u=t.Z>>r;t.bQ(s,0,u,u,0,0,1),t.L(s,s,[-n*u+o*t.Z,-i*u+l*t.Z,0])}else{const r=e.canonical.z-a.canonical.z,n=e.canonical.x-(e.canonical.x>>r<<r),i=e.canonical.y-(e.canonical.y>>r<<r),o=(e.canonical.x>>r)-a.canonical.x,l=(e.canonical.y>>r)-a.canonical.y,u=t.Z<<r;t.bQ(s,0,u,u,0,0,1),t.L(s,s,[n*t.Z+o*u,i*t.Z+l*u,0])}o.terrainRttPosMatrix32f=new Float32Array(s),n[i]=o}return n}getSourceTile(e,t){const r=this.sourceCache._source;let n=e.overscaledZ-this.deltaZoom;if(n>r.maxzoom&&(n=r.maxzoom),n<r.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let i=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!i||!i.dem)&&t)for(;n>=r.minzoom&&(!i||!i.dem);)i=this.sourceCache.getTileByID(e.scaledTo(n--).key);return i}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,t){return t[e.canonical.z]&&e.canonical.x>=t[e.canonical.z].minTileX&&e.canonical.x<=t[e.canonical.z].maxTileX&&e.canonical.y>=t[e.canonical.z].minTileY&&e.canonical.y<=t[e.canonical.z].maxTileY}}class Na{constructor(e,t,r){this._meshCache={},this.painter=e,this.sourceCache=new Ta(t),this.options=r,this.exaggeration="number"==typeof r.exaggeration?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,n,i=t.Z){var a;if(!(r>=0&&r<i&&n>=0&&n<i))return 0;const o=this.getTerrainData(e),s=null===(a=o.tile)||void 0===a?void 0:a.dem;if(!s)return 0;const l=t.cj([],[r/i*t.Z,n/i*t.Z],o.u_terrain_matrix),u=[l[0]*s.dim,l[1]*s.dim],c=Math.floor(u[0]),h=Math.floor(u[1]),p=u[0]-c,d=u[1]-h;return s.get(c,h)*(1-p)*(1-d)+s.get(c+1,h)*p*(1-d)+s.get(c,h+1)*(1-p)*d+s.get(c+1,h+1)*p*d}getElevationForLngLatZoom(e,r){if(!t.ck(r,e.wrap()))return 0;const{tileID:n,mercatorX:i,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(n,i%t.Z,a%t.Z,t.Z)}getElevation(e,r,n,i=t.Z){return this.getDEMElevation(e,r,n,i)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const e=this.painter.context,r=new t.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new v(e,r,e.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new v(e,new t.R({width:1,height:1}),e.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.ad([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const e=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new v(e,r.dem.getPixels(),e.gl.RGBA,{premultiply:!1}),r.demTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const n=r&&r+r.tileID.key+e.key;if(n&&!this._demMatrixCache[n]){const n=this.sourceCache.sourceCache._source.maxzoom;let i=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=n?i=e.canonical.z-n:t.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=e.canonical.x-(e.canonical.x>>i<<i),o=e.canonical.y-(e.canonical.y>>i<<i),s=t.cl(new Float64Array(16),[1/(t.Z<<i),1/(t.Z<<i),0]);t.L(s,s,[a*t.Z,o*t.Z,0]),this._demMatrixCache[e.key]={matrix:s,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:n?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const t=this.painter,r=t.width/devicePixelRatio,n=t.height/devicePixelRatio;return!this._fbo||this._fbo.width===r&&this._fbo.height===n||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new v(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new v(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(r,n,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,r,n))),this._fbo.colorAttachment.set("coords"===e?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let e=0,t=0;e<this._coordsTextureSize;e++)for(let n=0;n<this._coordsTextureSize;n++,t+=4)r[t+0]=255&n,r[t+1]=255&e,r[t+2]=n>>8<<4|e>>8,r[t+3]=0;const n=new t.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),i=new v(e,n,e.gl.RGBA,{premultiply:!1});return i.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=i,i}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),n=this.painter.context,i=n.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);n.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),i.readPixels(a,s-o-1,1,1,i.RGBA,i.UNSIGNED_BYTE,r),n.bindFramebuffer.set(null);const l=r[0]+(r[2]>>4<<8),u=r[1]+((15&r[2])<<8),c=this.coordsIndex[255-r[3]],h=c&&this.sourceCache.getTileByID(c);if(!h)return null;const p=this._coordsTextureSize,d=(1<<h.tileID.canonical.z)*p;return new t.$((h.tileID.canonical.x*p+l)/d+h.tileID.wrap,(h.tileID.canonical.y*p+u)/d,this.getElevation(h.tileID,l,u,p))}depthAtPoint(e){const t=new Uint8Array(4),r=this.painter.context,n=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null),(t[0]/16777216+t[1]/65536+t[2]/256+t[3])/256}getTerrainMesh(e){var r;const n=(null===(r=this.painter.style.projection)||void 0===r?void 0:r.transitionState)>0,i=n&&0===e.canonical.y,a=n&&e.canonical.y===(1<<e.canonical.z)-1,o=`m_${i?"n":""}_${a?"s":""}`;if(this._meshCache[o])return this._meshCache[o];const s=this.painter.context,l=new t.cm,u=new t.aK,c=this.meshSize,h=t.Z/c,p=c*c;for(let e=0;e<=c;e++)for(let t=0;t<=c;t++)l.emplaceBack(t*h,e*h,0);for(let e=0;e<p;e+=c+1)for(let t=0;t<c;t++)u.emplaceBack(t+e,c+t+e+1,c+t+e+2),u.emplaceBack(t+e,c+t+e+2,t+e+1);const d=l.length,f=d+(c+1),m=(c+1)*c,g=i?t.b9:0,y=i?0:1,v=a?t.ba:t.Z,x=a?0:1;for(let e=0;e<=c;e++)l.emplaceBack(e*h,g,y);for(let e=0;e<=c;e++)l.emplaceBack(e*h,v,x);for(let e=0;e<c;e++)u.emplaceBack(m+e,f+e,f+e+1),u.emplaceBack(m+e,f+e+1,m+e+1),u.emplaceBack(0+e,d+e+1,d+e),u.emplaceBack(0+e,0+e+1,d+e+1);const _=l.length,b=_+2*(c+1);for(const e of[0,1])for(let r=0;r<=c;r++)for(const n of[0,1])l.emplaceBack(e*t.Z,r*h,n);for(let e=0;e<2*c;e+=2)u.emplaceBack(_+e,_+e+1,_+e+3),u.emplaceBack(_+e,_+e+3,_+e+2),u.emplaceBack(b+e,b+e+3,b+e+1),u.emplaceBack(b+e,b+e+2,b+e+3);const w=new wt(s.createVertexBuffer(l,Da.members),s.createIndexBuffer(u),t.aJ.simpleSegment(0,0,l.length,u.length));return this._meshCache[o]=w,w}getMeshFrameDelta(e){return 2*Math.PI*t.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,t){var r;const{tileID:n}=this._getOverscaledTileIDFromLngLatZoom(e,t);return null!==(r=this.getMinMaxElevation(n).minElevation)&&void 0!==r?r:0}getMinMaxElevation(e){const t=this.getTerrainData(e).tile,r={minElevation:null,maxElevation:null};return t&&t.dem&&(r.minElevation=t.dem.min*this.exaggeration,r.maxElevation=t.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(e,r){const n=t.$.fromLngLat(e.wrap()),i=(1<<r)*t.Z,a=n.x*i,o=n.y*i,s=Math.floor(a/t.Z),l=Math.floor(o/t.Z);return{tileID:new t.Y(r,0,r,s,l),mercatorX:a,mercatorY:o}}}class Ia{constructor(e,t,r){this._context=e,this._size=t,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new v(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(r.texture),{id:e,fbo:t,texture:r,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((t=>e.id!==t)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const e of this._recentlyUsed)if(!this._objects[e].inUse)return this._objects[e];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((e=>!e.inUse))}}const Pa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class za{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new Ia(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((r=>!e._layers[r].isHidden(t))),this._coordsAscending={};for(const t in e.sourceCaches){this._coordsAscending[t]={};const r=e.sourceCaches[t].getVisibleCoordinates(),n=e.sourceCaches[t].getSource(),i=n instanceof Y?n.terrainTileRanges:null;for(const e of r){const r=this.terrain.sourceCache.getTerrainCoords(e,i);for(const e in r)this._coordsAscending[t][e]||(this._coordsAscending[t][e]=[]),this._coordsAscending[t][e].push(r[e])}}this._coordsAscendingStr={};for(const t of e._order){const r=e._layers[t],n=r.source;if(Pa[r.type]&&!this._coordsAscendingStr[n]){this._coordsAscendingStr[n]={};for(const e in this._coordsAscending[n])this._coordsAscendingStr[n][e]=this._coordsAscending[n][e].map((e=>e.key)).sort().join()}}for(const e of this._renderableTiles)for(const t in this._coordsAscendingStr){const r=this._coordsAscendingStr[t][e.tileID.key];r&&r!==e.rttCoords[t]&&(e.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const n=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),i=e.type,a=this.painter,o=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Pa[i]&&(this._prevType&&Pa[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(e.id),!o))return!0;if(Pa[this._prevType]||Pa[i]&&o){this._prevType=i;const e=this._stacks.length-1,r=this._stacks[e]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(bi(this.painter,this.terrain,this._rttTiles,n),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[e]){const t=this.pool.getObjectForId(i.rtt[e].id);if(t.stamp===i.rtt[e].stamp){this.pool.useObject(t);continue}}const o=this.pool.getOrCreateFreeObject();this.pool.useObject(o),this.pool.stampObject(o),i.rtt[e]={id:o.id,stamp:o.stamp},a.context.bindFramebuffer.set(o.fbo.framebuffer),a.context.clear({color:t.b7.transparent,stencil:0}),a.currentStencilSource=void 0;for(let e=0;e<r.length;e++){const t=a.style._layers[r[e]],s=t.source?this._coordsAscending[t.source][i.tileID.key]:[i.tileID];a.context.viewport.set([0,0,o.fbo.width,o.fbo.height]),a._renderTileClippingMasks(t,s,!0),a.renderLayer(a,a.style.sourceCaches[t.source],t,s,n),t.source&&(i.rttCoords[t.source]=this._coordsAscendingStr[t.source][i.tileID.key])}}return bi(this.painter,this.terrain,this._rttTiles,n),this._rttTiles=[],this.pool.freeAllObjects(),Pa[i]}return!1}}const Ba={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ka=r,Fa={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ca,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:t.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Ra={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Oa{constructor(e,r,n=!1){this.mousedown=e=>{this.startMove(e,s.mousePos(this.element,e)),s.addEventListener(window,"mousemove",this.mousemove),s.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=e=>{this.move(e,s.mousePos(this.element,e))},this.mouseup=e=>{this._rotatePitchHanlder.dragEnd(e),this.offTemp()},this.touchstart=e=>{1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=s.touchPos(this.element,e.targetTouches)[0],this.startMove(e,this._startPos),s.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.addEventListener(window,"touchend",this.touchend))},this.touchmove=e=>{1!==e.targetTouches.length?this.reset():(this._lastPos=s.touchPos(this.element,e.targetTouches)[0],this.move(e,this._lastPos))},this.touchend=e=>{0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const i=new Yi;this._rotatePitchHanlder=new Gi({clickTolerance:3,move:(e,i)=>{const a=r.getBoundingClientRect(),o=new t.P((a.bottom-a.top)/2,(a.right-a.left)/2);return{bearingDelta:t.ce(new t.P(e.x,i.y),i,o),pitchDelta:n?-.5*(i.y-e.y):void 0}},moveStateManager:i,enable:!0,assignEvents:()=>{}}),this.map=e,s.addEventListener(r,"mousedown",this.mousedown),s.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),s.addEventListener(r,"touchcancel",this.reset)}startMove(e,t){this._rotatePitchHanlder.dragStart(e,t),s.disableDrag()}move(e,t){const r=this.map,{bearingDelta:n,pitchDelta:i}=this._rotatePitchHanlder.dragMove(e,t)||{};n&&r.setBearing(r.getBearing()+n),i&&r.setPitch(r.getPitch()+i)}off(){const e=this.element;s.removeEventListener(e,"mousedown",this.mousedown),s.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),s.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.removeEventListener(window,"touchend",this.touchend),s.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){s.enableDrag(),s.removeEventListener(window,"mousemove",this.mousemove),s.removeEventListener(window,"mouseup",this.mouseup),s.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),s.removeEventListener(window,"touchend",this.touchend)}}let La;function qa(e,r,n,i=!1){if(i||!n.getCoveringTilesDetailsProvider().allowWorldCopies())return null==e?void 0:e.wrap();const a=new t.Q(e.lng,e.lat);if(e=new t.Q(e.lng,e.lat),r){const i=new t.Q(e.lng-360,e.lat),a=new t.Q(e.lng+360,e.lat),o=n.locationToScreenPoint(e).distSqr(r);n.locationToScreenPoint(i).distSqr(r)<o?e=i:n.locationToScreenPoint(a).distSqr(r)<o&&(e=a)}for(;Math.abs(e.lng-n.center.lng)>180;){const t=n.locationToScreenPoint(e);if(t.x>=0&&t.y>=0&&t.x<=n.width&&t.y<=n.height)break;e.lng>n.center.lng?e.lng-=360:e.lng+=360}return e.lng!==a.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(e))?e:a}const ja={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ua(e,t,r){const n=e.classList;for(const e in ja)n.remove(`maplibregl-${r}-anchor-${e}`);n.add(`maplibregl-${r}-anchor-${t}`)}class Va extends t.E{constructor(e){if(super(),this._onKeyPress=e=>{const t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()},this._onMapClick=e=>{const t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()},this._update=e=>{if(!this._map)return;const t=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==e?void 0:e.type)||"render"===(null==e?void 0:e.type)&&!t)&&this._map.once("render",this._update),this._lngLat=qa(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let r="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(r=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||e&&"moveend"!==e.type||(this._pos=this._pos.round()),s.setTransform(this._element,`${ja[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${r}`),o.frameAsync(new AbortController).then((()=>{this._updateOpacity(e&&"moveend"===e.type)})).catch((()=>{}))},this._onMove=e=>{if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.l("dragstart"))),this.fire(new t.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.l("dragend")),this._state="inactive"},this._addDragHandler=e=>{this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,this.setOpacity(null==e?void 0:e.opacity,null==e?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=s.create("div");const r=s.createNS("http://www.w3.org/2000/svg","svg"),n=41,i=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${n}px`),r.setAttributeNS(null,"width",`${i}px`),r.setAttributeNS(null,"viewBox",`0 0 ${i} ${n}`);const a=s.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const o=s.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");const l=s.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const e of u){const t=s.createNS("http://www.w3.org/2000/svg","ellipse");t.setAttributeNS(null,"opacity","0.04"),t.setAttributeNS(null,"cx","10.5"),t.setAttributeNS(null,"cy","5.80029008"),t.setAttributeNS(null,"rx",e.rx),t.setAttributeNS(null,"ry",e.ry),l.appendChild(t)}const c=s.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const h=s.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(h);const p=s.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");const d=s.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(d);const f=s.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=s.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=s.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const y=s.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),o.appendChild(l),o.appendChild(c),o.appendChild(p),o.appendChild(f),o.appendChild(m),r.appendChild(o),r.setAttributeNS(null,"height",n*this._scale+"px"),r.setAttributeNS(null,"width",i*this._scale+"px"),this._element.appendChild(r),this._offset=t.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()})),Ua(this._element,this._anchor,"marker"),e&&e.className)for(const t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),s.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,r=13.5,n=Math.abs(r)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[n,-1*(t-r+n)],"bottom-right":[-n,-1*(t-r+n)],left:[r,-1*(t-r)],right:[-13.5,-1*(t-r)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,n;const i=null===(r=this._map)||void 0===r?void 0:r.terrain,a=this._map.transform.isLocationOccluded(this._lngLat);if(!i||a){const e=a?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==e&&(this._element.style.opacity=e))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const o=this._map,s=o.terrain.depthAtPoint(this._pos),l=o.terrain.getElevationForLngLatZoom(this._lngLat,o.transform.tileZoom);if(o.transform.lngLatToCameraDepth(this._lngLat,l)-s<.006)return void(this._element.style.opacity=this._opacity);const u=-this._offset.y/o.transform.pixelsPerMeter,c=Math.sin(o.getPitch()*Math.PI/180)*u,h=o.terrain.depthAtPoint(new t.P(this._pos.x,this._pos.y-this._offset.y)),p=o.transform.lngLatToCameraDepth(this._lngLat,l+c)-h>.006;(null===(n=this._popup)||void 0===n?void 0:n.isOpen())&&p&&this._popup.remove(),this._element.style.opacity=p?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return(void 0===this._opacity||void 0===e&&void 0===t)&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==e&&(this._opacity=e),void 0!==t&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}}const Za={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let $a=0,Ga=!1;const Ha={maxWidth:100,unit:"metric"};function Wa(e,t,r){const n=r&&r.maxWidth||100,i=e._container.clientHeight/2,a=e._container.clientWidth/2,o=e.unproject([a-n/2,i]),s=e.unproject([a+n/2,i]),l=Math.round(e.project(s).x-e.project(o).x),u=Math.min(n,l,e._container.clientWidth),c=o.distanceTo(s);if(r&&"imperial"===r.unit){const r=3.2808*c;r>5280?Xa(t,u,r/5280,e._getUIString("ScaleControl.Miles")):Xa(t,u,r,e._getUIString("ScaleControl.Feet"))}else r&&"nautical"===r.unit?Xa(t,u,c/1852,e._getUIString("ScaleControl.NauticalMiles")):c>=1e3?Xa(t,u,c/1e3,e._getUIString("ScaleControl.Kilometers")):Xa(t,u,c,e._getUIString("ScaleControl.Meters"))}function Xa(e,t,r,n){const i=function(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let r=e/t;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r),t*r}(r);e.style.width=t*(i/r)+"px",e.innerHTML=`${i}&nbsp;${n}`}const Ya={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Ka=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ja(e){if(e){if("number"==typeof e){const r=Math.round(Math.abs(e)/Math.SQRT2);return{center:new t.P(0,0),top:new t.P(0,e),"top-left":new t.P(r,r),"top-right":new t.P(-r,r),bottom:new t.P(0,-e),"bottom-left":new t.P(r,-r),"bottom-right":new t.P(-r,-r),left:new t.P(e,0),right:new t.P(-e,0)}}if(e instanceof t.P||Array.isArray(e)){const r=t.P.convert(e);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:t.P.convert(e.center||[0,0]),top:t.P.convert(e.top||[0,0]),"top-left":t.P.convert(e["top-left"]||[0,0]),"top-right":t.P.convert(e["top-right"]||[0,0]),bottom:t.P.convert(e.bottom||[0,0]),"bottom-left":t.P.convert(e["bottom-left"]||[0,0]),"bottom-right":t.P.convert(e["bottom-right"]||[0,0]),left:t.P.convert(e.left||[0,0]),right:t.P.convert(e.right||[0,0])}}return Ja(new t.P(0,0))}const Qa=r;e.AJAXError=t.cq,e.Event=t.l,e.Evented=t.E,e.LngLat=t.Q,e.MercatorCoordinate=t.$,e.Point=t.P,e.addProtocol=t.cr,e.config=t.a,e.removeProtocol=t.cs,e.AttributionControl=Ea,e.BoxZoomHandler=ji,e.CanvasSource=J,e.CooperativeGesturesHandler=va,e.DoubleClickZoomHandler=pa,e.DragPanHandler=ma,e.DragRotateHandler=ga,e.EdgeInsets=St,e.FullscreenControl=class extends t.E{constructor(e={}){super(),this._onFullscreenChange=()=>{var e;let t=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(e=null==t?void 0:t.shadowRoot)||void 0===e?void 0:e.fullscreenElement;)t=t.shadowRoot.fullscreenElement;t===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){s.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const e=this._fullscreenButton=s.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);s.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new t.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new t.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},e.GeoJSONSource=X,e.GeolocateControl=class extends t.E{constructor(e){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new t.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new t.Q(e.coords.longitude,e.coords.latitude),n=e.coords.accuracy,i=this._map.getBearing(),a=t.e({bearing:i},this.options.fitBoundsOptions),o=Z.fromLngLat(r,n);this._map.fitBounds(o,a,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new t.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Ga)return;this.options.trackUserLocation&&this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new t.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=s.create("button","maplibregl-ctrl-geolocate",this._container),s.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Va({element:this._dotElement}),this._circleElement=s.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Va({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new t.l("trackuserlocationend")),this.fire(new t.l("userlocationlostfocus")))}))}},this.options=t.e({},Za,e)}onAdd(e){return this._map=e,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return t._(this,arguments,void 0,(function*(e=!1){if(void 0!==La&&!e)return La;if(void 0===window.navigator.permissions)return La=!!window.navigator.geolocation,La;try{const e=yield window.navigator.permissions.query({name:"geolocation"});La="denied"!==e.state}catch(e){La=!!window.navigator.geolocation}return La}))}().then((e=>this._finishSetupUI(e))),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),s.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,$a=0,Ga=!1}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const e=this._map.getBounds(),t=e.getSouthEast(),r=e.getNorthEast(),n=t.distanceTo(r),i=Math.ceil(this._accuracy/(n/this._map._container.clientHeight)*2);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$a--,Ga=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new t.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.l("trackuserlocationstart")),this.fire(new t.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$a++,$a>1?(e={maximumAge:6e5,timeout:0},Ga=!0):(e=this.options.positionOptions,Ga=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},e.GlobeControl=class{constructor(){this._toggleProjection=()=>{var e;const t=null===(e=this._map.getProjection())||void 0===e?void 0:e.type;this._map.setProjection("mercator"!==t&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var e;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),"globe"===(null===(e=this._map.getProjection())||void 0===e?void 0:e.type)?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(e){return this._map=e,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=s.create("button","maplibregl-ctrl-globe",this._container),s.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){s.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},e.Hash=Ei,e.ImageSource=Y,e.KeyboardHandler=la,e.LngLatBounds=Z,e.LogoControl=Ma,e.Map=class extends Aa{constructor(e){var r,n;t.cn.mark(t.co.create);const i=Object.assign(Object.assign(Object.assign({},Fa),e),{canvasContextAttributes:Object.assign(Object.assign({},Fa.canvasContextAttributes),e.canvasContextAttributes)});if(null!=i.minZoom&&null!=i.maxZoom&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=i.minPitch&&null!=i.maxPitch&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=i.minPitch&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=i.maxPitch&&i.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const a=new Bt,o=new Ot;if(void 0!==i.minZoom&&a.setMinZoom(i.minZoom),void 0!==i.maxZoom&&a.setMaxZoom(i.maxZoom),void 0!==i.minPitch&&a.setMinPitch(i.minPitch),void 0!==i.maxPitch&&a.setMaxPitch(i.maxPitch),void 0!==i.renderWorldCopies&&a.setRenderWorldCopies(i.renderWorldCopies),super(a,o,{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Sa,this._controls=[],this._mapId=t.a4(),this._contextLost=e=>{e.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new t.l("webglcontextlost",{originalEvent:e}))},this._contextRestored=e=>{this._setupPainter(),this.resize(),this._update(),this.fire(new t.l("webglcontextrestored",{originalEvent:e}))},this._onMapScroll=e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},i.canvasContextAttributes),this._trackResize=!0===i.trackResize,this._bearingSnap=i.bearingSnap,this._centerClampedToGround=i.centerClampedToGround,this._refreshExpiredTiles=!0===i.refreshExpiredTiles,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=!0===i.crossSourceCollisions,this._collectResourceTiming=!0===i.collectResourceTiming,this._locale=Object.assign(Object.assign({},Ba),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===i.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=f.addThrottleControl((()=>this.isMoving())),this._requestManager=new m(i.transformRequest),"string"==typeof i.container){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let e=!1;const t=Ci((e=>{this._trackResize&&!this._removed&&(this.resize(e),this.redraw())}),50);this._resizeObserver=new ResizeObserver((r=>{e?t(r):e=!0})),this._resizeObserver.observe(this._container)}this.handlers=new wa(this,i),this._hash=i.hash&&new Ei("string"==typeof i.hash&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,elevation:i.elevation,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,roll:i.roll}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,t.e({},i.fitBoundsOptions,{duration:0}))));const s="string"==typeof i.style||!("globe"===(null===(n=null===(r=i.style)||void 0===r?void 0:r.projection)||void 0===n?void 0:n.type));this.resize(null,s),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new Ea("boolean"==typeof i.attributionControl?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new Ma,i.logoPosition),this.on("style.load",(()=>{if(s||this._resizeTransform(),this.transform.unmodified){const e=t.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(e)}})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.l(`${e.dataType}data`,e))})),this.on("dataloading",(e=>{this.fire(new t.l(`${e.dataType}dataloading`,e))})),this.on("dataabort",(e=>{this.fire(new t.l("sourcedataabort",e))}))}_getMapId(){return this._mapId}addControl(e,r){if(void 0===r&&(r=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=e.onAdd(this);this._controls.push(e);const i=this._controlPositions[r];return-1!==r.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(e);return r>-1&&this._controls.splice(r,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,r,n){return null==n&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,r,n)}resize(e,r=!0){const[n,i]=this._containerDimensions(),a=this._getClampedPixelRatio(n,i);if(this._resizeCanvas(n,i,a),this.painter.resize(n,i,a),this.painter.overLimit()){const e=this.painter.context.gl;this._maxCanvasSize=[e.drawingBufferWidth,e.drawingBufferHeight];const t=this._getClampedPixelRatio(n,i);this._resizeCanvas(n,i,t),this.painter.resize(n,i,t)}this._resizeTransform(r);const o=!this._moving;return o&&(this.stop(),this.fire(new t.l("movestart",e)).fire(new t.l("move",e))),this.fire(new t.l("resize",e)),o&&this.fire(new t.l("moveend",e)),this}_resizeTransform(e=!0){var t;const[r,n]=this._containerDimensions();this.transform.resize(r,n,e),null===(t=this._requestedCameraState)||void 0===t||t.resize(r,n,e)}_getClampedPixelRatio(e,t){const{0:r,1:n}=this._maxCanvasSize,i=this.getPixelRatio(),a=e*i,o=t*i;return Math.min(a>r?r/a:1,o>n?n/o:1)*i}getPixelRatio(){var e;return null!==(e=this._overridePixelRatio)&&void 0!==e?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(Z.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.setMinZoom(e),this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.setMaxZoom(e),this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.setMinPitch(e),this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?60:e)>180)throw new Error("maxPitch must be less than or equal to 180");if(e>=this.transform.minPitch)return this.transform.setMaxPitch(e),this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.setRenderWorldCopies(e),this._update()}project(e){return this.transform.locationToScreenPoint(t.Q.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.screenPointToLocation(t.P.convert(e),this.terrain)}isMoving(){var e;return this._moving||(null===(e=this.handlers)||void 0===e?void 0:e.isMoving())}isZooming(){var e;return this._zooming||(null===(e=this.handlers)||void 0===e?void 0:e.isZooming())}isRotating(){var e;return this._rotating||(null===(e=this.handlers)||void 0===e?void 0:e.isRotating())}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let n=!1;const i=i=>{const a=t.filter((e=>this.getLayer(e))),o=0!==a.length?this.queryRenderedFeatures(i.point,{layers:a}):[];o.length?n||(n=!0,r.call(this,new ki(e,this,i.originalEvent,{features:o}))):n=!1};return{layers:t,listener:r,delegates:{mousemove:i,mouseout:()=>{n=!1}}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const i=i=>{const a=t.filter((e=>this.getLayer(e)));(0!==a.length?this.queryRenderedFeatures(i.point,{layers:a}):[]).length?n=!0:n&&(n=!1,r.call(this,new ki(e,this,i.originalEvent)))},a=t=>{n&&(n=!1,r.call(this,new ki(e,this,t.originalEvent)))};return{layers:t,listener:r,delegates:{mousemove:i,mouseout:a}}}{const n=e=>{const n=t.filter((e=>this.getLayer(e))),i=0!==n.length?this.queryRenderedFeatures(e.point,{layers:n}):[];i.length&&(e.features=i,r.call(this,e),delete e.features)};return{layers:t,listener:r,delegates:{[e]:n}}}}_saveDelegatedListener(e,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(t)}_removeDelegatedListener(e,t,r){if(!this._delegatedListeners||!this._delegatedListeners[e])return;const n=this._delegatedListeners[e];for(let e=0;e<n.length;e++){const i=n[e];if(i.listener===r&&i.layers.length===t.length&&i.layers.every((e=>t.includes(e)))){for(const e in i.delegates)this.off(e,i.delegates[e]);return void n.splice(e,1)}}}on(e,t,r){if(void 0===r)return super.on(e,t);const n="string"==typeof t?[t]:t,i=this._createDelegatedListener(e,n,r);this._saveDelegatedListener(e,i);for(const e in i.delegates)this.on(e,i.delegates[e]);return{unsubscribe:()=>{this._removeDelegatedListener(e,n,r)}}}once(e,t,r){if(void 0===r)return super.once(e,t);const n="string"==typeof t?[t]:t,i=this._createDelegatedListener(e,n,r);for(const t in i.delegates){const a=i.delegates[t];i.delegates[t]=(...t)=>{this._removeDelegatedListener(e,n,r),a(...t)}}this._saveDelegatedListener(e,i);for(const e in i.delegates)this.once(e,i.delegates[e]);return this}off(e,t,r){return void 0===r?super.off(e,t):(this._removeDelegatedListener(e,"string"==typeof t?[t]:t,r),this)}queryRenderedFeatures(e,r){if(!this.style)return[];let n;const i=e instanceof t.P||Array.isArray(e),a=i?e:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(i?{}:e)||{},a instanceof t.P||"number"==typeof a[0])n=[t.P.convert(a)];else{const e=t.P.convert(a[0]),r=t.P.convert(a[1]);n=[e,new t.P(r.x,e.y),r,new t.P(e.x,r.y),e]}return this.style.queryRenderedFeatures(n,r,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,r){return!1!==(r=t.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(e,r))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){var r,n;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(e,t)));const i=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e?(this.style=new _r(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e,t,i):this.style.loadJSON(e,t,i),this):(null===(n=null===(r=this.style)||void 0===r?void 0:r.projection)||void 0===n||n.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new _r(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,r){if("string"==typeof e){const n=this._requestManager.transformRequest(e,"Style");t.j(n,new AbortController).then((e=>{this._updateDiff(e.data,r)})).catch((e=>{e&&this.fire(new t.k(e))}))}else"object"==typeof e&&this._updateDiff(e,r)}_updateDiff(e,r){try{this.style.setState(e,r)&&this._update(!0)}catch(n){t.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(e,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.w("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){const r=this.style&&this.style.sourceCaches[e];if(void 0!==r)return r.loaded();this.fire(new t.k(new Error(`There is no source with ID '${e}'`)))}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),e){const r=this.style.sourceCaches[e.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);null===this.terrain&&r.reload();for(const r in this.style._layers){const n=this.style._layers[r];"hillshade"===n.type&&n.source===e.source&&t.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Na(this.painter,r,e),this.painter.renderToTexture=new za(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=t=>{var r;"style"===t.dataType?this.terrain.sourceCache.freeRtt():"source"===t.dataType&&t.tile&&(t.sourceId!==e.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),"image"===(null===(r=t.source)||void 0===r?void 0:r.type)?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(t.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new t.l("terrain",{terrain:e})),this}getTerrain(){var e,t;return null!==(t=null===(e=this.terrain)||void 0===e?void 0:e.options)&&void 0!==t?t:null}areTilesLoaded(){const e=this.style&&this.style.sourceCaches;for(const t in e){const r=e[t]._tiles;for(const e in r){const t=r[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}setSourceTileLodParams(e,t,r){if(r){const n=this.getSource(r);if(!n)throw new Error(`There is no source with ID "${r}", cannot set LOD parameters`);n.calculateTileZoom=ge(Math.max(1,e),Math.max(1,t))}else for(const r in this.style.sourceCaches)this.style.sourceCaches[r].getSource().calculateTileZoom=ge(Math.max(1,e),Math.max(1,t));return this._update(!0),this}refreshTiles(e,r){const n=this.style.sourceCaches[e];if(!n)throw new Error(`There is no source cache with ID "${e}", cannot refresh tile`);void 0===r?n.reload():n.refreshTiles(r.map((e=>new t.a1(e.z,e.x,e.y))))}addImage(e,r,n={}){const{pixelRatio:i=1,sdf:a=!1,stretchX:s,stretchY:l,content:u,textFitWidth:c,textFitHeight:h}=n;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||t.b(r))){if(void 0===r.width||void 0===r.height)return this.fire(new t.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:n,height:o,data:p}=r,d=r;return this.style.addImage(e,{data:new t.R({width:n,height:o},new Uint8Array(p)),pixelRatio:i,stretchX:s,stretchY:l,content:u,textFitWidth:c,textFitHeight:h,sdf:a,version:0,userImage:d}),d.onAdd&&d.onAdd(this,e),this}}{const{width:n,height:p,data:d}=o.getImageData(r);this.style.addImage(e,{data:new t.R({width:n,height:p},d),pixelRatio:i,stretchX:s,stretchY:l,content:u,textFitWidth:c,textFitHeight:h,sdf:a,version:0})}}updateImage(e,r){const n=this.style.getImage(e);if(!n)return this.fire(new t.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=r instanceof HTMLImageElement||t.b(r)?o.getImageData(r):r,{width:a,height:s,data:l}=i;if(void 0===a||void 0===s)return this.fire(new t.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==n.data.width||s!==n.data.height)return this.fire(new t.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const u=!(r instanceof HTMLImageElement||t.b(r));return n.data.replace(l,u),this.style.updateImage(e,n),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.k(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return f.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t,r={}){return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r,n={}){return this.style.setPaintProperty(e,t,r,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r,n={}){return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,r,(e=>{e||this._update(!0)})),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,(e=>{e||this._update(!0)})),this}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(e,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){const e=this._container;e.classList.add("maplibregl-map");const t=this._canvasContainer=s.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=s.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),n=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],n);const i=this._controlContainer=s.create("div","maplibregl-control-container",e),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((e=>{a[e]=s.create("div",`maplibregl-ctrl-${e} `,i)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t,r){this._canvas.width=Math.floor(r*e),this._canvas.height=Math.floor(r*t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const e=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(r=>{t={requestedAttributes:e},r&&(t.statusMessage=r.statusMessage,t.type=r.type)}),{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,e):this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e),!r){const e="Failed to initialize WebGL";throw t?(t.message=e,new Error(JSON.stringify(t))):new Error(e)}this.painter=new Ai(r,this.transform),l.testSupport(r)}migrateProjection(e,r){super.migrateProjection(e,r),this.painter.transform=e,this.fire(new t.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){var r,n,i,a,s;const l=this._idleTriggered?this._fadeDuration:0,u=(null===(r=this.style.projection)||void 0===r?void 0:r.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let c=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,r=o.now();this.style.zoomHistory.update(e,r);const n=new t.C(e,{now:r,fadeDuration:l,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),i=n.crossFadingFactor();1===i&&i===this._crossFadingFactor||(c=!0,this._crossFadingFactor=i),this.style.update(n)}const h=(null===(n=this.style.projection)||void 0===n?void 0:n.transitionState)>0!==u;null===(i=this.style.projection)||void 0===i||i.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState(null===(a=this.style.projection)||void 0===a?void 0:a.transitionState,null===(s=this.style.projection)||void 0===s?void 0:s.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||h)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,l,this._crossSourceCollisions,h),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,showPadding:this.showPadding}),this.fire(new t.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.cn.mark(t.co.load),this.fire(new t.l("load"))),this.style&&(this.style.hasTransitions()||c)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.l("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,t.cn.mark(t.co.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),f.removeThrottleControl(this._imageQueueHandle),null===(e=this._resizeObserver)||void 0===e||e.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==r?void 0:r.loseContext)&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),s.remove(this._canvasContainer),s.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),t.cn.clearMetrics(),this._removed=!0,this.fire(new t.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,o.frame(this._frameRequest,(e=>{t.cn.frame(e),this._frameRequest=null;try{this._render(e)}catch(e){if(!t.cp(e)&&!function(e){return e.message===Vn}(e))throw e}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return ka}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(e){return this._lazyInitEmptyStyle(),this.style.setProjection(e),this._update(!0)}},e.MapMouseEvent=ki,e.MapTouchEvent=Fi,e.MapWheelEvent=Ri,e.Marker=Va,e.NavigationControl=class{constructor(e){this._updateZoomButtons=()=>{const e=this._map.getZoom(),t=e===this._map.getMaxZoom(),r=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,t)=>{const r=this._map._getUIString(`NavigationControl.${t}`);e.title=r,e.setAttribute("aria-label",r)},this.options=t.e({},Ra,e),this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),s.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),s.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=s.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Oa(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){s.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){const r=s.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}},e.Popup=class extends t.E{constructor(e){super(),this._updateOpacity=()=>{void 0!==this.options.locationOccludedOpacity&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new t.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=s.create("div","maplibregl-popup",this._map.getContainer()),this._tip=s.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const e of this.options.className.split(" "))this._container.classList.add(e);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=qa(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const t=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let r=this.options.anchor;const n=Ja(this.options.offset);if(!r){const e=this._container.offsetWidth,i=this._container.offsetHeight;let a;a=t.y+n.bottom.y<i?["top"]:t.y>this._map.transform.height-i?["bottom"]:[],t.x<e/2?a.push("left"):t.x>this._map.transform.width-e/2&&a.push("right"),r=0===a.length?"bottom":a.join("-")}let i=t.add(n[r]);this.options.subpixelPositioning||(i=i.round()),s.setTransform(this._container,`${ja[r]} translate(${i.x}px,${i.y}px)`),Ua(this._container,r,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=t.e(Object.create(Ya),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new t.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.Q.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),r=document.createElement("body");let n;for(r.innerHTML=e;n=r.firstChild,n;)t.appendChild(n);return this.setDOMContent(t)}getMaxWidth(){var e;return null===(e=this._container)||void 0===e?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=s.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){return this._container&&this._container.classList.add(e),this}removeClassName(e){return this._container&&this._container.classList.remove(e),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=s.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(Ka);e&&e.focus()}},e.RasterDEMTileSource=W,e.RasterTileSource=H,e.ScaleControl=class{constructor(e){this._onMove=()=>{Wa(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Wa(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ha),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){s.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=ha,e.Style=_r,e.TerrainControl=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=s.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=s.create("button","maplibregl-ctrl-terrain",this._container),s.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){s.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=oa,e.TwoFingersTouchRotateHandler=ia,e.TwoFingersTouchZoomHandler=ra,e.TwoFingersTouchZoomRotateHandler=ya,e.VectorTileSource=G,e.VideoSource=K,e.addSourceType=(e,r)=>t._(void 0,void 0,void 0,(function*(){if(ee(e))throw new Error(`A source type called "${e}" already exists.`);((e,t)=>{Q[e]=t})(e,r)})),e.clearPrewarmedResources=function(){const e=B;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(I),B=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.createTileMesh=Xt,e.getMaxParallelImageRequests=function(){return t.a.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return ie().getRTLTextPluginStatus()},e.getVersion=function(){return Qa},e.getWorkerCount=function(){return P.workerCount},e.getWorkerUrl=function(){return t.a.WORKER_URL},e.importScriptInWorkers=function(e){return O().broadcast("IS",e)},e.prewarm=function(){F().acquire(I)},e.setMaxParallelImageRequests=function(e){t.a.MAX_PARALLEL_IMAGE_REQUESTS=e},e.setRTLTextPlugin=function(e,t){return ie().setRTLTextPlugin(e,t)},e.setWorkerCount=function(e){P.workerCount=e},e.setWorkerUrl=function(e){t.a.WORKER_URL=e}})),e}()},6539:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},6694:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27%2333b5e5%27 viewBox=%270 0 22 22%27%3E%3Cpath d=%27m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0%27/%3E%3C/svg%3E"},6833:function(e,t,r){var n;!function(e,i){function a(e){var t=this;t.next=function(){var e,r,n=t.w,i=t.X,a=t.i;return t.w=n=n+1640531527|0,r=i[a+34&127],e=i[a=a+1&127],r^=r<<13,e^=e<<17,r^=r>>>15,e^=e>>>12,r=i[a]=r^e,t.i=a,r+(n^n>>>16)|0},function(e,t){var r,n,i,a,o,s=[],l=128;for(t===(0|t)?(n=t,t=null):(t+="\0",n=0,l=Math.max(l,t.length)),i=0,a=-32;a<l;++a)t&&(n^=t.charCodeAt((a+32)%t.length)),0===a&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,a>=0&&(o=o+1640531527|0,i=0==(r=s[127&a]^=n+o)?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,a=512;a>0;--a)n=s[i+34&127],r=s[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,s[i]=n^r;e.w=o,e.X=s,e.i=i}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var r=new a(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&(n.X&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.xor4096=s}(0,e=r.nmd(e),r.amdD)},6945:(e,t,r)=>{"use strict";r.d(t,{A:()=>ve});var n=r(1354),i=r.n(n),a=r(6314),o=r.n(a),s=r(4417),l=r.n(s),u=new URL(r(7035),r.b),c=new URL(r(3470),r.b),h=new URL(r(8164),r.b),p=new URL(r(4665),r.b),d=new URL(r(4890),r.b),f=new URL(r(3363),r.b),m=new URL(r(3490),r.b),g=new URL(r(7603),r.b),y=new URL(r(3913),r.b),v=new URL(r(1413),r.b),x=new URL(r(4643),r.b),_=new URL(r(216),r.b),b=new URL(r(1907),r.b),w=new URL(r(8605),r.b),A=new URL(r(9387),r.b),C=new URL(r(2353),r.b),E=new URL(r(5446),r.b),M=new URL(r(6694),r.b),S=new URL(r(4420),r.b),D=new URL(r(5796),r.b),T=new URL(r(2228),r.b),N=new URL(r(9819),r.b),I=new URL(r(7695),r.b),P=new URL(r(8869),r.b),z=new URL(r(557),r.b),B=new URL(r(8460),r.b),k=new URL(r(6539),r.b),F=new URL(r(3737),r.b),R=new URL(r(7914),r.b),O=new URL(r(6117),r.b),L=new URL(r(6311),r.b),q=o()(i()),j=l()(u),U=l()(c),V=l()(h),Z=l()(p),$=l()(d),G=l()(f),H=l()(m),W=l()(g),X=l()(y),Y=l()(v),K=l()(x),J=l()(_),Q=l()(b),ee=l()(w),te=l()(A),re=l()(C),ne=l()(E),ie=l()(M),ae=l()(S),oe=l()(D),se=l()(T),le=l()(N),ue=l()(I),ce=l()(P),he=l()(z),pe=l()(B),de=l()(k),fe=l()(F),me=l()(R),ge=l()(O),ye=l()(L);q.push([e.id,`.maplibregl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (forced-colors:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (forced-colors:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}@media (hover:hover){.maplibregl-ctrl button:not(:disabled):hover{background-color:rgb(0 0 0/5%)}}.maplibregl-ctrl button:not(:disabled):active{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${j})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${U})}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${V})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${Z})}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${$})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${G})}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${H})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${W})}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${X})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${Y})}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${K})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${W})}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${J})}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${Q})}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${ee})}}.maplibregl-ctrl button.maplibregl-ctrl-globe .maplibregl-ctrl-icon{background-image:url(${te})}.maplibregl-ctrl button.maplibregl-ctrl-globe-enabled .maplibregl-ctrl-icon{background-image:url(${re})}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(${ne})}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(${ie})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${ae})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${oe})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(${se})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(${le})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(${ue})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(${ce})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${he})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${pe})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(${se})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(${le})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(${ue})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(${ce})}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${de})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${fe})}}@keyframes maplibregl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(${me});background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (forced-colors:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url(${me})}}@media (forced-colors:active) and (prefers-color-scheme:light){a.maplibregl-ctrl-logo{background-image:url(${me})}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;color:#000;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url(${ge});border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (forced-colors:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(${ye})}}@media screen and (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(${ge})}}.maplibregl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:rgb(0 0 0/5%)}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;transition:opacity .2s;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:"";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0,0,0,.4);color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(pointer:coarse){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}`,"",{version:3,sources:["webpack://./../node_modules/maplibre-gl/dist/maplibre-gl.css"],names:[],mappings:"AAAA,gBAAgB,wDAAwD,CAAC,eAAe,CAAC,iBAAiB,CAAC,wCAAwC,CAAC,mBAAmB,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,2BAA2B,WAAW,CAAC,UAAU,CAAC,sDAAsD,iBAAiB,CAAC,0GAA0G,WAAW,CAAC,wBAAwB,CAAC,qBAAqB,CAAC,gBAAgB,CAAC,6EAA6E,cAAc,CAAC,wHAAwH,eAAe,CAAC,uIAAuI,wBAAwB,CAAC,iIAAiI,uBAAuB,CAAC,2LAA2L,iBAAiB,CAAC,iMAAiM,wBAAwB,CAAC,gHAAgH,mBAAmB,CAAC,iBAAiB,CAAC,SAAS,CAAC,0BAA0B,MAAM,CAAC,KAAK,CAAC,2BAA2B,OAAO,CAAC,KAAK,CAAC,6BAA6B,QAAQ,CAAC,MAAM,CAAC,8BAA8B,QAAQ,CAAC,OAAO,CAAC,iBAAiB,UAAU,CAAC,mBAAmB,CAAC,sBAAsB,CAAC,2CAA2C,UAAU,CAAC,oBAAoB,CAAC,4CAA4C,WAAW,CAAC,oBAAoB,CAAC,8CAA8C,UAAU,CAAC,oBAAoB,CAAC,+CAA+C,WAAW,CAAC,oBAAoB,CAAC,uBAAuB,eAAe,CAAC,iBAAiB,CAAC,mCAAmC,mCAAmC,CAAC,8BAA8B,mCAAmC,+BAA+B,CAAC,CAAC,8BAA8B,4BAA4B,CAAC,QAAQ,CAAC,qBAAqB,CAAC,cAAc,CAAC,aAAa,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,qCAAqC,yBAAyB,CAAC,8CAA8C,uBAAuB,CAAC,2BAA2B,CAAC,aAAa,CAAC,WAAW,CAAC,UAAU,CAAC,8BAA8B,sBAAsB,4BAA4B,CAAC,qCAAqC,+BAA+B,CAAC,CAAC,0CAA0C,QAAQ,CAAC,SAAS,CAAC,yEAAyE,8BAA8B,CAAC,iCAAiC,kBAAkB,CAAC,uDAAuD,WAAW,CAAC,qBAAqB,6CAA6C,8BAA8B,CAAC,CAAC,8CAA8C,8BAA8B,CAAC,kDAAkD,8BAA8B,CAAC,wDAAwD,eAAe,CAAC,gDAAgD,yBAAyB,CAAC,+CAA+C,yBAAyB,CAAC,+CAA+C,qBAAqB,CAAC,uEAAuE,wDAA0Q,CAAC,sEAAsE,wDAA8W,CAAC,8BAA8B,uEAAuE,wDAA0Q,CAAC,sEAAsE,wDAA8W,CAAC,CAAC,+DAA+D,uEAAuE,wDAA4P,CAAC,sEAAsE,wDAAgW,CAAC,CAAC,yEAAyE,wDAA8b,CAAC,qEAAqE,wDAAgb,CAAC,8BAA8B,yEAAyE,wDAA8b,CAAC,qEAAqE,wDAA8b,CAAC,CAAC,+DAA+D,yEAAyE,yDAAgb,CAAC,qEAAqE,wDAAgb,CAAC,CAAC,sEAAsE,yDAAwP,CAAC,8BAA8B,sEAAsE,yDAAwP,CAAC,CAAC,+DAA+D,sEAAsE,yDAA0O,CAAC,CAAC,oEAAoE,yDAA4xD,CAAC,4EAA4E,yDAA+xD,CAAC,sEAAsE,yDAAuX,CAAC,8EAA8E,yDAA0X,CAAC,wEAAwE,yDAA2a,CAAC,iFAAiF,yDAAwd,CAAC,yGAAyG,yDAA8a,CAAC,+GAA+G,yDAA8a,CAAC,6GAA6G,yDAA2Y,CAAC,mHAAmH,yDAA2Y,CAAC,0GAA0G,4CAA4C,CAAC,8BAA8B,wEAAwE,yDAA2a,CAAC,iFAAiF,yDAAwd,CAAC,yGAAyG,yDAA8a,CAAC,+GAA+G,yDAA8a,CAAC,6GAA6G,yDAA2Y,CAAC,mHAAmH,yDAA2Y,CAAC,CAAC,+DAA+D,wEAAwE,yDAA6Z,CAAC,iFAAiF,yDAAwd,CAAC,CAAC,2BAA2B,GAAG,sBAAsB,CAAC,GAAG,uBAAuB,CAAC,CAAC,uBAAuB,yDAAkiZ,CAAC,2BAA2B,CAAC,cAAc,CAAC,aAAa,CAAC,WAAW,CAAC,oBAAoB,CAAC,eAAe,CAAC,UAAU,CAAC,0CAA0C,UAAU,CAAC,8BAA8B,uBAAuB,4BAA4B,CAAC,yDAAkiZ,CAAC,CAAC,+DAA+D,uBAAuB,yDAAkiZ,CAAC,CAAC,wCAAwC,mCAAmC,CAAC,QAAQ,CAAC,aAAa,CAAC,cAAc,2CAA2C,qBAAqB,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,UAAU,CAAC,WAAW,CAAC,eAAe,CAAC,sBAAsB,CAAC,iBAAiB,CAAC,gDAAgD,wBAAwB,CAAC,kBAAkB,CAAC,uJAAuJ,kBAAkB,CAAC,wBAAwB,CAAC,yEAAyE,YAAY,CAAC,+BAA+B,mCAAmC,CAAC,yDAAmS,CAAC,QAAQ,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,cAAc,CAAC,YAAY,CAAC,WAAW,CAAC,YAAY,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,8DAA8D,uBAAuB,CAAC,oBAAoB,CAAC,eAAe,CAAC,eAAe,CAAC,sFAAsF,YAAY,CAAC,qHAAqH,MAAM,CAAC,wJAAwJ,aAAa,CAAC,+EAA+E,8BAA8B,CAAC,+EAA+E,QAAQ,CAAC,OAAO,CAAC,4EAA4E,OAAO,CAAC,KAAK,CAAC,2EAA2E,MAAM,CAAC,KAAK,CAAC,8EAA8E,QAAQ,CAAC,MAAM,CAAC,CAAC,yCAAyC,iDAAiD,yDAAiT,CAAC,CAAC,0EAA0E,iDAAiD,yDAAmS,CAAC,CAAC,0BAA0B,qBAAqB,CAAC,oBAAoB,CAAC,gCAAgC,aAAa,CAAC,yBAAyB,CAAC,yBAAyB,YAAY,CAAC,uBAAuB,oCAAoC,CAAC,qBAAqB,CAAC,eAAe,CAAC,qBAAqB,CAAC,UAAU,CAAC,cAAc,CAAC,aAAa,CAAC,kBAAkB,YAAY,CAAC,MAAM,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,KAAK,CAAC,qBAAqB,CAAC,kGAAkG,qBAAqB,CAAC,2GAA2G,6BAA6B,CAAC,8BAA8B,kBAAkB,CAAC,+BAA+B,0BAA0B,CAAC,sBAAsB,6BAA6B,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,mDAAmD,iBAAiB,CAAC,wBAAwB,CAAC,eAAe,CAAC,wDAAwD,qBAAqB,CAAC,wBAAwB,CAAC,gBAAgB,CAAC,eAAe,CAAC,yDAAyD,mBAAmB,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,eAAe,CAAC,sDAAsD,iBAAiB,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,2DAA2D,qBAAqB,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,4DAA4D,mBAAmB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,oDAAoD,iBAAiB,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,qDAAqD,iBAAiB,CAAC,sBAAsB,CAAC,iBAAiB,CAAC,+BAA+B,4BAA4B,CAAC,QAAQ,CAAC,uBAAuB,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAK,CAAC,qCAAqC,8BAA8B,CAAC,0BAA0B,eAAe,CAAC,iBAAiB,CAAC,mCAAmC,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,4DAA4D,wBAAwB,CAAC,6DAA6D,yBAAyB,CAAC,+DAA+D,2BAA2B,CAAC,gEAAgE,4BAA4B,CAAC,gCAAgC,YAAY,CAAC,kCAAkC,mBAAmB,CAAC,wBAAwB,CAAC,qBAAqB,CAAC,gBAAgB,CAAC,sDAAsD,YAAY,CAAC,uDAAuD,YAAY,CAAC,mBAAmB,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,sBAAsB,CAAC,qBAAqB,CAAC,mEAAmE,wBAAwB,CAAC,iBAAiB,CAAC,WAAW,CAAC,UAAU,CAAC,qCAAqC,wDAAwD,CAAC,UAAU,CAAC,iBAAiB,CAAC,oCAAoC,qBAAqB,CAAC,iBAAiB,CAAC,kCAAkC,CAAC,qBAAqB,CAAC,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,QAAQ,CAAC,UAAU,CAAC,8CAA8C,GAAG,SAAS,CAAC,kBAAkB,CAAC,IAAI,SAAS,CAAC,kBAAkB,CAAC,GAAG,SAAS,CAAC,kBAAkB,CAAC,CAAC,oCAAoC,qBAAqB,CAAC,0CAA0C,YAAY,CAAC,0CAA0C,0BAA0B,CAAC,kBAAkB,CAAC,UAAU,CAAC,SAAS,CAAC,yHAAyH,gBAAgB,CAAC,oBAAoB,eAAe,CAAC,yBAAyB,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,iBAAiB,CAAC,KAAK,CAAC,OAAO,CAAC,uCAAuC,kBAAkB,CAAC,yBAAyB,CAAC,UAAU,CAAC,YAAY,CAAC,eAAe,CAAC,OAAO,CAAC,sBAAsB,CAAC,eAAe,CAAC,SAAS,CAAC,YAAY,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,6BAA6B,CAAC,aAAa,CAAC,uDAAuD,SAAS,CAAC,uBAAuB,CAAC,kEAAkE,YAAY,CAAC,qCAAqC,mEAAmE,YAAY,CAAC,kEAAkE,aAAa,CAAC,CAAC,8BAA8B,qBAAqB,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,eAAe,CAAC,oBAAoB,CAAC,aAAa",sourcesContent:[".maplibregl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (forced-colors:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (forced-colors:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}@media (hover:hover){.maplibregl-ctrl button:not(:disabled):hover{background-color:rgb(0 0 0/5%)}}.maplibregl-ctrl button:not(:disabled):active{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-globe .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='none' stroke='%23333' viewBox='0 0 22 22'%3E%3Ccircle cx='11' cy='11' r='8.5'/%3E%3Cpath d='M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z'/%3E%3Cpath d='M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z'/%3E%3Cpath d='M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-globe-enabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='none' stroke='%2333b5e5' viewBox='0 0 22 22'%3E%3Ccircle cx='11' cy='11' r='8.5'/%3E%3Cpath d='M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z'/%3E%3Cpath d='M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z'/%3E%3Cpath d='M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%23333' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%2333b5e5' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23aaa' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23999' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23666' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}}@keyframes maplibregl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (forced-colors:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\")}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;color:#000;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (forced-colors:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}@media screen and (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}.maplibregl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:rgb(0 0 0/5%)}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;transition:opacity .2s;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:\"\";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0,0,0,.4);color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(pointer:coarse){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}"],sourceRoot:""}]);const ve=q},7035:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},7180:function(e,t,r){var n;!function(e,i){function a(e){var t,r=this,n=(t=4022871197,function(e){e=String(e);for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)});r.next=function(){var e=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=e-(r.c=0|e)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(e),r.s0<0&&(r.s0+=1),r.s1-=n(e),r.s1<0&&(r.s1+=1),r.s2-=n(e),r.s2<0&&(r.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var r=new a(e),n=t&&t.state,i=r.next;return i.int32=function(){return 4294967296*r.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,n&&("object"==typeof n&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.alea=s}(0,e=r.nmd(e),r.amdD)},7391:(e,t,r)=>{var n=r(7180),i=r(3181),a=r(3031),o=r(9067),s=r(6833),l=r(3717),u=r(4801);u.alea=n,u.xor128=i,u.xorwow=a,u.xorshift7=o,u.xor4096=s,u.tychei=l,e.exports=u},7603:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z%27/%3E%3C/svg%3E"},7659:e=>{"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},7695:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%2333b5e5%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3C/svg%3E"},7825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,i&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var a=r.sourceMap;a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7914:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2788%27 height=%2723%27 fill=%27none%27%3E%3Cpath fill=%27%23000%27 fill-opacity=%27.4%27 fill-rule=%27evenodd%27 d=%27M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z%27/%3E%3Cpath fill=%27%23fff%27 d=%27m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z%27/%3E%3Cpath fill=%27%23e1e3e9%27 d=%27M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z%27/%3E%3Cpath d=%27M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z%27 style=%27fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001%27/%3E%3Cg style=%27stroke-width:1.12603545%27%3E%3Cpath d=%27M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668%27 style=%27color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3Cpath d=%27M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3%27 style=%27clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3Cpath d=%27M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z%27 style=%27clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3C/g%3E%3C/svg%3E"},8164:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},8460:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23999%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},8605:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},8869:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23e54e33%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3C/svg%3E"},9067:function(e,t,r){var n;!function(e,i){function a(e){var t=this;t.next=function(){var e,r,n=t.x,i=t.i;return e=n[i],r=(e^=e>>>7)^e<<24,r^=(e=n[i+1&7])^e>>>10,r^=(e=n[i+3&7])^e>>>3,r^=(e=n[i+4&7])^e<<7,e=n[i+7&7],r^=(e^=e<<13)^e<<9,n[i]=r,t.i=i+1&7,r},function(e,t){var r,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,r=0;r<t.length;++r)n[7&r]=n[7&r]<<15^t.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],e.x=n,e.i=0,r=256;r>0;--r)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var r=new a(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&(n.x&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.xorshift7=s}(0,e=r.nmd(e),r.amdD)},9387:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27none%27 stroke=%27%23333%27 viewBox=%270 0 22 22%27%3E%3Ccircle cx=%2711%27 cy=%2711%27 r=%278.5%27/%3E%3Cpath d=%27M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z%27/%3E%3Cpath d=%27M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z%27/%3E%3Cpath d=%27M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z%27/%3E%3C/svg%3E"},9819:e=>{"use strict";e.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23e58978%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=e,r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n,i=function(){var e=document.currentScript;if(!e){for(var t=document.getElementsByTagName("script"),r=[],n=0;n<t.length;n++)r.push(t[n]);e=(r=r.filter((function(e){return!e.async&&!e.text&&!e.textContent}))).slice(-1)[0]}return e};if(Object.defineProperty(r,"p",{get:(n=i().src.split("/").slice(0,-1).join("/")+"/",function(){return n})}),"undefined"!=typeof jsonpScriptSrc){var a=jsonpScriptSrc;jsonpScriptSrc=function(e){var t,r=(t=i(),/\/_dash-component-suites\//.test(t.src)),n=a(e);if(!r)return n;var o=n.split("/"),s=o.slice(-1)[0].split(".");return s.splice(1,0,"v0_0_4m1749710236"),o.splice(-1,1,s.join(".")),o.join("/")}}r.b=document.baseURI||self.location.href,r.nc=void 0;var o={};(()=>{"use strict";r.r(o),r.d(o,{DashMaplibre:()=>fT});const e=window.React;var t=r.n(e);const n=window.PropTypes;var i=r.n(n),a=r(6505),s=r.n(a),l=r(5072),u=r.n(l),c=r(7825),h=r.n(c),p=r(7659),d=r.n(p),f=r(5056),m=r.n(f),g=r(540),y=r.n(g),v=r(1113),x=r.n(v),_=r(6945),b={};function w(){}function A(e){return null==e?w:function(){return this.querySelector(e)}}function C(){return[]}function E(e){return null==e?C:function(){return this.querySelectorAll(e)}}function M(e){return function(){return this.matches(e)}}function S(e){return function(t){return t.matches(e)}}b.styleTagTransform=x(),b.setAttributes=m(),b.insert=d().bind(null,"head"),b.domAPI=h(),b.insertStyleElement=y(),u()(_.A,b),_.A&&_.A.locals&&_.A.locals;var D=Array.prototype.find;function T(){return this.firstElementChild}var N=Array.prototype.filter;function I(){return Array.from(this.children)}function P(e){return new Array(e.length)}function z(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function B(e,t,r,n,i,a){for(var o,s=0,l=t.length,u=a.length;s<u;++s)(o=t[s])?(o.__data__=a[s],n[s]=o):r[s]=new z(e,a[s]);for(;s<l;++s)(o=t[s])&&(i[s]=o)}function k(e,t,r,n,i,a,o){var s,l,u,c=new Map,h=t.length,p=a.length,d=new Array(h);for(s=0;s<h;++s)(l=t[s])&&(d[s]=u=o.call(l,l.__data__,s,t)+"",c.has(u)?i[s]=l:c.set(u,l));for(s=0;s<p;++s)u=o.call(e,a[s],s,a)+"",(l=c.get(u))?(n[s]=l,l.__data__=a[s],c.delete(u)):r[s]=new z(e,a[s]);for(s=0;s<h;++s)(l=t[s])&&c.get(d[s])===l&&(i[s]=l)}function F(e){return e.__data__}function R(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function O(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}z.prototype={constructor:z,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var L="http://www.w3.org/1999/xhtml";const q={svg:"http://www.w3.org/2000/svg",xhtml:L,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function j(e){var t=e+="",r=t.indexOf(":");return r>=0&&"xmlns"!==(t=e.slice(0,r))&&(e=e.slice(r+1)),q.hasOwnProperty(t)?{space:q[t],local:e}:e}function U(e){return function(){this.removeAttribute(e)}}function V(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Z(e,t){return function(){this.setAttribute(e,t)}}function $(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function G(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttribute(e):this.setAttribute(e,r)}}function H(e,t){return function(){var r=t.apply(this,arguments);null==r?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function W(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function X(e){return function(){this.style.removeProperty(e)}}function Y(e,t,r){return function(){this.style.setProperty(e,t,r)}}function K(e,t,r){return function(){var n=t.apply(this,arguments);null==n?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function J(e,t){return e.style.getPropertyValue(t)||W(e).getComputedStyle(e,null).getPropertyValue(t)}function Q(e){return function(){delete this[e]}}function ee(e,t){return function(){this[e]=t}}function te(e,t){return function(){var r=t.apply(this,arguments);null==r?delete this[e]:this[e]=r}}function re(e){return e.trim().split(/^|\s+/)}function ne(e){return e.classList||new ie(e)}function ie(e){this._node=e,this._names=re(e.getAttribute("class")||"")}function ae(e,t){for(var r=ne(e),n=-1,i=t.length;++n<i;)r.add(t[n])}function oe(e,t){for(var r=ne(e),n=-1,i=t.length;++n<i;)r.remove(t[n])}function se(e){return function(){ae(this,e)}}function le(e){return function(){oe(this,e)}}function ue(e,t){return function(){(t.apply(this,arguments)?ae:oe)(this,e)}}function ce(){this.textContent=""}function he(e){return function(){this.textContent=e}}function pe(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function de(){this.innerHTML=""}function fe(e){return function(){this.innerHTML=e}}function me(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ge(){this.nextSibling&&this.parentNode.appendChild(this)}function ye(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ve(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===L&&t.documentElement.namespaceURI===L?t.createElement(e):t.createElementNS(r,e)}}function xe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _e(e){var t=j(e);return(t.local?xe:ve)(t)}function be(){return null}function we(){var e=this.parentNode;e&&e.removeChild(this)}function Ae(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ce(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ee(e){return function(){var t=this.__on;if(t){for(var r,n=0,i=-1,a=t.length;n<a;++n)r=t[n],e.type&&r.type!==e.type||r.name!==e.name?t[++i]=r:this.removeEventListener(r.type,r.listener,r.options);++i?t.length=i:delete this.__on}}}function Me(e,t,r){return function(){var n,i=this.__on,a=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,s=i.length;o<s;++o)if((n=i[o]).type===e.type&&n.name===e.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=a,n.options=r),void(n.value=t);this.addEventListener(e.type,a,r),n={type:e.type,name:e.name,value:t,listener:a,options:r},i?i.push(n):this.__on=[n]}}function Se(e,t,r){var n=W(e),i=n.CustomEvent;"function"==typeof i?i=new i(t,r):(i=n.document.createEvent("Event"),r?(i.initEvent(t,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function De(e,t){return function(){return Se(this,e,t)}}function Te(e,t){return function(){return Se(this,e,t.apply(this,arguments))}}ie.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Ne=[null];function Ie(e,t){this._groups=e,this._parents=t}function Pe(){return new Ie([[document.documentElement]],Ne)}Ie.prototype=Pe.prototype={constructor:Ie,select:function(e){"function"!=typeof e&&(e=A(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var a,o,s=t[i],l=s.length,u=n[i]=new Array(l),c=0;c<l;++c)(a=s[c])&&(o=e.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),u[c]=o);return new Ie(n,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}(e):E(e);for(var t=this._groups,r=t.length,n=[],i=[],a=0;a<r;++a)for(var o,s=t[a],l=s.length,u=0;u<l;++u)(o=s[u])&&(n.push(e.call(o,o.__data__,u,s)),i.push(o));return new Ie(n,i)},selectChild:function(e){return this.select(null==e?T:function(e){return function(){return D.call(this.children,e)}}("function"==typeof e?e:S(e)))},selectChildren:function(e){return this.selectAll(null==e?I:function(e){return function(){return N.call(this.children,e)}}("function"==typeof e?e:S(e)))},filter:function(e){"function"!=typeof e&&(e=M(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var a,o=t[i],s=o.length,l=n[i]=[],u=0;u<s;++u)(a=o[u])&&e.call(a,a.__data__,u,o)&&l.push(a);return new Ie(n,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,F);var r,n=t?k:B,i=this._parents,a=this._groups;"function"!=typeof e&&(r=e,e=function(){return r});for(var o=a.length,s=new Array(o),l=new Array(o),u=new Array(o),c=0;c<o;++c){var h=i[c],p=a[c],d=p.length,f=R(e.call(h,h&&h.__data__,c,i)),m=f.length,g=l[c]=new Array(m),y=s[c]=new Array(m);n(h,p,g,y,u[c]=new Array(d),f,t);for(var v,x,_=0,b=0;_<m;++_)if(v=g[_]){for(_>=b&&(b=_+1);!(x=y[b])&&++b<m;);v._next=x||null}}return(s=new Ie(s,i))._enter=l,s._exit=u,s},enter:function(){return new Ie(this._enter||this._groups.map(P),this._parents)},exit:function(){return new Ie(this._exit||this._groups.map(P),this._parents)},join:function(e,t,r){var n=this.enter(),i=this,a=this.exit();return"function"==typeof e?(n=e(n))&&(n=n.selection()):n=n.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==r?a.remove():r(a),n&&i?n.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,i=r.length,a=n.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var u,c=r[l],h=n[l],p=c.length,d=s[l]=new Array(p),f=0;f<p;++f)(u=c[f]||h[f])&&(d[f]=u);for(;l<i;++l)s[l]=r[l];return new Ie(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n,i=e[t],a=i.length-1,o=i[a];--a>=0;)(n=i[a])&&(o&&4^n.compareDocumentPosition(o)&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(e){function t(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}e||(e=O);for(var r=this._groups,n=r.length,i=new Array(n),a=0;a<n;++a){for(var o,s=r[a],l=s.length,u=i[a]=new Array(l),c=0;c<l;++c)(o=s[c])&&(u[c]=o);u.sort(t)}return new Ie(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],i=0,a=n.length;i<a;++i){var o=n[i];if(o)return o}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var i,a=t[r],o=0,s=a.length;o<s;++o)(i=a[o])&&e.call(i,i.__data__,o,a);return this},attr:function(e,t){var r=j(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==t?r.local?V:U:"function"==typeof t?r.local?H:G:r.local?$:Z)(r,t))},style:function(e,t,r){return arguments.length>1?this.each((null==t?X:"function"==typeof t?K:Y)(e,t,null==r?"":r)):J(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Q:"function"==typeof t?te:ee)(e,t)):this.node()[e]},classed:function(e,t){var r=re(e+"");if(arguments.length<2){for(var n=ne(this.node()),i=-1,a=r.length;++i<a;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof t?ue:t?se:le)(r,t))},text:function(e){return arguments.length?this.each(null==e?ce:("function"==typeof e?pe:he)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?de:("function"==typeof e?me:fe)(e)):this.node().innerHTML},raise:function(){return this.each(ge)},lower:function(){return this.each(ye)},append:function(e){var t="function"==typeof e?e:_e(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var r="function"==typeof e?e:_e(e),n=null==t?be:"function"==typeof t?t:A(t);return this.select((function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(we)},clone:function(e){return this.select(e?Ce:Ae)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,r){var n,i,a=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}}))}(e+""),o=a.length;if(!(arguments.length<2)){for(s=t?Me:Ee,n=0;n<o;++n)this.each(s(a[n],t,r));return this}var s=this.node().__on;if(s)for(var l,u=0,c=s.length;u<c;++u)for(n=0,l=s[u];n<o;++n)if((i=a[n]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?Te:De)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n,i=e[t],a=0,o=i.length;a<o;++a)(n=i[a])&&(yield n)}};const ze=Pe;var Be={value:()=>{}};function ke(){for(var e,t=0,r=arguments.length,n={};t<r;++t){if(!(e=arguments[t]+"")||e in n||/[\s.]/.test(e))throw new Error("illegal type: "+e);n[e]=[]}return new Fe(n)}function Fe(e){this._=e}function Re(e,t){for(var r,n=0,i=e.length;n<i;++n)if((r=e[n]).name===t)return r.value}function Oe(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n].name===t){e[n]=Be,e=e.slice(0,n).concat(e.slice(n+1));break}return null!=r&&e.push({name:t,value:r}),e}Fe.prototype=ke.prototype={constructor:Fe,on:function(e,t){var r,n,i=this._,a=(n=i,(e+"").trim().split(/^|\s+/).map((function(e){var t="",r=e.indexOf(".");if(r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(e=a[o]).type)i[r]=Oe(i[r],e.name,t);else if(null==t)for(r in i)i[r]=Oe(i[r],e.name,null);return this}for(;++o<s;)if((r=(e=a[o]).type)&&(r=Re(i[r],e.name)))return r},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Fe(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,n,i=new Array(r),a=0;a<r;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=0,r=(n=this._[e]).length;a<r;++a)n[a].value.apply(t,i)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],i=0,a=n.length;i<a;++i)n[i].value.apply(t,r)}};const Le=ke;var qe,je,Ue=0,Ve=0,Ze=0,$e=0,Ge=0,He=0,We="object"==typeof performance&&performance.now?performance:Date,Xe="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ye(){return Ge||(Xe(Ke),Ge=We.now()+He)}function Ke(){Ge=0}function Je(){this._call=this._time=this._next=null}function Qe(e,t,r){var n=new Je;return n.restart(e,t,r),n}function et(){Ge=($e=We.now())+He,Ue=Ve=0;try{!function(){Ye(),++Ue;for(var e,t=qe;t;)(e=Ge-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ue}()}finally{Ue=0,function(){for(var e,t,r=qe,n=1/0;r;)r._call?(n>r._time&&(n=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:qe=t);je=e,rt(n)}(),Ge=0}}function tt(){var e=We.now(),t=e-$e;t>1e3&&(He-=t,$e=e)}function rt(e){Ue||(Ve&&(Ve=clearTimeout(Ve)),e-Ge>24?(e<1/0&&(Ve=setTimeout(et,e-We.now()-He)),Ze&&(Ze=clearInterval(Ze))):(Ze||($e=We.now(),Ze=setInterval(tt,1e3)),Ue=1,Xe(et)))}function nt(e,t,r){var n=new Je;return t=null==t?0:+t,n.restart((r=>{n.stop(),e(r+t)}),t,r),n}Je.prototype=Qe.prototype={constructor:Je,restart:function(e,t,r){if("function"!=typeof e)throw new TypeError("callback is not a function");r=(null==r?Ye():+r)+(null==t?0:+t),this._next||je===this||(je?je._next=this:qe=this,je=this),this._call=e,this._time=r,rt()},stop:function(){this._call&&(this._call=null,this._time=1/0,rt())}};var it=Le("start","end","cancel","interrupt"),at=[];function ot(e,t,r,n,i,a){var o=e.__transition;if(o){if(r in o)return}else e.__transition={};!function(e,t,r){var n,i=e.__transition;function a(l){var u,c,h,p;if(1!==r.state)return s();for(u in i)if((p=i[u]).name===r.name){if(3===p.state)return nt(a);4===p.state?(p.state=6,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete i[u]):+u<t&&(p.state=6,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete i[u])}if(nt((function(){3===r.state&&(r.state=4,r.timer.restart(o,r.delay,r.time),o(l))})),r.state=2,r.on.call("start",e,e.__data__,r.index,r.group),2===r.state){for(r.state=3,n=new Array(h=r.tween.length),u=0,c=-1;u<h;++u)(p=r.tween[u].value.call(e,e.__data__,r.index,r.group))&&(n[++c]=p);n.length=c+1}}function o(t){for(var i=t<r.duration?r.ease.call(null,t/r.duration):(r.timer.restart(s),r.state=5,1),a=-1,o=n.length;++a<o;)n[a].call(e,i);5===r.state&&(r.on.call("end",e,e.__data__,r.index,r.group),s())}function s(){for(var n in r.state=6,r.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=r,r.timer=Qe((function(e){r.state=1,r.timer.restart(a,r.delay,r.time),r.delay<=e&&a(e-r.delay)}),0,r.time)}(e,r,{name:t,index:n,group:i,on:it,tween:at,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function st(e,t){var r=ut(e,t);if(r.state>0)throw new Error("too late; already scheduled");return r}function lt(e,t){var r=ut(e,t);if(r.state>3)throw new Error("too late; already running");return r}function ut(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function ct(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var ht,pt=180/Math.PI,dt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ft(e,t,r,n,i,a){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*r+t*n)&&(r-=e*l,n-=t*l),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,l/=s),e*n<t*r&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*pt,skewX:Math.atan(l)*pt,scaleX:o,scaleY:s}}function mt(e,t,r,n){function i(e){return e.length?e.pop()+" ":""}return function(a,o){var s=[],l=[];return a=e(a),o=e(o),function(e,n,i,a,o,s){if(e!==i||n!==a){var l=o.push("translate(",null,t,null,r);s.push({i:l-4,x:ct(e,i)},{i:l-2,x:ct(n,a)})}else(i||a)&&o.push("translate("+i+t+a+r)}(a.translateX,a.translateY,o.translateX,o.translateY,s,l),function(e,t,r,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:r.push(i(r)+"rotate(",null,n)-2,x:ct(e,t)})):t&&r.push(i(r)+"rotate("+t+n)}(a.rotate,o.rotate,s,l),function(e,t,r,a){e!==t?a.push({i:r.push(i(r)+"skewX(",null,n)-2,x:ct(e,t)}):t&&r.push(i(r)+"skewX("+t+n)}(a.skewX,o.skewX,s,l),function(e,t,r,n,a,o){if(e!==r||t!==n){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:ct(e,r)},{i:s-2,x:ct(t,n)})}else 1===r&&1===n||a.push(i(a)+"scale("+r+","+n+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,l),a=o=null,function(e){for(var t,r=-1,n=l.length;++r<n;)s[(t=l[r]).i]=t.x(e);return s.join("")}}}var gt=mt((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?dt:ft(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),yt=mt((function(e){return null==e?dt:(ht||(ht=document.createElementNS("http://www.w3.org/2000/svg","g")),ht.setAttribute("transform",e),(e=ht.transform.baseVal.consolidate())?ft((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):dt)}),", ",")",")");function vt(e,t){var r,n;return function(){var i=lt(this,e),a=i.tween;if(a!==r)for(var o=0,s=(n=r=a).length;o<s;++o)if(n[o].name===t){(n=n.slice()).splice(o,1);break}i.tween=n}}function xt(e,t,r){var n,i;if("function"!=typeof r)throw new Error;return function(){var a=lt(this,e),o=a.tween;if(o!==n){i=(n=o).slice();for(var s={name:t,value:r},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}a.tween=i}}function _t(e,t,r){var n=e._id;return e.each((function(){var e=lt(this,n);(e.value||(e.value={}))[t]=r.apply(this,arguments)})),function(e){return ut(e,n).value[t]}}function bt(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function wt(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function At(){}var Ct=.7,Et=1/Ct,Mt="\\s*([+-]?\\d+)\\s*",St="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Tt=/^#([0-9a-f]{3,8})$/,Nt=new RegExp(`^rgb\\(${Mt},${Mt},${Mt}\\)$`),It=new RegExp(`^rgb\\(${Dt},${Dt},${Dt}\\)$`),Pt=new RegExp(`^rgba\\(${Mt},${Mt},${Mt},${St}\\)$`),zt=new RegExp(`^rgba\\(${Dt},${Dt},${Dt},${St}\\)$`),Bt=new RegExp(`^hsl\\(${St},${Dt},${Dt}\\)$`),kt=new RegExp(`^hsla\\(${St},${Dt},${Dt},${St}\\)$`),Ft={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Rt(){return this.rgb().formatHex()}function Ot(){return this.rgb().formatRgb()}function Lt(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Tt.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?qt(t):3===r?new Vt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?jt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?jt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Nt.exec(e))?new Vt(t[1],t[2],t[3],1):(t=It.exec(e))?new Vt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Pt.exec(e))?jt(t[1],t[2],t[3],t[4]):(t=zt.exec(e))?jt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Bt.exec(e))?Xt(t[1],t[2]/100,t[3]/100,1):(t=kt.exec(e))?Xt(t[1],t[2]/100,t[3]/100,t[4]):Ft.hasOwnProperty(e)?qt(Ft[e]):"transparent"===e?new Vt(NaN,NaN,NaN,0):null}function qt(e){return new Vt(e>>16&255,e>>8&255,255&e,1)}function jt(e,t,r,n){return n<=0&&(e=t=r=NaN),new Vt(e,t,r,n)}function Ut(e,t,r,n){return 1===arguments.length?((i=e)instanceof At||(i=Lt(i)),i?new Vt((i=i.rgb()).r,i.g,i.b,i.opacity):new Vt):new Vt(e,t,r,null==n?1:n);var i}function Vt(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function Zt(){return`#${Wt(this.r)}${Wt(this.g)}${Wt(this.b)}`}function $t(){const e=Gt(this.opacity);return`${1===e?"rgb(":"rgba("}${Ht(this.r)}, ${Ht(this.g)}, ${Ht(this.b)}${1===e?")":`, ${e})`}`}function Gt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ht(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wt(e){return((e=Ht(e))<16?"0":"")+e.toString(16)}function Xt(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Kt(e,t,r,n)}function Yt(e){if(e instanceof Kt)return new Kt(e.h,e.s,e.l,e.opacity);if(e instanceof At||(e=Lt(e)),!e)return new Kt;if(e instanceof Kt)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,s=a-i,l=(a+i)/2;return s?(o=t===a?(r-n)/s+6*(r<n):r===a?(n-t)/s+2:(t-r)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Kt(o,s,l,e.opacity)}function Kt(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function Jt(e){return(e=(e||0)%360)<0?e+360:e}function Qt(e){return Math.max(0,Math.min(1,e||0))}function er(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}function tr(e,t,r,n,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*r+(1+3*e+3*a-3*o)*n+o*i)/6}bt(At,Lt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Rt,formatHex:Rt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Yt(this).formatHsl()},formatRgb:Ot,toString:Ot}),bt(Vt,Ut,wt(At,{brighter(e){return e=null==e?Et:Math.pow(Et,e),new Vt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Ct:Math.pow(Ct,e),new Vt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Vt(Ht(this.r),Ht(this.g),Ht(this.b),Gt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zt,formatHex:Zt,formatHex8:function(){return`#${Wt(this.r)}${Wt(this.g)}${Wt(this.b)}${Wt(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:$t,toString:$t})),bt(Kt,(function(e,t,r,n){return 1===arguments.length?Yt(e):new Kt(e,t,r,null==n?1:n)}),wt(At,{brighter(e){return e=null==e?Et:Math.pow(Et,e),new Kt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Ct:Math.pow(Ct,e),new Kt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Vt(er(e>=240?e-240:e+120,i,n),er(e,i,n),er(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Kt(Jt(this.h),Qt(this.s),Qt(this.l),Gt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Gt(this.opacity);return`${1===e?"hsl(":"hsla("}${Jt(this.h)}, ${100*Qt(this.s)}%, ${100*Qt(this.l)}%${1===e?")":`, ${e})`}`}}));const rr=e=>()=>e;function nr(e,t){var r=t-e;return r?function(e,t){return function(r){return e+r*t}}(e,r):rr(isNaN(e)?t:e)}const ir=function e(t){var r=function(e){return 1===(e=+e)?nr:function(t,r){return r-t?function(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}(t,r,e):rr(isNaN(t)?r:t)}}(t);function n(e,t){var n=r((e=Ut(e)).r,(t=Ut(t)).r),i=r(e.g,t.g),a=r(e.b,t.b),o=nr(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return n.gamma=e,n}(1);function ar(e){return function(t){var r,n,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(r=0;r<i;++r)n=Ut(t[r]),a[r]=n.r||0,o[r]=n.g||0,s[r]=n.b||0;return a=e(a),o=e(o),s=e(s),n.opacity=1,function(e){return n.r=a(e),n.g=o(e),n.b=s(e),n+""}}}ar((function(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],o=n>0?e[n-1]:2*i-a,s=n<t-1?e[n+2]:2*a-i;return tr((r-n/t)*t,o,i,a,s)}})),ar((function(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],a=e[n%t],o=e[(n+1)%t],s=e[(n+2)%t];return tr((r-n/t)*t,i,a,o,s)}}));var or=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sr=new RegExp(or.source,"g");function lr(e,t){var r,n,i,a=or.lastIndex=sr.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(r=or.exec(e))&&(n=sr.exec(t));)(i=n.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(r=r[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,l.push({i:o,x:ct(r,n)})),a=sr.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var r,n=0;n<t;++n)s[(r=l[n]).i]=r.x(e);return s.join("")})}function ur(e,t){var r;return("number"==typeof t?ct:t instanceof Lt?ir:(r=Lt(t))?(t=r,ir):lr)(e,t)}function cr(e){return function(){this.removeAttribute(e)}}function hr(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pr(e,t,r){var n,i,a=r+"";return function(){var o=this.getAttribute(e);return o===a?null:o===n?i:i=t(n=o,r)}}function dr(e,t,r){var n,i,a=r+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===n?i:i=t(n=o,r)}}function fr(e,t,r){var n,i,a;return function(){var o,s,l=r(this);if(null!=l)return(o=this.getAttribute(e))===(s=l+"")?null:o===n&&s===i?a:(i=s,a=t(n=o,l));this.removeAttribute(e)}}function mr(e,t,r){var n,i,a;return function(){var o,s,l=r(this);if(null!=l)return(o=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:o===n&&s===i?a:(i=s,a=t(n=o,l));this.removeAttributeNS(e.space,e.local)}}function gr(e,t){var r,n;function i(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&function(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}(e,i)),r}return i._value=t,i}function yr(e,t){var r,n;function i(){var i=t.apply(this,arguments);return i!==n&&(r=(n=i)&&function(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}(e,i)),r}return i._value=t,i}function vr(e,t){return function(){st(this,e).delay=+t.apply(this,arguments)}}function xr(e,t){return t=+t,function(){st(this,e).delay=t}}function _r(e,t){return function(){lt(this,e).duration=+t.apply(this,arguments)}}function br(e,t){return t=+t,function(){lt(this,e).duration=t}}var wr=ze.prototype.constructor;function Ar(e){return function(){this.style.removeProperty(e)}}var Cr=0;function Er(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function Mr(){return++Cr}var Sr=ze.prototype;Er.prototype=function(e){return ze().transition(e)}.prototype={constructor:Er,select:function(e){var t=this._name,r=this._id;"function"!=typeof e&&(e=A(e));for(var n=this._groups,i=n.length,a=new Array(i),o=0;o<i;++o)for(var s,l,u=n[o],c=u.length,h=a[o]=new Array(c),p=0;p<c;++p)(s=u[p])&&(l=e.call(s,s.__data__,p,u))&&("__data__"in s&&(l.__data__=s.__data__),h[p]=l,ot(h[p],t,r,p,h,ut(s,r)));return new Er(a,this._parents,t,r)},selectAll:function(e){var t=this._name,r=this._id;"function"!=typeof e&&(e=E(e));for(var n=this._groups,i=n.length,a=[],o=[],s=0;s<i;++s)for(var l,u=n[s],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var p,d=e.call(l,l.__data__,h,u),f=ut(l,r),m=0,g=d.length;m<g;++m)(p=d[m])&&ot(p,t,r,m,d,f);a.push(d),o.push(l)}return new Er(a,o,t,r)},selectChild:Sr.selectChild,selectChildren:Sr.selectChildren,filter:function(e){"function"!=typeof e&&(e=M(e));for(var t=this._groups,r=t.length,n=new Array(r),i=0;i<r;++i)for(var a,o=t[i],s=o.length,l=n[i]=[],u=0;u<s;++u)(a=o[u])&&e.call(a,a.__data__,u,o)&&l.push(a);return new Er(n,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,i=r.length,a=Math.min(n,i),o=new Array(n),s=0;s<a;++s)for(var l,u=t[s],c=r[s],h=u.length,p=o[s]=new Array(h),d=0;d<h;++d)(l=u[d]||c[d])&&(p[d]=l);for(;s<n;++s)o[s]=t[s];return new Er(o,this._parents,this._name,this._id)},selection:function(){return new wr(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,r=Mr(),n=this._groups,i=n.length,a=0;a<i;++a)for(var o,s=n[a],l=s.length,u=0;u<l;++u)if(o=s[u]){var c=ut(o,t);ot(o,e,r,u,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Er(n,this._parents,e,r)},call:Sr.call,nodes:Sr.nodes,node:Sr.node,size:Sr.size,empty:Sr.empty,each:Sr.each,on:function(e,t){var r=this._id;return arguments.length<2?ut(this.node(),r).on.on(e):this.each(function(e,t,r){var n,i,a=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?st:lt;return function(){var o=a(this,e),s=o.on;s!==n&&(i=(n=s).copy()).on(t,r),o.on=i}}(r,e,t))},attr:function(e,t){var r=j(e),n="transform"===r?yt:ur;return this.attrTween(e,"function"==typeof t?(r.local?mr:fr)(r,n,_t(this,"attr."+e,t)):null==t?(r.local?hr:cr)(r):(r.local?dr:pr)(r,n,t))},attrTween:function(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;var n=j(e);return this.tween(r,(n.local?gr:yr)(n,t))},style:function(e,t,r){var n="transform"==(e+="")?gt:ur;return null==t?this.styleTween(e,function(e,t){var r,n,i;return function(){var a=J(this,e),o=(this.style.removeProperty(e),J(this,e));return a===o?null:a===r&&o===n?i:i=t(r=a,n=o)}}(e,n)).on("end.style."+e,Ar(e)):"function"==typeof t?this.styleTween(e,function(e,t,r){var n,i,a;return function(){var o=J(this,e),s=r(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=J(this,e)),o===l?null:o===n&&l===i?a:(i=l,a=t(n=o,s))}}(e,n,_t(this,"style."+e,t))).each(function(e,t){var r,n,i,a,o="style."+t,s="end."+o;return function(){var l=lt(this,e),u=l.on,c=null==l.value[o]?a||(a=Ar(t)):void 0;u===r&&i===c||(n=(r=u).copy()).on(s,i=c),l.on=n}}(this._id,e)):this.styleTween(e,function(e,t,r){var n,i,a=r+"";return function(){var o=J(this,e);return o===a?null:o===n?i:i=t(n=o,r)}}(e,n,t),r).on("end.style."+e,null)},styleTween:function(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,function(e,t,r){var n,i;function a(){var a=t.apply(this,arguments);return a!==i&&(n=(i=a)&&function(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}(e,a,r)),n}return a._value=t,a}(e,t,null==r?"":r))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(_t(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,r;function n(){var n=e.apply(this,arguments);return n!==r&&(t=(r=n)&&function(e){return function(t){this.textContent=e.call(this,t)}}(n)),t}return n._value=e,n}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n,i=ut(this.node(),r).tween,a=0,o=i.length;a<o;++a)if((n=i[a]).name===e)return n.value;return null}return this.each((null==t?vt:xt)(r,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?vr:xr)(t,e)):ut(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?_r:br)(t,e)):ut(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){lt(this,e).ease=t}}(t,e)):ut(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var r=t.apply(this,arguments);if("function"!=typeof r)throw new Error;lt(this,e).ease=r}}(this._id,e))},end:function(){var e,t,r=this,n=r._id,i=r.size();return new Promise((function(a,o){var s={value:o},l={value:function(){0===--i&&a()}};r.each((function(){var r=lt(this,n),i=r.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),r.on=t})),0===i&&a()}))},[Symbol.iterator]:Sr[Symbol.iterator]};var Dr={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Tr(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}ze.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var r,n,i,a=e.__transition,o=!0;if(a){for(i in t=null==t?null:t+"",a)(r=a[i]).name===t?(n=r.state>2&&r.state<5,r.state=6,r.timer.stop(),r.on.call(n?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete a[i]):o=!1;o&&delete e.__transition}}(this,e)}))},ze.prototype.transition=function(e){var t,r;e instanceof Er?(t=e._id,e=e._name):(t=Mr(),(r=Dr).time=Ye(),e=null==e?null:e+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var o,s=n[a],l=s.length,u=0;u<l;++u)(o=s[u])&&ot(o,e,t,u,s,r||Tr(o,t));return new Er(n,this._parents,e,t)};const{abs:Nr,max:Ir,min:Pr}=Math;function zr(e){return{type:e}}function Br(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function kr(e){return(e=Br(Math.abs(e)))?e[1]:NaN}["w","e"].map(zr),["n","s"].map(zr),["n","w","e","s","nw","ne","sw","se"].map(zr);var Fr,Rr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Or(e){if(!(t=Rr.exec(e)))throw new Error("invalid format: "+e);var t;return new Lr({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Lr(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function qr(e,t){var r=Br(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}Or.prototype=Lr.prototype,Lr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const jr={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>qr(100*e,t),r:qr,s:function(e,t){var r=Br(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(Fr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Br(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Ur(e){return e}var Vr,Zr,$r,Gr=Array.prototype.map,Hr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];Vr=function(e){var t,r,n=void 0===e.grouping||void 0===e.thousands?Ur:(t=Gr.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var i=e.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),a.push(e.substring(i-=s,i+s)),!((l+=s+1)>n));)s=t[o=(o+1)%t.length];return a.reverse().join(r)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Ur:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Gr.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",u=void 0===e.minus?"−":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Or(e)).fill,r=e.align,h=e.sign,p=e.symbol,d=e.zero,f=e.width,m=e.comma,g=e.precision,y=e.trim,v=e.type;"n"===v?(m=!0,v="g"):jr[v]||(void 0===g&&(g=12),y=!0,v="g"),(d||"0"===t&&"="===r)&&(d=!0,t="0",r="=");var x="$"===p?i:"#"===p&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",_="$"===p?a:/[%p]/.test(v)?l:"",b=jr[v],w=/[defgprs%]/.test(v);function A(e){var i,a,l,p=x,A=_;if("c"===v)A=b(e)+A,e="";else{var C=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:b(Math.abs(e),g),y&&(e=function(e){e:for(var t,r=e.length,n=1,i=-1;n<r;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),C&&0===+e&&"+"!==h&&(C=!1),p=(C?"("===h?h:u:"-"===h||"("===h?"":h)+p,A=("s"===v?Hr[8+Fr/3]:"")+A+(C&&"("===h?")":""),w)for(i=-1,a=e.length;++i<a;)if(48>(l=e.charCodeAt(i))||l>57){A=(46===l?o+e.slice(i+1):e.slice(i))+A,e=e.slice(0,i);break}}m&&!d&&(e=n(e,1/0));var E=p.length+e.length+A.length,M=E<f?new Array(f-E+1).join(t):"";switch(m&&d&&(e=n(M+e,M.length?f-A.length:1/0),M=""),r){case"<":e=p+e+A+M;break;case"=":e=p+M+e+A;break;case"^":e=M.slice(0,E=M.length>>1)+p+e+A+M.slice(E);break;default:e=M+p+e+A}return s(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),A.toString=function(){return e+""},A}return{format:h,formatPrefix:function(e,t){var r=h(((e=Or(e)).type="f",e)),n=3*Math.max(-8,Math.min(8,Math.floor(kr(t)/3))),i=Math.pow(10,-n),a=Hr[8+n/3];return function(e){return r(i*e)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),Zr=Vr.format,$r=Vr.formatPrefix;const Wr=Math.sqrt(50),Xr=Math.sqrt(10),Yr=Math.sqrt(2);function Kr(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=Wr?10:a>=Xr?5:a>=Yr?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/o,s=Math.round(e*u),l=Math.round(t*u),s/u<e&&++s,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*o,s=Math.round(e/u),l=Math.round(t/u),s*u<e&&++s,l*u>t&&--l),l<s&&.5<=r&&r<2?Kr(e,t,2*r):[s,l,u]}function Jr(e,t,r){return Kr(e=+e,t=+t,r=+r)[2]}function Qr(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function en(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function tn(e){let t,r,n;function i(e,n,i=0,a=e.length){if(i<a){if(0!==t(n,n))return a;do{const t=i+a>>>1;r(e[t],n)<0?i=t+1:a=t}while(i<a)}return i}return 2!==e.length?(t=Qr,r=(t,r)=>Qr(e(t),r),n=(t,r)=>e(t)-r):(t=e===Qr||e===en?e:rn,r=e,n=e),{left:i,center:function(e,t,r=0,a=e.length){const o=i(e,t,r,a-1);return o>r&&n(e[o-1],t)>-n(e[o],t)?o-1:o},right:function(e,n,i=0,a=e.length){if(i<a){if(0!==t(n,n))return a;do{const t=i+a>>>1;r(e[t],n)<=0?i=t+1:a=t}while(i<a)}return i}}}function rn(){return 0}const nn=tn(Qr),an=nn.right,on=(nn.left,tn((function(e){return null===e?NaN:+e})).center,an);function sn(e,t){var r,n=t?t.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),o=new Array(n);for(r=0;r<i;++r)a[r]=hn(e[r],t[r]);for(;r<n;++r)o[r]=t[r];return function(e){for(r=0;r<i;++r)o[r]=a[r](e);return o}}function ln(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function un(e,t){var r,n={},i={};for(r in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)r in e?n[r]=hn(e[r],t[r]):i[r]=t[r];return function(e){for(r in n)i[r]=n[r](e);return i}}function cn(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(r=0;r<n;++r)i[r]=e[r]*(1-a)+t[r]*a;return i}}function hn(e,t){var r,n,i=typeof t;return null==t||"boolean"===i?rr(t):("number"===i?ct:"string"===i?(r=Lt(t))?(t=r,ir):lr:t instanceof Lt?ir:t instanceof Date?ln:(n=t,!ArrayBuffer.isView(n)||n instanceof DataView?Array.isArray(t)?sn:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?un:ct:cn))(e,t)}function pn(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function dn(e){return+e}var fn=[0,1];function mn(e){return e}function gn(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:(r=isNaN(t)?NaN:.5,function(){return r});var r}function yn(e,t,r){var n=e[0],i=e[1],a=t[0],o=t[1];return i<n?(n=gn(i,n),a=r(o,a)):(n=gn(n,i),a=r(a,o)),function(e){return a(n(e))}}function vn(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=gn(e[o],e[o+1]),a[o]=r(t[o],t[o+1]);return function(t){var r=on(e,t,1,n)-1;return a[r](i[r](t))}}function xn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function _n(e){var t=e.domain;return e.ticks=function(e){var r=t();return function(e,t,r){if(!((r=+r)>0))return[];if((e=+e)===(t=+t))return[e];const n=t<e,[i,a,o]=n?Kr(t,e,r):Kr(e,t,r);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(n)if(o<0)for(let e=0;e<s;++e)l[e]=(a-e)/-o;else for(let e=0;e<s;++e)l[e]=(a-e)*o;else if(o<0)for(let e=0;e<s;++e)l[e]=(i+e)/-o;else for(let e=0;e<s;++e)l[e]=(i+e)*o;return l}(r[0],r[r.length-1],null==e?10:e)},e.tickFormat=function(e,r){var n=t();return function(e,t,r,n){var i,a=function(e,t,r){r=+r;const n=(t=+t)<(e=+e),i=n?Jr(t,e,r):Jr(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}(e,t,r);switch((n=Or(null==n?",f":n)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=n.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(kr(t)/3)))-kr(Math.abs(e)))}(a,o))||(n.precision=i),$r(n,o);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,kr(t)-kr(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=function(e){return Math.max(0,-kr(Math.abs(e)))}(a))||(n.precision=i-2*("%"===n.type))}return Zr(n)}(n[0],n[n.length-1],null==e?10:e,r)},e.nice=function(r){null==r&&(r=10);var n,i,a=t(),o=0,s=a.length-1,l=a[o],u=a[s],c=10;for(u<l&&(i=l,l=u,u=i,i=o,o=s,s=i);c-- >0;){if((i=Jr(l,u,r))===n)return a[o]=l,a[s]=u,t(a);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}n=i}return e},e}function bn(){var e=function(){var e,t,r,n,i,a,o=fn,s=fn,l=hn,u=mn;function c(){var e,t,r,l=Math.min(o.length,s.length);return u!==mn&&(e=o[0],t=o[l-1],e>t&&(r=e,e=t,t=r),u=function(r){return Math.max(e,Math.min(t,r))}),n=l>2?vn:yn,i=a=null,h}function h(t){return null==t||isNaN(t=+t)?r:(i||(i=n(o.map(e),s,l)))(e(u(t)))}return h.invert=function(r){return u(t((a||(a=n(s,o.map(e),ct)))(r)))},h.domain=function(e){return arguments.length?(o=Array.from(e,dn),c()):o.slice()},h.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},h.rangeRound=function(e){return s=Array.from(e),l=pn,c()},h.clamp=function(e){return arguments.length?(u=!!e||mn,c()):u!==mn},h.interpolate=function(e){return arguments.length?(l=e,c()):l},h.unknown=function(e){return arguments.length?(r=e,h):r},function(r,n){return e=r,t=n,c()}}()(mn,mn);return e.copy=function(){return t=e,bn().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},xn.apply(e,arguments),_n(e)}function wn(e,t,r){this.k=e,this.x=t,this.y=r}function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},An.apply(null,arguments)}wn.prototype={constructor:wn,scale:function(e){return 1===e?this:new wn(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new wn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new wn(1,0,0),wn.prototype;var Cn={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null},En=function(e){if(e)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(Cn)};function Mn(e){var t=typeof e;if("number"===t||"bigint"===t||"string"===t||"boolean"===t||null==e)return e;if("function"==typeof e.clone)return e.clone();if(Array.isArray(e))return e.map((function(e){return Mn(e)}));if(e instanceof Date)return new Date(e.valueOf());if(Un(e))return e;if(si(e))return function(e,t){var r={};for(var n in e)Tn(e,n)&&(r[n]=t(e[n]));return r}(e,Mn);if("function"===t)return e;throw new TypeError("Cannot clone: unknown type of value (value: ".concat(e,")"))}function Sn(e,t){for(var r in t)Tn(t,r)&&(e[r]=t[r]);return e}function Dn(e,t){var r,n,i;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(n=0,i=e.length;n<i;n++)if(!Dn(e[n],t[n]))return!1;return!0}if("function"==typeof e)return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(r in e)if(!(r in t)||!Dn(e[r],t[r]))return!1;for(r in t)if(!(r in e))return!1;return!0}return e===t}function Tn(e,t){return e&&Object.hasOwnProperty.call(e,t)}function Nn(e,t){if(Pn(e,t))return e[t];if("function"==typeof e[t]&&zn(e,t))throw new Error('Cannot access method "'+t+'" as a property');throw new Error('No access to property "'+t+'"')}function In(e,t,r){if(Pn(e,t))return e[t]=r,r;throw new Error('No access to property "'+t+'"')}function Pn(e,t){return!(!function(e){return"object"==typeof e&&e&&e.constructor===Object}(e)&&!Array.isArray(e)||!Tn(Bn,t)&&(t in Object.prototype||t in Function.prototype))}function zn(e,t){return!(null==e||"function"!=typeof e[t]||Tn(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e)||!Tn(kn,t)&&(t in Object.prototype||t in Function.prototype))}An(En,Cn,{MATRIX_OPTIONS:["Matrix","Array"],NUMBER_OPTIONS:["number","BigNumber","Fraction"]});var Bn={length:!0,name:!0},kn={toString:!0,valueOf:!0,toLocaleString:!0};class Fn{constructor(e){this.wrappedObject=e,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter((e=>this.has(e))).values()}get(e){return Nn(this.wrappedObject,e)}set(e,t){return In(this.wrappedObject,e,t),this}has(e){return Pn(this.wrappedObject,e)&&e in this.wrappedObject}entries(){return On(this.keys(),(e=>[e,this.get(e)]))}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){Pn(this.wrappedObject,e)&&delete this.wrappedObject[e]}clear(){for(var e of this.keys())this.delete(e)}get size(){return Object.keys(this.wrappedObject).length}}class Rn{constructor(e,t,r){this.a=e,this.b=t,this.bKeys=r,this[Symbol.iterator]=this.entries}get(e){return this.bKeys.has(e)?this.b.get(e):this.a.get(e)}set(e,t){return this.bKeys.has(e)?this.b.set(e,t):this.a.set(e,t),this}has(e){return this.b.has(e)||this.a.has(e)}keys(){return new Set([...this.a.keys(),...this.b.keys()])[Symbol.iterator]()}entries(){return On(this.keys(),(e=>[e,this.get(e)]))}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){return this.bKeys.has(e)?this.b.delete(e):this.a.delete(e)}clear(){this.a.clear(),this.b.clear()}get size(){return[...this.keys()].length}}function On(e,t){return{next:()=>{var r=e.next();return r.done?r:{value:t(r.value),done:!1}}}}function Ln(){return new Map}function qn(e){if(!e)return Ln();if(li(e))return e;if(si(e))return new Fn(e);throw new Error("createMap can create maps from objects or Maps")}function jn(e){return"number"==typeof e}function Un(e){return!(!e||"object"!=typeof e||"function"!=typeof e.constructor)&&(!0===e.isBigNumber&&"object"==typeof e.constructor.prototype&&!0===e.constructor.prototype.isBigNumber||"function"==typeof e.constructor.isDecimal&&!0===e.constructor.isDecimal(e))}function Vn(e){return"bigint"==typeof e}function Zn(e){return e&&"object"==typeof e&&!0===Object.getPrototypeOf(e).isComplex||!1}function $n(e){return e&&"object"==typeof e&&!0===Object.getPrototypeOf(e).isFraction||!1}function Gn(e){return e&&!0===e.constructor.prototype.isUnit||!1}function Hn(e){return"string"==typeof e}var Wn=Array.isArray;function Xn(e){return e&&!0===e.constructor.prototype.isMatrix||!1}function Yn(e){return Array.isArray(e)||Xn(e)}function Kn(e){return e&&e.isDenseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function Jn(e){return e&&e.isSparseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function Qn(e){return e&&!0===e.constructor.prototype.isRange||!1}function ei(e){return e&&!0===e.constructor.prototype.isIndex||!1}function ti(e){return"boolean"==typeof e}function ri(e){return e&&!0===e.constructor.prototype.isResultSet||!1}function ni(e){return e&&!0===e.constructor.prototype.isHelp||!1}function ii(e){return"function"==typeof e}function ai(e){return e instanceof Date}function oi(e){return e instanceof RegExp}function si(e){return!(!e||"object"!=typeof e||e.constructor!==Object||Zn(e)||$n(e))}function li(e){return!!e&&(e instanceof Map||e instanceof Fn||"function"==typeof e.set&&"function"==typeof e.get&&"function"==typeof e.keys&&"function"==typeof e.has)}function ui(e){return null===e}function ci(e){return void 0===e}function hi(e){return e&&!0===e.isAccessorNode&&!0===e.constructor.prototype.isNode||!1}function pi(e){return e&&!0===e.isArrayNode&&!0===e.constructor.prototype.isNode||!1}function di(e){return e&&!0===e.isAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function fi(e){return e&&!0===e.isBlockNode&&!0===e.constructor.prototype.isNode||!1}function mi(e){return e&&!0===e.isConditionalNode&&!0===e.constructor.prototype.isNode||!1}function gi(e){return e&&!0===e.isConstantNode&&!0===e.constructor.prototype.isNode||!1}function yi(e){return gi(e)||Ai(e)&&1===e.args.length&&gi(e.args[0])&&"-+~".includes(e.op)}function vi(e){return e&&!0===e.isFunctionAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function xi(e){return e&&!0===e.isFunctionNode&&!0===e.constructor.prototype.isNode||!1}function _i(e){return e&&!0===e.isIndexNode&&!0===e.constructor.prototype.isNode||!1}function bi(e){return e&&!0===e.isNode&&!0===e.constructor.prototype.isNode||!1}function wi(e){return e&&!0===e.isObjectNode&&!0===e.constructor.prototype.isNode||!1}function Ai(e){return e&&!0===e.isOperatorNode&&!0===e.constructor.prototype.isNode||!1}function Ci(e){return e&&!0===e.isParenthesisNode&&!0===e.constructor.prototype.isNode||!1}function Ei(e){return e&&!0===e.isRangeNode&&!0===e.constructor.prototype.isNode||!1}function Mi(e){return e&&!0===e.isRelationalNode&&!0===e.constructor.prototype.isNode||!1}function Si(e){return e&&!0===e.isSymbolNode&&!0===e.constructor.prototype.isNode||!1}function Di(e){return e&&!0===e.constructor.prototype.isChain||!1}function Ti(e){var t=typeof e;return"object"===t?null===e?"null":Un(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}var Ni=new Set(["end"]);function Ii(e,t,r,n){function i(n){var i=function(e,t){for(var r={},n=0;n<t.length;n++){var i=t[n],a=e[i];void 0!==a&&(r[i]=a)}return r}(n,t.map(Pi));return function(e,t,r){if(!t.filter((e=>!function(e){return e&&"?"===e[0]}(e))).every((e=>void 0!==r[e]))){var n=t.filter((e=>void 0===r[e]));throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(n.map((e=>'"'.concat(e,'"'))).join(", "),"."))}}(e,t,n),r(i)}return i.isFactory=!0,i.fn=e,i.dependencies=t.slice().sort(),n&&(i.meta=n),i}function Pi(e){return e&&"?"===e[0]?e.slice(1):e}var zi=Ii("Node",["mathWithTransform"],(e=>{var{mathWithTransform:t}=e;return class{get type(){return"Node"}get isNode(){return!0}evaluate(e){return this.compile().evaluate(e)}compile(){var e=this._compile(t,{}),r={};return{evaluate:function(t){var n=qn(t);return function(e){for(var t of[...Ni])if(e.has(t))throw new Error('Scope contains an illegal symbol, "'+t+'" is a reserved keyword')}(n),e(n,r,null)}}}_compile(e,t){throw new Error("Method _compile must be implemented by type "+this.type)}forEach(e){throw new Error("Cannot run forEach on a Node interface")}map(e){throw new Error("Cannot run map on a Node interface")}_ifNode(e){if(!bi(e))throw new TypeError("Callback function must return a Node");return e}traverse(e){e(this,null,null),function e(t,r){t.forEach((function(t,n,i){r(t,n,i),e(t,r)}))}(this,e)}transform(e){return function t(r,n,i){var a=e(r,n,i);return a!==r?a:r.map(t)}(this,null,null)}filter(e){var t=[];return this.traverse((function(r,n,i){e(r,n,i)&&t.push(r)})),t}clone(){throw new Error("Cannot clone a Node interface")}cloneDeep(){return this.map((function(e){return e.cloneDeep()}))}equals(e){return!!e&&this.type===e.type&&Dn(this,e)}toString(e){var t=this._getCustomString(e);return void 0!==t?t:this._toString(e)}_toString(){throw new Error("_toString not implemented for "+this.type)}toJSON(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}toHTML(e){var t=this._getCustomString(e);return void 0!==t?t:this._toHTML(e)}_toHTML(){throw new Error("_toHTML not implemented for "+this.type)}toTex(e){var t=this._getCustomString(e);return void 0!==t?t:this._toTex(e)}_toTex(e){throw new Error("_toTex not implemented for "+this.type)}_getCustomString(e){if(e&&"object"==typeof e)switch(typeof e.handler){case"object":case"undefined":return;case"function":return e.handler(this,e);default:throw new TypeError("Object or function expected as callback")}}getIdentifier(){return this.type}getContent(){return this}}}),{isClass:!0,isNode:!0});function Bi(e){return Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bi(e)}function ki(e,t,r){return(t=function(e){var t=function(e){if("object"!=Bi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Bi(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fi(e){return"boolean"==typeof e||!!isFinite(e)&&e===Math.round(e)}function Ri(e,t){if("bigint"===t.number)try{BigInt(e)}catch(e){return t.numberFallback}return t.number}var Oi=Math.sign||function(e){return e>0?1:e<0?-1:0},Li=Math.log2||function(e){return Math.log(e)/Math.LN2},qi=Math.log10||function(e){return Math.log(e)/Math.LN10},ji=Math.log1p||function(e){return Math.log(e+1)},Ui=Math.cbrt||function(e){if(0===e)return e;var t,r=e<0;return r&&(e=-e),t=isFinite(e)?(e/((t=Math.exp(Math.log(e)/3))*t)+2*t)/3:e,r?-t:t},Vi=Math.expm1||function(e){return e>=2e-4||e<=-2e-4?Math.exp(e)-1:e+e*e/2+e*e*e/6};function Zi(e,t,r){var n={2:"0b",8:"0o",16:"0x"}[t],i="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!Fi(r))throw new Error("size must be an integer");if(e>2**(r-1)-1||e<-(2**(r-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!Fi(e))throw new Error("Value must be an integer");e<0&&(e+=2**r),i="i".concat(r)}var a="";return e<0&&(e=-e,a="-"),"".concat(a).concat(n).concat(e.toString(t)).concat(i)}function $i(e,t){if("function"==typeof t)return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var{notation:r,precision:n,wordSize:i}=Gi(t);switch(r){case"fixed":return Wi(e,n);case"exponential":return Xi(e,n);case"engineering":return function(e,t){if(isNaN(e)||!isFinite(e))return String(e);var r=Yi(Hi(e),t),n=r.exponent,i=r.coefficients,a=n%3==0?n:n<0?n-3-n%3:n-n%3;if(jn(t))for(;t>i.length||n-a+1>i.length;)i.push(0);else for(var o=Math.abs(n-a)-(i.length-1),s=0;s<o;s++)i.push(0);for(var l=Math.abs(n-a),u=1;l>0;)u++,l--;var c=i.slice(u).join(""),h=jn(t)&&c.length||c.match(/[1-9]/)?"."+c:"",p=i.slice(0,u).join("")+h+"e"+(n>=0?"+":"")+a.toString();return r.sign+p}(e,n);case"bin":return Zi(e,2,i);case"oct":return Zi(e,8,i);case"hex":return Zi(e,16,i);case"auto":return function(e,t,r){if(isNaN(e)||!isFinite(e))return String(e);var n=oa(null==r?void 0:r.lowerExp,-3),i=oa(null==r?void 0:r.upperExp,5),a=Hi(e),o=t?Yi(a,t):a;if(o.exponent<n||o.exponent>=i)return Xi(e,t);var s=o.coefficients,l=o.exponent;s.length<t&&(s=s.concat(Ki(t-s.length))),s=s.concat(Ki(l-s.length+1+(s.length<t?t-s.length:0)));var u=l>0?l:0;return u<(s=Ki(-l).concat(s)).length-1&&s.splice(u+1,0,"."),o.sign+s.join("")}(e,n,t).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function Gi(e){var t,r,n="auto";if(void 0!==e)if(jn(e))t=e;else if(Un(e))t=e.toNumber();else{if(!si(e))throw new Error("Unsupported type of options, number, BigNumber, or object expected");void 0!==e.precision&&(t=aa(e.precision,(()=>{throw new Error('Option "precision" must be a number or BigNumber')}))),void 0!==e.wordSize&&(r=aa(e.wordSize,(()=>{throw new Error('Option "wordSize" must be a number or BigNumber')}))),e.notation&&(n=e.notation)}return{notation:n,precision:t,wordSize:r}}function Hi(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var r=t[1],n=t[2],i=parseFloat(t[4]||"0"),a=n.indexOf(".");i+=-1!==a?a-1:n.length-1;var o=n.replace(".","").replace(/^0*/,(function(e){return i-=e.length,""})).replace(/0*$/,"").split("").map((function(e){return parseInt(e)}));return 0===o.length&&(o.push(0),i++),{sign:r,coefficients:o,exponent:i}}function Wi(e,t){if(isNaN(e)||!isFinite(e))return String(e);var r=Hi(e),n="number"==typeof t?Yi(r,r.exponent+1+t):r,i=n.coefficients,a=n.exponent+1,o=a+(t||0);return i.length<o&&(i=i.concat(Ki(o-i.length))),a<0&&(i=Ki(1-a).concat(i),a=1),a<i.length&&i.splice(a,0,0===a?"0.":"."),n.sign+i.join("")}function Xi(e,t){if(isNaN(e)||!isFinite(e))return String(e);var r=Hi(e),n=t?Yi(r,t):r,i=n.coefficients,a=n.exponent;i.length<t&&(i=i.concat(Ki(t-i.length)));var o=i.shift();return n.sign+o+(i.length>0?"."+i.join(""):"")+"e"+(a>=0?"+":"")+a}function Yi(e,t){for(var r={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},n=r.coefficients;t<=0;)n.unshift(0),r.exponent++,t++;if(n.length>t&&n.splice(t,n.length-t)[0]>=5){var i=t-1;for(n[i]++;10===n[i];)n.pop(),0===i&&(n.unshift(0),r.exponent++,i++),n[--i]++}return r}function Ki(e){for(var t=[],r=0;r<e;r++)t.push(0);return t}function Ji(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-8,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(r<=0)throw new Error("Relative tolerance must be greater than 0");if(n<0)throw new Error("Absolute tolerance must be at least 0");return!isNaN(e)&&!isNaN(t)&&(isFinite(e)&&isFinite(t)?e===t||Math.abs(e-t)<=Math.max(r*Math.max(Math.abs(e),Math.abs(t)),n):e===t)}var Qi=Math.acosh||function(e){return Math.log(Math.sqrt(e*e-1)+e)},ea=Math.asinh||function(e){return Math.log(Math.sqrt(e*e+1)+e)},ta=Math.atanh||function(e){return Math.log((1+e)/(1-e))/2},ra=Math.cosh||function(e){return(Math.exp(e)+Math.exp(-e))/2},na=Math.sinh||function(e){return(Math.exp(e)-Math.exp(-e))/2},ia=Math.tanh||function(e){var t=Math.exp(2*e);return(t-1)/(t+1)};function aa(e,t){return jn(e)?e:Un(e)?e.toNumber():void t()}function oa(e,t){return jn(e)?e:Un(e)?e.toNumber():t}function sa(e,t,r){var n=new(0,e.constructor)(2),i="";if(r){if(r<1)throw new Error("size must be in greater than 0");if(!Fi(r))throw new Error("size must be an integer");if(e.greaterThan(n.pow(r-1).sub(1))||e.lessThan(n.pow(r-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(r-1,", 2^").concat(r-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(n.pow(r))),i="i".concat(r)}switch(t){case 2:return"".concat(e.toBinary()).concat(i);case 8:return"".concat(e.toOctal()).concat(i);case 16:return"".concat(e.toHexadecimal()).concat(i);default:throw new Error("Base ".concat(t," not supported "))}}function la(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()}function ua(e,t){return jn(e)?e:Un(e)?e.toNumber():t}function ca(e,t){var r=e.length-t.length,n=e.length;return e.substring(r,n)===t}function ha(e,t){var r=function(e,t){return"number"==typeof e?$i(e,t):Un(e)?function(e,t){if("function"==typeof t)return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var{notation:r,precision:n,wordSize:i}=Gi(t);switch(r){case"fixed":return function(e,t){return e.toFixed(t)}(e,n);case"exponential":return la(e,n);case"engineering":return function(e,t){var r=e.e,n=r%3==0?r:r<0?r-3-r%3:r-r%3,i=e.mul(Math.pow(10,-n)).toPrecision(t);return i.includes("e")&&(i=new(0,e.constructor)(i).toFixed()),i+"e"+(r>=0?"+":"")+n.toString()}(e,n);case"bin":return sa(e,2,i);case"oct":return sa(e,8,i);case"hex":return sa(e,16,i);case"auto":var a=ua(null==t?void 0:t.lowerExp,-3),o=ua(null==t?void 0:t.upperExp,5);if(e.isZero())return"0";var s=e.toSignificantDigits(n),l=s.e;return(l>=a&&l<o?s.toFixed():la(e,n)).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}(e,t):function(e){return e&&"object"==typeof e&&"bigint"==typeof e.s&&"bigint"==typeof e.n&&"bigint"==typeof e.d||!1}(e)?t&&"decimal"===t.fraction?e.toString():"".concat(e.s*e.n,"/").concat(e.d):Array.isArray(e)?ma(e,t):Hn(e)?pa(e):"function"==typeof e?e.syntax?String(e.syntax):"function":e&&"object"==typeof e?"function"==typeof e.format?e.format(t):e&&e.toString(t)!=={}.toString()?e.toString(t):"{"+Object.keys(e).map((r=>pa(r)+": "+ha(e[r],t))).join(", ")+"}":String(e)}(e,t);return t&&"object"==typeof t&&"truncate"in t&&r.length>t.truncate?r.substring(0,t.truncate-3)+"...":r}function pa(e){for(var t=String(e),r="",n=0;n<t.length;){var i=t.charAt(n);r+=i in da?da[i]:i,n++}return'"'+r+'"'}var da={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function fa(e){var t=String(e);return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ma(e,t){if(Array.isArray(e)){for(var r="[",n=e.length,i=0;i<n;i++)0!==i&&(r+=", "),r+=ma(e[i],t);return r+"]"}return ha(e,t)}function ga(e,t){if(!Hn(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+Ti(e)+", index: 0)");if(!Hn(t))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+Ti(t)+", index: 1)");return e===t?0:e>t?1:-1}var ya="ObjectNode",va=Ii(ya,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e){if(super(),this.properties=e||{},e&&("object"!=typeof e||!Object.keys(e).every((function(t){return bi(e[t])}))))throw new TypeError("Object containing Nodes expected")}get type(){return ya}get isObjectNode(){return!0}_compile(e,t){var r={};for(var n in this.properties)if(Tn(this.properties,n)){var i=pa(n),a=JSON.parse(i),o=Nn(this.properties,n);r[a]=o._compile(e,t)}return function(e,t,n){var i={};for(var a in r)Tn(r,a)&&(i[a]=r[a](e,t,n));return i}}forEach(e){for(var t in this.properties)Tn(this.properties,t)&&e(this.properties[t],"properties["+pa(t)+"]",this)}map(e){var t={};for(var n in this.properties)Tn(this.properties,n)&&(t[n]=this._ifNode(e(this.properties[n],"properties["+pa(n)+"]",this)));return new r(t)}clone(){var e={};for(var t in this.properties)Tn(this.properties,t)&&(e[t]=this.properties[t]);return new r(e)}_toString(e){var t=[];for(var r in this.properties)Tn(this.properties,r)&&t.push(pa(r)+": "+this.properties[r].toString(e));return"{"+t.join(", ")+"}"}toJSON(){return{mathjs:ya,properties:this.properties}}static fromJSON(e){return new r(e.properties)}_toHTML(e){var t=[];for(var r in this.properties)Tn(this.properties,r)&&t.push('<span class="math-symbol math-property">'+fa(r)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[r].toHTML(e));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}_toTex(e){var t=[];for(var r in this.properties)Tn(this.properties,r)&&t.push("\\mathbf{"+r+":} & "+this.properties[r].toTex(e)+"\\\\");return"\\left\\{\\begin{array}{ll}"+t.join("\n")+"\\end{array}\\right\\}"}}return ki(r,"name",ya),r}),{isClass:!0,isNode:!0});function xa(e,t,r){if(!(this instanceof xa))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=r,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=(new Error).stack}function _a(e,t,r){if(!(this instanceof _a))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=r),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function ba(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function wa(e,t,r){var n,i=e.length;if(i!==t[r])throw new xa(i,t[r]);if(r<t.length-1){var a=r+1;for(n=0;n<i;n++){var o=e[n];if(!Array.isArray(o))throw new xa(t.length-1,t.length,"<");wa(e[n],t,a)}}else for(n=0;n<i;n++)if(Array.isArray(e[n]))throw new xa(t.length+1,t.length,">")}function Aa(e,t){if(0===t.length){if(Array.isArray(e))throw new xa(e.length,0)}else wa(e,t,0)}function Ca(e,t){var r=e.isMatrix?e._size:ba(e);t._sourceSize.forEach(((e,t)=>{if(null!==e&&e!==r[t])throw new xa(e,r[t])}))}function Ea(e,t){if(void 0!==e){if(!jn(e)||!Fi(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||"number"==typeof t&&e>=t)throw new _a(e,t)}}function Ma(e){for(var t=0;t<e._dimensions.length;++t){var r=e._dimensions[t];if(r._data&&Wn(r._data)){if(0===r._size[0])return!0}else if(r.isRange){if(r.start===r.end)return!0}else if(Hn(r)&&0===r.length)return!0}return!1}function Sa(e,t,r){if(!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");return t.forEach((function(e){if(!jn(e)||!Fi(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+ha(t)+")")})),(jn(e)||Un(e))&&(e=[e]),Da(e,t,0,void 0!==r?r:0),e}function Da(e,t,r,n){var i,a,o=e.length,s=t[r],l=Math.min(o,s);if(e.length=s,r<t.length-1){var u=r+1;for(i=0;i<l;i++)a=e[i],Array.isArray(a)||(a=[a],e[i]=a),Da(a,t,u,n);for(i=l;i<s;i++)a=[],e[i]=a,Da(a,t,u,n)}else{for(i=0;i<l;i++)for(;Array.isArray(e[i]);)e[i]=e[i][0];for(i=l;i<s;i++)e[i]=n}}function Ta(e,t){var r=Fa(e,!0),n=r.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new xa(0,n,"!=");var i=Ia(t=Na(t,n));if(n!==i)throw new xa(i,n,"!=");try{return function(e,t){for(var r,n=e,i=t.length-1;i>0;i--){var a=t[i];r=[];for(var o=n.length/a,s=0;s<o;s++)r.push(n.slice(s*a,(s+1)*a));n=r}return n}(r,t)}catch(e){if(e instanceof xa)throw new xa(i,n,"!=");throw e}}function Na(e,t){var r=Ia(e),n=e.slice(),i=e.indexOf(-1);if(e.indexOf(-1,i+1)>=0)throw new Error("More than one wildcard in sizes");if(i>=0){if(t%r!==0)throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-r);n[i]=-t/r}return n}function Ia(e){return e.reduce(((e,t)=>e*t),1)}function Pa(e,t){for(var r=t||ba(e);Array.isArray(e)&&1===e.length;)e=e[0],r.shift();for(var n=r.length;1===r[n-1];)n--;return n<r.length&&(e=za(e,n,0),r.length=n),e}function za(e,t,r){var n,i;if(r<t){var a=r+1;for(n=0,i=e.length;n<i;n++)e[n]=za(e[n],t,a)}else for(;Array.isArray(e);)e=e[0];return e}function Ba(e,t,r,n){var i=n||ba(e);if(r)for(var a=0;a<r;a++)e=[e],i.unshift(1);for(e=ka(e,t,0);i.length<t;)i.push(1);return e}function ka(e,t,r){var n,i;if(Array.isArray(e)){var a=r+1;for(n=0,i=e.length;n<i;n++)e[n]=ka(e[n],t,a)}else for(var o=r;o<t;o++)e=[e];return e}function Fa(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e))return e;if("boolean"!=typeof t)throw new TypeError("Boolean expected for second argument of flatten");var r=[];return t?function e(t){if(Array.isArray(t[0]))for(var n=0;n<t.length;n++)e(t[n]);else for(var i=0;i<t.length;i++)r.push(t[i])}(e):function e(t){for(var n=0;n<t.length;n++){var i=t[n];Array.isArray(i)?e(i):r.push(i)}}(e),r}function Ra(e,t){return Array.prototype.map.call(e,t)}function Oa(e,t){Array.prototype.forEach.call(e,t)}function La(e,t){if(1!==ba(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,t)}function qa(e,t){if(1!==ba(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,(e=>t.test(e)))}function ja(e,t){return Array.prototype.join.call(e,t)}function Ua(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;var t=[],r=0;t[0]={value:e[0],identifier:0};for(var n=1;n<e.length;n++)e[n]===e[n-1]?r++:r=0,t.push({value:e[n],identifier:r});return t}function Va(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;for(var t=[],r=0;r<e.length;r++)t.push(e[r].value);return t}function Za(e,t){for(var r,n=0,i=0;i<e.length;i++){var a=e[i],o=Array.isArray(a);if(0===i&&o&&(n=a.length),o&&a.length!==n)return;var s=o?Za(a,t):t(a);if(void 0===r)r=s;else if(r!==s)return"mixed"}return r}function $a(e,t,r,n){if(n<r){if(e.length!==t.length)throw new xa(e.length,t.length);for(var i=[],a=0;a<e.length;a++)i[a]=$a(e[a],t[a],r,n+1);return i}return e.concat(t)}function Ga(){var e=Array.prototype.slice.call(arguments,0,-1),t=Array.prototype.slice.call(arguments,-1);if(1===e.length)return e[0];if(e.length>1)return e.slice(1).reduce((function(e,r){return $a(e,r,t,0)}),e[0]);throw new Error("Wrong number of arguments in function concat")}function Ha(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=t.map((e=>e.length)),i=Math.max(...n),a=new Array(i).fill(null),o=0;o<t.length;o++)for(var s=t[o],l=n[o],u=0;u<l;u++){var c=i-l+u;s[u]>a[c]&&(a[c]=s[u])}for(var h=0;h<t.length;h++)Wa(t[h],a);return a}function Wa(e,t){for(var r=t.length,n=e.length,i=0;i<n;i++){var a=r-n+i;if(e[i]<t[a]&&e[i]>1||e[i]>t[a])throw new Error("shape mismatch: mismatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(n," with size ").concat(e[i]," to size ").concat(t[a]))}}function Xa(e,t){var r=ba(e);if(Dn(r,t))return e;Wa(r,t);var n,i,a,o=Ha(r,t),s=o.length,l=[...Array(s-r.length).fill(1),...r],u=function(e){return An([],e)}(e);r.length<s&&(r=ba(u=Ta(u,l)));for(var c=0;c<s;c++)r[c]<o[c]&&(n=u,i=o[c],a=c,r=ba(u=Ga(...Array(i).fill(n),a)));return u}function Ya(e,t){if(!Array.isArray(e))throw new Error("Array expected");var r=ba(e);if(t.length!==r.length)throw new xa(t.length,r.length);for(var n=0;n<t.length;n++)Ea(t[n],r[n]);return t.reduce(((e,t)=>e[t]),e)}function Ka(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return[];if(r)return function e(r){if(Array.isArray(r)){for(var n=r.length,i=Array(n),a=0;a<n;a++)i[a]=e(r[a]);return i}return t(r)}(e);var n=[];return function r(i,a){if(Array.isArray(i)){for(var o=i.length,s=Array(o),l=0;l<o;l++)n[a]=l,s[l]=r(i[l],a+1);return s}return t(i,n.slice(0,a),e)}(e,0)}function Ja(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==e.length)if(r)!function e(r){if(Array.isArray(r))for(var n=r.length,i=0;i<n;i++)e(r[i]);else t(r)}(e);else{var n=[];!function r(i,a){if(Array.isArray(i))for(var o=i.length,s=0;s<o;s++)n[a]=s,r(i[s],a+1);else t(i,n.slice(0,a),e)}(e,0)}}function Qa(e,t){return new Rn(e,new Fn(t),new Set(Object.keys(t)))}xa.prototype=new RangeError,xa.prototype.constructor=RangeError,xa.prototype.name="DimensionError",xa.prototype.isDimensionError=!0,_a.prototype=new RangeError,_a.prototype.constructor=RangeError,_a.prototype.name="IndexError",_a.prototype.isIndexError=!0;var eo=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function to(e,t){if(!t||"auto"!==t)return e;for(var r=e;Ci(r);)r=r.content;return r}function ro(e,t,r,n){var i=e;"keep"!==t&&(i=e.getContent());for(var a=i.getIdentifier(),o=null,s=0;s<eo.length;s++)if(a in eo[s]){o=s;break}if("OperatorNode:multiply"===a&&i.implicit&&"show"!==r){var l=to(i.args[0],t);gi(l)&&n&&"OperatorNode:divide"===n.getIdentifier()&&yi(to(n.args[0],t))||"OperatorNode:divide"===l.getIdentifier()&&yi(to(l.args[0],t))&&gi(to(l.args[1]))||(o+=1)}return o}function no(e,t){var r=e;"keep"!==t&&(r=e.getContent());var n=r.getIdentifier(),i=ro(r,t);if(null===i)return null;var a=eo[i][n];if(Tn(a,"associativity")){if("left"===a.associativity)return"left";if("right"===a.associativity)return"right";throw Error("'"+n+"' has the invalid associativity '"+a.associativity+"'.")}return null}function io(e,t,r){var n="keep"!==r?e.getContent():e,i="keep"!==r?e.getContent():t,a=n.getIdentifier(),o=i.getIdentifier(),s=ro(n,r);if(null===s)return null;var l=eo[s][a];if(Tn(l,"associativeWith")&&l.associativeWith instanceof Array){for(var u=0;u<l.associativeWith.length;u++)if(l.associativeWith[u]===o)return!0;return!1}return null}var ao=r(3144),oo={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},so={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},lo={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(so.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(so.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(so.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(so.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(so.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},fraction:{2:"\\frac{${args[0]}}{${args[1]}}"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(so.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(so.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : y^${args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(so.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(so.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(so.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(so.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(so.bitAnd,"${args[1]}\\right)")},bitNot:{1:so.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(so.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(so.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(so.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(so.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(so.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(so.and,"${args[1]}\\right)")},not:{1:so.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(so.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(so.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(so.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat(so.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(so.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(so.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(so.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(so.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(so.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(so.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(so.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(so.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(so.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},bigint:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(oo.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},uo={deg:"^\\circ"};function co(e){return ao(e,{preserveFormatting:!0})}function ho(e,t){return(t=void 0!==t&&t)?Tn(uo,e)?uo[e]:"\\mathrm{"+co(e)+"}":Tn(oo,e)?oo[e]:co(e)}var po="OperatorNode",fo=Ii(po,["Node"],(e=>{var{Node:t}=e;function r(e,t){var n=e;if("auto"===t)for(;Ci(n);)n=n.content;return!!gi(n)||!!Ai(n)&&r(n.args[0],t)}function n(e,t,n,i,a){var o,s=ro(e,t,n),l=no(e,t);if("all"===t||i.length>2&&"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier())return i.map((function(e){switch(e.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}}));switch(i.length){case 0:o=[];break;case 1:var u=ro(i[0],t,n,e);if(a&&null!==u){var c,h;if("keep"===t?(c=i[0].getIdentifier(),h=e.getIdentifier()):(c=i[0].getContent().getIdentifier(),h=e.getContent().getIdentifier()),!1===eo[s][h].latexLeftParens){o=[!1];break}if(!1===eo[u][c].latexParens){o=[!1];break}}if(null===u){o=[!1];break}if(u<=s){o=[!0];break}o=[!1];break;case 2:var p,d,f=ro(i[0],t,n,e),m=io(e,i[0],t);p=null!==f&&(f===s&&"right"===l&&!m||f<s);var g,y,v,x=ro(i[1],t,n,e),_=io(e,i[1],t);d=null!==x&&(x===s&&"left"===l&&!_||x<s),a&&("keep"===t?(g=e.getIdentifier(),y=e.args[0].getIdentifier(),v=e.args[1].getIdentifier()):(g=e.getContent().getIdentifier(),y=e.args[0].getContent().getIdentifier(),v=e.args[1].getContent().getIdentifier()),null!==f&&(!1===eo[s][g].latexLeftParens&&(p=!1),!1===eo[f][y].latexParens&&(p=!1)),null!==x&&(!1===eo[s][g].latexRightParens&&(d=!1),!1===eo[x][v].latexParens&&(d=!1))),o=[p,d];break;default:"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier()||(o=i.map((function(r){var i=ro(r,t,n,e),a=io(e,r,t),o=no(r,t);return null!==i&&(s===i&&l===o&&!a||i<s)})))}if(i.length>=2&&"OperatorNode:multiply"===e.getIdentifier()&&e.implicit&&"all"!==t&&"hide"===n)for(var b=1;b<o.length;++b)!r(i[b],t)||o[b-1]||"keep"===t&&Ci(i[b-1])||(o[b]=!0);return o}class i extends t{constructor(e,t,r,n,i){if(super(),"string"!=typeof e)throw new TypeError('string expected for parameter "op"');if("string"!=typeof t)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(r)||!r.every(bi))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=!0===n,this.isPercentage=!0===i,this.op=e,this.fn=t,this.args=r||[]}get type(){return po}get isOperatorNode(){return!0}_compile(e,t){if("string"!=typeof this.fn||!zn(e,this.fn))throw e[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var r=Nn(e,this.fn),n=Ra(this.args,(function(r){return r._compile(e,t)}));if("function"==typeof r&&!0===r.rawArgs){var i=this.args;return function(t,n,a){return r(i,e,Qa(t,n))}}if(1===n.length){var a=n[0];return function(e,t,n){return r(a(e,t,n))}}if(2===n.length){var o=n[0],s=n[1];return function(e,t,n){return r(o(e,t,n),s(e,t,n))}}return function(e,t,i){return r.apply(null,Ra(n,(function(r){return r(e,t,i)})))}}forEach(e){for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=[],r=0;r<this.args.length;r++)t[r]=this._ifNode(e(this.args[r],"args["+r+"]",this));return new i(this.op,this.fn,t,this.implicit,this.isPercentage)}clone(){return new i(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}isUnary(){return 1===this.args.length}isBinary(){return 2===this.args.length}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=e&&e.implicit?e.implicit:"hide",i=this.args,a=n(this,t,r,i,!1);if(1===i.length){var o=no(this,t),s=i[0].toString(e);a[0]&&(s="("+s+")");var l=/[a-zA-Z]+/.test(this.op);return"right"===o?this.op+(l?" ":"")+s:"left"===o?s+(l?" ":"")+this.op:s+this.op}if(2===i.length){var u=i[0].toString(e),c=i[1].toString(e);return a[0]&&(u="("+u+")"),a[1]&&(c="("+c+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?u+" "+c:u+" "+this.op+" "+c}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var h=i.map((function(t,r){return t=t.toString(e),a[r]&&(t="("+t+")"),t}));return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?h.join(" "):h.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"}toJSON(){return{mathjs:po,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}static fromJSON(e){return new i(e.op,e.fn,e.args,e.implicit,e.isPercentage)}_toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=e&&e.implicit?e.implicit:"hide",i=this.args,a=n(this,t,r,i,!1);if(1===i.length){var o=no(this,t),s=i[0].toHTML(e);return a[0]&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),"right"===o?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+fa(this.op)+"</span>"+s:s+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+fa(this.op)+"</span>"}if(2===i.length){var l=i[0].toHTML(e),u=i[1].toHTML(e);return a[0]&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),a[1]&&(u='<span class="math-parenthesis math-round-parenthesis">(</span>'+u+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?l+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+u:l+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+fa(this.op)+"</span>"+u}var c=i.map((function(t,r){return t=t.toHTML(e),a[r]&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t}));return i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())?this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===r?c.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):c.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+fa(this.op)+"</span>"):'<span class="math-function">'+fa(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+c.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=e&&e.implicit?e.implicit:"hide",i=this.args,a=n(this,t,r,i,!0),o=so[this.fn];if(o=void 0===o?this.op:o,1===i.length){var s=no(this,t),l=i[0].toTex(e);return a[0]&&(l="\\left(".concat(l,"\\right)")),"right"===s?o+l:l+o}if(2===i.length){var u=i[0],c=u.toTex(e);a[0]&&(c="\\left(".concat(c,"\\right)"));var h,p=i[1].toTex(e);switch(a[1]&&(p="\\left(".concat(p,"\\right)")),h="keep"===t?u.getIdentifier():u.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return o+"{"+c+"}{"+p+"}";case"OperatorNode:pow":switch(c="{"+c+"}",p="{"+p+"}",h){case"ConditionalNode":case"OperatorNode:divide":c="\\left(".concat(c,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&"hide"===r)return c+"~"+p}return c+o+p}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var d=i.map((function(t,r){return t=t.toTex(e),a[r]&&(t="\\left(".concat(t,"\\right)")),t}));return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit&&"hide"===r?d.join("~"):d.join(o)}return"\\mathrm{"+this.fn+"}\\left("+i.map((function(t){return t.toTex(e)})).join(",")+"\\right)"}getIdentifier(){return this.type+":"+this.fn}}return ki(i,"name",po),i}),{isClass:!0,isNode:!0}),mo="ParenthesisNode",go=Ii(mo,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e){if(super(),!bi(e))throw new TypeError('Node expected for parameter "content"');this.content=e}get type(){return mo}get isParenthesisNode(){return!0}_compile(e,t){return this.content._compile(e,t)}getContent(){return this.content.getContent()}forEach(e){e(this.content,"content",this)}map(e){var t=e(this.content,"content",this);return new r(t)}clone(){return new r(this.content)}_toString(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"("+this.content.toString(e)+")":this.content.toString(e)}toJSON(){return{mathjs:mo,content:this.content}}static fromJSON(e){return new r(e.content)}_toHTML(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(e)}_toTex(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"\\left(".concat(this.content.toTex(e),"\\right)"):this.content.toTex(e)}}return ki(r,"name",mo),r}),{isClass:!0,isNode:!0}),yo="RelationalNode",vo=Ii(yo,["Node"],(e=>{var{Node:t}=e,r={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="};class n extends t{constructor(e,t){if(super(),!Array.isArray(e))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(t))throw new TypeError("Parameter params must be an array");if(e.length!==t.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=e,this.params=t}get type(){return yo}get isRelationalNode(){return!0}_compile(e,t){var r=this,n=this.params.map((r=>r._compile(e,t)));return function(t,i,a){for(var o,s=n[0](t,i,a),l=0;l<r.conditionals.length;l++)if(o=s,s=n[l+1](t,i,a),!Nn(e,r.conditionals[l])(o,s))return!1;return!0}}forEach(e){this.params.forEach(((t,r)=>e(t,"params["+r+"]",this)),this)}map(e){return new n(this.conditionals.slice(),this.params.map(((t,r)=>this._ifNode(e(t,"params["+r+"]",this))),this))}clone(){return new n(this.conditionals,this.params)}_toString(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=ro(this,t,e&&e.implicit),i=this.params.map((function(r,i){var a=ro(r,t,e&&e.implicit);return"all"===t||null!==a&&a<=n?"("+r.toString(e)+")":r.toString(e)})),a=i[0],o=0;o<this.conditionals.length;o++)a+=" "+r[this.conditionals[o]],a+=" "+i[o+1];return a}toJSON(){return{mathjs:yo,conditionals:this.conditionals,params:this.params}}static fromJSON(e){return new n(e.conditionals,e.params)}_toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=ro(this,t,e&&e.implicit),i=this.params.map((function(r,i){var a=ro(r,t,e&&e.implicit);return"all"===t||null!==a&&a<=n?'<span class="math-parenthesis math-round-parenthesis">(</span>'+r.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':r.toHTML(e)})),a=i[0],o=0;o<this.conditionals.length;o++)a+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+fa(r[this.conditionals[o]])+"</span>"+i[o+1];return a}_toTex(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=ro(this,t,e&&e.implicit),n=this.params.map((function(n,i){var a=ro(n,t,e&&e.implicit);return"all"===t||null!==a&&a<=r?"\\left("+n.toTex(e)+"\right)":n.toTex(e)})),i=n[0],a=0;a<this.conditionals.length;a++)i+=so[this.conditionals[a]]+n[a+1];return i}}return ki(n,"name",yo),n}),{isClass:!0,isNode:!0}),xo="ArrayNode",_o=Ii(xo,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e){if(super(),this.items=e||[],!Array.isArray(this.items)||!this.items.every(bi))throw new TypeError("Array containing Nodes expected")}get type(){return xo}get isArrayNode(){return!0}_compile(e,t){var r=Ra(this.items,(function(r){return r._compile(e,t)}));if("Array"!==e.config.matrix){var n=e.matrix;return function(e,t,i){return n(Ra(r,(function(r){return r(e,t,i)})))}}return function(e,t,n){return Ra(r,(function(r){return r(e,t,n)}))}}forEach(e){for(var t=0;t<this.items.length;t++)e(this.items[t],"items["+t+"]",this)}map(e){for(var t=[],n=0;n<this.items.length;n++)t[n]=this._ifNode(e(this.items[n],"items["+n+"]",this));return new r(t)}clone(){return new r(this.items.slice(0))}_toString(e){return"["+this.items.map((function(t){return t.toString(e)})).join(", ")+"]"}toJSON(){return{mathjs:xo,items:this.items}}static fromJSON(e){return new r(e.items)}_toHTML(e){return'<span class="math-parenthesis math-square-parenthesis">[</span>'+this.items.map((function(t){return t.toHTML(e)})).join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){return function t(r,n){var i=r.some(pi)&&!r.every(pi),a=n||i,o=a?"&":"\\\\",s=r.map((function(r){return r.items?t(r.items,!n):r.toTex(e)})).join(o);return i||!a||a&&!n?"\\begin{bmatrix}"+s+"\\end{bmatrix}":s}(this.items,!1)}}return ki(r,"name",xo),r}),{isClass:!0,isNode:!0}),bo="BlockNode",wo=Ii(bo,["ResultSet","Node"],(e=>{var{ResultSet:t,Node:r}=e;class n extends r{constructor(e){if(super(),!Array.isArray(e))throw new Error("Array expected");this.blocks=e.map((function(e){var t=e&&e.node,r=!e||void 0===e.visible||e.visible;if(!bi(t))throw new TypeError('Property "node" must be a Node');if("boolean"!=typeof r)throw new TypeError('Property "visible" must be a boolean');return{node:t,visible:r}}))}get type(){return bo}get isBlockNode(){return!0}_compile(e,r){var n=Ra(this.blocks,(function(t){return{evaluate:t.node._compile(e,r),visible:t.visible}}));return function(e,r,i){var a=[];return Oa(n,(function(t){var n=t.evaluate(e,r,i);t.visible&&a.push(n)})),new t(a)}}forEach(e){for(var t=0;t<this.blocks.length;t++)e(this.blocks[t].node,"blocks["+t+"].node",this)}map(e){for(var t=[],r=0;r<this.blocks.length;r++){var i=this.blocks[r],a=this._ifNode(e(i.node,"blocks["+r+"].node",this));t[r]={node:a,visible:i.visible}}return new n(t)}clone(){var e=this.blocks.map((function(e){return{node:e.node,visible:e.visible}}));return new n(e)}_toString(e){return this.blocks.map((function(t){return t.node.toString(e)+(t.visible?"":";")})).join("\n")}toJSON(){return{mathjs:bo,blocks:this.blocks}}static fromJSON(e){return new n(e.blocks)}_toHTML(e){return this.blocks.map((function(t){return t.node.toHTML(e)+(t.visible?"":'<span class="math-separator">;</span>')})).join('<span class="math-separator"><br /></span>')}_toTex(e){return this.blocks.map((function(t){return t.node.toTex(e)+(t.visible?"":";")})).join("\\;\\;\n")}}return ki(n,"name",bo),n}),{isClass:!0,isNode:!0}),Ao="ConditionalNode",Co=Ii(Ao,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e,t,r){if(super(),!bi(e))throw new TypeError("Parameter condition must be a Node");if(!bi(t))throw new TypeError("Parameter trueExpr must be a Node");if(!bi(r))throw new TypeError("Parameter falseExpr must be a Node");this.condition=e,this.trueExpr=t,this.falseExpr=r}get type(){return Ao}get isConditionalNode(){return!0}_compile(e,t){var r=this.condition._compile(e,t),n=this.trueExpr._compile(e,t),i=this.falseExpr._compile(e,t);return function(e,t,a){return function(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e)return!!e;if(e){if(Un(e))return!e.isZero();if(Zn(e))return!(!e.re&&!e.im);if(Gn(e))return!!e.value}if(null==e)return!1;throw new TypeError('Unsupported type of condition "'+Ti(e)+'"')}(r(e,t,a))?n(e,t,a):i(e,t,a)}}forEach(e){e(this.condition,"condition",this),e(this.trueExpr,"trueExpr",this),e(this.falseExpr,"falseExpr",this)}map(e){return new r(this._ifNode(e(this.condition,"condition",this)),this._ifNode(e(this.trueExpr,"trueExpr",this)),this._ifNode(e(this.falseExpr,"falseExpr",this)))}clone(){return new r(this.condition,this.trueExpr,this.falseExpr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=ro(this,t,e&&e.implicit),n=this.condition.toString(e),i=ro(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==i&&i<=r)&&(n="("+n+")");var a=this.trueExpr.toString(e),o=ro(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==o&&o<=r)&&(a="("+a+")");var s=this.falseExpr.toString(e),l=ro(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==l&&l<=r)&&(s="("+s+")"),n+" ? "+a+" : "+s}toJSON(){return{mathjs:Ao,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}static fromJSON(e){return new r(e.condition,e.trueExpr,e.falseExpr)}_toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=ro(this,t,e&&e.implicit),n=this.condition.toHTML(e),i=ro(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==i&&i<=r)&&(n='<span class="math-parenthesis math-round-parenthesis">(</span>'+n+'<span class="math-parenthesis math-round-parenthesis">)</span>');var a=this.trueExpr.toHTML(e),o=ro(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==o&&o<=r)&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>');var s=this.falseExpr.toHTML(e),l=ro(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==l&&l<=r)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),n+'<span class="math-operator math-conditional-operator">?</span>'+a+'<span class="math-operator math-conditional-operator">:</span>'+s}_toTex(e){return"\\begin{cases} {"+this.trueExpr.toTex(e)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(e)+"}\\\\{"+this.falseExpr.toTex(e)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}return ki(r,"name",Ao),r}),{isClass:!0,isNode:!0}),Eo="ConstantNode",Mo=Ii(Eo,["Node"],(e=>{var{Node:t}=e;class r extends t{constructor(e){super(),this.value=e}get type(){return Eo}get isConstantNode(){return!0}_compile(e,t){var r=this.value;return function(){return r}}forEach(e){}map(e){return this.clone()}clone(){return new r(this.value)}_toString(e){return ha(this.value,e)}_toHTML(e){var t=this._toString(e);switch(Ti(this.value)){case"number":case"bigint":case"BigNumber":case"Fraction":return'<span class="math-number">'+t+"</span>";case"string":return'<span class="math-string">'+t+"</span>";case"boolean":return'<span class="math-boolean">'+t+"</span>";case"null":return'<span class="math-null-symbol">'+t+"</span>";case"undefined":return'<span class="math-undefined">'+t+"</span>";default:return'<span class="math-symbol">'+t+"</span>"}}toJSON(){return{mathjs:Eo,value:this.value}}static fromJSON(e){return new r(e.value)}_toTex(e){var t=this._toString(e),r=Ti(this.value);switch(r){case"string":return"\\mathtt{"+co(t)+"}";case"number":case"BigNumber":if(!("BigNumber"===r?this.value.isFinite():isFinite(this.value)))return this.value.valueOf()<0?"-\\infty":"\\infty";var n=t.toLowerCase().indexOf("e");return-1!==n?t.substring(0,n)+"\\cdot10^{"+t.substring(n+1)+"}":t;case"bigint":return t.toString();case"Fraction":return this.value.toLatex();default:return t}}}return ki(r,"name",Eo),r}),{isClass:!0,isNode:!0}),So="RangeNode",Do=Ii(So,["Node"],(e=>{var{Node:t}=e;function r(e,t,r){var n=ro(e,t,r),i={},a=ro(e.start,t,r);if(i.start=null!==a&&a<=n||"all"===t,e.step){var o=ro(e.step,t,r);i.step=null!==o&&o<=n||"all"===t}var s=ro(e.end,t,r);return i.end=null!==s&&s<=n||"all"===t,i}class n extends t{constructor(e,t,r){if(super(),!bi(e))throw new TypeError("Node expected");if(!bi(t))throw new TypeError("Node expected");if(r&&!bi(r))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=e,this.end=t,this.step=r||null}get type(){return So}get isRangeNode(){return!0}needsEnd(){return this.filter((function(e){return Si(e)&&"end"===e.name})).length>0}_compile(e,t){var r=e.range,n=this.start._compile(e,t),i=this.end._compile(e,t);if(this.step){var a=this.step._compile(e,t);return function(e,t,o){return r(n(e,t,o),i(e,t,o),a(e,t,o))}}return function(e,t,a){return r(n(e,t,a),i(e,t,a))}}forEach(e){e(this.start,"start",this),e(this.end,"end",this),this.step&&e(this.step,"step",this)}map(e){return new n(this._ifNode(e(this.start,"start",this)),this._ifNode(e(this.end,"end",this)),this.step&&this._ifNode(e(this.step,"step",this)))}clone(){return new n(this.start,this.end,this.step&&this.step)}_toString(e){var t,n=r(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),i=this.start.toString(e);if(n.start&&(i="("+i+")"),t=i,this.step){var a=this.step.toString(e);n.step&&(a="("+a+")"),t+=":"+a}var o=this.end.toString(e);return n.end&&(o="("+o+")"),t+":"+o}toJSON(){return{mathjs:So,start:this.start,end:this.end,step:this.step}}static fromJSON(e){return new n(e.start,e.end,e.step)}_toHTML(e){var t,n=r(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),i=this.start.toHTML(e);if(n.start&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t=i,this.step){var a=this.step.toHTML(e);n.step&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+a}var o=this.end.toHTML(e);return n.end&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+'<span class="math-operator math-range-operator">:</span>'+o}_toTex(e){var t=r(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),n=this.start.toTex(e);if(t.start&&(n="\\left(".concat(n,"\\right)")),this.step){var i=this.step.toTex(e);t.step&&(i="\\left(".concat(i,"\\right)")),n+=":"+i}var a=this.end.toTex(e);return t.end&&(a="\\left(".concat(a,"\\right)")),n+":"+a}}return ki(n,"name",So),n}),{isClass:!0,isNode:!0}),To=Ii("reviver",["classes"],(e=>{var{classes:t}=e;return function(e,r){var n=t[r&&r.mathjs];return n&&"function"==typeof n.fromJSON?n.fromJSON(r):r}})),No=Ii("Chain",["?on","math","typed"],(e=>{var{on:t,math:r,typed:n}=e;function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");Di(e)?this.value=e.value:this.value=e}function a(e,t){!function(e,r){var n,i=!0;Object.defineProperty(e,r,{get:function(){return i&&(n=function(){var e=t();if("function"==typeof e)return o(e)}(),i=!1),n},set:function(e){n=e,i=!1},configurable:!0,enumerable:!0})}(i.prototype,e)}function o(e){return function(){if(0===arguments.length)return new i(e(this.value));for(var t=[this.value],r=0;r<arguments.length;r++)t[r+1]=arguments[r];if(n.isTypedFunction(e)){var a=n.resolve(e,t);if(1===a.params.length)throw new Error("chain function "+e.name+" cannot match rest parameter between chain value and additional arguments.");return new i(a.implementation.apply(e,t))}return new i(e.apply(e,t))}}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return ha(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(e){return new i(e.value)},i.createProxy=function(e,t){if("string"==typeof e)l=e,"function"==typeof(u=t)&&(i.prototype[l]=o(u));else{var r=function(t){Tn(e,t)&&void 0===s[t]&&a(t,(()=>e[t]))};for(var n in e)r(n)}var l,u};var s={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return i.createProxy(r),t&&t("import",(function(e,t,r){r||a(e,t)})),i}),{isClass:!0}),Io="FunctionAssignmentNode",Po=Ii(Io,["typed","Node"],(e=>{var{typed:t,Node:r}=e;function n(e,t,r){var n=ro(e,t,r),i=ro(e.expr,t,r);return"all"===t||null!==i&&i<=n}class i extends r{constructor(e,t,r){if(super(),"string"!=typeof e)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(t))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!bi(r))throw new TypeError('Node expected for parameter "expr"');if(Ni.has(e))throw new Error('Illegal function name, "'+e+'" is a reserved keyword');var n=new Set;for(var i of t){var a="string"==typeof i?i:i.name;if(n.has(a))throw new Error('Duplicate parameter name "'.concat(a,'"'));n.add(a)}this.name=e,this.params=t.map((function(e){return e&&e.name||e})),this.types=t.map((function(e){return e&&e.type||"any"})),this.expr=r}get type(){return Io}get isFunctionAssignmentNode(){return!0}_compile(e,r){var n=Object.create(r);Oa(this.params,(function(e){n[e]=!0}));var i=this.expr._compile(e,n),a=this.name,o=this.params,s=ja(this.types,","),l=a+"("+ja(this.params,", ")+")";return function(e,r,n){var u={};u[s]=function(){for(var t=Object.create(r),a=0;a<o.length;a++)t[o[a]]=arguments[a];return i(e,t,n)};var c=t(a,u);return c.syntax=l,e.set(a,c),c}}forEach(e){e(this.expr,"expr",this)}map(e){var t=this._ifNode(e(this.expr,"expr",this));return new i(this.name,this.params.slice(0),t)}clone(){return new i(this.name,this.params.slice(0),this.expr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=this.expr.toString(e);return n(this,t,e&&e.implicit)&&(r="("+r+")"),this.name+"("+this.params.join(", ")+") = "+r}toJSON(){var e=this.types;return{mathjs:Io,name:this.name,params:this.params.map((function(t,r){return{name:t,type:e[r]}})),expr:this.expr}}static fromJSON(e){return new i(e.name,e.params,e.expr)}_toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=[],i=0;i<this.params.length;i++)r.push('<span class="math-symbol math-parameter">'+fa(this.params[i])+"</span>");var a=this.expr.toHTML(e);return n(this,t,e&&e.implicit)&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+fa(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+r.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+a}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",r=this.expr.toTex(e);return n(this,t,e&&e.implicit)&&(r="\\left(".concat(r,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(ho).join(",")+"\\right)="+r}}return ki(i,"name",Io),i}),{isClass:!0,isNode:!0}),zo="chain",Bo=Ii(zo,["typed","Chain"],(e=>{var{typed:t,Chain:r}=e;return t(zo,{"":function(){return new r},any:function(e){return new r(e)}})}));function ko(e){return e&&e.isIndexError?new _a(e.index+1,e.min+1,void 0!==e.max?e.max+1:void 0):e}function Fo(e){var{subset:t}=e;return function(e,r){try{if(Array.isArray(e))return t(e,r);if(e&&"function"==typeof e.subset)return e.subset(r);if("string"==typeof e)return t(e,r);if("object"==typeof e){if(!r.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return Nn(e,r.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(e){throw ko(e)}}}var Ro="AccessorNode",Oo=Ii(Ro,["subset","Node"],(e=>{var{subset:t,Node:r}=e,n=Fo({subset:t});function i(e){return!(hi(e)||pi(e)||gi(e)||xi(e)||wi(e)||Ci(e)||Si(e))}class a extends r{constructor(e,t){if(super(),!bi(e))throw new TypeError('Node expected for parameter "object"');if(!_i(t))throw new TypeError('IndexNode expected for parameter "index"');this.object=e,this.index=t}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return Ro}get isAccessorNode(){return!0}_compile(e,t){var r=this.object._compile(e,t),i=this.index._compile(e,t);if(this.index.isObjectProperty()){var a=this.index.getObjectProperty();return function(e,t,n){return Nn(r(e,t,n),a)}}return function(e,t,a){var o=r(e,t,a),s=i(e,t,o);return n(o,s)}}forEach(e){e(this.object,"object",this),e(this.index,"index",this)}map(e){return new a(this._ifNode(e(this.object,"object",this)),this._ifNode(e(this.index,"index",this)))}clone(){return new a(this.object,this.index)}_toString(e){var t=this.object.toString(e);return i(this.object)&&(t="("+t+")"),t+this.index.toString(e)}_toHTML(e){var t=this.object.toHTML(e);return i(this.object)&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+this.index.toHTML(e)}_toTex(e){var t=this.object.toTex(e);return i(this.object)&&(t="\\left(' + object + '\\right)"),t+this.index.toTex(e)}toJSON(){return{mathjs:Ro,object:this.object,index:this.index}}static fromJSON(e){return new a(e.object,e.index)}}return ki(a,"name",Ro),a}),{isClass:!0,isNode:!0}),Lo="AssignmentNode",qo=Ii(Lo,["subset","?matrix","Node"],(e=>{var{subset:t,matrix:r,Node:n}=e,i=Fo({subset:t}),a=function(e){var{subset:t,matrix:r}=e;return function(e,n,i){try{if(Array.isArray(e))return r(e).subset(n,i).valueOf().forEach(((t,r)=>{e[r]=t})),e;if(e&&"function"==typeof e.subset)return e.subset(n,i);if("string"==typeof e)return t(e,n,i);if("object"==typeof e){if(!n.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return In(e,n.getObjectProperty(),i),e}throw new TypeError("Cannot apply index: unsupported type of object")}catch(e){throw ko(e)}}}({subset:t,matrix:r});function o(e,t,r){t||(t="keep");var n=ro(e,t,r),i=ro(e.value,t,r);return"all"===t||null!==i&&i<=n}class s extends n{constructor(e,t,r){if(super(),this.object=e,this.index=r?t:null,this.value=r||t,!Si(e)&&!hi(e))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(Si(e)&&"end"===e.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!_i(this.index))throw new TypeError('IndexNode expected as "index"');if(!bi(this.value))throw new TypeError('Node expected as "value"')}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return Lo}get isAssignmentNode(){return!0}_compile(e,t){var r=this.object._compile(e,t),n=this.index?this.index._compile(e,t):null,o=this.value._compile(e,t),s=this.object.name;if(this.index){if(this.index.isObjectProperty()){var l=this.index.getObjectProperty();return function(e,t,n){var i=r(e,t,n),a=o(e,t,n);return In(i,l,a),a}}if(Si(this.object))return function(e,t,i){var l=r(e,t,i),u=o(e,t,i),c=n(e,t,l);return e.set(s,a(l,c,u)),u};var u=this.object.object._compile(e,t);if(this.object.index.isObjectProperty()){var c=this.object.index.getObjectProperty();return function(e,t,r){var i=u(e,t,r),s=Nn(i,c),l=n(e,t,s),h=o(e,t,r);return In(i,c,a(s,l,h)),h}}var h=this.object.index._compile(e,t);return function(e,t,r){var s=u(e,t,r),l=h(e,t,s),c=i(s,l),p=n(e,t,c),d=o(e,t,r);return a(s,l,a(c,p,d)),d}}if(!Si(this.object))throw new TypeError("SymbolNode expected as object");return function(e,t,r){var n=o(e,t,r);return e.set(s,n),n}}forEach(e){e(this.object,"object",this),this.index&&e(this.index,"index",this),e(this.value,"value",this)}map(e){var t=this._ifNode(e(this.object,"object",this)),r=this.index?this._ifNode(e(this.index,"index",this)):null,n=this._ifNode(e(this.value,"value",this));return new s(t,r,n)}clone(){return new s(this.object,this.index,this.value)}_toString(e){var t=this.object.toString(e),r=this.index?this.index.toString(e):"",n=this.value.toString(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(n="("+n+")"),t+r+" = "+n}toJSON(){return{mathjs:Lo,object:this.object,index:this.index,value:this.value}}static fromJSON(e){return new s(e.object,e.index,e.value)}_toHTML(e){var t=this.object.toHTML(e),r=this.index?this.index.toHTML(e):"",n=this.value.toHTML(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(n='<span class="math-paranthesis math-round-parenthesis">(</span>'+n+'<span class="math-paranthesis math-round-parenthesis">)</span>'),t+r+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+n}_toTex(e){var t=this.object.toTex(e),r=this.index?this.index.toTex(e):"",n=this.value.toTex(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(n="\\left(".concat(n,"\\right)")),t+r+"="+n}}return ki(s,"name",Lo),s}),{isClass:!0,isNode:!0}),jo="IndexNode",Uo=Ii(jo,["Node","size"],(e=>{var{Node:t,size:r}=e;class n extends t{constructor(e,t){if(super(),this.dimensions=e,this.dotNotation=t||!1,!Array.isArray(e)||!e.every(bi))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}get type(){return jo}get isIndexNode(){return!0}_compile(e,t){var n=Ra(this.dimensions,(function(n,i){if(n.filter((e=>e.isSymbolNode&&"end"===e.name)).length>0){var a=Object.create(t);a.end=!0;var o=n._compile(e,a);return function(e,t,n){if(!Xn(n)&&!Wn(n)&&!Hn(n))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+Ti(n));var a=r(n).valueOf(),s=Object.create(t);return s.end=a[i],o(e,s,n)}}return n._compile(e,t)})),i=Nn(e,"index");return function(e,t,r){var a=Ra(n,(function(n){return n(e,t,r)}));return i(...a)}}forEach(e){for(var t=0;t<this.dimensions.length;t++)e(this.dimensions[t],"dimensions["+t+"]",this)}map(e){for(var t=[],r=0;r<this.dimensions.length;r++)t[r]=this._ifNode(e(this.dimensions[r],"dimensions["+r+"]",this));return new n(t,this.dotNotation)}clone(){return new n(this.dimensions.slice(0),this.dotNotation)}isObjectProperty(){return 1===this.dimensions.length&&gi(this.dimensions[0])&&"string"==typeof this.dimensions[0].value}getObjectProperty(){return this.isObjectProperty()?this.dimensions[0].value:null}_toString(e){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}toJSON(){return{mathjs:jo,dimensions:this.dimensions,dotNotation:this.dotNotation}}static fromJSON(e){return new n(e.dimensions,e.dotNotation)}_toHTML(e){for(var t=[],r=0;r<this.dimensions.length;r++)t[r]=this.dimensions[r].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+fa(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){var t=this.dimensions.map((function(t){return t.toTex(e)}));return this.dotNotation?"."+this.getObjectProperty():"_{"+t.join(",")+"}"}}return ki(n,"name",jo),n}),{isClass:!0,isNode:!0}),Vo=Ii("SymbolNode",["math","?Unit","Node"],(e=>{var{math:t,Unit:r,Node:n}=e;function i(e){return!!r&&r.isValuelessUnit(e)}class a extends n{constructor(e){if(super(),"string"!=typeof e)throw new TypeError('String expected for parameter "name"');this.name=e}get type(){return"SymbolNode"}get isSymbolNode(){return!0}_compile(e,t){var n=this.name;if(!0===t[n])return function(e,t,r){return Nn(t,n)};if(n in e)return function(t,r,i){return t.has(n)?t.get(n):Nn(e,n)};var o=i(n);return function(e,t,i){return e.has(n)?e.get(n):o?new r(null,n):a.onUndefinedSymbol(n)}}forEach(e){}map(e){return this.clone()}static onUndefinedSymbol(e){throw new Error("Undefined symbol "+e)}clone(){return new a(this.name)}_toString(e){return this.name}_toHTML(e){var t=fa(this.name);return"true"===t||"false"===t?'<span class="math-symbol math-boolean">'+t+"</span>":"i"===t?'<span class="math-symbol math-imaginary-symbol">'+t+"</span>":"Infinity"===t?'<span class="math-symbol math-infinity-symbol">'+t+"</span>":"NaN"===t?'<span class="math-symbol math-nan-symbol">'+t+"</span>":"null"===t?'<span class="math-symbol math-null-symbol">'+t+"</span>":"undefined"===t?'<span class="math-symbol math-undefined-symbol">'+t+"</span>":'<span class="math-symbol">'+t+"</span>"}toJSON(){return{mathjs:"SymbolNode",name:this.name}}static fromJSON(e){return new a(e.name)}_toTex(e){var r=!1;void 0===t[this.name]&&i(this.name)&&(r=!0);var n=ho(this.name,r);return"\\"===n[0]?n:" "+n}}return a}),{isClass:!0,isNode:!0}),Zo="FunctionNode",$o=Ii(Zo,["math","Node","SymbolNode"],(e=>{var t,{math:r,Node:n,SymbolNode:i}=e,a=e=>ha(e,{truncate:78});function o(e,t,r){for(var n,i="",a=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,o=0;null!==(n=a.exec(e));)if(i+=e.substring(o,n.index),o=n.index,"$$"===n[0])i+="$",o++;else{o+=n[0].length;var s=t[n[1]];if(!s)throw new ReferenceError("Template: Property "+n[1]+" does not exist.");if(void 0===n[2])switch(typeof s){case"string":i+=s;break;case"object":if(bi(s))i+=s.toTex(r);else{if(!Array.isArray(s))throw new TypeError("Template: "+n[1]+" has to be a Node, String or array of Nodes");i+=s.map((function(e,t){if(bi(e))return e.toTex(r);throw new TypeError("Template: "+n[1]+"["+t+"] is not a Node.")})).join(",")}break;default:throw new TypeError("Template: "+n[1]+" has to be a Node, String or array of Nodes")}else{if(!bi(s[n[2]]&&s[n[2]]))throw new TypeError("Template: "+n[1]+"["+n[2]+"] is not a Node.");i+=s[n[2]].toTex(r)}}return i+e.slice(o)}class s extends n{constructor(e,t){if(super(),"string"==typeof e&&(e=new i(e)),!bi(e))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(t)||!t.every(bi))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=e,this.args=t||[]}get name(){return this.fn.name||""}get type(){return Zo}get isFunctionNode(){return!0}_compile(e,t){var r=this.args.map((r=>r._compile(e,t)));if(!Si(this.fn)){if(hi(this.fn)&&_i(this.fn.index)&&this.fn.index.isObjectProperty()){var n=this.fn.object._compile(e,t),i=this.fn.index.getObjectProperty(),o=this.args;return function(t,a,s){var l=n(t,a,s),u=function(e,t){if(!zn(e,t))throw new Error('No access to method "'+t+'"');return e[t]}(l,i);if(null!=u&&u.rawArgs)return u(o,e,Qa(t,a));var c=r.map((e=>e(t,a,s)));return u.apply(l,c)}}var l=this.fn.toString(),u=this.fn._compile(e,t),c=this.args;return function(t,n,i){var o=u(t,n,i);if("function"!=typeof o)throw new TypeError("Expression '".concat(l,"' did not evaluate to a function; value is:")+"\n  ".concat(a(o)));if(o.rawArgs)return o(c,e,Qa(t,n));var s=r.map((e=>e(t,n,i)));return o.apply(o,s)}}var h=this.fn.name;if(t[h]){var p=this.args;return function(t,n,i){var o=Nn(n,h);if("function"!=typeof o)throw new TypeError("Argument '".concat(h,"' was not a function; received: ").concat(a(o)));if(o.rawArgs)return o(p,e,Qa(t,n));var s=r.map((e=>e(t,n,i)));return o.apply(o,s)}}var d=h in e?Nn(e,h):void 0,f="function"==typeof d&&!0===d.rawArgs,m=t=>{var r;if(t.has(h))r=t.get(h);else{if(!(h in e))return s.onUndefinedFunction(h);r=Nn(e,h)}if("function"==typeof r)return r;throw new TypeError("'".concat(h,"' is not a function; its value is:\n  ").concat(a(r)))};if(f){var g=this.args;return function(t,n,i){var a=m(t);return!0===a.rawArgs?a(g,e,Qa(t,n)):a(...r.map((e=>e(t,n,i))))}}switch(r.length){case 0:return function(e,t,r){return m(e)()};case 1:return function(e,t,n){return m(e)((0,r[0])(e,t,n))};case 2:return function(e,t,n){var i=m(e),a=r[0],o=r[1];return i(a(e,t,n),o(e,t,n))};default:return function(e,t,n){return m(e)(...r.map((r=>r(e,t,n))))}}}forEach(e){e(this.fn,"fn",this);for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=this._ifNode(e(this.fn,"fn",this)),r=[],n=0;n<this.args.length;n++)r[n]=this._ifNode(e(this.args[n],"args["+n+"]",this));return new s(t,r)}clone(){return new s(this.fn,this.args.slice(0))}toString(e){var t,r=this.fn.toString(e);return e&&"object"==typeof e.handler&&Tn(e.handler,r)&&(t=e.handler[r](this,e)),void 0!==t?t:super.toString(e)}_toString(e){var t=this.args.map((function(t){return t.toString(e)}));return(vi(this.fn)?"("+this.fn.toString(e)+")":this.fn.toString(e))+"("+t.join(", ")+")"}toJSON(){return{mathjs:Zo,fn:this.fn,args:this.args}}_toHTML(e){var t=this.args.map((function(t){return t.toHTML(e)}));return'<span class="math-function">'+fa(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}toTex(e){var t;return e&&"object"==typeof e.handler&&Tn(e.handler,this.name)&&(t=e.handler[this.name](this,e)),void 0!==t?t:super.toTex(e)}_toTex(e){var t,n,i=this.args.map((function(t){return t.toTex(e)}));switch(lo[this.name]&&(t=lo[this.name]),!r[this.name]||"function"!=typeof r[this.name].toTex&&"object"!=typeof r[this.name].toTex&&"string"!=typeof r[this.name].toTex||(t=r[this.name].toTex),typeof t){case"function":n=t(this,e);break;case"string":n=o(t,this,e);break;case"object":switch(typeof t[i.length]){case"function":n=t[i.length](this,e);break;case"string":n=o(t[i.length],this,e)}}return void 0!==n?n:o("\\mathrm{${name}}\\left(${args}\\right)",this,e)}getIdentifier(){return this.type+":"+this.name}}return t=s,ki(s,"name",Zo),ki(s,"onUndefinedFunction",(function(e){throw new Error("Undefined function "+e)})),ki(s,"fromJSON",(function(e){return new t(e.fn,e.args)})),s}),{isClass:!0,isNode:!0});function Go(e){var t,r,n=e.length,i=e[0].length,a=[];for(r=0;r<i;r++){var o=[];for(t=0;t<n;t++)o.push(e[t][r]);a.push(o)}return a}function Ho(e){for(var t=0;t<e.length;t++)if(Yn(e[t]))return!0;return!1}function Wo(e,t){Xn(e)?e.forEach((e=>t(e)),!1,!0):Ja(e,t,!0)}function Xo(e,t,r){if(!r)return Xn(e)?e.map((e=>t(e)),!1,!0):Ka(e,t,!0);var n=e=>0===e?e:t(e);return Xn(e)?e.map((e=>n(e)),!1,!0):Ka(e,n,!0)}function Yo(e,t,r){var n=Array.isArray(e)?ba(e):e.size();if(t<0||t>=n.length)throw new _a(t,n.length);return Xn(e)?e.create(Ko(e.valueOf(),t,r),e.datatype()):Ko(e,t,r)}function Ko(e,t,r){var n,i,a,o;if(t<=0){if(Array.isArray(e[0])){for(o=Go(e),i=[],n=0;n<o.length;n++)i[n]=Ko(o[n],t-1,r);return i}for(a=e[0],n=1;n<e.length;n++)a=r(a,e[n]);return a}for(i=[],n=0;n<e.length;n++)i[n]=Ko(e[n],t-1,r);return i}function Jo(e,t,r,n,i,a,o,s,l,u,c){var h,p,d,f,m=e._values,g=e._index,y=e._ptr;if(n)for(p=y[t],d=y[t+1],h=p;h<d;h++)r[f=g[h]]!==a?(r[f]=a,o.push(f),u?(n[f]=l?s(m[h],c):s(c,m[h]),i[f]=a):n[f]=m[h]):(n[f]=l?s(m[h],n[f]):s(n[f],m[h]),i[f]=a);else for(p=y[t],d=y[t+1],h=p;h<d;h++)r[f=g[h]]!==a?(r[f]=a,o.push(f)):i[f]=a}var Qo="parse",es=Ii(Qo,["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],(e=>{var{typed:t,numeric:r,config:n,AccessorNode:i,ArrayNode:a,AssignmentNode:o,BlockNode:s,ConditionalNode:l,ConstantNode:u,FunctionAssignmentNode:c,FunctionNode:h,IndexNode:p,ObjectNode:d,OperatorNode:f,ParenthesisNode:m,RangeNode:g,RelationalNode:y,SymbolNode:v}=e,x=t(Qo,{string:function(e){return F(e,{})},"Array | Matrix":function(e){return _(e,{})},"string, Object":function(e,t){return F(e,void 0!==t.nodes?t.nodes:{})},"Array | Matrix, Object":_});function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=void 0!==t.nodes?t.nodes:{};return Xo(e,(function(e){if("string"!=typeof e)throw new TypeError("String expected");return F(e,r)}))}var b={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},w={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},A={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},C={true:!0,false:!1,null:null,undefined:void 0},E=["NaN","Infinity"],M={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function S(e,t){return e.expression.substr(e.index,t)}function D(e){return S(e,1)}function T(e){e.index++}function N(e){return e.expression.charAt(e.index-1)}function I(e){return e.expression.charAt(e.index+1)}function P(e){for(e.tokenType=b.NULL,e.token="",e.comment="";;){if("#"===D(e))for(;"\n"!==D(e)&&""!==D(e);)e.comment+=D(e),T(e);if(!x.isWhitespace(D(e),e.nestingLevel))break;T(e)}if(""!==D(e)){if("\n"===D(e)&&!e.nestingLevel)return e.tokenType=b.DELIMITER,e.token=D(e),void T(e);var t=D(e),r=S(e,2),n=S(e,3);if(3===n.length&&w[n])return e.tokenType=b.DELIMITER,e.token=n,T(e),T(e),void T(e);if(2===r.length&&w[r])return e.tokenType=b.DELIMITER,e.token=r,T(e),void T(e);if(w[t])return e.tokenType=b.DELIMITER,e.token=t,void T(e);if(x.isDigitDot(t)){e.tokenType=b.NUMBER;var i=S(e,2);if("0b"===i||"0o"===i||"0x"===i){for(e.token+=D(e),T(e),e.token+=D(e),T(e);x.isHexDigit(D(e));)e.token+=D(e),T(e);if("."===D(e))for(e.token+=".",T(e);x.isHexDigit(D(e));)e.token+=D(e),T(e);else if("i"===D(e))for(e.token+="i",T(e);x.isDigit(D(e));)e.token+=D(e),T(e);return}if("."===D(e)){if(e.token+=D(e),T(e),!x.isDigit(D(e)))return void(e.tokenType=b.DELIMITER)}else{for(;x.isDigit(D(e));)e.token+=D(e),T(e);x.isDecimalMark(D(e),I(e))&&(e.token+=D(e),T(e))}for(;x.isDigit(D(e));)e.token+=D(e),T(e);if("E"===D(e)||"e"===D(e))if(x.isDigit(I(e))||"-"===I(e)||"+"===I(e)){if(e.token+=D(e),T(e),"+"!==D(e)&&"-"!==D(e)||(e.token+=D(e),T(e)),!x.isDigit(D(e)))throw re(e,'Digit expected, got "'+D(e)+'"');for(;x.isDigit(D(e));)e.token+=D(e),T(e);if(x.isDecimalMark(D(e),I(e)))throw re(e,'Digit expected, got "'+D(e)+'"')}else if(x.isDecimalMark(I(e),e.expression.charAt(e.index+2)))throw T(e),re(e,'Digit expected, got "'+D(e)+'"')}else{if(!x.isAlpha(D(e),N(e),I(e))){for(e.tokenType=b.UNKNOWN;""!==D(e);)e.token+=D(e),T(e);throw re(e,'Syntax error in part "'+e.token+'"')}for(;x.isAlpha(D(e),N(e),I(e))||x.isDigit(D(e));)e.token+=D(e),T(e);Tn(A,e.token)?e.tokenType=b.DELIMITER:e.tokenType=b.SYMBOL}}else e.tokenType=b.DELIMITER}function z(e){do{P(e)}while("\n"===e.token)}function B(e){e.nestingLevel++}function k(e){e.nestingLevel--}function F(e,t){var r={extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:b.NULL,nestingLevel:0,conditionalLevel:null};An(r,{expression:e,extraNodes:t}),P(r);var n=function(e){var t,r,n=[];for(""!==e.token&&"\n"!==e.token&&";"!==e.token&&(t=R(e),e.comment&&(t.comment=e.comment));"\n"===e.token||";"===e.token;)0===n.length&&t&&(r=";"!==e.token,n.push({node:t,visible:r})),P(e),"\n"!==e.token&&";"!==e.token&&""!==e.token&&(t=R(e),e.comment&&(t.comment=e.comment),r=";"!==e.token,n.push({node:t,visible:r}));return n.length>0?new s(n):(t||(t=new u(void 0),e.comment&&(t.comment=e.comment)),t)}(r);if(""!==r.token)throw r.tokenType===b.DELIMITER?ne(r,"Unexpected operator "+r.token):re(r,'Unexpected part "'+r.token+'"');return n}function R(e){var t,r,n,i,a=function(e){for(var t=function(e){for(var t=O(e);"or"===e.token;)z(e),t=new f("or","or",[t,O(e)]);return t}(e);"?"===e.token;){var r=e.conditionalLevel;e.conditionalLevel=e.nestingLevel,z(e);var n=t,i=R(e);if(":"!==e.token)throw re(e,"False part of conditional expression expected");e.conditionalLevel=null,z(e);var a=R(e);t=new l(n,i,a),e.conditionalLevel=r}return t}(e);if("="===e.token){if(Si(a))return t=a.name,z(e),n=R(e),new o(new v(t),n);if(hi(a))return z(e),n=R(e),new o(a.object,a.index,n);if(xi(a)&&Si(a.fn)&&(i=!0,r=[],t=a.name,a.args.forEach((function(e,t){Si(e)?r[t]=e.name:i=!1})),i))return z(e),n=R(e),new c(t,r,n);throw re(e,"Invalid left hand side of assignment operator =")}return a}function O(e){for(var t=L(e);"xor"===e.token;)z(e),t=new f("xor","xor",[t,L(e)]);return t}function L(e){for(var t=q(e);"and"===e.token;)z(e),t=new f("and","and",[t,q(e)]);return t}function q(e){for(var t=j(e);"|"===e.token;)z(e),t=new f("|","bitOr",[t,j(e)]);return t}function j(e){for(var t=U(e);"^|"===e.token;)z(e),t=new f("^|","bitXor",[t,U(e)]);return t}function U(e){for(var t=V(e);"&"===e.token;)z(e),t=new f("&","bitAnd",[t,V(e)]);return t}function V(e){for(var t=[Z(e)],r=[],n={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};Tn(n,e.token);){var i={name:e.token,fn:n[e.token]};r.push(i),z(e),t.push(Z(e))}return 1===t.length?t[0]:2===t.length?new f(r[0].name,r[0].fn,t):new y(r.map((e=>e.fn)),t)}function Z(e){var t,r,n,i;t=$(e);for(var a={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};Tn(a,e.token);)n=a[r=e.token],z(e),i=[t,$(e)],t=new f(r,n,i);return t}function $(e){var t,r,n,i;t=G(e);for(var a={to:"to",in:"to"};Tn(a,e.token);)n=a[r=e.token],z(e),"in"===r&&"])},;".includes(e.token)?t=new f("*","multiply",[t,new v("in")],!0):(i=[t,G(e)],t=new f(r,n,i));return t}function G(e){var t,r=[];if(t=":"===e.token?new u(1):H(e),":"===e.token&&e.conditionalLevel!==e.nestingLevel){for(r.push(t);":"===e.token&&r.length<3;)z(e),")"===e.token||"]"===e.token||","===e.token||""===e.token?r.push(new v("end")):r.push(H(e));t=3===r.length?new g(r[0],r[2],r[1]):new g(r[0],r[1])}return t}function H(e){var t,r,n,i;t=W(e);for(var a={"+":"add","-":"subtract"};Tn(a,e.token);){n=a[r=e.token],z(e);var o=W(e);i=o.isPercentage?[t,new f("*","multiply",[t,o])]:[t,o],t=new f(r,n,i)}return t}function W(e){var t,r,n,i;r=t=X(e);for(var a={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};Tn(a,e.token);)if(i=a[n=e.token],z(e),"%"===n&&e.tokenType===b.DELIMITER&&"("!==e.token)if(""!==e.token&&a[e.token]){var o=new f("/","divide",[t,new u(100)],!1,!0);i=a[n=e.token],z(e),r=X(e),t=new f(n,i,[o,r])}else t=new f("/","divide",[t,new u(100)],!1,!0);else r=X(e),t=new f(n,i,[t,r]);return t}function X(e){var t,r;for(r=t=Y(e);e.tokenType===b.SYMBOL||"in"===e.token&&gi(t)||"in"===e.token&&Ai(t)&&"unaryMinus"===t.fn&&gi(t.args[0])||!(e.tokenType!==b.NUMBER||gi(r)||Ai(r)&&"!"!==r.op)||"("===e.token;)r=Y(e),t=new f("*","multiply",[t,r],!0);return t}function Y(e){for(var t=K(e),r=t,n=[];"/"===e.token&&yi(r);){if(n.push(An({},e)),z(e),e.tokenType!==b.NUMBER){An(e,n.pop());break}if(n.push(An({},e)),z(e),e.tokenType!==b.SYMBOL&&"("!==e.token&&"in"!==e.token){n.pop(),An(e,n.pop());break}An(e,n.pop()),n.pop(),r=K(e),t=new f("/","divide",[t,r])}return t}function K(e){var t,i,o,s={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return Tn(s,e.token)?(o=s[e.token],t=e.token,z(e),i=[K(e)],new f(t,o,i)):function(e){var t,i,o,s;return t=function(e){var t,i,o;t=function(e){var t=[];if(e.tokenType===b.SYMBOL&&Tn(e.extraNodes,e.token)){var i=e.extraNodes[e.token];if(P(e),"("===e.token){if(t=[],B(e),P(e),")"!==e.token)for(t.push(R(e));","===e.token;)P(e),t.push(R(e));if(")"!==e.token)throw re(e,"Parenthesis ) expected");k(e),P(e)}return new i(t)}return function(e){var t;return e.tokenType===b.SYMBOL||e.tokenType===b.DELIMITER&&e.token in A?(t=e.token,P(e),J(e,Tn(C,t)?new u(C[t]):E.includes(t)?new u(r(t,"number")):new v(t))):function(e){var t;return'"'===e.token||"'"===e.token?(t=Q(e,e.token),J(e,new u(t))):function(e){var t,i,o,s;if("["===e.token){if(B(e),P(e),"]"!==e.token){var l=ee(e);if(";"===e.token){for(o=1,i=[l];";"===e.token;)P(e),"]"!==e.token&&(i[o]=ee(e),o++);if("]"!==e.token)throw re(e,"End of matrix ] expected");k(e),P(e),s=i[0].items.length;for(var c=1;c<o;c++)if(i[c].items.length!==s)throw ne(e,"Column dimensions mismatch ("+i[c].items.length+" !== "+s+")");t=new a(i)}else{if("]"!==e.token)throw re(e,"End of matrix ] expected");k(e),P(e),t=l}}else k(e),P(e),t=new a([]);return J(e,t)}return function(e){if("{"===e.token){var t;B(e);var i={};do{if(P(e),"}"!==e.token){if('"'===e.token||"'"===e.token)t=Q(e,e.token);else{if(!(e.tokenType===b.SYMBOL||e.tokenType===b.DELIMITER&&e.token in A))throw re(e,"Symbol or string expected as object key");t=e.token,P(e)}if(":"!==e.token)throw re(e,"Colon : expected after object key");P(e),i[t]=R(e)}}while(","===e.token);if("}"!==e.token)throw re(e,"Comma , or bracket } expected after object value");k(e),P(e);var a=new d(i);return J(e,a)}return function(e){var t;if(e.tokenType===b.NUMBER){t=e.token,P(e);var i=Ri(t,n),a=r(t,i);return new u(a)}return function(e){var t;if("("===e.token){if(B(e),P(e),t=R(e),")"!==e.token)throw re(e,"Parenthesis ) expected");return k(e),P(e),J(e,t=new m(t))}return function(e){throw""===e.token?re(e,"Unexpected end of expression"):re(e,"Value expected")}(e)}(e)}(e)}(e)}(e)}(e)}(e)}(e);for(var s={"!":"factorial","'":"ctranspose"};Tn(s,e.token);)o=s[i=e.token],P(e),t=J(e,t=new f(i,o,[t]));return t}(e),("^"===e.token||".^"===e.token)&&(o="^"===(i=e.token)?"pow":"dotPow",z(e),s=[t,K(e)],t=new f(i,o,s)),t}(e)}function J(e,t,r){for(var n;("("===e.token||"["===e.token||"."===e.token)&&(!r||r.includes(e.token));)if(n=[],"("===e.token){if(!Si(t)&&!hi(t))return t;if(B(e),P(e),")"!==e.token)for(n.push(R(e));","===e.token;)P(e),n.push(R(e));if(")"!==e.token)throw re(e,"Parenthesis ) expected");k(e),P(e),t=new h(t,n)}else if("["===e.token){if(B(e),P(e),"]"!==e.token)for(n.push(R(e));","===e.token;)P(e),n.push(R(e));if("]"!==e.token)throw re(e,"Parenthesis ] expected");k(e),P(e),t=new i(t,new p(n))}else{if(P(e),!(e.tokenType===b.SYMBOL||e.tokenType===b.DELIMITER&&e.token in A))throw re(e,"Property name expected after dot");n.push(new u(e.token)),P(e),t=new i(t,new p(n,!0))}return t}function Q(e,t){for(var r="";""!==D(e)&&D(e)!==t;)if("\\"===D(e)){T(e);var n=D(e),i=M[n];if(void 0!==i)r+=i,e.index+=1;else{if("u"!==n)throw re(e,"Bad escape character \\".concat(n));var a=e.expression.slice(e.index+1,e.index+5);if(!/^[0-9A-Fa-f]{4}$/.test(a))throw re(e,"Invalid unicode character \\u".concat(a));r+=String.fromCharCode(parseInt(a,16)),e.index+=5}}else r+=D(e),T(e);if(P(e),e.token!==t)throw re(e,"End of string ".concat(t," expected"));return P(e),r}function ee(e){for(var t=[R(e)],r=1;","===e.token;)P(e),"]"!==e.token&&";"!==e.token&&(t[r]=R(e),r++);return new a(t)}function te(e){return e.index-e.token.length+1}function re(e,t){var r=te(e),n=new SyntaxError(t+" (char "+r+")");return n.char=r,n}function ne(e,t){var r=te(e),n=new SyntaxError(t+" (char "+r+")");return n.char=r,n}return x.isAlpha=function(e,t,r){return x.isValidLatinOrGreek(e)||x.isValidMathSymbol(e,r)||x.isValidMathSymbol(t,e)},x.isValidLatinOrGreek=function(e){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(e)},x.isValidMathSymbol=function(e,t){return/^[\uD835]$/.test(e)&&/^[\uDC00-\uDFFF]$/.test(t)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(t)},x.isWhitespace=function(e,t){return" "===e||"\t"===e||"\n"===e&&t>0},x.isDecimalMark=function(e,t){return"."===e&&"/"!==t&&"*"!==t&&"^"!==t},x.isDigitDot=function(e){return e>="0"&&e<="9"||"."===e},x.isDigit=function(e){return e>="0"&&e<="9"},x.isHexDigit=function(e){return e>="0"&&e<="9"||e>="a"&&e<="f"||e>="A"&&e<="F"},t.addConversion({from:"string",to:"Node",convert:x}),x})),ts=Ii("resolve",["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],(e=>{var{typed:t,parse:r,ConstantNode:n,FunctionNode:i,OperatorNode:a,ParenthesisNode:o}=e;function s(e,t){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(!t)return e;if(Si(e)){if(l.has(e.name)){var u=Array.from(l).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(u,"}"))}var c=t.get(e.name);if(bi(c)){var h=new Set(l);return h.add(e.name),s(c,t,h)}return"number"==typeof c?r(String(c)):void 0!==c?new n(c):e}if(Ai(e)){var p=e.args.map((function(e){return s(e,t,l)}));return new a(e.op,e.fn,p,e.implicit)}if(Ci(e))return new o(s(e.content,t,l));if(xi(e)){var d=e.args.map((function(e){return s(e,t,l)}));return new i(e.name,d)}return e.map((e=>s(e,t,l)))}return t("resolve",{Node:s,"Node, Map | null | undefined":s,"Node, Object":(e,t)=>s(e,qn(t)),"Array | Matrix":t.referToSelf((e=>t=>t.map((t=>e(t))))),"Array | Matrix, null | undefined":t.referToSelf((e=>t=>t.map((t=>e(t))))),"Array, Object":t.referTo("Array,Map",(e=>(t,r)=>e(t,qn(r)))),"Matrix, Object":t.referTo("Matrix,Map",(e=>(t,r)=>e(t,qn(r)))),"Array | Matrix, Map":t.referToSelf((e=>(t,r)=>t.map((t=>e(t,r)))))})}));function rs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ns(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rs(Object(r),!0).forEach((function(t){ki(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var is=Ii("simplifyUtil",["FunctionNode","OperatorNode","SymbolNode"],(e=>{var{FunctionNode:t,OperatorNode:r,SymbolNode:n}=e,i=!0,a=!1,o="defaultF",s={add:{trivial:i,total:i,commutative:i,associative:i},unaryPlus:{trivial:i,total:i,commutative:i,associative:i},subtract:{trivial:a,total:i,commutative:a,associative:a},multiply:{trivial:i,total:i,commutative:i,associative:i},divide:{trivial:a,total:i,commutative:a,associative:a},paren:{trivial:i,total:i,commutative:i,associative:a},defaultF:{trivial:a,total:i,commutative:a,associative:a}};function l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,n=o;if("string"==typeof e?n=e:Ai(e)?n=e.fn.toString():xi(e)?n=e.name:Ci(e)&&(n="paren"),Tn(r,n)){var i=r[n];if(Tn(i,t))return i[t];if(Tn(s,n))return s[n][t]}if(Tn(r,o)){var a=r[o];return Tn(a,t)?a[t]:s[o][t]}if(Tn(s,n)){var l=s[n];if(Tn(l,t))return l[t]}return s[o][t]}function u(e){return l(e,"associative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)}function c(e,t){var r,n=[],i=function(e){for(var t=0;t<e.args.length;t++){var a=e.args[t];Ai(a)&&r===a.op?i(a):n.push(a)}};return u(e,t)?(r=e.op,i(e),n):e.args}function h(e){return Ai(e)?function(t){try{return new r(e.op,e.fn,t,e.implicit)}catch(e){return console.error(e),[]}}:function(r){return new t(new n(e.name),r)}}return{createMakeNodeFunction:h,hasProperty:l,isCommutative:function(e){return l(e,"commutative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)},isAssociative:u,mergeContext:function(e,t){var r=ns({},e);for(var n in t)Tn(e,n)?r[n]=ns(ns({},t[n]),e[n]):r[n]=t[n];return r},flatten:function e(t,r){if(!t.args||0===t.args.length)return t;t.args=c(t,r);for(var n=0;n<t.args.length;n++)e(t.args[n],r)},allChildren:c,unflattenr:function e(t,r){if(t.args&&0!==t.args.length){for(var n=h(t),i=t.args.length,a=0;a<i;a++)e(t.args[a],r);if(i>2&&u(t,r)){for(var o=t.args.pop();t.args.length>0;)o=n([t.args.pop(),o]);t.args=o.args}}},unflattenl:function e(t,r){if(t.args&&0!==t.args.length){for(var n=h(t),i=t.args.length,a=0;a<i;a++)e(t.args[a],r);if(i>2&&u(t,r)){for(var o=t.args.shift();t.args.length>0;)o=n([o,t.args.shift()]);t.args=o.args}}},defaultContext:s,realContext:{divide:{total:a},log:{total:a}},positiveContext:{subtract:{total:a},abs:{trivial:i},log:{total:i}}}}));function as(){throw new Error('No "bignumber" implementation available')}function os(){throw new Error('No "fraction" implementation available')}function ss(){throw new Error('No "matrix" implementation available')}var ls=Ii("simplifyConstant",["typed","config","mathWithTransform","matrix","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],(e=>{var{typed:t,config:r,mathWithTransform:n,matrix:i,fraction:a,bignumber:o,AccessorNode:s,ArrayNode:l,ConstantNode:u,FunctionNode:c,IndexNode:h,ObjectNode:p,OperatorNode:d,SymbolNode:f}=e,{isCommutative:m,isAssociative:g,allChildren:y,createMakeNodeFunction:v}=is({FunctionNode:c,OperatorNode:d,SymbolNode:f}),x=t("simplifyConstant",{Node:e=>A(D(e,{})),"Node, Object":function(e,t){return A(D(e,t))}});function _(e){return $n(e)?e.valueOf():e instanceof Array?e.map(_):Xn(e)?i(_(e.valueOf())):e}function b(e,t,r){try{return n[e].apply(null,t)}catch(i){return t=t.map(_),E(n[e].apply(null,t),r)}}var w=t({Fraction:function(e){var t=e=>"BigNumber"===r.number&&o?o(e):Number(e),n=e.s*e.n,i=n<0n?new d("-","unaryMinus",[new u(-t(n))]):new u(t(n));return 1n===e.d?i:new d("/","divide",[i,new u(t(e.d))])},number:function(e){return e<0?M(new u(-e)):new u(e)},BigNumber:function(e){return e<0?M(new u(-e)):new u(e)},bigint:function(e){return e<0n?M(new u(-e)):new u(e)},Complex:function(e){throw new Error("Cannot convert Complex number to Node")},string:function(e){return new u(e)},Matrix:function(e){return new l(e.valueOf().map((e=>w(e))))}});function A(e){return bi(e)?e:w(e)}function C(e,t){if(t&&!1!==t.exactFractions&&isFinite(e)&&a){var r=a(e),n=t&&"number"==typeof t.fractionsLimit?t.fractionsLimit:1/0;if(r.valueOf()===e&&r.n<n&&r.d<n)return r}return e}var E=t({"string, Object":function(e,t){var n=Ri(e,r);return"BigNumber"===n?(void 0===o&&as(),o(e)):"bigint"===n?BigInt(e):"Fraction"===n?(void 0===a&&os(),a(e)):C(parseFloat(e),t)},"Fraction, Object":function(e,t){return e},"BigNumber, Object":function(e,t){return e},"number, Object":function(e,t){return C(e,t)},"bigint, Object":function(e,t){return e},"Complex, Object":function(e,t){return 0!==e.im?e:C(e.re,t)},"Matrix, Object":function(e,t){return i(C(e.valueOf()))},"Array, Object":function(e,t){return e.map(C)}});function M(e){return new d("-","unaryMinus",[e])}function S(e,t,r,n){var i=t.shift(),a=t.reduce(((t,i)=>{if(!bi(i)){var a=t.pop();if(bi(a))return[a,i];try{return t.push(b(e,[a,i],n)),t}catch(e){t.push(a)}}t.push(A(t.pop()));var o=1===t.length?t[0]:r(t);return[r([o,A(i)])]}),[i]);return 1===a.length?a[0]:r([a[0],w(a[1])])}function D(e,t){switch(e.type){case"SymbolNode":return e;case"ConstantNode":switch(typeof e.value){case"number":case"bigint":return E(e.value,t);case"string":return e.value;default:if(!isNaN(e.value))return E(e.value,t)}return e;case"FunctionNode":if(n[e.name]&&n[e.name].rawArgs)return e;if(!["add","multiply"].includes(e.name)){var r=e.args.map((e=>D(e,t)));if(!r.some(bi))try{return b(e.name,r,t)}catch(e){}if("size"===e.name&&1===r.length&&pi(r[0])){for(var a=[],o=r[0];pi(o);)a.push(o.items.length),o=o.items[0];return i(a)}return new c(e.name,r.map(A))}case"OperatorNode":var d,f,_=e.fn.toString(),w=v(e);if(Ai(e)&&e.isUnary())f=bi((d=[D(e.args[0],t)])[0])?w(d):b(_,d,t);else if(g(e,t.context))if(d=(d=y(e,t.context)).map((e=>D(e,t))),m(_,t.context)){for(var C=[],M=[],T=0;T<d.length;T++)bi(d[T])?M.push(d[T]):C.push(d[T]);C.length>1?(f=S(_,C,w,t),M.unshift(f),f=S(_,M,w,t)):f=S(_,d,w,t)}else f=S(_,d,w,t);else d=e.args.map((e=>D(e,t))),f=S(_,d,w,t);return f;case"ParenthesisNode":return D(e.content,t);case"AccessorNode":return function(e,t,r){if(!_i(t))return new s(A(e),A(t));if(pi(e)||Xn(e)){for(var n=Array.from(t.dimensions);n.length>0;)if(gi(n[0])&&"string"!=typeof n[0].value){var a=E(n.shift().value,r);pi(e)?e=e.items[a-1]:(e=e.valueOf()[a-1])instanceof Array&&(e=i(e))}else{if(!(n.length>1&&gi(n[1])&&"string"!=typeof n[1].value))break;var o=E(n[1].value,r),c=[],p=pi(e)?e.items:e.valueOf();for(var d of p)if(pi(d))c.push(d.items[o-1]);else{if(!Xn(e))break;c.push(d[o-1])}if(c.length!==p.length)break;e=pi(e)?new l(c):i(c),n.splice(1,1)}return n.length===t.dimensions.length?new s(A(e),t):n.length>0?(t=new h(n),new s(A(e),t)):e}if(wi(e)&&1===t.dimensions.length&&gi(t.dimensions[0])){var f=t.dimensions[0].value;return f in e.properties?e.properties[f]:new u}return new s(A(e),t)}(D(e.object,t),D(e.index,t),t);case"ArrayNode":var N=e.items.map((e=>D(e,t)));return N.some(bi)?new l(N.map(A)):i(N);case"IndexNode":return new h(e.dimensions.map((e=>x(e,t))));case"ObjectNode":var I={};for(var P in e.properties)I[P]=x(e.properties[P],t);return new p(I);default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(e.type))}}return x})),us="compile",cs=Ii(us,["typed","parse"],(e=>{var{typed:t,parse:r}=e;return t(us,{string:function(e){return r(e).compile()},"Array | Matrix":function(e){return Xo(e,(function(e){return r(e).compile()}))}})})),hs="simplifyCore",ps=Ii(hs,["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],(e=>{var{typed:t,parse:r,equal:n,isZero:i,add:a,subtract:o,multiply:s,divide:l,pow:u,AccessorNode:c,ArrayNode:h,ConstantNode:p,FunctionNode:d,IndexNode:f,ObjectNode:m,OperatorNode:g,ParenthesisNode:y,SymbolNode:v}=e,x=new p(0),_=new p(1),b=new p(!0),w=new p(!1);function A(e){return Ai(e)&&["and","not","or"].includes(e.op)}var{hasProperty:C,isCommutative:E}=is({FunctionNode:d,OperatorNode:g,SymbolNode:v});function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t?t.context:void 0;if(C(e,"trivial",r)){if(xi(e)&&1===e.args.length)return M(e.args[0],t);var a=!1,o=0;if(e.forEach((e=>{1===++o&&(a=M(e,t))})),1===o)return a}var s=e;if(xi(s)){var l=function(e){var t="OperatorNode:"+e;for(var r of eo)if(t in r)return r[t].op;return null}(s.name);if(!l)return new d(M(s.fn),s.args.map((e=>M(e,t))));if(s.args.length>2&&C(s,"associative",r))for(;s.args.length>2;){var u=s.args.pop(),p=s.args.pop();s.args.push(new g(l,s.name,[u,p]))}s=new g(l,s.name,s.args)}if(Ai(s)&&s.isUnary()){var y=M(s.args[0],t);if("~"===s.op&&Ai(y)&&y.isUnary()&&"~"===y.op)return y.args[0];if("not"===s.op&&Ai(y)&&y.isUnary()&&"not"===y.op&&A(y.args[0]))return y.args[0];var v=!0;if("-"===s.op&&Ai(y)&&(y.isBinary()&&"subtract"===y.fn&&(s=new g("-","subtract",[y.args[1],y.args[0]]),v=!1),y.isUnary()&&"-"===y.op))return y.args[0];if(v)return new g(s.op,s.fn,[y])}if(Ai(s)&&s.isBinary()){var S=M(s.args[0],t),D=M(s.args[1],t);if("+"===s.op){if(gi(S)&&i(S.value))return D;if(gi(D)&&i(D.value))return S;Ai(D)&&D.isUnary()&&"-"===D.op&&(D=D.args[0],s=new g("-","subtract",[S,D]))}if("-"===s.op)return Ai(D)&&D.isUnary()&&"-"===D.op?M(new g("+","add",[S,D.args[0]]),t):gi(S)&&i(S.value)?M(new g("-","unaryMinus",[D])):gi(D)&&i(D.value)?S:new g(s.op,s.fn,[S,D]);if("*"===s.op){if(gi(S)){if(i(S.value))return x;if(n(S.value,1))return D}if(gi(D)){if(i(D.value))return x;if(n(D.value,1))return S;if(E(s,r))return new g(s.op,s.fn,[D,S],s.implicit)}return new g(s.op,s.fn,[S,D],s.implicit)}if("/"===s.op)return gi(S)&&i(S.value)?x:gi(D)&&n(D.value,1)?S:new g(s.op,s.fn,[S,D]);if("^"===s.op&&gi(D)){if(i(D.value))return _;if(n(D.value,1))return S}if("and"===s.op){if(gi(S)){if(!S.value)return w;if(A(D))return D;if(gi(D))return D.value?b:w}if(gi(D)){if(!D.value)return w;if(A(S))return S}}if("or"===s.op){if(gi(S)){if(S.value)return b;if(A(D))return D}if(gi(D)){if(D.value)return b;if(A(S))return S}}return new g(s.op,s.fn,[S,D])}if(Ai(s))return new g(s.op,s.fn,s.args.map((e=>M(e,t))));if(pi(s))return new h(s.items.map((e=>M(e,t))));if(hi(s))return new c(M(s.object,t),M(s.index,t));if(_i(s))return new f(s.dimensions.map((e=>M(e,t))));if(wi(s)){var T={};for(var N in s.properties)T[N]=M(s.properties[N],t);return new m(T)}return s}return t(hs,{Node:M,"Node,Object":M})})),ds="evaluate",fs=Ii(ds,["typed","parse"],(e=>{var{typed:t,parse:r}=e;return t(ds,{string:function(e){var t=Ln();return r(e).compile().evaluate(t)},"string, Map | Object":function(e,t){return r(e).compile().evaluate(t)},"Array | Matrix":function(e){var t=Ln();return Xo(e,(function(e){return r(e).compile().evaluate(t)}))},"Array | Matrix, Map | Object":function(e,t){return Xo(e,(function(e){return r(e).compile().evaluate(t)}))}})})),ms=Ii("Help",["evaluate"],(e=>{var{evaluate:t}=e;function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(!e)throw new Error('Argument "doc" missing');this.doc=e}return r.prototype.type="Help",r.prototype.isHelp=!0,r.prototype.toString=function(){var e=this.doc||{},r="\n";if(e.name&&(r+="Name: "+e.name+"\n\n"),e.category&&(r+="Category: "+e.category+"\n\n"),e.description&&(r+="Description:\n    "+e.description+"\n\n"),e.syntax&&(r+="Syntax:\n    "+e.syntax.join("\n    ")+"\n\n"),e.examples){r+="Examples:\n";for(var n=!1,i=t("config()"),a={config:e=>(n=!0,t("config(newConfig)",{newConfig:e}))},o=0;o<e.examples.length;o++){var s=e.examples[o];r+="    "+s+"\n";var l=void 0;try{l=t(s,a)}catch(e){l=e}void 0===l||ni(l)||(r+="        "+ha(l,{precision:14})+"\n")}r+="\n",n&&t("config(originalConfig)",{originalConfig:i})}return e.mayThrow&&e.mayThrow.length&&(r+="Throws: "+e.mayThrow.join(", ")+"\n\n"),e.seealso&&e.seealso.length&&(r+="See also: "+e.seealso.join(", ")+"\n"),r},r.prototype.toJSON=function(){var e=Mn(this.doc);return e.mathjs="Help",e},r.fromJSON=function(e){var t={};return Object.keys(e).filter((e=>"mathjs"!==e)).forEach((r=>{t[r]=e[r]})),new r(t)},r.prototype.valueOf=r.prototype.toString,r}),{isClass:!0}),gs=Ii("Parser",["evaluate","parse"],(e=>{var{evaluate:t,parse:r}=e;function n(){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:Ln(),writable:!1})}return n.prototype.type="Parser",n.prototype.isParser=!0,n.prototype.evaluate=function(e){return t(e,this.scope)},n.prototype.get=function(e){if(this.scope.has(e))return this.scope.get(e)},n.prototype.getAll=function(){return function(e){if(e instanceof Fn)return e.wrappedObject;var t={};for(var r of e.keys())In(t,r,e.get(r));return t}(this.scope)},n.prototype.getAllAsMap=function(){return this.scope},n.prototype.set=function(e,t){if(!function(e){if(0===e.length)return!1;for(var t=0;t<e.length;t++){var n=e.charAt(t-1),i=e.charAt(t),a=e.charAt(t+1);if(!(r.isAlpha(i,n,a)||t>0&&r.isDigit(i)))return!1}return!0}(e))throw new Error("Invalid variable name: '".concat(e,"'. Variable names must follow the specified rules."));return this.scope.set(e,t),t},n.prototype.remove=function(e){this.scope.delete(e)},n.prototype.clear=function(){this.scope.clear()},n}),{isClass:!0});function ys(e){return gi(e)||Ai(e)&&e.isUnary()&&gi(e.args[0])}function vs(e){return!!gi(e)||!(!xi(e)&&!Ai(e)||!e.args.every(vs))||!(!Ci(e)||!vs(e.content))}var xs=Ii("simplify",["typed","parse","equal","resolve","simplifyConstant","simplifyCore","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode","replacer"],(e=>{var{typed:t,parse:r,equal:n,resolve:i,simplifyConstant:a,simplifyCore:o,AccessorNode:s,ArrayNode:l,ConstantNode:u,FunctionNode:c,IndexNode:h,ObjectNode:p,OperatorNode:d,ParenthesisNode:f,SymbolNode:m,replacer:g}=e,{hasProperty:y,isCommutative:v,isAssociative:x,mergeContext:_,flatten:b,unflattenr:w,unflattenl:A,createMakeNodeFunction:C,defaultContext:E,realContext:M,positiveContext:S}=is({FunctionNode:c,OperatorNode:d,SymbolNode:m});t.addConversion({from:"Object",to:"Map",convert:qn});var D=t("simplify",{Node:B,"Node, Map":(e,t)=>B(e,!1,t),"Node, Map, Object":(e,t,r)=>B(e,!1,t,r),"Node, Array":B,"Node, Array, Map":B,"Node, Array, Map, Object":B});function T(e){return e.transform((function(e){return Ci(e)?T(e.content):e}))}t.removeConversion({from:"Object",to:"Map",convert:qn}),D.defaultContext=E,D.realContext=M,D.positiveContext=S;var N={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};function I(e,t){var n={};if(e.s){var i=e.s.split("->");if(2!==i.length)throw SyntaxError("Could not parse rule: "+e.s);n.l=i[0],n.r=i[1]}else n.l=e.l,n.r=e.r;for(var a of(n.l=T(r(n.l)),n.r=T(r(n.r)),["imposeContext","repeat","assuming"]))a in e&&(n[a]=e[a]);if(e.evaluate&&(n.evaluate=r(e.evaluate)),x(n.l,t)){var o,s=!v(n.l,t);s&&(o=z());var l=C(n.l),u=z();n.expanded={},n.expanded.l=l([n.l,u]),b(n.expanded.l,t),w(n.expanded.l,t),n.expanded.r=l([n.r,u]),s&&(n.expandedNC1={},n.expandedNC1.l=l([o,n.l]),n.expandedNC1.r=l([o,n.r]),n.expandedNC2={},n.expandedNC2.l=l([o,n.expanded.l]),n.expandedNC2.r=l([o,n.expanded.r]))}return n}D.rules=[o,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},a,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},a,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];var P=0;function z(){return new m("_p"+P++)}function B(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ln(),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=n.consoleDebug;t=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],a=void 0,o=typeof i;switch(o){case"string":i={s:i};case"object":a=I(i,t);break;case"function":a=i;break;default:throw TypeError("Unsupported type of rule: "+o)}r.push(a)}return r}(t||D.rules,n.context);for(var o=i(e,r),s={},l=(o=T(o)).toString({parenthesis:"all"});!s[l];){s[l]=!0,P=0;var u=l;a&&console.log("Working on: ",l);for(var c=0;c<t.length;c++){var h="";if("function"==typeof t[c]?(o=t[c](o,n),a&&(h=t[c].name)):(b(o,n.context),o=F(o,t[c],n.context),a&&(h="".concat(t[c].l.toString()," -> ").concat(t[c].r.toString()))),a){var p=o.toString({parenthesis:"all"});p!==u&&(console.log("Applying",h,"produced",p),u=p)}A(o,n.context)}l=o.toString({parenthesis:"all"})}return o}function k(e,t,r){var n=e;if(e)for(var i=0;i<e.length;++i){var a=F(e[i],t,r);a!==e[i]&&(n===e&&(n=e.slice()),n[i]=a)}return n}function F(e,t,r){if(t.assuming)for(var n in t.assuming)for(var i in t.assuming[n])if(y(n,i,r)!==t.assuming[n][i])return e;var a=_(t.imposeContext,r),o=e;if(o instanceof d||o instanceof c){var u=k(o.args,t,r);u!==o.args&&((o=o.clone()).args=u)}else if(o instanceof f){if(o.content){var m=F(o.content,t,r);m!==o.content&&(o=new f(m))}}else if(o instanceof l){var g=k(o.items,t,r);g!==o.items&&(o=new l(g))}else if(o instanceof s){var v=o.object;o.object&&(v=F(o.object,t,r));var x=o.index;o.index&&(x=F(o.index,t,r)),v===o.object&&x===o.index||(o=new s(v,x))}else if(o instanceof h){var b=k(o.dimensions,t,r);b!==o.dimensions&&(o=new h(b))}else if(o instanceof p){var w=!1,A={};for(var C in o.properties)A[C]=F(o.properties[C],t,r),A[C]!==o.properties[C]&&(w=!0);w&&(o=new p(A))}var E=t.r,M=L(t.l,o,a)[0];if(!M&&t.expanded&&(E=t.expanded.r,M=L(t.expanded.l,o,a)[0]),!M&&t.expandedNC1&&(E=t.expandedNC1.r,(M=L(t.expandedNC1.l,o,a)[0])||(E=t.expandedNC2.r,M=L(t.expandedNC2.l,o,a)[0])),M){var S=o.implicit;o=E.clone(),S&&"implicit"in E&&(o.implicit=!0),o=o.transform((function(e){return e.isSymbolNode&&Tn(M.placeholders,e.name)?M.placeholders[e.name].clone():e}))}return t.repeat&&o!==e&&(o=F(o,t,r)),o}function R(e,t){var r={placeholders:{}};if(!e.placeholders&&!t.placeholders)return r;if(!e.placeholders)return t;if(!t.placeholders)return e;for(var n in e.placeholders)if(Tn(e.placeholders,n)&&(r.placeholders[n]=e.placeholders[n],Tn(t.placeholders,n)&&!q(e.placeholders[n],t.placeholders[n])))return null;for(var i in t.placeholders)Tn(t.placeholders,i)&&(r.placeholders[i]=t.placeholders[i]);return r}function O(e,t){var r,n=[];if(0===e.length||0===t.length)return n;for(var i=0;i<e.length;i++)for(var a=0;a<t.length;a++)(r=R(e[i],t[a]))&&n.push(r);return n}function L(e,t,r,i){var a=[{placeholders:{}}];if(e instanceof d&&t instanceof d||e instanceof c&&t instanceof c){if(e instanceof d){if(e.op!==t.op||e.fn!==t.fn)return[]}else if(e instanceof c&&e.name!==t.name)return[];if(!(1===t.args.length&&1===e.args.length||!x(t,r)&&t.args.length===e.args.length||i)){if(t.args.length>=2&&2===e.args.length){for(var o=function(e,t){var r,n,i=[],a=C(e);if(v(e,t))for(var o=0;o<e.args.length;o++)(n=e.args.slice(0)).splice(o,1),r=1===n.length?n[0]:a(n),i.push(a([e.args[o],r]));else for(var s=1;s<e.args.length;s++){var l=e.args[0];s>1&&(l=a(e.args.slice(0,s))),r=1===(n=e.args.slice(s)).length?n[0]:a(n),i.push(a([l,r]))}return i}(t,r),s=[],l=0;l<o.length;l++){var h=L(e,o[l],r,!0);s=s.concat(h)}return s}if(e.args.length>2)throw Error("Unexpected non-binary associative function: "+e.toString());return[]}for(var p=[],f=0;f<e.args.length;f++){var y=L(e.args[f],t.args[f],r);if(0===y.length)break;p.push(y)}if(p.length!==e.args.length){if(!v(t,r)||1===e.args.length)return[];if(e.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var _=L(e.args[0],t.args[1],r);if(0===_.length)return[];var b=L(e.args[1],t.args[0],r);if(0===b.length)return[];p=[_,b]}a=function(e){if(0===e.length)return e;for(var t=e.reduce(O),r=[],n={},i=0;i<t.length;i++){var a=JSON.stringify(t[i],g);n[a]||(n[a]=!0,r.push(t[i]))}return r}(p)}else if(e instanceof m){if(0===e.name.length)throw new Error("Symbol in rule has 0 length...!?");if(N[e.name]){if(e.name!==t.name)return[]}else switch(e.name[1]>="a"&&e.name[1]<="z"?e.name.substring(0,2):e.name[0]){case"n":case"_p":a[0].placeholders[e.name]=t;break;case"c":case"cl":if(!gi(t))return[];a[0].placeholders[e.name]=t;break;case"v":if(gi(t))return[];a[0].placeholders[e.name]=t;break;case"vl":if(!Si(t))return[];a[0].placeholders[e.name]=t;break;case"cd":if(!ys(t))return[];a[0].placeholders[e.name]=t;break;case"vd":if(ys(t))return[];a[0].placeholders[e.name]=t;break;case"ce":if(!vs(t))return[];a[0].placeholders[e.name]=t;break;case"ve":if(vs(t))return[];a[0].placeholders[e.name]=t;break;default:throw new Error("Invalid symbol in rule: "+e.name)}}else{if(!(e instanceof u))return[];if(!n(e.value,t.value))return[]}return a}function q(e,t){if(e instanceof u&&t instanceof u){if(!n(e.value,t.value))return!1}else if(e instanceof m&&t instanceof m){if(e.name!==t.name)return!1}else{if(!(e instanceof d&&t instanceof d||e instanceof c&&t instanceof c))return!1;if(e instanceof d){if(e.op!==t.op||e.fn!==t.fn)return!1}else if(e instanceof c&&e.name!==t.name)return!1;if(e.args.length!==t.args.length)return!1;for(var r=0;r<e.args.length;r++)if(!q(e.args[r],t.args[r]))return!1}return!0}return D})),_s="symbolicEqual",bs=Ii(_s,["parse","simplify","typed","OperatorNode"],(e=>{var{parse:t,simplify:r,typed:n,OperatorNode:i}=e;function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=new i("-","subtract",[e,t]),o=r(a,{},n);return gi(o)&&!o.value}return n(_s,{"Node, Node":a,"Node, Node, Object":a})})),ws="leafCount",As=Ii(ws,["parse","typed"],(e=>{var{parse:t,typed:r}=e;function n(e){var t=0;return e.forEach((e=>{t+=n(e)})),t||1}return r(ws,{Node:function(e){return n(e)}})})),Cs="parser",Es=Ii(Cs,["typed","Parser"],(e=>{var{typed:t,Parser:r}=e;return t(Cs,{"":function(){return new r}})})),Ms="rationalize",Ss=Ii(Ms,["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],(e=>{var{config:t,typed:r,equal:n,isZero:i,add:a,subtract:o,multiply:s,divide:l,pow:u,parse:c,simplifyConstant:h,simplifyCore:p,simplify:d,fraction:f,bignumber:m,mathWithTransform:g,matrix:y,AccessorNode:v,ArrayNode:x,ConstantNode:_,FunctionNode:b,IndexNode:w,ObjectNode:A,OperatorNode:C,SymbolNode:E,ParenthesisNode:M}=e;function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=function(){var e=[p,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},h,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],t=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],r=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],n={};return n.firstRules=e.concat(t,r),n.distrDivRules=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],n.sucDivRules=r,n.firstRulesAgain=e.concat(t),n.finalRules=[p,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},h,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],n}(),i=function(e,t,r,n){var i=[],a=d(e,n,t,{exactFractions:!1}),o="+-*"+((r=!!r)?"/":"");!function e(t){var r=t.type;if("FunctionNode"===r)throw new Error("There is an unsolved function call");if("OperatorNode"===r)if("^"===t.op){if("ConstantNode"!==t.args[1].type||!Fi(parseFloat(t.args[1].value)))throw new Error("There is a non-integer exponent");e(t.args[0])}else{if(!o.includes(t.op))throw new Error("Operator "+t.op+" invalid in polynomial expression");for(var n=0;n<t.args.length;n++)e(t.args[n])}else if("SymbolNode"===r){var a=t.name;-1===i.indexOf(a)&&i.push(a)}else if("ParenthesisNode"===r)e(t.content);else if("ConstantNode"!==r)throw new Error("type "+r+" is not allowed in polynomial expression")}(a);var s={};return s.expression=a,s.variables=i,s}(e,t,!0,n.firstRules),a=i.variables.length,o={exactFractions:!1},s={exactFractions:!0};if(e=i.expression,a>=1){var l,u;e=D(e);var c,f=!0,m=!1;for(e=d(e,n.firstRules,{},o);u=f?n.distrDivRules:n.sucDivRules,f=!f,(c=(e=d(e,u,{},s)).toString())!==l;)m=!0,l=c;m&&(e=d(e,n.firstRulesAgain,{},o)),e=d(e,n.finalRules,{},o)}var g=[],y={};return"OperatorNode"===e.type&&e.isBinary()&&"/"===e.op?(1===a&&(e.args[0]=T(e.args[0],g),e.args[1]=T(e.args[1])),r&&(y.numerator=e.args[0],y.denominator=e.args[1])):(1===a&&(e=T(e,g)),r&&(y.numerator=e,y.denominator=null)),r?(y.coefficients=g,y.variables=i.variables,y.expression=e,y):e}return r(Ms,{Node:S,"Node, boolean":(e,t)=>S(e,{},t),"Node, Object":S,"Node, Object, boolean":S});function D(e,t,r){var n=e.type,i=arguments.length>1;if("OperatorNode"===n&&e.isBinary()){var a,o=!1;if("^"===e.op&&("ParenthesisNode"!==e.args[0].type&&"OperatorNode"!==e.args[0].type||"ConstantNode"!==e.args[1].type||(o=(a=parseFloat(e.args[1].value))>=2&&Fi(a))),o){if(a>2){var s=e.args[0],l=new C("^","pow",[e.args[0].cloneDeep(),new _(a-1)]);e=new C("*","multiply",[s,l])}else e=new C("*","multiply",[e.args[0],e.args[0].cloneDeep()]);i&&("content"===r?t.content=e:t.args[r]=e)}}if("ParenthesisNode"===n)D(e.content,e,"content");else if("ConstantNode"!==n&&"SymbolNode"!==n)for(var u=0;u<e.args.length;u++)D(e.args[u],e,u);if(!i)return e}function T(e,t){void 0===t&&(t=[]),t[0]=0;var r=0,n="";!function e(i,a,o){var s=i.type;if("FunctionNode"===s)throw new Error("There is an unsolved function call");if("OperatorNode"===s){if(!"+-*^".includes(i.op))throw new Error("Operator "+i.op+" invalid");if(null!==a){if(("unaryMinus"===i.fn||"pow"===i.fn)&&"add"!==a.fn&&"subtract"!==a.fn&&"multiply"!==a.fn)throw new Error("Invalid "+i.op+" placing");if(("subtract"===i.fn||"add"===i.fn||"multiply"===i.fn)&&"add"!==a.fn&&"subtract"!==a.fn)throw new Error("Invalid "+i.op+" placing");if(("subtract"===i.fn||"add"===i.fn||"unaryMinus"===i.fn)&&0!==o.noFil)throw new Error("Invalid "+i.op+" placing")}"^"!==i.op&&"*"!==i.op||(o.fire=i.op);for(var l=0;l<i.args.length;l++)"unaryMinus"===i.fn&&(o.oper="-"),"+"!==i.op&&"subtract"!==i.fn||(o.fire="",o.cte=1,o.oper=0===l?"+":i.op),o.noFil=l,e(i.args[l],i,o)}else if("SymbolNode"===s){if(i.name!==n&&""!==n)throw new Error("There is more than one variable");if(n=i.name,null===a)return void(t[1]=1);if("^"===a.op&&0!==o.noFil)throw new Error("In power the variable should be the first parameter");if("*"===a.op&&1!==o.noFil)throw new Error("In multiply the variable should be the second parameter");""!==o.fire&&"*"!==o.fire||(r<1&&(t[1]=0),t[1]+=o.cte*("+"===o.oper?1:-1),r=Math.max(1,r))}else{if("ConstantNode"!==s)throw new Error("Type "+s+" is not allowed");var u=parseFloat(i.value);if(null===a)return void(t[0]=u);if("^"===a.op){if(1!==o.noFil)throw new Error("Constant cannot be powered");if(!Fi(u)||u<=0)throw new Error("Non-integer exponent is not allowed");for(var c=r+1;c<u;c++)t[c]=0;return u>r&&(t[u]=0),t[u]+=o.cte*("+"===o.oper?1:-1),void(r=Math.max(u,r))}o.cte=u,""===o.fire&&(t[0]+=o.cte*("+"===o.oper?1:-1))}}(e,null,{cte:1,oper:"+",fire:""});for(var i,a=!0,o=r=t.length-1;o>=0;o--)if(0!==t[o]){var s=new _(a?t[o]:Math.abs(t[o])),l=t[o]<0?"-":"+";if(o>0){var u=new E(n);if(o>1){var c=new _(o);u=new C("^","pow",[u,c])}s=-1===t[o]&&a?new C("-","unaryMinus",[u]):1===Math.abs(t[o])?u:new C("*","multiply",[s,u])}i=a?s:"+"===l?new C("+","add",[i,s]):new C("-","subtract",[i,s]),a=!1}return a?new _(0):i}})),Ds="derivative",Ts=Ii(Ds,["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],(e=>{var{typed:t,config:r,parse:n,simplify:i,equal:a,isZero:o,numeric:s,ConstantNode:l,FunctionNode:u,OperatorNode:c,ParenthesisNode:h,SymbolNode:p}=e;function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{simplify:!0},n=new Map,a=t.name,o=v(e,(function e(t){var r=n.get(t);if(void 0!==r)return r;var i=y(e,t,a);return n.set(t,i),i}));return r.simplify?i(o):o}function f(e){var t=n(e);if(!t.isSymbolNode)throw new TypeError("Invalid variable. "+"Cannot parse ".concat(JSON.stringify(e)," into a variable in function derivative"));return t}var m=t(Ds,{"Node, SymbolNode":d,"Node, SymbolNode, Object":d,"Node, string":(e,t)=>d(e,f(t)),"Node, string, Object":(e,t,r)=>d(e,f(t),r)});m._simplify=!0,m.toTex=function(e){return g.apply(null,e.args)};var g=t("_derivTex",{"Node, SymbolNode":function(e,t){return gi(e)&&"string"===Ti(e.value)?g(n(e.value).toString(),t.toString(),1):g(e.toTex(),t.toString(),1)},"Node, ConstantNode":function(e,t){if("string"===Ti(t.value))return g(e,n(t.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(e,t,r){return g(e.toString(),t.name,r.value)},"string, string, number":function(e,t,r){return(1===r?"{d\\over d"+t+"}":"{d^{"+r+"}\\over d"+t+"^{"+r+"}}")+"\\left[".concat(e,"\\right]")}}),y=t("_isConst",{"function, ConstantNode, string":function(){return!0},"function, SymbolNode, string":function(e,t,r){return t.name!==r},"function, ParenthesisNode, string":function(e,t,r){return e(t.content,r)},"function, FunctionAssignmentNode, string":function(e,t,r){return!t.params.includes(r)||e(t.expr,r)},"function, FunctionNode | OperatorNode, string":function(e,t,r){return t.args.every((t=>e(t,r)))}}),v=t("_derivative",{"ConstantNode, function":function(){return x(0)},"SymbolNode, function":function(e,t){return t(e)?x(0):x(1)},"ParenthesisNode, function":function(e,t){return new h(v(e.content,t))},"FunctionAssignmentNode, function":function(e,t){return t(e)?x(0):v(e.expr,t)},"FunctionNode, function":function(e,t){if(t(e))return x(0);var r,n,i,a,o=e.args[0],s=!1,l=!1;switch(e.name){case"cbrt":s=!0,n=new c("*","multiply",[x(3),new c("^","pow",[o,new c("/","divide",[x(2),x(3)])])]);break;case"sqrt":case"nthRoot":if(1===e.args.length)s=!0,n=new c("*","multiply",[x(2),new u("sqrt",[o])]);else if(2===e.args.length)return r=new c("/","divide",[x(1),e.args[1]]),v(new c("^","pow",[o,r]),t);break;case"log10":r=x(10);case"log":if(r||1!==e.args.length){if(1===e.args.length&&r||2===e.args.length&&t(e.args[1]))n=new c("*","multiply",[o.clone(),new u("log",[r||e.args[1]])]),s=!0;else if(2===e.args.length)return v(new c("/","divide",[new u("log",[o]),new u("log",[e.args[1]])]),t)}else n=o.clone(),s=!0;break;case"pow":if(2===e.args.length)return v(new c("^","pow",[o,e.args[1]]),t);break;case"exp":n=new u("exp",[o.clone()]);break;case"sin":n=new u("cos",[o.clone()]);break;case"cos":n=new c("-","unaryMinus",[new u("sin",[o.clone()])]);break;case"tan":n=new c("^","pow",[new u("sec",[o.clone()]),x(2)]);break;case"sec":n=new c("*","multiply",[e,new u("tan",[o.clone()])]);break;case"csc":l=!0,n=new c("*","multiply",[e,new u("cot",[o.clone()])]);break;case"cot":l=!0,n=new c("^","pow",[new u("csc",[o.clone()]),x(2)]);break;case"asin":s=!0,n=new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[o.clone(),x(2)])])]);break;case"acos":s=!0,l=!0,n=new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[o.clone(),x(2)])])]);break;case"atan":s=!0,n=new c("+","add",[new c("^","pow",[o.clone(),x(2)]),x(1)]);break;case"asec":s=!0,n=new c("*","multiply",[new u("abs",[o.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),x(2)]),x(1)])])]);break;case"acsc":s=!0,l=!0,n=new c("*","multiply",[new u("abs",[o.clone()]),new u("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),x(2)]),x(1)])])]);break;case"acot":s=!0,l=!0,n=new c("+","add",[new c("^","pow",[o.clone(),x(2)]),x(1)]);break;case"sinh":n=new u("cosh",[o.clone()]);break;case"cosh":n=new u("sinh",[o.clone()]);break;case"tanh":n=new c("^","pow",[new u("sech",[o.clone()]),x(2)]);break;case"sech":l=!0,n=new c("*","multiply",[e,new u("tanh",[o.clone()])]);break;case"csch":l=!0,n=new c("*","multiply",[e,new u("coth",[o.clone()])]);break;case"coth":l=!0,n=new c("^","pow",[new u("csch",[o.clone()]),x(2)]);break;case"asinh":s=!0,n=new u("sqrt",[new c("+","add",[new c("^","pow",[o.clone(),x(2)]),x(1)])]);break;case"acosh":s=!0,n=new u("sqrt",[new c("-","subtract",[new c("^","pow",[o.clone(),x(2)]),x(1)])]);break;case"atanh":s=!0,n=new c("-","subtract",[x(1),new c("^","pow",[o.clone(),x(2)])]);break;case"asech":s=!0,l=!0,n=new c("*","multiply",[o.clone(),new u("sqrt",[new c("-","subtract",[x(1),new c("^","pow",[o.clone(),x(2)])])])]);break;case"acsch":s=!0,l=!0,n=new c("*","multiply",[new u("abs",[o.clone()]),new u("sqrt",[new c("+","add",[new c("^","pow",[o.clone(),x(2)]),x(1)])])]);break;case"acoth":s=!0,l=!0,n=new c("-","subtract",[x(1),new c("^","pow",[o.clone(),x(2)])]);break;case"abs":n=new c("/","divide",[new u(new p("abs"),[o.clone()]),o.clone()]);break;default:throw new Error('Cannot process function "'+e.name+'" in derivative: the function is not supported, undefined, or the number of arguments passed to it are not supported')}s?(i="/",a="divide"):(i="*",a="multiply");var h=v(o,t);return l&&(h=new c("-","unaryMinus",[h])),new c(i,a,[h,n])},"OperatorNode, function":function(e,t){if(t(e))return x(0);if("+"===e.op)return new c(e.op,e.fn,e.args.map((function(e){return v(e,t)})));if("-"===e.op){if(e.isUnary())return new c(e.op,e.fn,[v(e.args[0],t)]);if(e.isBinary())return new c(e.op,e.fn,[v(e.args[0],t),v(e.args[1],t)])}if("*"===e.op){var r=e.args.filter((function(e){return t(e)}));if(r.length>0){var n=e.args.filter((function(e){return!t(e)})),i=1===n.length?n[0]:new c("*","multiply",n),s=r.concat(v(i,t));return new c("*","multiply",s)}return new c("+","add",e.args.map((function(r){return new c("*","multiply",e.args.map((function(e){return e===r?v(e,t):e.clone()})))})))}if("/"===e.op&&e.isBinary()){var l=e.args[0],h=e.args[1];return t(h)?new c("/","divide",[v(l,t),h]):t(l)?new c("*","multiply",[new c("-","unaryMinus",[l]),new c("/","divide",[v(h,t),new c("^","pow",[h.clone(),x(2)])])]):new c("/","divide",[new c("-","subtract",[new c("*","multiply",[v(l,t),h.clone()]),new c("*","multiply",[l.clone(),v(h,t)])]),new c("^","pow",[h.clone(),x(2)])])}if("^"===e.op&&e.isBinary()){var p=e.args[0],d=e.args[1];if(t(p))return gi(p)&&(o(p.value)||a(p.value,1))?x(0):new c("*","multiply",[e,new c("*","multiply",[new u("log",[p.clone()]),v(d.clone(),t)])]);if(t(d)){if(gi(d)){if(o(d.value))return x(0);if(a(d.value,1))return v(p,t)}var f=new c("^","pow",[p.clone(),new c("-","subtract",[d,x(1)])]);return new c("*","multiply",[d.clone(),new c("*","multiply",[v(p,t),f])])}return new c("*","multiply",[new c("^","pow",[p.clone(),d.clone()]),new c("+","add",[new c("*","multiply",[v(p,t),new c("/","divide",[d.clone(),p.clone()])]),new c("*","multiply",[v(d,t),new u("log",[p.clone()])])])])}throw new Error('Cannot process operator "'+e.op+'" in derivative: the operator is not supported, undefined, or the number of arguments passed to it are not supported')}});function x(e,t){return new l(s(e,t||Ri(String(e),r)))}return m})),Ns={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},Is={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},Ps={bignumber:{name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","bigint","complex","fraction","index","matrix","string","unit"]},bigint:{name:"bigint",category:"Construction",syntax:["bigint(x)"],description:"Create a bigint, an integer with an arbitrary number of digits, from a number or string.",examples:["123123123123123123 # a large number will lose digits",'bigint("123123123123123123")','bignumber(["1", "3", "5"])'],seealso:["boolean","bignumber","number","complex","fraction","index","matrix","string","unit"]},boolean:{name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},complex:{name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},createUnit:{name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},fraction:{name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},index:{name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = 1","B = [1, 2, 3]","B[B>1 and B<3]"],seealso:["bignumber","boolean","complex","matrix","number","range","string","unit"]},matrix:{name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},number:{name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","bigint","boolean","complex","fraction","index","matrix","string","unit"]},sparse:{name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},splitUnit:{name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},string:{name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},unit:{name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},e:Ns,E:Ns,false:{name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},i:{name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Infinity:{name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},LN2:{name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},LN10:{name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},LOG2E:{name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},LOG10E:{name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},NaN:{name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},null:{name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},pi:Is,PI:Is,phi:{name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},SQRT1_2:{name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},SQRT2:{name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},tau:{name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},true:{name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},version:{name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant. Deprecated in favor of coulombConstant",examples:["coulombConstant"]},coulombConstant:{description:"Coulomb's constant",examples:["coulombConstant"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Bohr magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Bohr radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:{name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},lsolve:{name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},lsolveAll:{name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},lup:{name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lusolve:{name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},leafCount:{name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},polynomialRoot:{name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},resolve:{name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},simplify:{name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},simplifyConstant:{name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},simplifyCore:{name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},symbolicEqual:{name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},rationalize:{name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},slu:{name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},usolve:{name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},usolveAll:{name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},qr:{name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},abs:{name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},add:{name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},cbrt:{name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},ceil:{name:"ceil",category:"Arithmetic",syntax:["ceil(x)","ceil(x, n)","ceil(unit, valuelessUnit)","ceil(unit, n, valuelessUnit)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)","ceil(3.241cm, cm)","ceil(3.241cm, 2, cm)"],seealso:["floor","fix","round"]},cube:{name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},divide:{name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},dotDivide:{name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},dotMultiply:{name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},dotPow:{name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},exp:{name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},expm:{name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},expm1:{name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},fix:{name:"fix",category:"Arithmetic",syntax:["fix(x)","fix(x, n)","fix(unit, valuelessUnit)","fix(unit, n, valuelessUnit)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)","fix(3.241cm, cm)","fix(3.241cm, 2, cm)"],seealso:["ceil","floor","round"]},floor:{name:"floor",category:"Arithmetic",syntax:["floor(x)","floor(x, n)","floor(unit, valuelessUnit)","floor(unit, n, valuelessUnit)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)","floor(3.241cm, cm)","floor(3.241cm, 2, cm)"],seealso:["ceil","fix","round"]},gcd:{name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},hypot:{name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenuse of a list with values.",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},lcm:{name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},log:{name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},log2:{name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},log1p:{name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},log10:{name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},mod:{name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},multiply:{name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},norm:{name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},nthRoot:{name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},nthRoots:{name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},pow:{name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},round:{name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)","round(unit, valuelessUnit)","round(unit, n, valuelessUnit)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)","round(3.241cm, 2, cm)","round([3.2, 3.8, -4.7])"],seealso:["ceil","floor","fix"]},sign:{name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>0, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},sqrt:{name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},sqrtm:{name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},square:{name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},subtract:{name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},unaryMinus:{name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},unaryPlus:{name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},xgcd:{name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},invmod:{name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax ≣ 1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},bitAnd:{name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitNot:{name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitOr:{name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},bitXor:{name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},leftShift:{name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},rightArithShift:{name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},rightLogShift:{name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},bellNumbers:{name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},catalan:{name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},composition:{name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},stirlingS2:{name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},config:{name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},import:{name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},typed:{name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},arg:{name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},conj:{name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},re:{name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},im:{name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},evaluate:{name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:["parser","parse","compile"]},help:{name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},parse:{name:"parse",category:"Expression",syntax:["parse(expr)","parse(expr, options)","parse([expr1, expr2, expr3, ...])","parse([expr1, expr2, expr3, ...], options)"],description:"Parse an expression. Returns a node tree, which can be evaluated by invoking node.evaluate() or transformed into a functional object via node.compile().",examples:['node1 = parse("sqrt(3^2 + 4^2)")',"node1.evaluate()","code1 = node1.compile()","code1.evaluate()","scope = {a: 3, b: 4}",'node2 = parse("a * b")',"node2.evaluate(scope)","code2 = node2.compile()","code2.evaluate(scope)"],seealso:["parser","evaluate","compile"]},parser:{name:"parser",category:"Expression",syntax:["parser()"],description:"Create a parser object that keeps a context of variables and their values, allowing the evaluation of expressions in that context.",examples:["myParser = parser()",'myParser.evaluate("sqrt(3^2 + 4^2)")','myParser.set("x", 3)','myParser.evaluate("y = x + 3")','myParser.evaluate(["y = x + 3", "y = y + 1"])','myParser.get("y")'],seealso:["evaluate","parse","compile"]},compile:{name:"compile",category:"Expression",syntax:["compile(expr) ","compile([expr1, expr2, expr3, ...])"],description:"Parse and compile an expression. Returns a an object with a function evaluate([scope]) to evaluate the compiled expression.",examples:['code1 = compile("sqrt(3^2 + 4^2)")',"code1.evaluate() ",'code2 = compile("a * b")',"code2.evaluate({a: 3, b: 4})"],seealso:["parser","parse","evaluate"]},distance:{name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},intersect:{name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},and:{name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},not:{name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},or:{name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},xor:{name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},mapSlices:{name:"mapSlices",category:"Matrix",syntax:["mapSlices(A, dim, callback)"],description:"Generate a matrix one dimension less than A by applying callback to each slice of A along dimension dim.",examples:["A = [[1, 2], [3, 4]]","mapSlices(A, 1, sum)","mapSlices(A, 2, prod)"],seealso:["map","forEach"]},concat:{name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},count:{name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},cross:{name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},column:{name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},ctranspose:{name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},det:{name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diag:{name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diff:{name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicate the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},dot:{name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},getMatrixDataType:{name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},identity:{name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},filter:{name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},flatten:{name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},forEach:{name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},inv:{name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},pinv:{name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the Moore–Penrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},eigs:{name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and optionally eigenvectors of a square matrix",examples:["eigs([[5, 2.3], [2.3, 1]])","eigs([[1, 2, 3], [4, 5, 6], [7, 8, 9]], { precision: 1e-6, eigenvectors: false })"],seealso:["inv"]},kron:{name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the Kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},matrixFromFunction:{name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},matrixFromRows:{name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},matrixFromColumns:{name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},map:{name:"map",category:"Matrix",syntax:["map(x, callback)","map(x, y, ..., callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array or the matrices/arrays.",examples:["map([1, 2, 3], square)","map([1, 2], [3, 4], f(a,b) = a + b)"],seealso:["filter","forEach"]},ones:{name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},partitionSelect:{name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},range:{name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},resize:{name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},reshape:{name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},rotate:{name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},rotationMatrix:{name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},row:{name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},size:{name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},sort:{name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},squeeze:{name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},subset:{name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},trace:{name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},transpose:{name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},zeros:{name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},fft:{name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional Fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},ifft:{name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse Fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},sylvester:{name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},schur:{name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},lyap:{name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},solveODE:{name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},combinations:{name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},combinationsWithRep:{name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},factorial:{name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},gamma:{name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},kldivergence:{name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},lgamma:{name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},multinomial:{name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},permutations:{name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},pickRandom:{name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},random:{name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},randomInt:{name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},compare:{name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},compareNatural:{name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},compareText:{name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},deepEqual:{name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},equal:{name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},equalText:{name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},larger:{name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not. Comparing a value with NaN returns false.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},largerEq:{name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},smaller:{name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not. Comparing a value with NaN returns false.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},smallerEq:{name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},unequal:{name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},setCartesian:{name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},setDifference:{name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},setDistinct:{name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},setIntersect:{name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},setIsSubset:{name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},setMultiplicity:{name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},setPowerset:{name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},setSize:{name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},setSymDifference:{name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},setUnion:{name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},zpk2tf:{name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},freqz:{name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},erf:{name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},zeta:{name:"zeta",category:"Special",syntax:["zeta(s)"],description:"Compute the Riemann Zeta Function using an infinite series and Riemann's Functional Equation for the entire complex plane",examples:["zeta(0.2)","zeta(-0.5)","zeta(4)"],seealso:[]},cumsum:{name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},mad:{name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},max:{name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},mean:{name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},median:{name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},min:{name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},mode:{name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},prod:{name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},quantileSeq:{name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probability are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},std:{name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},sum:{name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","variance"]},variance:{name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},corr:{name:"corr",category:"Statistics",syntax:["corr(A,B)"],description:"Compute the correlation coefficient of a two list with values, For matrices, the matrix correlation coefficient is calculated.",examples:["corr([2, 4, 6, 8],[1, 2, 3, 6])","corr(matrix([[1, 2.2, 3, 4.8, 5], [1, 2, 3, 4, 5]]), matrix([[4, 5.3, 6.6, 7, 8], [1, 2, 3, 4, 5]]))"],seealso:["max","mean","min","median","min","prod","std","sum"]},acos:{name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},acosh:{name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},acot:{name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},acoth:{name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the inverse hyperbolic tangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},acsc:{name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},acsch:{name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the inverse hyperbolic cosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},asec:{name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},asech:{name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},asin:{name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},asinh:{name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},atan:{name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},atanh:{name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},atan2:{name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},cos:{name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},cosh:{name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},cot:{name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},coth:{name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},csc:{name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},csch:{name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},sec:{name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},sech:{name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},sin:{name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},sinh:{name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},tan:{name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},tanh:{name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},to:{name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},clone:{name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables, and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},format:{name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},bin:{name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},oct:{name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},hex:{name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},isNaN:{name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isInteger:{name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isNegative:{name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},isNumeric:{name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue"]},hasNumericValue:{name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},isPositive:{name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isPrime:{name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isZero:{name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},print:{name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $1, $2, $3", [6, 9, 4])'],seealso:["format"]},typeOf:{name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},numeric:{name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, bigint, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "bigint")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","bigint","fraction","bignumber","string","format"]}},zs="help",Bs=Ii(zs,["typed","mathWithTransform","Help"],(e=>{var{typed:t,mathWithTransform:r,Help:n}=e;return t(zs,{any:function(e){var t,i=e;if("string"!=typeof e)for(t in r)if(Tn(r,t)&&e===r[t]){i=t;break}var a=Nn(Ps,i);if(!a){var o="function"==typeof i?i.name:i;throw new Error('No documentation found on "'+o+'"')}return new n(a)}})})),ks="mapSlices",Fs=Ii(ks,["typed","isInteger"],(e=>{var{typed:t,isInteger:r}=e;return t(ks,{"Array | Matrix, number | BigNumber, function":function(e,t,n){if(!r(t))throw new TypeError("Integer number expected for dimension");var i=Array.isArray(e)?ba(e):e.size();if(t<0||t>=i.length)throw new _a(t,i.length);return Xn(e)?e.create(Rs(e.valueOf(),t,n),e.datatype()):Rs(e,t,n)}})}),{formerly:"apply"});function Rs(e,t,r){var n,i,a;if(t<=0){if(Array.isArray(e[0])){for(a=function(e){var t,r,n=e.length,i=e[0].length,a=[];for(r=0;r<i;r++){var o=[];for(t=0;t<n;t++)o.push(e[t][r]);a.push(o)}return a}(e),i=[],n=0;n<a.length;n++)i[n]=Rs(a[n],t-1,r);return i}return r(e)}for(i=[],n=0;n<e.length;n++)i[n]=Rs(e[n],t-1,r);return i}function Os(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Ls=Ii("mapSlices",["typed","isInteger"],(e=>{var{typed:t,isInteger:r}=e,n=Fs({typed:t,isInteger:r});return t("mapSlices",{"...any":function(e){var t=e[1];jn(t)?e[1]=t-1:Un(t)&&(e[1]=t.minus(1));try{return n.apply(null,e)}catch(e){throw ko(e)}}})}),function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Os(Object(r),!0).forEach((function(t){ki(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Os(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isTransformFunction:!0},Fs.meta)),qs=r(2369);function js(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(qs.isTypedFunction(e)){var i,a;if(n)i=1;else{var o=(t.isMatrix?t.size():ba(t)).map((()=>0)),s=t.isMatrix?t.get(o):Ya(t,o);i=function(e,t,r,n){for(var i=[t,r,n],a=3;a>0;a--){var o=i.slice(0,a);if(null!==qs.resolve(e,o))return a}}(e,s,o,t)}if(t.isMatrix&&"mixed"!==t.dataType&&void 0!==t.dataType){var l=function(e,t){var r=[];if(Object.entries(e.signatures).forEach((e=>{var[n,i]=e;n.split(",").length===t&&r.push(i)})),1===r.length)return r[0]}(e,i);a=void 0!==l?l:e}else a=e;return i>=1&&i<=3?{isUnary:1===i,fn:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return Vs(a,n.slice(0,i),r,e.name)}}:{isUnary:!1,fn:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Vs(a,n,r,e.name)}}}return void 0===n?{isUnary:Us(e),fn:e}:{isUnary:n,fn:e}}function Us(e){if(1!==e.length)return!1;var t=e.toString();if(/arguments/.test(t))return!1;var r=t.match(/\(.*?\)/);return!/\.\.\./.test(r)}function Vs(e,t,r,n){try{return e(...t)}catch(e){!function(e,t,r,n){var i;if(e instanceof TypeError&&"wrongType"===(null===(i=e.data)||void 0===i?void 0:i.category)){var a=[];throw a.push("value: ".concat(Ti(t[0]))),t.length>=2&&a.push("index: ".concat(Ti(t[1]))),t.length>=3&&a.push("array: ".concat(Ti(t[2]))),new TypeError("Function ".concat(r," cannot apply callback arguments ")+"".concat(n,"(").concat(a.join(", "),") at index ").concat(JSON.stringify(t[1])))}throw new TypeError("Function ".concat(r," cannot apply callback arguments ")+"to function ".concat(n,": ").concat(e.message))}(e,t,r,n)}}var Zs=Ii("filter",["typed"],(e=>{var{typed:t}=e;return t("filter",{"Array, function":$s,"Matrix, function":function(e,t){return e.create($s(e.valueOf(),t),e.datatype())},"Array, RegExp":qa,"Matrix, RegExp":function(e,t){return e.create(qa(e.valueOf(),t),e.datatype())}})}));function $s(e,t){var r=js(t,e,"filter");return r.isUnary?La(e,r.fn):La(e,(function(e,t,n){return r.fn(e,[t],n)}))}function Gs(e,t,r){var n=e.filter((function(e){return Si(e)&&!(e.name in t)&&!r.has(e.name)}))[0];if(!n)throw new Error('No undefined variable found in inline expression "'+e+'"');var i=n.name,a=new Map,o=new Rn(r,a,new Set([i])),s=e.compile();return function(e){return a.set(i,e),s.evaluate(o)}}var Hs=Ii("transformCallback",["typed"],(e=>{var{typed:t}=e;return function(e,n){return t.isTypedFunction(e)?r(e,n):Ws(e,e.length,n)};function r(e,n){var i=Object.fromEntries(Object.entries(e.signatures).map((e=>{var[i,a]=e,o=i.split(",").length;return t.isTypedFunction(a)?[i,r(a,n)]:[i,Ws(a,o,n)]})));return"string"==typeof e.name?t(e.name,i):t(i)}}));function Ws(e,t,r){return t===r?e:t===r+1?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=n.slice(0,r),o=Xs(n[r]);return e(...a,o)}:t>r+1?function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=n.slice(0,r),o=Xs(n[r]),s=n.slice(r+1);return e(...a,o,...s)}:e}function Xs(e){return e.map((e=>e+1))}var Ys=Ii("filter",["typed"],(e=>{var{typed:t}=e;function r(e,r,i){var a=Zs({typed:t}),o=Hs({typed:t});if(0===e.length)return a();var s=e[0];if(1===e.length)return a(s);var l=e.length-1,u=e[l];return s&&(s=n(s,i)),u&&(u=Si(u)||vi(u)?n(u,i):Gs(u,r,i)),a(s,o(u,l))}function n(e,t){return e.compile().evaluate(t)}return r.rawArgs=!0,r}),{isTransformFunction:!0}),Ks="forEach",Js=Ii(Ks,["typed"],(e=>{var{typed:t}=e;return t(Ks,{"Array, function":Qs,"Matrix, function":function(e,t){e.forEach(t)}})}));function Qs(e,t){var r=js(t,e,Ks);Ja(e,r.fn,r.isUnary)}var el=Ii("forEach",["typed"],(e=>{var{typed:t}=e,r=Js({typed:t}),n=Hs({typed:t});function i(e,t,i){if(0===e.length)return r();var o=e[0];if(1===e.length)return r(o);var s=e.length-1,l=e[s];return o&&(o=a(o,i)),l&&(l=Si(l)||vi(l)?a(l,i):Gs(l,t,i)),r(o,n(l,s))}function a(e,t){return e.compile().evaluate(t)}return i.rawArgs=!0,i}),{isTransformFunction:!0}),tl="map",rl=Ii(tl,["typed"],(e=>{var{typed:t}=e;return t(tl,{"Array, function":r,"Matrix, function":function(e,t){return e.map(t)},"Array|Matrix, Array|Matrix, ...Array|Matrix|function":(e,n,i)=>function(e,n){if("function"!=typeof n)throw new Error("Last argument must be a callback function");var i,a=e[0].isMatrix,o=Ha(...e.map((e=>e.isMatrix?e.size():ba(e)))),s=a?(e,t)=>e.get(t):Ya,l=a?e.map((t=>t.isMatrix?t.create(Xa(t.toArray(),o),t.datatype()):e[0].create(Xa(t.valueOf(),o)))):e.map((e=>e.isMatrix?Xa(e.toArray(),o):Xa(e,o)));if(t.isTypedFunction(n)){var u=o.map((()=>0)),c=l.map((e=>s(e,u))),h=function(e,r,n,i){return null!==t.resolve(e,[...r,n,...i])?2:null!==t.resolve(e,[...r,n])?1:(t.resolve(e,r),0)}(n,c,u,l);i=m(h)}else{var p=e.length,d=function(e,t){return e.length>t+1?2:e.length===t+1?1:0}(n,p);i=m(d)}var f=(e,t)=>i([e,...l.slice(1).map((e=>s(e,t)))],t);return a?l[0].map(f):r(l[0],f);function m(e){switch(e){case 0:return e=>n(...e);case 1:return(e,t)=>n(...e,t);case 2:return(e,t)=>n(...e,t,...l)}}}([e,n,...i.slice(0,i.length-1)],i[i.length-1])});function r(e,t){var r=js(t,e,tl);return Ka(e,r.fn,r.isUnary)}})),nl=Ii("map",["typed"],(e=>{var{typed:t}=e,r=rl({typed:t}),n=Hs({typed:t});function i(e,t,i){if(0===e.length)return r();if(1===e.length)return r(e[0]);var a=e.length-1,o=e.slice(0,a),s=e[a];return o=o.map((e=>l(e,i))),s&&(s=Si(s)||vi(s)?l(s,i):Gs(s,t,i)),r(...o,n(s,a));function l(e,t){return e.compile().evaluate(t)}}return i.rawArgs=!0,i}),{isTransformFunction:!0}),il=Ii("matAlgo03xDSf",["typed"],(e=>{var{typed:t}=e;return function(e,r,n,i){var a=e._data,o=e._size,s=e._datatype||e.getDataType(),l=r._values,u=r._index,c=r._ptr,h=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(o.length!==h.length)throw new xa(o.length,h.length);if(o[0]!==h[0]||o[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+h+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,f=o[0],m=o[1],g=0,y=n;"string"==typeof s&&s===p&&"mixed"!==s&&(d=s,g=t.convert(0,d),y=t.find(n,[d,d]));for(var v=[],x=0;x<f;x++)v[x]=[];for(var _=[],b=[],w=0;w<m;w++){for(var A=w+1,C=c[w],E=c[w+1],M=C;M<E;M++){var S=u[M];_[S]=i?y(l[M],a[S][w]):y(a[S][w],l[M]),b[S]=A}for(var D=0;D<f;D++)b[D]===A?v[D][w]=_[D]:v[D][w]=i?y(g,a[D][w]):y(a[D][w],g)}return e.createDenseMatrix({data:v,size:[f,m],datatype:s===e._datatype&&p===r._datatype?d:void 0})}})),al=Ii("matAlgo12xSfs",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:r}=e;return function(e,n,i,a){var o=e._values,s=e._index,l=e._ptr,u=e._size,c=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,p=u[0],d=u[1],f=i;"string"==typeof c&&(h=c,n=t.convert(n,h),f=t.find(i,[h,h]));for(var m=[],g=[],y=[],v=0;v<d;v++){for(var x=v+1,_=l[v],b=l[v+1],w=_;w<b;w++){var A=s[w];g[A]=o[w],y[A]=x}for(var C=0;C<p;C++)0===v&&(m[C]=[]),y[C]===x?m[C][v]=a?f(n,g[C]):f(g[C],n):m[C][v]=a?f(n,0):f(0,n)}return new r({data:m,size:[p,d],datatype:h})}})),ol=Ii("matAlgo05xSfSf",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var a=e._values,o=e._index,s=e._ptr,l=e._size,u=e._datatype||void 0===e._data?e._datatype:e.getDataType(),c=n._values,h=n._index,p=n._ptr,d=n._size,f=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(l.length!==d.length)throw new xa(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");var m,g=l[0],y=l[1],v=r,x=0,_=i;"string"==typeof u&&u===f&&"mixed"!==u&&(m=u,v=t.find(r,[m,m]),x=t.convert(0,m),_=t.find(i,[m,m]));var b,w,A,C,E=a&&c?[]:void 0,M=[],S=[],D=E?[]:void 0,T=E?[]:void 0,N=[],I=[];for(w=0;w<y;w++){S[w]=M.length;var P=w+1;for(A=s[w],C=s[w+1];A<C;A++)b=o[A],M.push(b),N[b]=P,D&&(D[b]=a[A]);for(A=p[w],C=p[w+1];A<C;A++)N[b=h[A]]!==P&&M.push(b),I[b]=P,T&&(T[b]=c[A]);if(E)for(A=S[w];A<M.length;){var z=N[b=M[A]],B=I[b];if(z===P||B===P){var k=_(z===P?D[b]:x,B===P?T[b]:x);v(k,x)?M.splice(A,1):(E.push(k),A++)}}}return S[y]=M.length,e.createSparseMatrix({values:E,index:M,ptr:S,size:[g,y],datatype:u===e._datatype&&f===n._datatype?m:void 0})}})),sl=Ii("matAlgo13xDD",["typed"],(e=>{var{typed:t}=e;return function(e,n,i){var a,o=e._data,s=e._size,l=e._datatype,u=n._data,c=n._size,h=n._datatype,p=[];if(s.length!==c.length)throw new xa(s.length,c.length);for(var d=0;d<s.length;d++){if(s[d]!==c[d])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+c+")");p[d]=s[d]}var f=i;"string"==typeof l&&l===h&&(a=l,f=t.find(i,[a,a]));var m=p.length>0?r(f,0,p,p[0],o,u):[];return e.createDenseMatrix({data:m,size:p,datatype:a})};function r(e,t,n,i,a,o){var s=[];if(t===n.length-1)for(var l=0;l<i;l++)s[l]=e(a[l],o[l]);else for(var u=0;u<i;u++)s[u]=r(e,t+1,n,n[t+1],a[u],o[u]);return s}})),ll=Ii("matAlgo14xDs",["typed"],(e=>{var{typed:t}=e;return function(e,n,i,a){var o,s=e._data,l=e._size,u=e._datatype,c=i;"string"==typeof u&&(o=u,n=t.convert(n,o),c=t.find(i,[o,o]));var h=l.length>0?r(c,0,l,l[0],s,n,a):[];return e.createDenseMatrix({data:h,size:Mn(l),datatype:o})};function r(e,t,n,i,a,o,s){var l=[];if(t===n.length-1)for(var u=0;u<i;u++)l[u]=s?e(o,a[u]):e(a[u],o);else for(var c=0;c<i;c++)l[c]=r(e,t+1,n,n[t+1],a[c],o,s);return l}}));function ul(e,t){if(Dn(e.size(),t.size()))return[e,t];var r=Ha(e.size(),t.size());return[e,t].map((e=>function(e,t){return Dn(e.size(),t)?e:e.create(Xa(e.valueOf(),t),e.datatype())}(e,r)))}var cl=Ii("matrixAlgorithmSuite",["typed","matrix"],(e=>{var{typed:t,matrix:r}=e,n=sl({typed:t}),i=ll({typed:t});return function(e){var a,o=e.elop,s=e.SD||e.DS;o?(a={"DenseMatrix, DenseMatrix":(e,t)=>n(...ul(e,t),o),"Array, Array":(e,t)=>n(...ul(r(e),r(t)),o).valueOf(),"Array, DenseMatrix":(e,t)=>n(...ul(r(e),t),o),"DenseMatrix, Array":(e,t)=>n(...ul(e,r(t)),o)},e.SS&&(a["SparseMatrix, SparseMatrix"]=(t,r)=>e.SS(...ul(t,r),o,!1)),e.DS&&(a["DenseMatrix, SparseMatrix"]=(t,r)=>e.DS(...ul(t,r),o,!1),a["Array, SparseMatrix"]=(t,n)=>e.DS(...ul(r(t),n),o,!1)),s&&(a["SparseMatrix, DenseMatrix"]=(e,t)=>s(...ul(t,e),o,!0),a["SparseMatrix, Array"]=(e,t)=>s(...ul(r(t),e),o,!0))):(a={"DenseMatrix, DenseMatrix":t.referToSelf((e=>(t,r)=>n(...ul(t,r),e))),"Array, Array":t.referToSelf((e=>(t,i)=>n(...ul(r(t),r(i)),e).valueOf())),"Array, DenseMatrix":t.referToSelf((e=>(t,i)=>n(...ul(r(t),i),e))),"DenseMatrix, Array":t.referToSelf((e=>(t,i)=>n(...ul(t,r(i)),e)))},e.SS&&(a["SparseMatrix, SparseMatrix"]=t.referToSelf((t=>(r,n)=>e.SS(...ul(r,n),t,!1)))),e.DS&&(a["DenseMatrix, SparseMatrix"]=t.referToSelf((t=>(r,n)=>e.DS(...ul(r,n),t,!1))),a["Array, SparseMatrix"]=t.referToSelf((t=>(n,i)=>e.DS(...ul(r(n),i),t,!1)))),s&&(a["SparseMatrix, DenseMatrix"]=t.referToSelf((e=>(t,r)=>s(...ul(r,t),e,!0))),a["SparseMatrix, Array"]=t.referToSelf((e=>(t,n)=>s(...ul(r(n),t),e,!0)))));var l=e.scalar||"any";(e.Ds||e.Ss)&&(o?(a["DenseMatrix,"+l]=(e,t)=>i(e,t,o,!1),a[l+", DenseMatrix"]=(e,t)=>i(t,e,o,!0),a["Array,"+l]=(e,t)=>i(r(e),t,o,!1).valueOf(),a[l+", Array"]=(e,t)=>i(r(t),e,o,!0).valueOf()):(a["DenseMatrix,"+l]=t.referToSelf((e=>(t,r)=>i(t,r,e,!1))),a[l+", DenseMatrix"]=t.referToSelf((e=>(t,r)=>i(r,t,e,!0))),a["Array,"+l]=t.referToSelf((e=>(t,n)=>i(r(t),n,e,!1).valueOf())),a[l+", Array"]=t.referToSelf((e=>(t,n)=>i(r(n),t,e,!0).valueOf()))));var u=void 0!==e.sS?e.sS:e.Ss;return o?(e.Ss&&(a["SparseMatrix,"+l]=(t,r)=>e.Ss(t,r,o,!1)),u&&(a[l+", SparseMatrix"]=(e,t)=>u(t,e,o,!0))):(e.Ss&&(a["SparseMatrix,"+l]=t.referToSelf((t=>(r,n)=>e.Ss(r,n,t,!1)))),u&&(a[l+", SparseMatrix"]=t.referToSelf((e=>(t,r)=>u(r,t,e,!0))))),o&&o.signatures&&Sn(a,o.signatures),a}})),hl="number, number";function pl(e){return!e}function dl(e,t){return!(!e&&!t)}function fl(e,t){return!!e!=!!t}function ml(e,t){return!(!e||!t)}pl.signature="number",dl.signature=hl,fl.signature=hl,ml.signature=hl;var gl=Ii("or",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:a}=e,o=il({typed:t}),s=ol({typed:t,equalScalar:n}),l=al({typed:t,DenseMatrix:i}),u=cl({typed:t,matrix:r,concat:a});return t("or",{"number, number":dl,"Complex, Complex":function(e,t){return 0!==e.re||0!==e.im||0!==t.re||0!==t.im},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!e.isNaN()||!t.isZero()&&!t.isNaN()},"bigint, bigint":dl,"Unit, Unit":t.referToSelf((e=>(t,r)=>e(t.value||0,r.value||0)))},u({SS:s,DS:o,Ss:l}))})),yl=Ii("or",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:a}=e,o=gl({typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:a});function s(e,t,r){var n=e[0].compile().evaluate(r);if(!Yn(n)&&o(n,!1))return!0;var i=e[1].compile().evaluate(r);return o(n,i)}return s.rawArgs=!0,s}),{isTransformFunction:!0}),vl=Ii("matAlgo02xDS0",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i,a){var o=e._data,s=e._size,l=e._datatype||e.getDataType(),u=n._values,c=n._index,h=n._ptr,p=n._size,d=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(s.length!==p.length)throw new xa(s.length,p.length);if(s[0]!==p[0]||s[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+p+")");if(!u)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,m=s[0],g=s[1],y=r,v=0,x=i;"string"==typeof l&&l===d&&"mixed"!==l&&(f=l,y=t.find(r,[f,f]),v=t.convert(0,f),x=t.find(i,[f,f]));for(var _=[],b=[],w=[],A=0;A<g;A++){w[A]=b.length;for(var C=h[A],E=h[A+1],M=C;M<E;M++){var S=c[M],D=a?x(u[M],o[S][A]):x(o[S][A],u[M]);y(D,v)||(b.push(S),_.push(D))}}return w[g]=b.length,n.createSparseMatrix({values:_,index:b,ptr:w,size:[m,g],datatype:l===e._datatype&&d===n._datatype?f:void 0})}})),xl=Ii("matAlgo11xS0s",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i,a){var o=e._values,s=e._index,l=e._ptr,u=e._size,c=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,p=u[0],d=u[1],f=r,m=0,g=i;"string"==typeof c&&(h=c,f=t.find(r,[h,h]),m=t.convert(0,h),n=t.convert(n,h),g=t.find(i,[h,h]));for(var y=[],v=[],x=[],_=0;_<d;_++){x[_]=v.length;for(var b=l[_],w=l[_+1],A=b;A<w;A++){var C=s[A],E=a?g(n,o[A]):g(o[A],n);f(E,m)||(v.push(C),y.push(E))}}return x[d]=v.length,e.createSparseMatrix({values:y,index:v,ptr:x,size:[p,d],datatype:h})}})),_l=Ii("matAlgo06xS0S0",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var a=e._values,o=e._size,s=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=n._values,u=n._size,c=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(o.length!==u.length)throw new xa(o.length,u.length);if(o[0]!==u[0]||o[1]!==u[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+u+")");var h,p=o[0],d=o[1],f=r,m=0,g=i;"string"==typeof s&&s===c&&"mixed"!==s&&(h=s,f=t.find(r,[h,h]),m=t.convert(0,h),g=t.find(i,[h,h]));for(var y=a&&l?[]:void 0,v=[],x=[],_=y?[]:void 0,b=[],w=[],A=0;A<d;A++){x[A]=v.length;var C=A+1;if(Jo(e,A,b,_,w,C,v,g),Jo(n,A,b,_,w,C,v,g),_)for(var E=x[A];E<v.length;){var M=v[E];if(w[M]===C){var S=_[M];f(S,m)?v.splice(E,1):(y.push(S),E++)}else v.splice(E,1)}else for(var D=x[A];D<v.length;)w[v[D]]!==C?v.splice(D,1):D++}return x[d]=v.length,e.createSparseMatrix({values:y,index:v,ptr:x,size:[p,d],datatype:s===e._datatype&&c===n._datatype?h:void 0})}})),bl=Ii("and",["typed","matrix","equalScalar","zeros","not","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,not:a,concat:o}=e,s=vl({typed:t,equalScalar:n}),l=_l({typed:t,equalScalar:n}),u=xl({typed:t,equalScalar:n}),c=ll({typed:t}),h=cl({typed:t,matrix:r,concat:o});return t("and",{"number, number":ml,"Complex, Complex":function(e,t){return!(0===e.re&&0===e.im||0===t.re&&0===t.im)},"BigNumber, BigNumber":function(e,t){return!(e.isZero()||t.isZero()||e.isNaN()||t.isNaN())},"bigint, bigint":ml,"Unit, Unit":t.referToSelf((e=>(t,r)=>e(t.value||0,r.value||0))),"SparseMatrix, any":t.referToSelf((e=>(t,r)=>a(r)?i(t.size(),t.storage()):u(t,r,e,!1))),"DenseMatrix, any":t.referToSelf((e=>(t,r)=>a(r)?i(t.size(),t.storage()):c(t,r,e,!1))),"any, SparseMatrix":t.referToSelf((e=>(t,r)=>a(t)?i(t.size(),t.storage()):u(r,t,e,!0))),"any, DenseMatrix":t.referToSelf((e=>(t,r)=>a(t)?i(t.size(),t.storage()):c(r,t,e,!0))),"Array, any":t.referToSelf((e=>(t,n)=>e(r(t),n).valueOf())),"any, Array":t.referToSelf((e=>(t,n)=>e(t,r(n)).valueOf()))},h({SS:l,DS:s}))})),wl=Ii("and",["typed","matrix","zeros","add","equalScalar","not","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,not:a,concat:o}=e,s=bl({typed:t,matrix:r,equalScalar:n,zeros:i,not:a,concat:o});function l(e,t,r){var n=e[0].compile().evaluate(r);if(!Yn(n)&&!s(n,!0))return!1;var i=e[1].compile().evaluate(r);return s(n,i)}return l.rawArgs=!0,l}),{isTransformFunction:!0}),Al="concat",Cl=Ii(Al,["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:r,isInteger:n}=e;return t(Al,{"...Array | Matrix | number | BigNumber":function(e){var t,i,a=e.length,o=-1,s=!1,l=[];for(t=0;t<a;t++){var u=e[t];if(Xn(u)&&(s=!0),jn(u)||Un(u)){if(t!==a-1)throw new Error("Dimension must be specified as last argument");if(i=o,o=u.valueOf(),!n(o))throw new TypeError("Integer number expected for dimension");if(o<0||t>0&&o>i)throw new _a(o,i+1)}else{var c=Mn(u).valueOf(),h=ba(c);if(l[t]=c,i=o,o=h.length-1,t>0&&o!==i)throw new xa(i+1,o+1)}}if(0===l.length)throw new SyntaxError("At least one matrix expected");for(var p=l.shift();l.length;)p=Ga(p,l.shift(),o);return s?r(p):p},"...string":function(e){return e.join("")}})})),El=Ii("concat",["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:r,isInteger:n}=e,i=Cl({typed:t,matrix:r,isInteger:n});return t("concat",{"...any":function(e){var t=e.length-1,r=e[t];jn(r)?e[t]=r-1:Un(r)&&(e[t]=r.minus(1));try{return i.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),Ml=Ii("index",["Index","getMatrixDataType"],(e=>{var{Index:t,getMatrixDataType:r}=e;return function(){for(var e=[],n=0,i=arguments.length;n<i;n++){var a=arguments[n];if(Qn(a))a.start--,a.end-=a.step>0?0:2;else if(a&&!0===a.isSet)a=a.map((function(e){return e-1}));else if(Wn(a)||Xn(a))"boolean"!==r(a)&&(a=a.map((function(e){return e-1})));else if(jn(a)||Vn(a))a--;else if(Un(a))a=a.toNumber()-1;else if("string"!=typeof a)throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");e[n]=a}var o=new t;return t.apply(o,e),o}}),{isTransformFunction:!0}),Sl=/\$([\w.]+)/g,Dl="print",Tl=Ii(Dl,["typed"],(e=>{var{typed:t}=e;return t(Dl,{"string, Object | Array":Nl,"string, Object | Array, number | Object":Nl})}));function Nl(e,t,r){return e.replace(Sl,(function(e,n){var i=n.split("."),a=t[i.shift()];for(void 0!==a&&a.isMatrix&&(a=a.toArray());i.length&&void 0!==a;){var o=i.shift();a=o?a[o]:a+"."}return void 0!==a?Hn(a)?a:ha(a,r):e}))}var Il="print",Pl=Ii(Il,["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:r,zeros:n,add:i}=e,a=Tl({typed:t,matrix:r,zeros:n,add:i});return t(Il,{"string, Object | Array":function(e,t){return a(o(e),t)},"string, Object | Array, number | Object":function(e,t,r){return a(o(e),t,r)}});function o(e){return e.replace(Sl,(e=>"$"+e.slice(1).split(".").map((function(e){return!isNaN(e)&&e.length>0?parseInt(e)-1:e})).join(".")))}}),{isTransformFunction:!0});function zl(e,t,r){var n;return String(e).includes("Unexpected type")?(n=arguments.length>2?" (type: "+Ti(r)+", value: "+JSON.stringify(r)+")":" (type: "+e.data.actual+")",new TypeError("Cannot calculate "+t+", unexpected type of argument"+n)):String(e).includes("complex numbers")?(n=arguments.length>2?" (type: "+Ti(r)+", value: "+JSON.stringify(r)+")":"",new TypeError("Cannot calculate "+t+", no ordering relation is defined for complex numbers"+n)):e}var Bl=Ii("sum",["typed","config","add","numeric"],(e=>{var{typed:t,config:r,add:n,numeric:i}=e;return t("sum",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(e,t){try{return Yo(e,t,n)}catch(e){throw zl(e,"sum")}},"...":function(e){if(Ho(e))throw new TypeError("Scalar values expected in function sum");return a(e)}});function a(e){var t;return Wo(e,(function(e){try{t=void 0===t?e:n(t,e)}catch(t){throw zl(t,"sum",e)}})),void 0===t&&(t=i(0,r.number)),"string"==typeof t&&(t=i(t,Ri(t,r))),t}}));function kl(e){if(2===e.length&&Yn(e[0])){var t=(e=e.slice())[1];(jn(r=t)||Un(r))&&(e[1]=function(e){return jn(e)?e-1:Un(e)?e.minus(1):e}(t))}var r;return e}var Fl=Ii("sum",["typed","config","add","numeric"],(e=>{var{typed:t,config:r,add:n,numeric:i}=e,a=Bl({typed:t,config:r,add:n,numeric:i});return t("sum",{"...any":function(e){e=kl(e);try{return a.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0});function Rl(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitAnd");var r=e.constructor;if(e.isNaN()||t.isNaN())return new r(NaN);if(e.isZero()||t.eq(-1)||e.eq(t))return e;if(t.isZero()||e.eq(-1))return t;if(!e.isFinite()||!t.isFinite()){if(!e.isFinite()&&!t.isFinite())return e.isNegative()===t.isNegative()?e:new r(0);if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new r(0):t;if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new r(0):e}return ql(e,t,(function(e,t){return e&t}))}function Ol(e){if(e.isFinite()&&!e.isInteger())throw new Error("Integer expected in function bitNot");var t=e.constructor,r=t.precision;t.config({precision:1e9});var n=e.plus(new t(1));return n.s=-n.s||null,t.config({precision:r}),n}function Ll(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitOr");var r=e.constructor;if(e.isNaN()||t.isNaN())return new r(NaN);var n=new r(-1);return e.isZero()||t.eq(n)||e.eq(t)?t:t.isZero()||e.eq(n)?e:e.isFinite()&&t.isFinite()?ql(e,t,(function(e,t){return e|t})):!e.isFinite()&&!e.isNegative()&&t.isNegative()||e.isNegative()&&!t.isNegative()&&!t.isFinite()?n:e.isNegative()&&t.isNegative()?e.isFinite()?e:t:e.isFinite()?t:e}function ql(e,t,r){var n,i,a,o,s,l=e.constructor,u=+(e.s<0),c=+(t.s<0);if(u){n=jl(Ol(e));for(var h=0;h<n.length;++h)n[h]^=1}else n=jl(e);if(c){i=jl(Ol(t));for(var p=0;p<i.length;++p)i[p]^=1}else i=jl(t);n.length<=i.length?(a=n,o=i,s=u):(a=i,o=n,s=c);var d=a.length,f=o.length,m=1^r(u,c),g=new l(1^m),y=new l(1),v=new l(2),x=l.precision;for(l.config({precision:1e9});d>0;)r(a[--d],o[--f])===m&&(g=g.plus(y)),y=y.times(v);for(;f>0;)r(s,o[--f])===m&&(g=g.plus(y)),y=y.times(v);return l.config({precision:x}),0===m&&(g.s=-g.s),g}function jl(e){for(var t=e.d,r=t[0]+"",n=1;n<t.length;++n){for(var i=t[n]+"",a=7-i.length;a--;)i="0"+i;r+=i}for(var o=r.length;"0"===r.charAt(o);)o--;var s=e.e,l=r.slice(0,o+1||1),u=l.length;if(s>0)if(++s>u)for(s-=u;s--;)l+="0";else s<u&&(l=l.slice(0,s)+"."+l.slice(s));for(var c=[0],h=0;h<l.length;){for(var p=c.length;p--;)c[p]*=10;c[0]+=parseInt(l.charAt(h++));for(var d=0;d<c.length;++d)c[d]>1&&(null!==c[d+1]&&void 0!==c[d+1]||(c[d+1]=0),c[d+1]+=c[d]>>1,c[d]&=1)}return c.reverse()}function Ul(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitXor");var r=e.constructor;if(e.isNaN()||t.isNaN())return new r(NaN);if(e.isZero())return t;if(t.isZero())return e;if(e.eq(t))return new r(0);var n=new r(-1);return e.eq(n)?Ol(t):t.eq(n)?Ol(e):e.isFinite()&&t.isFinite()?ql(e,t,(function(e,t){return e^t})):e.isFinite()||t.isFinite()?new r(e.isNegative()===t.isNegative()?1/0:-1/0):n}function Vl(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function leftShift");var r=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new r(NaN):e.isZero()||t.isZero()?e:e.isFinite()||t.isFinite()?t.lt(55)?e.times(Math.pow(2,t.toNumber())+""):e.times(new r(2).pow(t)):new r(NaN)}function Zl(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function rightArithShift");var r=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new r(NaN):e.isZero()||t.isZero()?e:t.isFinite()?t.lt(55)?e.div(Math.pow(2,t.toNumber())+"").floor():e.div(new r(2).pow(t)).floor():e.isNegative()?new r(-1):e.isFinite()?new r(0):new r(NaN)}var $l="number, number";function Gl(e,t){if(!Fi(e)||!Fi(t))throw new Error("Integers expected in function bitAnd");return e&t}function Hl(e){if(!Fi(e))throw new Error("Integer expected in function bitNot");return~e}function Wl(e,t){if(!Fi(e)||!Fi(t))throw new Error("Integers expected in function bitOr");return e|t}function Xl(e,t){if(!Fi(e)||!Fi(t))throw new Error("Integers expected in function bitXor");return e^t}function Yl(e,t){if(!Fi(e)||!Fi(t))throw new Error("Integers expected in function leftShift");return e<<t}function Kl(e,t){if(!Fi(e)||!Fi(t))throw new Error("Integers expected in function rightArithShift");return e>>t}function Jl(e,t){if(!Fi(e)||!Fi(t))throw new Error("Integers expected in function rightLogShift");return e>>>t}Gl.signature=$l,Hl.signature="number",Wl.signature=$l,Xl.signature=$l,Yl.signature=$l,Kl.signature=$l,Jl.signature=$l;var Ql="bitAnd",eu=Ii(Ql,["typed","matrix","equalScalar","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,concat:i}=e,a=vl({typed:t,equalScalar:n}),o=_l({typed:t,equalScalar:n}),s=xl({typed:t,equalScalar:n}),l=cl({typed:t,matrix:r,concat:i});return t(Ql,{"number, number":Gl,"BigNumber, BigNumber":Rl,"bigint, bigint":(e,t)=>e&t},l({SS:o,DS:a,Ss:s}))})),tu=Ii("bitAnd",["typed","matrix","zeros","add","equalScalar","not","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,not:a,concat:o}=e,s=eu({typed:t,matrix:r,equalScalar:n,zeros:i,not:a,concat:o});function l(e,t,r){var n=e[0].compile().evaluate(r);if(!Yn(n)){if(isNaN(n))return NaN;if(0===n||!1===n)return 0}var i=e[1].compile().evaluate(r);return s(n,i)}return l.rawArgs=!0,l}),{isTransformFunction:!0}),ru=Ii("min",["typed","config","numeric","smaller","isNaN"],(e=>{var{typed:t,config:r,numeric:n,smaller:i,isNaN:a}=e;return t("min",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){return Yo(e,t.valueOf(),o)},"...":function(e){if(Ho(e))throw new TypeError("Scalar values expected in function min");return s(e)}});function o(e,t){try{return i(e,t)?e:t}catch(e){throw zl(e,"min",t)}}function s(e){var t;if(Wo(e,(function(e){try{(a(e)||void 0===t||i(e,t))&&(t=e)}catch(t){throw zl(t,"min",e)}})),void 0===t)throw new Error("Cannot calculate min of an empty array");return"string"==typeof t&&(t=n(t,Ri(t,r))),t}})),nu=Ii("min",["typed","config","numeric","smaller","isNaN"],(e=>{var{typed:t,config:r,numeric:n,smaller:i,isNaN:a}=e,o=ru({typed:t,config:r,numeric:n,smaller:i,isNaN:a});return t("min",{"...any":function(e){e=kl(e);try{return o.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),iu="subset",au=Ii(iu,["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:r,zeros:n,add:i}=e;return t(iu,{"Matrix, Index":function(e,t){return Ma(t)?r():(Ca(e,t),e.subset(t))},"Array, Index":t.referTo("Matrix, Index",(function(e){return function(t,n){var i=e(r(t),n);return n.isScalar()?i:i.valueOf()}})),"Object, Index":lu,"string, Index":ou,"Matrix, Index, any, any":function(e,t,r,a){return Ma(t)?e:(Ca(e,t),e.clone().subset(t,function(e,t){if("string"==typeof e)throw new Error("can't boradcast a string");if(t._isScalar)return e;var r=t.size();if(!r.every((e=>e>0)))return e;try{return i(e,n(r))}catch(t){return e}}(r,t),a))},"Array, Index, any, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,n,i,a){var o=e(r(t),n,i,a);return o.isMatrix?o.valueOf():o}})),"Array, Index, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,n,i){return e(r(t),n,i,void 0).valueOf()}})),"Matrix, Index, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,r,n){return e(t,r,n,void 0)}})),"string, Index, string":su,"string, Index, string, string":su,"Object, Index, any":uu})}));function ou(e,t){if(!ei(t))throw new TypeError("Index expected");if(Ma(t))return"";if(Ca(Array.from(e),t),1!==t.size().length)throw new xa(t.size().length,1);var r=e.length;Ea(t.min()[0],r),Ea(t.max()[0],r);var n=t.dimension(0),i="";return n.forEach((function(t){i+=e.charAt(t)})),i}function su(e,t,r,n){if(!t||!0!==t.isIndex)throw new TypeError("Index expected");if(Ma(t))return e;if(Ca(Array.from(e),t),1!==t.size().length)throw new xa(t.size().length,1);if(void 0!==n){if("string"!=typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";var i=t.dimension(0);if(i.size()[0]!==r.length)throw new xa(i.size()[0],r.length);var a=e.length;Ea(t.min()[0]),Ea(t.max()[0]);for(var o=[],s=0;s<a;s++)o[s]=e.charAt(s);if(i.forEach((function(e,t){o[e]=r.charAt(t[0])})),o.length>a)for(var l=a-1,u=o.length;l<u;l++)o[l]||(o[l]=n);return o.join("")}function lu(e,t){if(!Ma(t)){if(1!==t.size().length)throw new xa(t.size(),1);var r=t.dimension(0);if("string"!=typeof r)throw new TypeError("String expected as index to retrieve an object property");return Nn(e,r)}}function uu(e,t,r){if(Ma(t))return e;if(1!==t.size().length)throw new xa(t.size(),1);var n=t.dimension(0);if("string"!=typeof n)throw new TypeError("String expected as index to retrieve an object property");var i=Mn(e);return In(i,n,r),i}var cu,hu,pu=Ii("subset",["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:r,zeros:n,add:i}=e,a=au({typed:t,matrix:r,zeros:n,add:i});return t("subset",{"...any":function(e){try{return a.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),du=Ii("matAlgo10xSids",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:r}=e;return function(e,n,i,a){var o=e._values,s=e._index,l=e._ptr,u=e._size,c=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,p=u[0],d=u[1],f=i;"string"==typeof c&&(h=c,n=t.convert(n,h),f=t.find(i,[h,h]));for(var m=[],g=[],y=[],v=0;v<d;v++){for(var x=v+1,_=l[v],b=l[v+1],w=_;w<b;w++){var A=s[w];g[A]=o[w],y[A]=x}for(var C=0;C<p;C++)0===v&&(m[C]=[]),y[C]===x?m[C][v]=a?f(n,g[C]):f(g[C],n):m[C][v]=n}return new r({data:m,size:[p,d],datatype:h})}})),fu=Ii("matAlgo04xSidSid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var a=e._values,o=e._index,s=e._ptr,l=e._size,u=e._datatype||void 0===e._data?e._datatype:e.getDataType(),c=n._values,h=n._index,p=n._ptr,d=n._size,f=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(l.length!==d.length)throw new xa(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");var m,g=l[0],y=l[1],v=r,x=0,_=i;"string"==typeof u&&u===f&&"mixed"!==u&&(m=u,v=t.find(r,[m,m]),x=t.convert(0,m),_=t.find(i,[m,m]));var b,w,A,C,E,M=a&&c?[]:void 0,S=[],D=[],T=a&&c?[]:void 0,N=a&&c?[]:void 0,I=[],P=[];for(w=0;w<y;w++){D[w]=S.length;var z=w+1;for(C=s[w],E=s[w+1],A=C;A<E;A++)b=o[A],S.push(b),I[b]=z,T&&(T[b]=a[A]);for(C=p[w],E=p[w+1],A=C;A<E;A++)if(I[b=h[A]]===z){if(T){var B=_(T[b],c[A]);v(B,x)?I[b]=null:T[b]=B}}else S.push(b),P[b]=z,N&&(N[b]=c[A]);if(T&&N)for(A=D[w];A<S.length;)I[b=S[A]]===z?(M[A]=T[b],A++):P[b]===z?(M[A]=N[b],A++):S.splice(A,1)}return D[y]=S.length,e.createSparseMatrix({values:M,index:S,ptr:D,size:[g,y],datatype:u===e._datatype&&f===n._datatype?m:void 0})}})),mu=Ii("matAlgo01xDSid",["typed"],(e=>{var{typed:t}=e;return function(e,r,n,i){var a=e._data,o=e._size,s=e._datatype||e.getDataType(),l=r._values,u=r._index,c=r._ptr,h=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(o.length!==h.length)throw new xa(o.length,h.length);if(o[0]!==h[0]||o[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+h+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var d,f,m=o[0],g=o[1],y="string"==typeof s&&"mixed"!==s&&s===p?s:void 0,v=y?t.find(n,[y,y]):n,x=[];for(d=0;d<m;d++)x[d]=[];var _=[],b=[];for(f=0;f<g;f++){for(var w=f+1,A=c[f],C=c[f+1],E=A;E<C;E++)_[d=u[E]]=i?v(l[E],a[d][f]):v(a[d][f],l[E]),b[d]=w;for(d=0;d<m;d++)b[d]===w?x[d][f]=_[d]:x[d][f]=a[d][f]}return e.createDenseMatrix({data:x,size:[m,g],datatype:s===e._datatype&&p===r._datatype?y:void 0})}})),gu="bitOr",yu=Ii(gu,["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:a}=e,o=mu({typed:t}),s=fu({typed:t,equalScalar:n}),l=du({typed:t,DenseMatrix:i}),u=cl({typed:t,matrix:r,concat:a});return t(gu,{"number, number":Wl,"BigNumber, BigNumber":Ll,"bigint, bigint":(e,t)=>e|t},u({SS:s,DS:o,Ss:l}))})),vu=Ii("bitOr",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:a}=e,o=yu({typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:a});function s(e,t,r){var n=e[0].compile().evaluate(r);if(!Yn(n)){if(isNaN(n))return NaN;if(-1===n)return-1;if(!0===n)return 1}var i=e[1].compile().evaluate(r);return o(n,i)}return s.rawArgs=!0,s}),{isTransformFunction:!0}),xu="cumsum",_u=Ii(xu,["typed","add","unaryPlus"],(e=>{var{typed:t,add:r,unaryPlus:n}=e;return t(xu,{Array:i,Matrix:function(e){return e.create(i(e.valueOf(),e.datatype()))},"Array, number | BigNumber":o,"Matrix, number | BigNumber":function(e,t){return e.create(o(e.valueOf(),t),e.datatype())},"...":function(e){if(Ho(e))throw new TypeError("All values expected to be scalar in function cumsum");return i(e)}});function i(e){try{return a(e)}catch(e){throw zl(e,xu)}}function a(e){if(0===e.length)return[];for(var t=[n(e[0])],i=1;i<e.length;++i)t.push(r(t[i-1],e[i]));return t}function o(e,t){var r=ba(e);if(t<0||t>=r.length)throw new _a(t,r.length);try{return s(e,t)}catch(e){throw zl(e,xu)}}function s(e,t){var r,n,i;if(t<=0){var o=e[0][0];if(Array.isArray(o)){for(i=Go(e),n=[],r=0;r<i.length;r++)n[r]=s(i[r],t-1);return n}return a(e)}for(n=[],r=0;r<e.length;r++)n[r]=s(e[r],t-1);return n}})),bu="cumsum",wu=Ii(bu,["typed","add","unaryPlus"],(e=>{var{typed:t,add:r,unaryPlus:n}=e,i=_u({typed:t,add:r,unaryPlus:n});return t(bu,{"...any":function(e){if(2===e.length&&Yn(e[0])){var t=e[1];jn(t)?e[1]=t-1:Un(t)&&(e[1]=t.minus(1))}try{return i.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),Au="diff",Cu=Ii(Au,["typed","matrix","subtract","number"],(e=>{var{typed:t,matrix:r,subtract:n,number:i}=e;return t(Au,{"Array | Matrix":function(e){return Xn(e)?r(o(e.toArray())):o(e)},"Array | Matrix, number":function(e,t){if(!Fi(t))throw new RangeError("Dimension must be a whole number");return Xn(e)?r(a(e.toArray(),t)):a(e,t)},"Array, BigNumber":t.referTo("Array,number",(e=>(t,r)=>e(t,i(r)))),"Matrix, BigNumber":t.referTo("Matrix,number",(e=>(t,r)=>e(t,i(r))))});function a(e,t){if(Xn(e)&&(e=e.toArray()),!Array.isArray(e))throw RangeError("Array/Matrix does not have that many dimensions");if(t>0){var r=[];return e.forEach((e=>{r.push(a(e,t-1))})),r}if(0===t)return o(e);throw RangeError("Cannot have negative dimension")}function o(e){for(var t=[],r=e.length,n=1;n<r;n++)t.push(s(e[n-1],e[n]));return t}function s(e,t){Xn(e)&&(e=e.toArray()),Xn(t)&&(t=t.toArray());var r=Array.isArray(e),i=Array.isArray(t);if(r&&i)return function(e,t){if(e.length!==t.length)throw RangeError("Not all sub-arrays have the same length");for(var r=[],n=e.length,i=0;i<n;i++)r.push(s(e[i],t[i]));return r}(e,t);if(!r&&!i)return n(t,e);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}})),Eu="diff",Mu=Ii(Eu,["typed","matrix","subtract","number","bignumber"],(e=>{var{typed:t,matrix:r,subtract:n,number:i,bignumber:a}=e,o=Cu({typed:t,matrix:r,subtract:n,number:i,bignumber:a});return t(Eu,{"...any":function(e){e=kl(e);try{return o.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),Su=Ii("max",["typed","config","numeric","larger","isNaN"],(e=>{var{typed:t,config:r,numeric:n,larger:i,isNaN:a}=e;return t("max",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){return Yo(e,t.valueOf(),o)},"...":function(e){if(Ho(e))throw new TypeError("Scalar values expected in function max");return s(e)}});function o(e,t){try{return i(e,t)?e:t}catch(e){throw zl(e,"max",t)}}function s(e){var t;if(Wo(e,(function(e){try{(a(e)||void 0===t||i(e,t))&&(t=e)}catch(t){throw zl(t,"max",e)}})),void 0===t)throw new Error("Cannot calculate max of an empty array");return"string"==typeof t&&(t=n(t,Ri(t,r))),t}})),Du=Ii("max",["typed","config","numeric","larger","isNaN"],(e=>{var{typed:t,config:r,numeric:n,larger:i,isNaN:a}=e,o=Su({typed:t,config:r,numeric:n,larger:i,isNaN:a});return t("max",{"...any":function(e){e=kl(e);try{return o.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),Tu="range",Nu=Ii(Tu,["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(e=>{var{typed:t,config:r,matrix:n,bignumber:i,smaller:a,smallerEq:o,larger:s,largerEq:l,add:u,isPositive:c}=e;return t(Tu,{string:p,"string, boolean":p,number:function(e){throw new TypeError("Too few arguments to function range(): ".concat(e))},boolean:function(e){throw new TypeError("Unexpected type of argument 1 to function range(): ".concat(e,", number|bigint|BigNumber|Fraction"))},"number, number":function(e,t){return h(d(e,t,1,!1))},"number, number, number":function(e,t,r){return h(d(e,t,r,!1))},"number, number, boolean":function(e,t,r){return h(d(e,t,1,r))},"number, number, number, boolean":function(e,t,r,n){return h(d(e,t,r,n))},"bigint, bigint|number":function(e,t){return h(d(e,t,1n,!1))},"number, bigint":function(e,t){return h(d(BigInt(e),t,1n,!1))},"bigint, bigint|number, bigint|number":function(e,t,r){return h(d(e,t,BigInt(r),!1))},"number, bigint, bigint|number":function(e,t,r){return h(d(BigInt(e),t,BigInt(r),!1))},"bigint, bigint|number, boolean":function(e,t,r){return h(d(e,t,1n,r))},"number, bigint, boolean":function(e,t,r){return h(d(BigInt(e),t,1n,r))},"bigint, bigint|number, bigint|number, boolean":function(e,t,r,n){return h(d(e,t,BigInt(r),n))},"number, bigint, bigint|number, boolean":function(e,t,r,n){return h(d(BigInt(e),t,BigInt(r),n))},"BigNumber, BigNumber":function(e,t){return h(d(e,t,new(0,e.constructor)(1),!1))},"BigNumber, BigNumber, BigNumber":function(e,t,r){return h(d(e,t,r,!1))},"BigNumber, BigNumber, boolean":function(e,t,r){return h(d(e,t,new(0,e.constructor)(1),r))},"BigNumber, BigNumber, BigNumber, boolean":function(e,t,r,n){return h(d(e,t,r,n))},"Fraction, Fraction":function(e,t){return h(d(e,t,1,!1))},"Fraction, Fraction, Fraction":function(e,t,r){return h(d(e,t,r,!1))},"Fraction, Fraction, boolean":function(e,t,r){return h(d(e,t,1,r))},"Fraction, Fraction, Fraction, boolean":function(e,t,r,n){return h(d(e,t,r,n))},"Unit, Unit, Unit":function(e,t,r){return h(d(e,t,r,!1))},"Unit, Unit, Unit, boolean":function(e,t,r,n){return h(d(e,t,r,n))}});function h(e){return"Matrix"===r.matrix?n?n(e):ss():e}function p(e,t){var n=function(e){var t=e.split(":").map((function(e){return Number(e)}));if(t.some((function(e){return isNaN(e)})))return null;switch(t.length){case 2:return{start:t[0],end:t[1],step:1};case 3:return{start:t[0],end:t[2],step:t[1]};default:return null}}(e);if(!n)throw new SyntaxError('String "'+e+'" is no valid range');return"BigNumber"===r.number?(void 0===i&&as(),h(d(i(n.start),i(n.end),i(n.step)))):h(d(n.start,n.end,n.step,t))}function d(e,t,r,n){for(var i=[],h=c(r)?n?o:a:n?l:s,p=e;h(p,t);)i.push(p),p=u(p,r);return i}})),Iu=Ii("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(e=>{var{typed:t,config:r,matrix:n,bignumber:i,smaller:a,smallerEq:o,larger:s,largerEq:l,add:u,isPositive:c}=e,h=Nu({typed:t,config:r,matrix:n,bignumber:i,smaller:a,smallerEq:o,larger:s,largerEq:l,add:u,isPositive:c});return t("range",{"...any":function(e){return"boolean"!=typeof e[e.length-1]&&e.push(!0),h.apply(null,e)}})}),{isTransformFunction:!0}),Pu=Ii("row",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:r,matrix:n,range:i}=e;return t("row",{"Matrix, number":a,"Array, number":function(e,t){return a(n(Mn(e)),t).valueOf()}});function a(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");Ea(t,e.size()[0]);var a=i(0,e.size()[1]),o=new r(t,a),s=e.subset(o);return Xn(s)?s:n([[s]])}})),zu=Ii("row",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:r,matrix:n,range:i}=e,a=Pu({typed:t,Index:r,matrix:n,range:i});return t("row",{"...any":function(e){var t=e.length-1,r=e[t];jn(r)&&(e[t]=r-1);try{return a.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),Bu="column",ku=Ii(Bu,["typed","Index","matrix","range"],(e=>{var{typed:t,Index:r,matrix:n,range:i}=e;return t(Bu,{"Matrix, number":a,"Array, number":function(e,t){return a(n(Mn(e)),t).valueOf()}});function a(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");Ea(t,e.size()[1]);var a=i(0,e.size()[0]),o=new r(a,t),s=e.subset(o);return Xn(s)?s:n([[s]])}})),Fu=Ii("column",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:r,matrix:n,range:i}=e,a=ku({typed:t,Index:r,matrix:n,range:i});return t("column",{"...any":function(e){var t=e.length-1,r=e[t];jn(r)&&(e[t]=r-1);try{return a.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),Ru="mean",Ou=Ii(Ru,["typed","add","divide"],(e=>{var{typed:t,add:r,divide:n}=e;return t(Ru,{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(e,t){try{var i=Yo(e,t,r),a=Array.isArray(e)?ba(e):e.size();return n(i,a[t])}catch(e){throw zl(e,"mean")}},"...":function(e){if(Ho(e))throw new TypeError("Scalar values expected in function mean");return i(e)}});function i(e){var t,i=0;if(Wo(e,(function(e){try{t=void 0===t?e:r(t,e),i++}catch(t){throw zl(t,"mean",e)}})),0===i)throw new Error("Cannot calculate the mean of an empty array");return n(t,i)}})),Lu=Ii("mean",["typed","add","divide"],(e=>{var{typed:t,add:r,divide:n}=e,i=Ou({typed:t,add:r,divide:n});return t("mean",{"...any":function(e){e=kl(e);try{return i.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),qu="quantileSeq",ju=Ii(qu,["typed","?bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],(e=>{var{typed:t,bignumber:r,add:n,subtract:i,divide:a,multiply:o,partitionSelect:s,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:p,mapSlices:d}=e;return t(qu,{"Array | Matrix, number | BigNumber":(e,t)=>m(e,t,!1),"Array | Matrix, number | BigNumber, number":(e,t,r)=>f(e,t,!1,r,m),"Array | Matrix, number | BigNumber, boolean":m,"Array | Matrix, number | BigNumber, boolean, number":(e,t,r,n)=>f(e,t,r,n,m),"Array | Matrix, Array | Matrix":(e,t)=>g(e,t,!1),"Array | Matrix, Array | Matrix, number":(e,t,r)=>f(e,t,!1,r,g),"Array | Matrix, Array | Matrix, boolean":g,"Array | Matrix, Array | Matrix, boolean, number":(e,t,r,n)=>f(e,t,r,n,g)});function f(e,t,r,n,i){return d(e,n,(e=>i(e,t,r)))}function m(e,t,i){var o,s=e.valueOf();if(c(t,0))throw new Error("N/prob must be non-negative");if(h(t,1))return jn(t)?y(s,t,i):r(y(s,t,i));if(p(t,1)){if(!u(t))throw new Error("N must be a positive integer");if(p(t,4294967295))throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var l=n(t,1);o=[];for(var d=0;c(d,t);d++){var f=a(d+1,l);o.push(y(s,f,i))}return jn(t)?o:r(o)}}function g(e,t,r){for(var n=e.valueOf(),i=t.valueOf(),a=[],o=0;o<i.length;++o)a.push(y(n,i[o],r));return a}function y(e,t,r){var a=Fa(e),c=a.length;if(0===c)throw new Error("Cannot calculate quantile of an empty sequence");var h,p,d=jn(t)?t*(c-1):t.times(c-1),f=jn(t)?Math.floor(d):d.floor().toNumber(),m=jn(t)?d%1:d.minus(f);if(u(d))return r?a[d]:s(a,jn(t)?d:d.valueOf());if(r)h=a[f],p=a[f+1];else{p=s(a,f+1),h=a[f];for(var g=0;g<f;++g)l(a[g],h)>0&&(h=a[g])}return n(o(h,i(1,m)),o(p,m))}})),Uu=Ii("quantileSeq",["typed","bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],(e=>{var{typed:t,bignumber:r,add:n,subtract:i,divide:a,multiply:o,partitionSelect:s,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:p,mapSlices:d}=e,f=ju({typed:t,bignumber:r,add:n,subtract:i,divide:a,multiply:o,partitionSelect:s,compare:l,isInteger:u,smaller:c,smallerEq:h,larger:p,mapSlices:d});return t("quantileSeq",{"Array | Matrix, number | BigNumber":f,"Array | Matrix, number | BigNumber, number":(e,t,r)=>f(e,t,m(r)),"Array | Matrix, number | BigNumber, boolean":f,"Array | Matrix, number | BigNumber, boolean, number":(e,t,r,n)=>f(e,t,r,m(n)),"Array | Matrix, Array | Matrix":f,"Array | Matrix, Array | Matrix, number":(e,t,r)=>f(e,t,m(r)),"Array | Matrix, Array | Matrix, boolean":f,"Array | Matrix, Array | Matrix, boolean, number":(e,t,r,n)=>f(e,t,r,m(n))});function m(e){return kl([[],e])[1]}}),{isTransformFunction:!0}),Vu="unbiased",Zu="variance",$u=Ii(Zu,["typed","add","subtract","multiply","divide","mapSlices","isNaN"],(e=>{var{typed:t,add:r,subtract:n,multiply:i,divide:a,mapSlices:o,isNaN:s}=e;return t(Zu,{"Array | Matrix":function(e){return l(e,Vu)},"Array | Matrix, string":l,"Array | Matrix, number | BigNumber":function(e,t){return u(e,t,Vu)},"Array | Matrix, number | BigNumber, string":u,"...":function(e){return l(e,Vu)}});function l(e,t){var o,l=0;if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(Wo(e,(function(e){try{o=void 0===o?e:r(o,e),l++}catch(t){throw zl(t,"variance",e)}})),0===l)throw new Error("Cannot calculate variance of an empty array");var u=a(o,l);if(o=void 0,Wo(e,(function(e){var t=n(e,u);o=void 0===o?i(t,t):r(o,i(t,t))})),s(o))return o;switch(t){case"uncorrected":return a(o,l);case"biased":return a(o,l+1);case"unbiased":var c=Un(o)?o.mul(0):0;return 1===l?c:a(o,l-1);default:throw new Error('Unknown normalization "'+t+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function u(e,t,r){try{if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return o(e,t,(e=>l(e,r)))}catch(e){throw zl(e,"variance")}}})),Gu="variance",Hu=Ii(Gu,["typed","add","subtract","multiply","divide","mapSlices","isNaN"],(e=>{var{typed:t,add:r,subtract:n,multiply:i,divide:a,mapSlices:o,isNaN:s}=e,l=$u({typed:t,add:r,subtract:n,multiply:i,divide:a,mapSlices:o,isNaN:s});return t(Gu,{"...any":function(e){e=kl(e);try{return l.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),Wu=Ii("std",["typed","map","sqrt","variance"],(e=>{var{typed:t,map:r,sqrt:n,variance:i}=e;return t("std",{"Array | Matrix":a,"Array | Matrix, string":a,"Array | Matrix, number | BigNumber":a,"Array | Matrix, number | BigNumber, string":a,"...":function(e){return a(e)}});function a(e,t){if(0===e.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var a=i.apply(null,arguments);return Yn(a)?r(a,n):n(a)}catch(e){throw e instanceof TypeError&&e.message.includes(" variance")?new TypeError(e.message.replace(" variance"," std")):e}}})),Xu=Ii("std",["typed","map","sqrt","variance"],(e=>{var{typed:t,map:r,sqrt:n,variance:i}=e,a=Wu({typed:t,map:r,sqrt:n,variance:i});return t("std",{"...any":function(e){e=kl(e);try{return a.apply(null,e)}catch(e){throw ko(e)}}})}),{isTransformFunction:!0}),Yu=9e15,Ku=1e9,Ju="0123456789abcdef",Qu="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",ec="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",tc={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Yu,maxE:Yu,crypto:!1},rc=!0,nc="[DecimalError] ",ic=nc+"Invalid argument: ",ac=nc+"Precision limit exceeded",oc=nc+"crypto unavailable",sc="[object Decimal]",lc=Math.floor,uc=Math.pow,cc=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,hc=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,pc=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,dc=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fc=1e7,mc=Qu.length-1,gc=ec.length-1,yc={toStringTag:sc};function vc(e){var t,r,n,i=e.length-1,a="",o=e[0];if(i>0){for(a+=o,t=1;t<i;t++)(r=7-(n=e[t]+"").length)&&(a+=Tc(r)),a+=n;(r=7-(n=(o=e[t])+"").length)&&(a+=Tc(r))}else if(0===o)return"0";for(;o%10==0;)o/=10;return a+o}function xc(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ic+e)}function _c(e,t,r,n){var i,a,o,s;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=7,i=0):(i=Math.ceil((t+1)/7),t%=7),a=uc(10,7-t),s=e[i]%a|0,null==n?t<3?(0==t?s=s/100|0:1==t&&(s=s/10|0),o=r<4&&99999==s||r>3&&49999==s||5e4==s||0==s):o=(r<4&&s+1==a||r>3&&s+1==a/2)&&(e[i+1]/a/100|0)==uc(10,t-2)-1||(s==a/2||0==s)&&!(e[i+1]/a/100|0):t<4?(0==t?s=s/1e3|0:1==t?s=s/100|0:2==t&&(s=s/10|0),o=(n||r<4)&&9999==s||!n&&r>3&&4999==s):o=((n||r<4)&&s+1==a||!n&&r>3&&s+1==a/2)&&(e[i+1]/a/1e3|0)==uc(10,t-3)-1,o}function bc(e,t,r){for(var n,i,a=[0],o=0,s=e.length;o<s;){for(i=a.length;i--;)a[i]*=t;for(a[0]+=Ju.indexOf(e.charAt(o++)),n=0;n<a.length;n++)a[n]>r-1&&(void 0===a[n+1]&&(a[n+1]=0),a[n+1]+=a[n]/r|0,a[n]%=r)}return a.reverse()}yc.absoluteValue=yc.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),Ac(e)},yc.ceil=function(){return Ac(new this.constructor(this),this.e+1,2)},yc.clampedTo=yc.clamp=function(e,t){var r=this,n=r.constructor;if(e=new n(e),t=new n(t),!e.s||!t.s)return new n(NaN);if(e.gt(t))throw Error(ic+t);return r.cmp(e)<0?e:r.cmp(t)>0?t:new n(r)},yc.comparedTo=yc.cmp=function(e){var t,r,n,i,a=this,o=a.d,s=(e=new a.constructor(e)).d,l=a.s,u=e.s;if(!o||!s)return l&&u?l!==u?l:o===s?0:!o^l<0?1:-1:NaN;if(!o[0]||!s[0])return o[0]?l:s[0]?-u:0;if(l!==u)return l;if(a.e!==e.e)return a.e>e.e^l<0?1:-1;for(t=0,r=(n=o.length)<(i=s.length)?n:i;t<r;++t)if(o[t]!==s[t])return o[t]>s[t]^l<0?1:-1;return n===i?0:n>i^l<0?1:-1},yc.cosine=yc.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(e,t){var r,n,i;if(t.isZero())return t;(n=t.d.length)<32?i=(1/Lc(4,r=Math.ceil(n/3))).toString():(r=16,i="2.3283064365386962890625e-10"),e.precision+=r,t=Oc(e,1,t.times(i),new e(1));for(var a=r;a--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=r,t}(n,qc(n,r)),n.precision=e,n.rounding=t,Ac(2==hu||3==hu?r.neg():r,e,t,!0)):new n(1):new n(NaN)},yc.cubeRoot=yc.cbrt=function(){var e,t,r,n,i,a,o,s,l,u,c=this,h=c.constructor;if(!c.isFinite()||c.isZero())return new h(c);for(rc=!1,(a=c.s*uc(c.s*c,1/3))&&Math.abs(a)!=1/0?n=new h(a.toString()):(r=vc(c.d),(a=((e=c.e)-r.length+1)%3)&&(r+=1==a||-2==a?"0":"00"),a=uc(r,1/3),e=lc((e+1)/3)-(e%3==(e<0?-1:2)),(n=new h(r=a==1/0?"5e"+e:(r=a.toExponential()).slice(0,r.indexOf("e")+1)+e)).s=c.s),o=(e=h.precision)+3;;)if(u=(l=(s=n).times(s).times(s)).plus(c),n=wc(u.plus(c).times(s),u.plus(l),o+2,1),vc(s.d).slice(0,o)===(r=vc(n.d)).slice(0,o)){if("9999"!=(r=r.slice(o-3,o+1))&&(i||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(Ac(n,e+1,1),t=!n.times(n).times(n).eq(c));break}if(!i&&(Ac(s,e+1,0),s.times(s).times(s).eq(c))){n=s;break}o+=4,i=1}return rc=!0,Ac(n,e,h.rounding,t)},yc.decimalPlaces=yc.dp=function(){var e,t=this.d,r=NaN;if(t){if(r=7*((e=t.length-1)-lc(this.e/7)),e=t[e])for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r},yc.dividedBy=yc.div=function(e){return wc(this,new this.constructor(e))},yc.dividedToIntegerBy=yc.divToInt=function(e){var t=this.constructor;return Ac(wc(this,new t(e),0,1,1),t.precision,t.rounding)},yc.equals=yc.eq=function(e){return 0===this.cmp(e)},yc.floor=function(){return Ac(new this.constructor(this),this.e+1,3)},yc.greaterThan=yc.gt=function(e){return this.cmp(e)>0},yc.greaterThanOrEqualTo=yc.gte=function(e){var t=this.cmp(e);return 1==t||0===t},yc.hyperbolicCosine=yc.cosh=function(){var e,t,r,n,i,a=this,o=a.constructor,s=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return s;r=o.precision,n=o.rounding,o.precision=r+Math.max(a.e,a.sd())+4,o.rounding=1,(i=a.d.length)<32?t=(1/Lc(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),a=Oc(o,1,a.times(t),new o(1),!0);for(var l,u=e,c=new o(8);u--;)l=a.times(a),a=s.minus(l.times(c.minus(l.times(c))));return Ac(a,o.precision=r,o.rounding=n,!0)},yc.hyperbolicSine=yc.sinh=function(){var e,t,r,n,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(t=a.precision,r=a.rounding,a.precision=t+Math.max(i.e,i.sd())+4,a.rounding=1,(n=i.d.length)<3)i=Oc(a,2,i,i,!0);else{e=(e=1.4*Math.sqrt(n))>16?16:0|e,i=Oc(a,2,i=i.times(1/Lc(5,e)),i,!0);for(var o,s=new a(5),l=new a(16),u=new a(20);e--;)o=i.times(i),i=i.times(s.plus(o.times(l.times(o).plus(u))))}return a.precision=t,a.rounding=r,Ac(i,t,r,!0)},yc.hyperbolicTangent=yc.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,wc(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)},yc.inverseCosine=yc.acos=function(){var e=this,t=e.constructor,r=e.abs().cmp(1),n=t.precision,i=t.rounding;return-1!==r?0===r?e.isNeg()?Sc(t,n,i):new t(0):new t(NaN):e.isZero()?Sc(t,n+4,i).times(.5):(t.precision=n+6,t.rounding=1,e=new t(1).minus(e).div(e.plus(1)).sqrt().atan(),t.precision=n,t.rounding=i,e.times(2))},yc.inverseHyperbolicCosine=yc.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,rc=!1,r=r.times(r).minus(1).sqrt().plus(r),rc=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)},yc.inverseHyperbolicSine=yc.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,rc=!1,r=r.times(r).plus(1).sqrt().plus(r),rc=!0,n.precision=e,n.rounding=t,r.ln())},yc.inverseHyperbolicTangent=yc.atanh=function(){var e,t,r,n,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=a.precision,t=a.rounding,n=i.sd(),Math.max(n,e)<2*-i.e-1?Ac(new a(i),e,t,!0):(a.precision=r=n-i.e,i=wc(i.plus(1),new a(1).minus(i),r+e,1),a.precision=e+4,a.rounding=1,i=i.ln(),a.precision=e,a.rounding=t,i.times(.5))):new a(NaN)},yc.inverseSine=yc.asin=function(){var e,t,r,n,i=this,a=i.constructor;return i.isZero()?new a(i):(t=i.abs().cmp(1),r=a.precision,n=a.rounding,-1!==t?0===t?((e=Sc(a,r+4,n).times(.5)).s=i.s,e):new a(NaN):(a.precision=r+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=r,a.rounding=n,i.times(2)))},yc.inverseTangent=yc.atan=function(){var e,t,r,n,i,a,o,s,l,u=this,c=u.constructor,h=c.precision,p=c.rounding;if(u.isFinite()){if(u.isZero())return new c(u);if(u.abs().eq(1)&&h+4<=gc)return(o=Sc(c,h+4,p).times(.25)).s=u.s,o}else{if(!u.s)return new c(NaN);if(h+4<=gc)return(o=Sc(c,h+4,p).times(.5)).s=u.s,o}for(c.precision=s=h+10,c.rounding=1,e=r=Math.min(28,s/7+2|0);e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(rc=!1,t=Math.ceil(s/7),n=1,l=u.times(u),o=new c(u),i=u;-1!==e;)if(i=i.times(l),a=o.minus(i.div(n+=2)),i=i.times(l),void 0!==(o=a.plus(i.div(n+=2))).d[t])for(e=t;o.d[e]===a.d[e]&&e--;);return r&&(o=o.times(2<<r-1)),rc=!0,Ac(o,c.precision=h,c.rounding=p,!0)},yc.isFinite=function(){return!!this.d},yc.isInteger=yc.isInt=function(){return!!this.d&&lc(this.e/7)>this.d.length-2},yc.isNaN=function(){return!this.s},yc.isNegative=yc.isNeg=function(){return this.s<0},yc.isPositive=yc.isPos=function(){return this.s>0},yc.isZero=function(){return!!this.d&&0===this.d[0]},yc.lessThan=yc.lt=function(e){return this.cmp(e)<0},yc.lessThanOrEqualTo=yc.lte=function(e){return this.cmp(e)<1},yc.logarithm=yc.log=function(e){var t,r,n,i,a,o,s,l,u=this,c=u.constructor,h=c.precision,p=c.rounding;if(null==e)e=new c(10),t=!0;else{if(r=(e=new c(e)).d,e.s<0||!r||!r[0]||e.eq(1))return new c(NaN);t=e.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new c(r&&!r[0]?-1/0:1!=u.s?NaN:r?0:1/0);if(t)if(r.length>1)a=!0;else{for(i=r[0];i%10==0;)i/=10;a=1!==i}if(rc=!1,o=Bc(u,s=h+5),n=t?Mc(c,s+10):Bc(e,s),_c((l=wc(o,n,s,1)).d,i=h,p))do{if(o=Bc(u,s+=10),n=t?Mc(c,s+10):Bc(e,s),l=wc(o,n,s,1),!a){+vc(l.d).slice(i+1,i+15)+1==1e14&&(l=Ac(l,h+1,0));break}}while(_c(l.d,i+=10,p));return rc=!0,Ac(l,h,p)},yc.minus=yc.sub=function(e){var t,r,n,i,a,o,s,l,u,c,h,p,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return d.s&&e.s?d.d?e.s=-e.s:e=new f(e.d||d.s!==e.s?d:NaN):e=new f(NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(u=d.d,p=e.d,s=f.precision,l=f.rounding,!u[0]||!p[0]){if(p[0])e.s=-e.s;else{if(!u[0])return new f(3===l?-0:0);e=new f(d)}return rc?Ac(e,s,l):e}if(r=lc(e.e/7),c=lc(d.e/7),u=u.slice(),a=c-r){for((h=a<0)?(t=u,a=-a,o=p.length):(t=p,r=c,o=u.length),a>(n=Math.max(Math.ceil(s/7),o)+2)&&(a=n,t.length=1),t.reverse(),n=a;n--;)t.push(0);t.reverse()}else{for((h=(n=u.length)<(o=p.length))&&(o=n),n=0;n<o;n++)if(u[n]!=p[n]){h=u[n]<p[n];break}a=0}for(h&&(t=u,u=p,p=t,e.s=-e.s),o=u.length,n=p.length-o;n>0;--n)u[o++]=0;for(n=p.length;n>a;){if(u[--n]<p[n]){for(i=n;i&&0===u[--i];)u[i]=fc-1;--u[i],u[n]+=fc}u[n]-=p[n]}for(;0===u[--o];)u.pop();for(;0===u[0];u.shift())--r;return u[0]?(e.d=u,e.e=Ec(u,r),rc?Ac(e,s,l):e):new f(3===l?-0:0)},yc.modulo=yc.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?Ac(new n(r),n.precision,n.rounding):(rc=!1,9==n.modulo?(t=wc(r,e.abs(),0,3,1)).s*=e.s:t=wc(r,e,0,n.modulo,1),t=t.times(e),rc=!0,r.minus(t))},yc.naturalExponential=yc.exp=function(){return zc(this)},yc.naturalLogarithm=yc.ln=function(){return Bc(this)},yc.negated=yc.neg=function(){var e=new this.constructor(this);return e.s=-e.s,Ac(e)},yc.plus=yc.add=function(e){var t,r,n,i,a,o,s,l,u,c,h=this,p=h.constructor;if(e=new p(e),!h.d||!e.d)return h.s&&e.s?h.d||(e=new p(e.d||h.s===e.s?h:NaN)):e=new p(NaN),e;if(h.s!=e.s)return e.s=-e.s,h.minus(e);if(u=h.d,c=e.d,s=p.precision,l=p.rounding,!u[0]||!c[0])return c[0]||(e=new p(h)),rc?Ac(e,s,l):e;if(a=lc(h.e/7),n=lc(e.e/7),u=u.slice(),i=a-n){for(i<0?(r=u,i=-i,o=c.length):(r=c,n=a,o=u.length),i>(o=(a=Math.ceil(s/7))>o?a+1:o+1)&&(i=o,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for((o=u.length)-(i=c.length)<0&&(i=o,r=c,c=u,u=r),t=0;i;)t=(u[--i]=u[i]+c[i]+t)/fc|0,u[i]%=fc;for(t&&(u.unshift(t),++n),o=u.length;0==u[--o];)u.pop();return e.d=u,e.e=Ec(u,n),rc?Ac(e,s,l):e},yc.precision=yc.sd=function(e){var t,r=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(ic+e);return r.d?(t=Dc(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t},yc.round=function(){var e=this,t=e.constructor;return Ac(new t(e),e.e+1,t.rounding)},yc.sine=yc.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(e,t){var r,n=t.d.length;if(n<3)return t.isZero()?t:Oc(e,2,t,t);r=(r=1.4*Math.sqrt(n))>16?16:0|r,t=Oc(e,2,t=t.times(1/Lc(5,r)),t);for(var i,a=new e(5),o=new e(16),s=new e(20);r--;)i=t.times(t),t=t.times(a.plus(i.times(o.times(i).minus(s))));return t}(n,qc(n,r)),n.precision=e,n.rounding=t,Ac(hu>2?r.neg():r,e,t,!0)):new n(NaN)},yc.squareRoot=yc.sqrt=function(){var e,t,r,n,i,a,o=this,s=o.d,l=o.e,u=o.s,c=o.constructor;if(1!==u||!s||!s[0])return new c(!u||u<0&&(!s||s[0])?NaN:s?o:1/0);for(rc=!1,0==(u=Math.sqrt(+o))||u==1/0?(((t=vc(s)).length+l)%2==0&&(t+="0"),u=Math.sqrt(t),l=lc((l+1)/2)-(l<0||l%2),n=new c(t=u==1/0?"5e"+l:(t=u.toExponential()).slice(0,t.indexOf("e")+1)+l)):n=new c(u.toString()),r=(l=c.precision)+3;;)if(n=(a=n).plus(wc(o,a,r+2,1)).times(.5),vc(a.d).slice(0,r)===(t=vc(n.d)).slice(0,r)){if("9999"!=(t=t.slice(r-3,r+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(Ac(n,l+1,1),e=!n.times(n).eq(o));break}if(!i&&(Ac(a,l+1,0),a.times(a).eq(o))){n=a;break}r+=4,i=1}return rc=!0,Ac(n,l,c.rounding,e)},yc.tangent=yc.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,(r=r.sin()).s=1,r=wc(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,Ac(2==hu||4==hu?r.neg():r,e,t,!0)):new n(NaN)},yc.times=yc.mul=function(e){var t,r,n,i,a,o,s,l,u,c=this,h=c.constructor,p=c.d,d=(e=new h(e)).d;if(e.s*=c.s,!(p&&p[0]&&d&&d[0]))return new h(!e.s||p&&!p[0]&&!d||d&&!d[0]&&!p?NaN:p&&d?0*e.s:e.s/0);for(r=lc(c.e/7)+lc(e.e/7),(l=p.length)<(u=d.length)&&(a=p,p=d,d=a,o=l,l=u,u=o),a=[],n=o=l+u;n--;)a.push(0);for(n=u;--n>=0;){for(t=0,i=l+n;i>n;)s=a[i]+d[n]*p[i-n-1]+t,a[i--]=s%fc|0,t=s/fc|0;a[i]=(a[i]+t)%fc|0}for(;!a[--o];)a.pop();return t?++r:a.shift(),e.d=a,e.e=Ec(a,r),rc?Ac(e,h.precision,h.rounding):e},yc.toBinary=function(e,t){return jc(this,2,e,t)},yc.toDecimalPlaces=yc.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),void 0===e?r:(xc(e,0,Ku),void 0===t?t=n.rounding:xc(t,0,8),Ac(r,e+r.e+1,t))},yc.toExponential=function(e,t){var r,n=this,i=n.constructor;return void 0===e?r=Cc(n,!0):(xc(e,0,Ku),void 0===t?t=i.rounding:xc(t,0,8),r=Cc(n=Ac(new i(n),e+1,t),!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r},yc.toFixed=function(e,t){var r,n,i=this,a=i.constructor;return void 0===e?r=Cc(i):(xc(e,0,Ku),void 0===t?t=a.rounding:xc(t,0,8),r=Cc(n=Ac(new a(i),e+i.e+1,t),!1,e+n.e+1)),i.isNeg()&&!i.isZero()?"-"+r:r},yc.toFraction=function(e){var t,r,n,i,a,o,s,l,u,c,h,p,d=this,f=d.d,m=d.constructor;if(!f)return new m(d);if(u=r=new m(1),n=l=new m(0),o=(a=(t=new m(n)).e=Dc(f)-d.e-1)%7,t.d[0]=uc(10,o<0?7+o:o),null==e)e=a>0?t:u;else{if(!(s=new m(e)).isInt()||s.lt(u))throw Error(ic+s);e=s.gt(t)?a>0?t:u:s}for(rc=!1,s=new m(vc(f)),c=m.precision,m.precision=a=7*f.length*2;h=wc(s,t,0,1,1),1!=(i=r.plus(h.times(n))).cmp(e);)r=n,n=i,i=u,u=l.plus(h.times(i)),l=i,i=t,t=s.minus(h.times(i)),s=i;return i=wc(e.minus(r),n,0,1,1),l=l.plus(i.times(u)),r=r.plus(i.times(n)),l.s=u.s=d.s,p=wc(u,n,a,1).minus(d).abs().cmp(wc(l,r,a,1).minus(d).abs())<1?[u,n]:[l,r],m.precision=c,rc=!0,p},yc.toHexadecimal=yc.toHex=function(e,t){return jc(this,16,e,t)},yc.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),null==e){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),void 0===t?t=n.rounding:xc(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(rc=!1,r=wc(r,e,0,t,1).times(e),rc=!0,Ac(r)):(e.s=r.s,r=e),r},yc.toNumber=function(){return+this},yc.toOctal=function(e,t){return jc(this,8,e,t)},yc.toPower=yc.pow=function(e){var t,r,n,i,a,o,s=this,l=s.constructor,u=+(e=new l(e));if(!(s.d&&e.d&&s.d[0]&&e.d[0]))return new l(uc(+s,u));if((s=new l(s)).eq(1))return s;if(n=l.precision,a=l.rounding,e.eq(1))return Ac(s,n,a);if((t=lc(e.e/7))>=e.d.length-1&&(r=u<0?-u:u)<=9007199254740991)return i=Nc(l,s,r,n),e.s<0?new l(1).div(i):Ac(i,n,a);if((o=s.s)<0){if(t<e.d.length-1)return new l(NaN);if(1&e.d[t]||(o=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=o,s}return(t=0!=(r=uc(+s,u))&&isFinite(r)?new l(r+"").e:lc(u*(Math.log("0."+vc(s.d))/Math.LN10+s.e+1)))>l.maxE+1||t<l.minE-1?new l(t>0?o/0:0):(rc=!1,l.rounding=s.s=1,r=Math.min(12,(t+"").length),(i=zc(e.times(Bc(s,n+r)),n)).d&&_c((i=Ac(i,n+5,1)).d,n,a)&&(t=n+10,+vc((i=Ac(zc(e.times(Bc(s,t+r)),t),t+5,1)).d).slice(n+1,n+15)+1==1e14&&(i=Ac(i,n+1,0))),i.s=o,rc=!0,l.rounding=a,Ac(i,n,a))},yc.toPrecision=function(e,t){var r,n=this,i=n.constructor;return void 0===e?r=Cc(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(xc(e,1,Ku),void 0===t?t=i.rounding:xc(t,0,8),r=Cc(n=Ac(new i(n),e,t),e<=n.e||n.e<=i.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r},yc.toSignificantDigits=yc.toSD=function(e,t){var r=this.constructor;return void 0===e?(e=r.precision,t=r.rounding):(xc(e,1,Ku),void 0===t?t=r.rounding:xc(t,0,8)),Ac(new r(this),e,t)},yc.toString=function(){var e=this,t=e.constructor,r=Cc(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r},yc.truncated=yc.trunc=function(){return Ac(new this.constructor(this),this.e+1,1)},yc.valueOf=yc.toJSON=function(){var e=this,t=e.constructor,r=Cc(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};var wc=function(){function e(e,t,r){var n,i=0,a=e.length;for(e=e.slice();a--;)n=e[a]*t+i,e[a]=n%r|0,i=n/r|0;return i&&e.unshift(i),e}function t(e,t,r,n){var i,a;if(r!=n)a=r>n?1:-1;else for(i=a=0;i<r;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;)e.shift()}return function(n,i,a,o,s,l){var u,c,h,p,d,f,m,g,y,v,x,_,b,w,A,C,E,M,S,D,T=n.constructor,N=n.s==i.s?1:-1,I=n.d,P=i.d;if(!(I&&I[0]&&P&&P[0]))return new T(n.s&&i.s&&(I?!P||I[0]!=P[0]:P)?I&&0==I[0]||!P?0*N:N/0:NaN);for(l?(d=1,c=n.e-i.e):(l=fc,d=7,c=lc(n.e/d)-lc(i.e/d)),S=P.length,E=I.length,v=(y=new T(N)).d=[],h=0;P[h]==(I[h]||0);h++);if(P[h]>(I[h]||0)&&c--,null==a?(w=a=T.precision,o=T.rounding):w=s?a+(n.e-i.e)+1:a,w<0)v.push(1),f=!0;else{if(w=w/d+2|0,h=0,1==S){for(p=0,P=P[0],w++;(h<E||p)&&w--;h++)A=p*l+(I[h]||0),v[h]=A/P|0,p=A%P|0;f=p||h<E}else{for((p=l/(P[0]+1)|0)>1&&(P=e(P,p,l),I=e(I,p,l),S=P.length,E=I.length),C=S,_=(x=I.slice(0,S)).length;_<S;)x[_++]=0;(D=P.slice()).unshift(0),M=P[0],P[1]>=l/2&&++M;do{p=0,(u=t(P,x,S,_))<0?(b=x[0],S!=_&&(b=b*l+(x[1]||0)),(p=b/M|0)>1?(p>=l&&(p=l-1),1==(u=t(m=e(P,p,l),x,g=m.length,_=x.length))&&(p--,r(m,S<g?D:P,g,l))):(0==p&&(u=p=1),m=P.slice()),(g=m.length)<_&&m.unshift(0),r(x,m,_,l),-1==u&&(u=t(P,x,S,_=x.length))<1&&(p++,r(x,S<_?D:P,_,l)),_=x.length):0===u&&(p++,x=[0]),v[h++]=p,u&&x[0]?x[_++]=I[C]||0:(x=[I[C]],_=1)}while((C++<E||void 0!==x[0])&&w--);f=void 0!==x[0]}v[0]||v.shift()}if(1==d)y.e=c,cu=f;else{for(h=1,p=v[0];p>=10;p/=10)h++;y.e=h+c*d-1,Ac(y,s?a+y.e+1:a,o,f)}return y}}();function Ac(e,t,r,n){var i,a,o,s,l,u,c,h,p,d=e.constructor;e:if(null!=t){if(!(h=e.d))return e;for(i=1,s=h[0];s>=10;s/=10)i++;if((a=t-i)<0)a+=7,o=t,l=(c=h[p=0])/uc(10,i-o-1)%10|0;else if((p=Math.ceil((a+1)/7))>=(s=h.length)){if(!n)break e;for(;s++<=p;)h.push(0);c=l=0,i=1,o=(a%=7)-7+1}else{for(c=s=h[p],i=1;s>=10;s/=10)i++;l=(o=(a%=7)-7+i)<0?0:c/uc(10,i-o-1)%10|0}if(n=n||t<0||void 0!==h[p+1]||(o<0?c:c%uc(10,i-o-1)),u=r<4?(l||n)&&(0==r||r==(e.s<0?3:2)):l>5||5==l&&(4==r||n||6==r&&(a>0?o>0?c/uc(10,i-o):0:h[p-1])%10&1||r==(e.s<0?8:7)),t<1||!h[0])return h.length=0,u?(t-=e.e+1,h[0]=uc(10,(7-t%7)%7),e.e=-t||0):h[0]=e.e=0,e;if(0==a?(h.length=p,s=1,p--):(h.length=p+1,s=uc(10,7-a),h[p]=o>0?(c/uc(10,i-o)%uc(10,o)|0)*s:0),u)for(;;){if(0==p){for(a=1,o=h[0];o>=10;o/=10)a++;for(o=h[0]+=s,s=1;o>=10;o/=10)s++;a!=s&&(e.e++,h[0]==fc&&(h[0]=1));break}if(h[p]+=s,h[p]!=fc)break;h[p--]=0,s=1}for(a=h.length;0===h[--a];)h.pop()}return rc&&(e.e>d.maxE?(e.d=null,e.e=NaN):e.e<d.minE&&(e.e=0,e.d=[0])),e}function Cc(e,t,r){if(!e.isFinite())return kc(e);var n,i=e.e,a=vc(e.d),o=a.length;return t?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+Tc(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):i<0?(a="0."+Tc(-i-1)+a,r&&(n=r-o)>0&&(a+=Tc(n))):i>=o?(a+=Tc(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+Tc(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=Tc(n))),a}function Ec(e,t){var r=e[0];for(t*=7;r>=10;r/=10)t++;return t}function Mc(e,t,r){if(t>mc)throw rc=!0,r&&(e.precision=r),Error(ac);return Ac(new e(Qu),t,1,!0)}function Sc(e,t,r){if(t>gc)throw Error(ac);return Ac(new e(ec),t,r,!0)}function Dc(e){var t=e.length-1,r=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function Tc(e){for(var t="";e--;)t+="0";return t}function Nc(e,t,r,n){var i,a=new e(1),o=Math.ceil(n/7+4);for(rc=!1;;){if(r%2&&Uc((a=a.times(t)).d,o)&&(i=!0),0===(r=lc(r/2))){r=a.d.length-1,i&&0===a.d[r]&&++a.d[r];break}Uc((t=t.times(t)).d,o)}return rc=!0,a}function Ic(e){return 1&e.d[e.d.length-1]}function Pc(e,t,r){for(var n,i,a=new e(t[0]),o=0;++o<t.length;){if(!(i=new e(t[o])).s){a=i;break}((n=a.cmp(i))===r||0===n&&a.s===r)&&(a=i)}return a}function zc(e,t){var r,n,i,a,o,s,l,u=0,c=0,h=0,p=e.constructor,d=p.rounding,f=p.precision;if(!e.d||!e.d[0]||e.e>17)return new p(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(rc=!1,l=f):l=t,s=new p(.03125);e.e>-2;)e=e.times(s),h+=5;for(l+=n=Math.log(uc(2,h))/Math.LN10*2+5|0,r=a=o=new p(1),p.precision=l;;){if(a=Ac(a.times(e),l,1),r=r.times(++c),vc((s=o.plus(wc(a,r,l,1))).d).slice(0,l)===vc(o.d).slice(0,l)){for(i=h;i--;)o=Ac(o.times(o),l,1);if(null!=t)return p.precision=f,o;if(!(u<3&&_c(o.d,l-n,d,u)))return Ac(o,p.precision=f,d,rc=!0);p.precision=l+=10,r=a=s=new p(1),c=0,u++}o=s}}function Bc(e,t){var r,n,i,a,o,s,l,u,c,h,p,d=1,f=e,m=f.d,g=f.constructor,y=g.rounding,v=g.precision;if(f.s<0||!m||!m[0]||!f.e&&1==m[0]&&1==m.length)return new g(m&&!m[0]?-1/0:1!=f.s?NaN:m?0:f);if(null==t?(rc=!1,c=v):c=t,g.precision=c+=10,n=(r=vc(m)).charAt(0),!(Math.abs(a=f.e)<15e14))return u=Mc(g,c+2,v).times(a+""),f=Bc(new g(n+"."+r.slice(1)),c-10).plus(u),g.precision=v,null==t?Ac(f,v,y,rc=!0):f;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=vc((f=f.times(e)).d)).charAt(0),d++;for(a=f.e,n>1?(f=new g("0."+r),a++):f=new g(n+"."+r.slice(1)),h=f,l=o=f=wc(f.minus(1),f.plus(1),c,1),p=Ac(f.times(f),c,1),i=3;;){if(o=Ac(o.times(p),c,1),vc((u=l.plus(wc(o,new g(i),c,1))).d).slice(0,c)===vc(l.d).slice(0,c)){if(l=l.times(2),0!==a&&(l=l.plus(Mc(g,c+2,v).times(a+""))),l=wc(l,new g(d),c,1),null!=t)return g.precision=v,l;if(!_c(l.d,c-10,y,s))return Ac(l,g.precision=v,y,rc=!0);g.precision=c+=10,u=o=f=wc(h.minus(1),h.plus(1),c,1),p=Ac(f.times(f),c,1),i=s=1}l=u,i+=2}}function kc(e){return String(e.s*e.s/0)}function Fc(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;48===t.charCodeAt(n);n++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(n,i)){if(i-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%7,r<0&&(n+=7),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=7;n<i;)e.d.push(+t.slice(n,n+=7));n=7-(t=t.slice(n)).length}else n-=i;for(;n--;)t+="0";e.d.push(+t),rc&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Rc(e,t){var r,n,i,a,o,s,l,u,c;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),dc.test(t))return Fc(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(hc.test(t))r=16,t=t.toLowerCase();else if(cc.test(t))r=2;else{if(!pc.test(t))throw Error(ic+t);r=8}for((a=t.search(/p/i))>0?(l=+t.slice(a+1),t=t.substring(2,a)):t=t.slice(2),o=(a=t.indexOf("."))>=0,n=e.constructor,o&&(a=(s=(t=t.replace(".","")).length)-a,i=Nc(n,new n(r),a,2*a)),a=c=(u=bc(t,r,fc)).length-1;0===u[a];--a)u.pop();return a<0?new n(0*e.s):(e.e=Ec(u,c),e.d=u,rc=!1,o&&(e=wc(e,i,4*s)),l&&(e=e.times(Math.abs(l)<54?uc(2,l):Th.pow(2,l))),rc=!0,e)}function Oc(e,t,r,n,i){var a,o,s,l,u=e.precision,c=Math.ceil(u/7);for(rc=!1,l=r.times(r),s=new e(n);;){if(o=wc(s.times(l),new e(t++*t++),u,1),s=i?n.plus(o):n.minus(o),n=wc(o.times(l),new e(t++*t++),u,1),void 0!==(o=s.plus(n)).d[c]){for(a=c;o.d[a]===s.d[a]&&a--;);if(-1==a)break}a=s,s=n,n=o,o=a}return rc=!0,o.d.length=c+1,o}function Lc(e,t){for(var r=e;--t;)r*=e;return r}function qc(e,t){var r,n=t.s<0,i=Sc(e,e.precision,1),a=i.times(.5);if((t=t.abs()).lte(a))return hu=n?4:1,t;if((r=t.divToInt(i)).isZero())hu=n?3:2;else{if((t=t.minus(r.times(i))).lte(a))return hu=Ic(r)?n?2:3:n?4:1,t;hu=Ic(r)?n?1:4:n?3:2}return t.minus(i).abs()}function jc(e,t,r,n){var i,a,o,s,l,u,c,h,p,d=e.constructor,f=void 0!==r;if(f?(xc(r,1,Ku),void 0===n?n=d.rounding:xc(n,0,8)):(r=d.precision,n=d.rounding),e.isFinite()){for(f?(i=2,16==t?r=4*r-3:8==t&&(r=3*r-2)):i=t,(o=(c=Cc(e)).indexOf("."))>=0&&(c=c.replace(".",""),(p=new d(1)).e=c.length-o,p.d=bc(Cc(p),10,i),p.e=p.d.length),a=l=(h=bc(c,10,i)).length;0==h[--l];)h.pop();if(h[0]){if(o<0?a--:((e=new d(e)).d=h,e.e=a,h=(e=wc(e,p,r,n,0,i)).d,a=e.e,u=cu),o=h[r],s=i/2,u=u||void 0!==h[r+1],u=n<4?(void 0!==o||u)&&(0===n||n===(e.s<0?3:2)):o>s||o===s&&(4===n||u||6===n&&1&h[r-1]||n===(e.s<0?8:7)),h.length=r,u)for(;++h[--r]>i-1;)h[r]=0,r||(++a,h.unshift(1));for(l=h.length;!h[l-1];--l);for(o=0,c="";o<l;o++)c+=Ju.charAt(h[o]);if(f){if(l>1)if(16==t||8==t){for(o=16==t?4:3,--l;l%o;l++)c+="0";for(l=(h=bc(c,i,t)).length;!h[l-1];--l);for(o=1,c="1.";o<l;o++)c+=Ju.charAt(h[o])}else c=c.charAt(0)+"."+c.slice(1);c=c+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)c="0"+c;c="0."+c}else if(++a>l)for(a-=l;a--;)c+="0";else a<l&&(c=c.slice(0,a)+"."+c.slice(a))}else c=f?"0p+0":"0";c=(16==t?"0x":2==t?"0b":8==t?"0o":"")+c}else c=kc(e);return e.s<0?"-"+c:c}function Uc(e,t){if(e.length>t)return e.length=t,!0}function Vc(e){return new this(e).abs()}function Zc(e){return new this(e).acos()}function $c(e){return new this(e).acosh()}function Gc(e,t){return new this(e).plus(t)}function Hc(e){return new this(e).asin()}function Wc(e){return new this(e).asinh()}function Xc(e){return new this(e).atan()}function Yc(e){return new this(e).atanh()}function Kc(e,t){e=new this(e),t=new this(t);var r,n=this.precision,i=this.rounding,a=n+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(r=t.s<0?Sc(this,n,i):new this(0)).s=e.s:!e.d||t.isZero()?(r=Sc(this,a,1).times(.5)).s=e.s:t.s<0?(this.precision=a,this.rounding=1,r=this.atan(wc(e,t,a,1)),t=Sc(this,a,1),this.precision=n,this.rounding=i,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(wc(e,t,a,1)):(r=Sc(this,a,1).times(t.s>0?.25:.75)).s=e.s:r=new this(NaN),r}function Jc(e){return new this(e).cbrt()}function Qc(e){return Ac(e=new this(e),e.e+1,2)}function eh(e,t,r){return new this(e).clamp(t,r)}function th(e){if(!e||"object"!=typeof e)throw Error(nc+"Object expected");var t,r,n,i=!0===e.defaults,a=["precision",1,Ku,"rounding",0,8,"toExpNeg",-Yu,0,"toExpPos",0,Yu,"maxE",0,Yu,"minE",-Yu,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(r=a[t],i&&(this[r]=tc[r]),void 0!==(n=e[r])){if(!(lc(n)===n&&n>=a[t+1]&&n<=a[t+2]))throw Error(ic+r+": "+n);this[r]=n}if(r="crypto",i&&(this[r]=tc[r]),void 0!==(n=e[r])){if(!0!==n&&!1!==n&&0!==n&&1!==n)throw Error(ic+r+": "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(oc);this[r]=!0}else this[r]=!1}return this}function rh(e){return new this(e).cos()}function nh(e){return new this(e).cosh()}function ih(e,t){return new this(e).div(t)}function ah(e){return new this(e).exp()}function oh(e){return Ac(e=new this(e),e.e+1,3)}function sh(){var e,t,r=new this(0);for(rc=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return rc=!0,new this(1/0);r=t}return rc=!0,r.sqrt()}function lh(e){return e instanceof Th||e&&e.toStringTag===sc||!1}function uh(e){return new this(e).ln()}function ch(e,t){return new this(e).log(t)}function hh(e){return new this(e).log(2)}function ph(e){return new this(e).log(10)}function dh(){return Pc(this,arguments,-1)}function fh(){return Pc(this,arguments,1)}function mh(e,t){return new this(e).mod(t)}function gh(e,t){return new this(e).mul(t)}function yh(e,t){return new this(e).pow(t)}function vh(e){var t,r,n,i,a=0,o=new this(1),s=[];if(void 0===e?e=this.precision:xc(e,1,Ku),n=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));a<n;)(i=t[a])>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:s[a++]=i%1e7;else{if(!crypto.randomBytes)throw Error(oc);for(t=crypto.randomBytes(n*=4);a<n;)(i=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((127&t[a+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,a):(s.push(i%1e7),a+=4);a=n/4}else for(;a<n;)s[a++]=1e7*Math.random()|0;for(e%=7,(n=s[--a])&&e&&(i=uc(10,7-e),s[a]=(n/i|0)*i);0===s[a];a--)s.pop();if(a<0)r=0,s=[0];else{for(r=-1;0===s[0];r-=7)s.shift();for(n=1,i=s[0];i>=10;i/=10)n++;n<7&&(r-=7-n)}return o.e=r,o.d=s,o}function xh(e){return Ac(e=new this(e),e.e+1,this.rounding)}function _h(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function bh(e){return new this(e).sin()}function wh(e){return new this(e).sinh()}function Ah(e){return new this(e).sqrt()}function Ch(e,t){return new this(e).sub(t)}function Eh(){var e=0,t=arguments,r=new this(t[e]);for(rc=!1;r.s&&++e<t.length;)r=r.plus(t[e]);return rc=!0,Ac(r,this.precision,this.rounding)}function Mh(e){return new this(e).tan()}function Sh(e){return new this(e).tanh()}function Dh(e){return Ac(e=new this(e),e.e+1,1)}yc[Symbol.for("nodejs.util.inspect.custom")]=yc.toString,yc[Symbol.toStringTag]="Decimal";var Th=yc.constructor=function e(t){var r,n,i;function a(e){var t,r,n,i=this;if(!(i instanceof a))return new a(e);if(i.constructor=a,lh(e))return i.s=e.s,void(rc?!e.d||e.e>a.maxE?(i.e=NaN,i.d=null):e.e<a.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"==(n=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,r=e;r>=10;r/=10)t++;return void(rc?t>a.maxE?(i.e=NaN,i.d=null):t<a.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!=0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):Fc(i,e.toString())}if("string"===n)return 45===(r=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===r&&(e=e.slice(1)),i.s=1),dc.test(e)?Fc(i,e):Rc(i,e);if("bigint"===n)return e<0?(e=-e,i.s=-1):i.s=1,Fc(i,e.toString());throw Error(ic+e)}if(a.prototype=yc,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.EUCLID=9,a.config=a.set=th,a.clone=e,a.isDecimal=lh,a.abs=Vc,a.acos=Zc,a.acosh=$c,a.add=Gc,a.asin=Hc,a.asinh=Wc,a.atan=Xc,a.atanh=Yc,a.atan2=Kc,a.cbrt=Jc,a.ceil=Qc,a.clamp=eh,a.cos=rh,a.cosh=nh,a.div=ih,a.exp=ah,a.floor=oh,a.hypot=sh,a.ln=uh,a.log=ch,a.log10=ph,a.log2=hh,a.max=dh,a.min=fh,a.mod=mh,a.mul=gh,a.pow=yh,a.random=vh,a.round=xh,a.sign=_h,a.sin=bh,a.sinh=wh,a.sqrt=Ah,a.sub=Ch,a.sum=Eh,a.tan=Mh,a.tanh=Sh,a.trunc=Dh,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<i.length;)t.hasOwnProperty(n=i[r++])||(t[n]=this[n]);return a.config(t),a}(tc);Qu=new Th(Qu),ec=new Th(ec);const Nh=Th;var Ih=Ii("BigNumber",["?on","config"],(e=>{var{on:t,config:r}=e,n=Nh.clone({precision:r.precision,modulo:Nh.EUCLID});return n.prototype=Object.create(n.prototype),n.prototype.type="BigNumber",n.prototype.isBigNumber=!0,n.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},n.fromJSON=function(e){return new n(e.value)},t&&t("config",(function(e,t){e.precision!==t.precision&&n.config({precision:e.precision})})),n}),{isClass:!0});const Ph=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:.5*(Math.exp(e)+Math.exp(-e))},zh=Math.sinh||function(e){return Math.abs(e)<1e-9?e:.5*(Math.exp(e)-Math.exp(-e))},Bh=function(e,t){return(e=Math.abs(e))<(t=Math.abs(t))&&([e,t]=[t,e]),e<1e8?Math.sqrt(e*e+t*t):(t/=e,e*Math.sqrt(1+t*t))},kh=function(){throw SyntaxError("Invalid Param")};function Fh(e,t){const r=Math.abs(e),n=Math.abs(t);return 0===e?Math.log(n):0===t?Math.log(r):r<3e3&&n<3e3?.5*Math.log(e*e+t*t):(e*=.5,t*=.5,.5*Math.log(e*e+t*t)+Math.LN2)}const Rh={re:0,im:0},Oh=function(e,t){const r=Rh;if(null==e)r.re=r.im=0;else if(void 0!==t)r.re=e,r.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)r.re=e.re,r.im=e.im;else if("abs"in e&&"arg"in e){if(!isFinite(e.abs)&&isFinite(e.arg))return Lh.INFINITY;r.re=e.abs*Math.cos(e.arg),r.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!isFinite(e.r)&&isFinite(e.phi))return Lh.INFINITY;r.re=e.r*Math.cos(e.phi),r.im=e.r*Math.sin(e.phi)}else 2===e.length?(r.re=e[0],r.im=e[1]):kh();break;case"string":r.im=r.re=0;const t=e.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g);let n=1,i=0;null===t&&kh();for(let e=0;e<t.length;e++){const a=t[e];" "===a||"\t"===a||"\n"===a||("+"===a?n++:"-"===a?i++:"i"===a||"I"===a?(n+i===0&&kh()," "===t[e+1]||isNaN(t[e+1])?r.im+=parseFloat((i%2?"-":"")+"1"):(r.im+=parseFloat((i%2?"-":"")+t[e+1]),e++),n=i=0):((n+i===0||isNaN(a))&&kh(),"i"===t[e+1]||"I"===t[e+1]?(r.im+=parseFloat((i%2?"-":"")+a),e++):r.re+=parseFloat((i%2?"-":"")+a),n=i=0))}n+i>0&&kh();break;case"number":r.im=0,r.re=e;break;default:kh()}return isNaN(r.re)||isNaN(r.im),r};function Lh(e,t){if(!(this instanceof Lh))return new Lh(e,t);const r=Oh(e,t);this.re=r.re,this.im=r.im}Lh.prototype={re:0,im:0,sign:function(){const e=Bh(this.re,this.im);return new Lh(this.re/e,this.im/e)},add:function(e,t){const r=Oh(e,t),n=this.isInfinite(),i=!(isFinite(r.re)&&isFinite(r.im));return n||i?n&&i?Lh.NAN:Lh.INFINITY:new Lh(this.re+r.re,this.im+r.im)},sub:function(e,t){const r=Oh(e,t),n=this.isInfinite(),i=!(isFinite(r.re)&&isFinite(r.im));return n||i?n&&i?Lh.NAN:Lh.INFINITY:new Lh(this.re-r.re,this.im-r.im)},mul:function(e,t){const r=Oh(e,t),n=this.isInfinite(),i=!(isFinite(r.re)&&isFinite(r.im)),a=0===this.re&&0===this.im,o=0===r.re&&0===r.im;return n&&o||i&&a?Lh.NAN:n||i?Lh.INFINITY:0===r.im&&0===this.im?new Lh(this.re*r.re,0):new Lh(this.re*r.re-this.im*r.im,this.re*r.im+this.im*r.re)},div:function(e,t){const r=Oh(e,t),n=this.isInfinite(),i=!(isFinite(r.re)&&isFinite(r.im)),a=0===this.re&&0===this.im,o=0===r.re&&0===r.im;if(a&&o||n&&i)return Lh.NAN;if(o||n)return Lh.INFINITY;if(a||i)return Lh.ZERO;if(0===r.im)return new Lh(this.re/r.re,this.im/r.re);if(Math.abs(r.re)<Math.abs(r.im)){const e=r.re/r.im,t=r.re*e+r.im;return new Lh((this.re*e+this.im)/t,(this.im*e-this.re)/t)}{const e=r.im/r.re,t=r.im*e+r.re;return new Lh((this.re+this.im*e)/t,(this.im-this.re*e)/t)}},pow:function(e,t){const r=Oh(e,t),n=0===this.re&&0===this.im;if(0===r.re&&0===r.im)return Lh.ONE;if(0===r.im){if(0===this.im&&this.re>0)return new Lh(Math.pow(this.re,r.re),0);if(0===this.re)switch((r.re%4+4)%4){case 0:return new Lh(Math.pow(this.im,r.re),0);case 1:return new Lh(0,Math.pow(this.im,r.re));case 2:return new Lh(-Math.pow(this.im,r.re),0);case 3:return new Lh(0,-Math.pow(this.im,r.re))}}if(n&&r.re>0)return Lh.ZERO;const i=Math.atan2(this.im,this.re),a=Fh(this.re,this.im);let o=Math.exp(r.re*a-r.im*i),s=r.im*a+r.re*i;return new Lh(o*Math.cos(s),o*Math.sin(s))},sqrt:function(){const e=this.re,t=this.im;if(0===t)return e>=0?new Lh(Math.sqrt(e),0):new Lh(0,Math.sqrt(-e));const r=Bh(e,t);let n=Math.sqrt(.5*(r+Math.abs(e))),i=Math.abs(t)/(2*n);return e>=0?new Lh(n,t<0?-i:i):new Lh(i,t<0?-n:n)},exp:function(){const e=Math.exp(this.re);return 0===this.im?new Lh(e,0):new Lh(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){const e=this.re,t=this.im;return new Lh(Math.expm1(e)*Math.cos(t)+function(e){const t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;const r=e*e;return r*(r*(r*(r*(r*(r*(r*(r/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(t),Math.exp(e)*Math.sin(t))},log:function(){const e=this.re,t=this.im;return 0===t&&e>0?new Lh(Math.log(e),0):new Lh(Fh(e,t),Math.atan2(t,e))},abs:function(){return Bh(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){const e=this.re,t=this.im;return new Lh(Math.sin(e)*Ph(t),Math.cos(e)*zh(t))},cos:function(){const e=this.re,t=this.im;return new Lh(Math.cos(e)*Ph(t),-Math.sin(e)*zh(t))},tan:function(){const e=2*this.re,t=2*this.im,r=Math.cos(e)+Ph(t);return new Lh(Math.sin(e)/r,zh(t)/r)},cot:function(){const e=2*this.re,t=2*this.im,r=Math.cos(e)-Ph(t);return new Lh(-Math.sin(e)/r,zh(t)/r)},sec:function(){const e=this.re,t=this.im,r=.5*Ph(2*t)+.5*Math.cos(2*e);return new Lh(Math.cos(e)*Ph(t)/r,Math.sin(e)*zh(t)/r)},csc:function(){const e=this.re,t=this.im,r=.5*Ph(2*t)-.5*Math.cos(2*e);return new Lh(Math.sin(e)*Ph(t)/r,-Math.cos(e)*zh(t)/r)},asin:function(){const e=this.re,t=this.im,r=new Lh(t*t-e*e+1,-2*e*t).sqrt(),n=new Lh(r.re-t,r.im+e).log();return new Lh(n.im,-n.re)},acos:function(){const e=this.re,t=this.im,r=new Lh(t*t-e*e+1,-2*e*t).sqrt(),n=new Lh(r.re-t,r.im+e).log();return new Lh(Math.PI/2-n.im,n.re)},atan:function(){const e=this.re,t=this.im;if(0===e){if(1===t)return new Lh(0,1/0);if(-1===t)return new Lh(0,-1/0)}const r=e*e+(1-t)*(1-t),n=new Lh((1-t*t-e*e)/r,-2*e/r).log();return new Lh(-.5*n.im,.5*n.re)},acot:function(){const e=this.re,t=this.im;if(0===t)return new Lh(Math.atan2(1,e),0);const r=e*e+t*t;return 0!==r?new Lh(e/r,-t/r).atan():new Lh(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Lh(0,1/0);const r=e*e+t*t;return 0!==r?new Lh(e/r,-t/r).acos():new Lh(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Lh(Math.PI/2,1/0);const r=e*e+t*t;return 0!==r?new Lh(e/r,-t/r).asin():new Lh(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){const e=this.re,t=this.im;return new Lh(zh(e)*Math.cos(t),Ph(e)*Math.sin(t))},cosh:function(){const e=this.re,t=this.im;return new Lh(Ph(e)*Math.cos(t),zh(e)*Math.sin(t))},tanh:function(){const e=2*this.re,t=2*this.im,r=Ph(e)+Math.cos(t);return new Lh(zh(e)/r,Math.sin(t)/r)},coth:function(){const e=2*this.re,t=2*this.im,r=Ph(e)-Math.cos(t);return new Lh(zh(e)/r,-Math.sin(t)/r)},csch:function(){const e=this.re,t=this.im,r=Math.cos(2*t)-Ph(2*e);return new Lh(-2*zh(e)*Math.cos(t)/r,2*Ph(e)*Math.sin(t)/r)},sech:function(){const e=this.re,t=this.im,r=Math.cos(2*t)+Ph(2*e);return new Lh(2*Ph(e)*Math.cos(t)/r,-2*zh(e)*Math.sin(t)/r)},asinh:function(){let e=this.im;this.im=-this.re,this.re=e;const t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){const e=this.acos();if(e.im<=0){const t=e.re;e.re=-e.im,e.im=t}else{const t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){const e=this.re,t=this.im,r=e>1&&0===t,n=1-e,i=1+e,a=n*n+t*t,o=0!==a?new Lh((i*n-t*t)/a,(t*n+i*t)/a):new Lh(-1!==e?e/0:0,0!==t?t/0:0),s=o.re;return o.re=Fh(o.re,o.im)/2,o.im=Math.atan2(o.im,s)/2,r&&(o.im=-o.im),o},acoth:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new Lh(0,Math.PI/2);const r=e*e+t*t;return 0!==r?new Lh(e/r,-t/r).atanh():new Lh(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){const e=this.re,t=this.im;if(0===t)return new Lh(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);const r=e*e+t*t;return 0!==r?new Lh(e/r,-t/r).asinh():new Lh(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){const e=this.re,t=this.im;if(this.isZero())return Lh.INFINITY;const r=e*e+t*t;return 0!==r?new Lh(e/r,-t/r).acosh():new Lh(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){if(this.isZero())return Lh.INFINITY;if(this.isInfinite())return Lh.ZERO;const e=this.re,t=this.im,r=e*e+t*t;return new Lh(e/r,-t/r)},conjugate:function(){return new Lh(this.re,-this.im)},neg:function(){return new Lh(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new Lh(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new Lh(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new Lh(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){const r=Oh(e,t);return Math.abs(r.re-this.re)<=Lh.EPSILON&&Math.abs(r.im-this.im)<=Lh.EPSILON},clone:function(){return new Lh(this.re,this.im)},toString:function(){let e=this.re,t=this.im,r="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<Lh.EPSILON&&(e=0),Math.abs(t)<Lh.EPSILON&&(t=0),0===t?r+e:(0!==e?(r+=e,r+=" ",t<0?(t=-t,r+="-"):r+="+",r+=" "):t<0&&(t=-t,r+="-"),1!==t&&(r+=t),r+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}},Lh.ZERO=new Lh(0,0),Lh.ONE=new Lh(1,0),Lh.I=new Lh(0,1),Lh.PI=new Lh(Math.PI,0),Lh.E=new Lh(Math.E,0),Lh.INFINITY=new Lh(1/0,1/0),Lh.NAN=new Lh(NaN,NaN),Lh.EPSILON=1e-15;var qh=Ii("Complex",[],(()=>(Object.defineProperty(Lh,"name",{value:"Complex"}),Lh.prototype.constructor=Lh,Lh.prototype.type="Complex",Lh.prototype.isComplex=!0,Lh.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Lh.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Lh.prototype.format=function(e){var t=this.im,r=this.re,n=$i(this.re,e),i=$i(this.im,e),a=jn(e)?e:e?e.precision:null;if(null!==a){var o=Math.pow(10,-a);Math.abs(r/t)<o&&(r=0),Math.abs(t/r)<o&&(t=0)}return 0===t?n:0===r?1===t?"i":-1===t?"-i":i+"i":t<0?-1===t?n+" - i":n+" - "+i.substring(1)+"i":1===t?n+" + i":n+" + "+i+"i"},Lh.fromPolar=function(e){switch(arguments.length){case 1:var t=arguments[0];if("object"==typeof t)return Lh(t);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var r=arguments[0],n=arguments[1];if(jn(r)){if(Gn(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),jn(n))return new Lh({r,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},Lh.prototype.valueOf=Lh.prototype.toString,Lh.fromJSON=function(e){return new Lh(e)},Lh.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},Lh)),{isClass:!0});function jh(e){var t=0,r=1,n=Object.create(null),i=Object.create(null),a=0,o=function(e){var o=i[e];if(o&&(delete n[o],delete i[e],--t,r===o)){if(!t)return a=0,void(r=1);for(;!Object.prototype.hasOwnProperty.call(n,++r););}};return e=Math.abs(e),{hit:function(s){var l=i[s],u=++a;if(n[u]=s,i[s]=u,!l){if(++t<=e)return;return s=n[r],o(s),s}if(delete n[l],r===l)for(;!Object.prototype.hasOwnProperty.call(n,++r););},delete:o,clear:function(){t=a=0,r=1,n=Object.create(null),i=Object.create(null)}}}function Uh(e){var{hasher:t,limit:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r=null==r?Number.POSITIVE_INFINITY:r,t=null==t?JSON.stringify:t,function n(){"object"!=typeof n.cache&&(n.cache={values:new Map,lru:jh(r||Number.POSITIVE_INFINITY)});for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=t(i);if(n.cache.values.has(o))return n.cache.lru.hit(o),n.cache.values.get(o);var s=e.apply(e,i);return n.cache.values.set(o,s),n.cache.values.delete(n.cache.lru.hit(o)),s}}var Vh=Uh((function(e){return new e(1).exp()}),{hasher:Hh}),Zh=Uh((function(e){return new e(1).plus(new e(5).sqrt()).div(2)}),{hasher:Hh}),$h=Uh((function(e){return e.acos(-1)}),{hasher:Hh}),Gh=Uh((function(e){return $h(e).times(2)}),{hasher:Hh});function Hh(e){return e[0].precision}var Wh=Math.PI,Xh=2*Math.PI,Yh=Math.E,Kh=Ii("true",[],(()=>!0)),Jh=Ii("false",[],(()=>!1)),Qh=Ii("null",[],(()=>null)),ep=fp("Infinity",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(1/0):1/0})),tp=fp("NaN",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(NaN):NaN})),rp=fp("pi",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?$h(r):Wh})),np=fp("tau",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?Gh(r):Xh})),ip=fp("e",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?Vh(r):Yh})),ap=fp("phi",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?Zh(r):1.618033988749895})),op=fp("LN2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(2).ln():Math.LN2})),sp=fp("LN10",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(10).ln():Math.LN10})),lp=fp("LOG2E",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(1).div(new r(2).ln()):Math.LOG2E})),up=fp("LOG10E",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(1).div(new r(10).ln()):Math.LOG10E})),cp=fp("SQRT1_2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r("0.5").sqrt():Math.SQRT1_2})),hp=fp("SQRT2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:r}=e;return"BigNumber"===t.number?new r(2).sqrt():Math.SQRT2})),pp=fp("i",["Complex"],(e=>{var{Complex:t}=e;return t.I})),dp=Ii("version",[],(()=>"14.5.2"));function fp(e,t,r){return Ii(e,t,r,{recreateOnConfigChange:!0})}var mp=pd("speedOfLight","299792458","m s^-1"),gp=pd("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),yp=pd("planckConstant","6.62607015e-34","J s"),vp=pd("reducedPlanckConstant","1.0545718176461565e-34","J s"),xp=pd("magneticConstant","1.25663706212e-6","N A^-2"),_p=pd("electricConstant","8.8541878128e-12","F m^-1"),bp=pd("vacuumImpedance","376.730313667","ohm"),wp=pd("coulomb","8.987551792261171e9","N m^2 C^-2"),Ap=pd("coulombConstant","8.987551792261171e9","N m^2 C^-2"),Cp=pd("elementaryCharge","1.602176634e-19","C"),Ep=pd("bohrMagneton","9.2740100783e-24","J T^-1"),Mp=pd("conductanceQuantum","7.748091729863649e-5","S"),Sp=pd("inverseConductanceQuantum","12906.403729652257","ohm"),Dp=pd("magneticFluxQuantum","2.0678338484619295e-15","Wb"),Tp=pd("nuclearMagneton","5.0507837461e-27","J T^-1"),Np=pd("klitzing","25812.807459304513","ohm"),Ip=pd("bohrRadius","5.29177210903e-11","m"),Pp=pd("classicalElectronRadius","2.8179403262e-15","m"),zp=pd("electronMass","9.1093837015e-31","kg"),Bp=pd("fermiCoupling","1.1663787e-5","GeV^-2"),kp=dd("fineStructure",.0072973525693),Fp=pd("hartreeEnergy","4.3597447222071e-18","J"),Rp=pd("protonMass","1.67262192369e-27","kg"),Op=pd("deuteronMass","3.3435830926e-27","kg"),Lp=pd("neutronMass","1.6749271613e-27","kg"),qp=pd("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),jp=pd("rydberg","10973731.568160","m^-1"),Up=pd("thomsonCrossSection","6.6524587321e-29","m^2"),Vp=dd("weakMixingAngle",.2229),Zp=dd("efimovFactor",22.7),$p=pd("atomicMass","1.66053906660e-27","kg"),Gp=pd("avogadro","6.02214076e23","mol^-1"),Hp=pd("boltzmann","1.380649e-23","J K^-1"),Wp=pd("faraday","96485.33212331001","C mol^-1"),Xp=pd("firstRadiation","3.7417718521927573e-16","W m^2"),Yp=pd("loschmidt","2.686780111798444e25","m^-3"),Kp=pd("gasConstant","8.31446261815324","J K^-1 mol^-1"),Jp=pd("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),Qp=pd("molarVolume","0.022413969545014137","m^3 mol^-1"),ed=dd("sackurTetrode",-1.16487052358),td=pd("secondRadiation","0.014387768775039337","m K"),rd=pd("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),nd=pd("wienDisplacement","2.897771955e-3","m K"),id=pd("molarMass","0.99999999965e-3","kg mol^-1"),ad=pd("molarMassC12","11.9999999958e-3","kg mol^-1"),od=pd("gravity","9.80665","m s^-2"),sd=pd("planckLength","1.616255e-35","m"),ld=pd("planckMass","2.176435e-8","kg"),ud=pd("planckTime","5.391245e-44","s"),cd=pd("planckCharge","1.87554603778e-18","C"),hd=pd("planckTemperature","1.416785e+32","K");function pd(e,t,r){return Ii(e,["config","Unit","BigNumber"],(e=>{var{config:n,Unit:i,BigNumber:a}=e,o=new i("BigNumber"===n.number?new a(t):parseFloat(t),r);return o.fixPrefix=!0,o}))}function dd(e,t){return Ii(e,["config","BigNumber"],(e=>{var{config:r,BigNumber:n}=e;return"BigNumber"===r.number?new n(t):t}))}"undefined"==typeof BigInt&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const fd=BigInt(0),md=BigInt(1),gd=BigInt(2),yd=BigInt(5),vd=BigInt(10),xd={s:md,n:fd,d:md};function _d(e,t){try{e=BigInt(e)}catch(e){throw Dd()}return e*t}function bd(e){return"bigint"==typeof e?e:Math.floor(e)}function wd(e,t){if(t===fd)throw Sd();const r=Object.create(Md.prototype);r.s=e<fd?-md:md;const n=Ed(e=e<fd?-e:e,t);return r.n=e/n,r.d=t/n,r}function Ad(e){const t={};let r=e,n=gd,i=yd-md;for(;i<=r;){for(;r%n===fd;)r/=n,t[n]=(t[n]||fd)+md;i+=md+gd*n++}return r!==e?r>1&&(t[r]=(t[r]||fd)+md):t[e]=(t[e]||fd)+md,t}const Cd=function(e,t){let r=fd,n=md,i=md;if(null==e);else if(void 0!==t){if("bigint"==typeof e)r=e;else{if(isNaN(e))throw Dd();if(e%1!=0)throw Td();r=BigInt(e)}if("bigint"==typeof t)n=t;else{if(isNaN(t))throw Dd();if(t%1!=0)throw Td();n=BigInt(t)}i=r*n}else if("object"==typeof e){if("d"in e&&"n"in e)r=BigInt(e.n),n=BigInt(e.d),"s"in e&&(r*=BigInt(e.s));else if(0 in e)r=BigInt(e[0]),1 in e&&(n=BigInt(e[1]));else{if("bigint"!=typeof e)throw Dd();r=e}i=r*n}else if("number"==typeof e){if(isNaN(e))throw Dd();if(e<0&&(i=-md,e=-e),e%1==0)r=BigInt(e);else{let t=1,i=0,a=1,o=1,s=1,l=1e7;for(e>=1&&(t=10**Math.floor(1+Math.log10(e)),e/=t);a<=l&&s<=l;){let t=(i+o)/(a+s);if(e===t){a+s<=l?(r=i+o,n=a+s):s>a?(r=o,n=s):(r=i,n=a);break}e>t?(i+=o,a+=s):(o+=i,s+=a),a>l?(r=o,n=s):(r=i,n=a)}r=BigInt(r)*BigInt(t),n=BigInt(n)}}else if("string"==typeof e){let t=0,a=fd,o=fd,s=fd,l=md,u=md,c=e.replace(/_/g,"").match(/\d+|./g);if(null===c)throw Dd();if("-"===c[t]?(i=-md,t++):"+"===c[t]&&t++,c.length===t+1?o=_d(c[t++],i):"."===c[t+1]||"."===c[t]?("."!==c[t]&&(a=_d(c[t++],i)),t++,(t+1===c.length||"("===c[t+1]&&")"===c[t+3]||"'"===c[t+1]&&"'"===c[t+3])&&(o=_d(c[t],i),l=vd**BigInt(c[t].length),t++),("("===c[t]&&")"===c[t+2]||"'"===c[t]&&"'"===c[t+2])&&(s=_d(c[t+1],i),u=vd**BigInt(c[t+1].length)-md,t+=3)):"/"===c[t+1]||":"===c[t+1]?(o=_d(c[t],i),l=_d(c[t+2],md),t+=3):"/"===c[t+3]&&" "===c[t+1]&&(a=_d(c[t],i),o=_d(c[t+2],i),l=_d(c[t+4],md),t+=5),!(c.length<=t))throw Dd();n=l*u,i=r=s+n*a+u*o}else{if("bigint"!=typeof e)throw Dd();r=e,i=e,n=md}if(n===fd)throw Sd();xd.s=i<fd?-md:md,xd.n=r<fd?-r:r,xd.d=n<fd?-n:n};function Ed(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function Md(e,t){if(Cd(e,t),!(this instanceof Md))return wd(xd.s*xd.n,xd.d);e=Ed(xd.d,xd.n),this.s=xd.s,this.n=xd.n/e,this.d=xd.d/e}var Sd=function(){return new Error("Division by Zero")},Dd=function(){return new Error("Invalid argument")},Td=function(){return new Error("Parameters must be integer")};Md.prototype={s:md,n:fd,d:md,abs:function(){return wd(this.n,this.d)},neg:function(){return wd(-this.s*this.n,this.d)},add:function(e,t){return Cd(e,t),wd(this.s*this.n*xd.d+xd.s*this.d*xd.n,this.d*xd.d)},sub:function(e,t){return Cd(e,t),wd(this.s*this.n*xd.d-xd.s*this.d*xd.n,this.d*xd.d)},mul:function(e,t){return Cd(e,t),wd(this.s*xd.s*this.n*xd.n,this.d*xd.d)},div:function(e,t){return Cd(e,t),wd(this.s*xd.s*this.n*xd.d,this.d*xd.n)},clone:function(){return wd(this.s*this.n,this.d)},mod:function(e,t){if(void 0===e)return wd(this.s*this.n%this.d,md);if(Cd(e,t),fd===xd.n*this.d)throw Sd();return wd(this.s*(xd.d*this.n)%(xd.n*this.d),xd.d*this.d)},gcd:function(e,t){return Cd(e,t),wd(Ed(xd.n,this.n)*Ed(xd.d,this.d),xd.d*this.d)},lcm:function(e,t){return Cd(e,t),xd.n===fd&&this.n===fd?wd(fd,md):wd(xd.n*this.n,Ed(xd.n,this.n)*Ed(xd.d,this.d))},inverse:function(){return wd(this.s*this.d,this.n)},pow:function(e,t){if(Cd(e,t),xd.d===md)return xd.s<fd?wd((this.s*this.d)**xd.n,this.n**xd.n):wd((this.s*this.n)**xd.n,this.d**xd.n);if(this.s<fd)return null;let r=Ad(this.n),n=Ad(this.d),i=md,a=md;for(let e in r)if("1"!==e){if("0"===e){i=fd;break}if(r[e]*=xd.n,r[e]%xd.d!==fd)return null;r[e]/=xd.d,i*=BigInt(e)**r[e]}for(let e in n)if("1"!==e){if(n[e]*=xd.n,n[e]%xd.d!==fd)return null;n[e]/=xd.d,a*=BigInt(e)**n[e]}return xd.s<fd?wd(a,i):wd(i,a)},log:function(e,t){if(Cd(e,t),this.s<=fd||xd.s<=fd)return null;const r={},n=Ad(xd.n),i=Ad(xd.d),a=Ad(this.n),o=Ad(this.d);for(const e in i)n[e]=(n[e]||fd)-i[e];for(const e in o)a[e]=(a[e]||fd)-o[e];for(const e in n)"1"!==e&&(r[e]=!0);for(const e in a)"1"!==e&&(r[e]=!0);let s=null,l=null;for(const e in r){const t=n[e]||fd,r=a[e]||fd;if(t===fd){if(r!==fd)return null;continue}let i=r,o=t;const u=Ed(i,o);if(i/=u,o/=u,null===s&&null===l)s=i,l=o;else if(i*l!==s*o)return null}return null!==s&&null!==l?wd(s,l):null},equals:function(e,t){return Cd(e,t),this.s*this.n*xd.d===xd.s*xd.n*this.d},lt:function(e,t){return Cd(e,t),this.s*this.n*xd.d<xd.s*xd.n*this.d},lte:function(e,t){return Cd(e,t),this.s*this.n*xd.d<=xd.s*xd.n*this.d},gt:function(e,t){return Cd(e,t),this.s*this.n*xd.d>xd.s*xd.n*this.d},gte:function(e,t){return Cd(e,t),this.s*this.n*xd.d>=xd.s*xd.n*this.d},compare:function(e,t){Cd(e,t);let r=this.s*this.n*xd.d-xd.s*xd.n*this.d;return(fd<r)-(r<fd)},ceil:function(e){return e=vd**BigInt(e||0),wd(bd(this.s*e*this.n/this.d)+(e*this.n%this.d>fd&&this.s>=fd?md:fd),e)},floor:function(e){return e=vd**BigInt(e||0),wd(bd(this.s*e*this.n/this.d)-(e*this.n%this.d>fd&&this.s<fd?md:fd),e)},round:function(e){return e=vd**BigInt(e||0),wd(bd(this.s*e*this.n/this.d)+this.s*((this.s>=fd?md:fd)+gd*(e*this.n%this.d)>this.d?md:fd),e)},roundTo:function(e,t){Cd(e,t);const r=this.n*xd.d,n=this.d*xd.n,i=r%n;let a=bd(r/n);return i+i>=n&&a++,wd(this.s*a*xd.n,xd.d)},divisible:function(e,t){return Cd(e,t),!(!(xd.n*this.d)||this.n*xd.d%(xd.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(e){let t=this.n,r=this.d;e=e||15;let n=function(e,t){for(;t%gd===fd;t/=gd);for(;t%yd===fd;t/=yd);if(t===md)return fd;let r=vd%t,n=1;for(;r!==md;n++)if(r=r*vd%t,n>2e3)return fd;return BigInt(n)}(0,r),i=function(e,t,r){let n=md,i=function(e,t,r){let n=md;for(;t>fd;e=e*e%r,t>>=md)t&md&&(n=n*e%r);return n}(vd,r,t);for(let e=0;e<300;e++){if(n===i)return BigInt(e);n=n*vd%t,i=i*vd%t}return 0}(0,r,n),a=this.s<fd?"-":"";if(a+=bd(t/r),t%=r,t*=vd,t&&(a+="."),n){for(let e=i;e--;)a+=bd(t/r),t%=r,t*=vd;a+="(";for(let e=n;e--;)a+=bd(t/r),t%=r,t*=vd;a+=")"}else for(let n=e;t&&n--;)a+=bd(t/r),t%=r,t*=vd;return a},toFraction:function(e){let t=this.n,r=this.d,n=this.s<fd?"-":"";if(r===md)n+=t;else{let i=bd(t/r);e&&i>fd&&(n+=i,n+=" ",t%=r),n+=t,n+="/",n+=r}return n},toLatex:function(e){let t=this.n,r=this.d,n=this.s<fd?"-":"";if(r===md)n+=t;else{let i=bd(t/r);e&&i>fd&&(n+=i,t%=r),n+="\\frac{",n+=t,n+="}{",n+=r,n+="}"}return n},toContinued:function(){let e=this.n,t=this.d,r=[];do{r.push(bd(e/t));let n=e%t;e=t,t=n}while(e!==md);return r},simplify:function(e){const t=BigInt(1/(e||.001)|0),r=this.abs(),n=r.toContinued();for(let e=1;e<n.length;e++){let i=wd(n[e-1],md);for(let t=e-2;t>=0;t--)i=i.inverse().add(n[t]);let a=i.sub(r);if(a.n*t<a.d)return i.mul(this.s)}return this}};var Nd=Ii("Fraction",[],(()=>(Object.defineProperty(Md,"name",{value:"Fraction"}),Md.prototype.constructor=Md,Md.prototype.type="Fraction",Md.prototype.isFraction=!0,Md.prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},Md.fromJSON=function(e){return new Md(e)},Md)),{isClass:!0}),Id=Ii("Matrix",[],(()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(e,t,r){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(e,t,r){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e}),{isClass:!0}),Pd=Ii("Range",[],(()=>{function e(t,r,n){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");var i=null!=t,a=null!=r,o=null!=n;if(i)if(Un(t))t=t.toNumber();else if("number"!=typeof t&&!Vn(t))throw new TypeError("Parameter start must be a number or bigint");if(a)if(Un(r))r=r.toNumber();else if("number"!=typeof r&&!Vn(r))throw new TypeError("Parameter end must be a number or bigint");if(o)if(Un(n))n=n.toNumber();else if("number"!=typeof n&&!Vn(n))throw new TypeError("Parameter step must be a number or bigint");this.start=i?parseFloat(t):0,this.end=a?parseFloat(r):0,this.step=o?parseFloat(n):1}return e.prototype.type="Range",e.prototype.isRange=!0,e.parse=function(t){if("string"!=typeof t)return null;var r=t.split(":").map((function(e){return parseFloat(e)}));if(r.some((function(e){return isNaN(e)})))return null;switch(r.length){case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[2],r[1]);default:return null}},e.prototype.clone=function(){return new e(this.start,this.end,this.step)},e.prototype.size=function(){var e=0,t=this.start,r=this.step,n=this.end-t;return Oi(r)===Oi(n)?e=Math.ceil(n/r):0===n&&(e=0),isNaN(e)&&(e=0),[e]},e.prototype.min=function(){var e=this.size()[0];return e>0?this.step>0?this.start:this.start+(e-1)*this.step:void 0},e.prototype.max=function(){var e=this.size()[0];return e>0?this.step>0?this.start+(e-1)*this.step:this.start:void 0},e.prototype.forEach=function(e){var t=this.start,r=this.step,n=this.end,i=0;if(r>0)for(;t<n;)e(t,[i],this),t+=r,i++;else if(r<0)for(;t>n;)e(t,[i],this),t+=r,i++},e.prototype.map=function(e){var t=[];return this.forEach((function(r,n,i){t[n[0]]=e(r,n,i)})),t},e.prototype.toArray=function(){var e=[];return this.forEach((function(t,r){e[r[0]]=t})),e},e.prototype.valueOf=function(){return this.toArray()},e.prototype.format=function(e){var t=$i(this.start,e);return 1!==this.step&&(t+=":"+$i(this.step,e)),t+":"+$i(this.end,e)},e.prototype.toString=function(){return this.format()},e.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},e.fromJSON=function(t){return new e(t.start,t.end,t.step)},e}),{isClass:!0}),zd=Ii("ResultSet",[],(()=>{function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return e.prototype.type="ResultSet",e.prototype.isResultSet=!0,e.prototype.valueOf=function(){return this.entries},e.prototype.toString=function(){return"["+this.entries.map(String).join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},e.fromJSON=function(t){return new e(t.entries)},e}),{isClass:!0}),Bd=Ii("DenseMatrix",["Matrix"],(e=>{var{Matrix:t}=e;function r(e,t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!Hn(t))throw new Error("Invalid datatype: "+t);if(Xn(e))"DenseMatrix"===e.type?(this._data=Mn(e._data),this._size=Mn(e._size),this._datatype=t||e._datatype):(this._data=e.toArray(),this._size=e.size(),this._datatype=t||e._datatype);else if(e&&Wn(e.data)&&Wn(e.size))this._data=e.data,this._size=e.size,Aa(this._data,this._size),this._datatype=t||e.datatype;else if(Wn(e))this._data=a(e),this._size=ba(this._data),Aa(this._data,this._size),this._datatype=t;else{if(e)throw new TypeError("Unsupported type of data ("+Ti(e)+")");this._data=[],this._size=[0],this._datatype=t}}function n(e,t,r){if(0===t.length){for(var n=e._data;Wn(n);)n=n[0];return n}return e._size=t.slice(0),e._data=Sa(e._data,e._size,r),e}function i(e,t,r){for(var i=e._size.slice(0),a=!1;i.length<t.length;)i.push(0),a=!0;for(var o=0,s=t.length;o<s;o++)t[o]>i[o]&&(i[o]=t[o],a=!0);a&&n(e,i,r)}function a(e){return Xn(e)?a(e.valueOf()):Wn(e)?e.map(a):e}return r.prototype=new t,r.prototype.createDenseMatrix=function(e,t){return new r(e,t)},Object.defineProperty(r,"name",{value:"DenseMatrix"}),r.prototype.constructor=r,r.prototype.type="DenseMatrix",r.prototype.isDenseMatrix=!0,r.prototype.getDataType=function(){return Za(this._data,Ti)},r.prototype.storage=function(){return"dense"},r.prototype.datatype=function(){return this._datatype},r.prototype.create=function(e,t){return new r(e,t)},r.prototype.subset=function(e,t,n){switch(arguments.length){case 1:return function(e,t){if(!ei(t))throw new TypeError("Invalid index");if(t.isScalar())return e.get(t.min());var n=t.size();if(n.length!==e._size.length)throw new xa(n.length,e._size.length);for(var i=t.min(),a=t.max(),o=0,s=e._size.length;o<s;o++)Ea(i[o],e._size[o]),Ea(a[o],e._size[o]);var l=new r([]),u=function(e,t){var r=t.size().length-1,n=Array(r);return{data:function e(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t.dimension(a);return n[a]=o.size()[0],a<r?o.map((t=>(Ea(t,i.length),e(i[t],a+1)))).valueOf():o.map((e=>(Ea(e,i.length),i[e]))).valueOf()}(e),size:n}}(e._data,t);return l._size=u.size,l._datatype=e._datatype,l._data=u.data,l}(this,e);case 2:case 3:return function(e,t,r,n){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var a,o=t.size(),s=t.isScalar();if(Xn(r)?(a=r.size(),r=r.valueOf()):a=ba(r),s){if(0!==a.length)throw new TypeError("Scalar expected");e.set(t.min(),r,n)}else{if(!Dn(a,o))try{a=ba(r=0===a.length?Xa([r],o):Xa(r,o))}catch(e){}if(o.length<e._size.length)throw new xa(o.length,e._size.length,"<");if(a.length<o.length){for(var l=0,u=0;1===o[l]&&1===a[l];)l++;for(;1===o[l];)u++,l++;r=Ba(r,o.length,u,a)}if(!Dn(o,a))throw new xa(o,a,">");var c=t.max().map((function(e){return e+1}));i(e,c,n),function(e,t,r){var n=t.size().length-1;!function e(r,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t.dimension(a);a<n?o.forEach(((t,n)=>{Ea(t,r.length),e(r[t],i[n[0]],a+1)})):o.forEach(((e,t)=>{Ea(e,r.length),r[e]=i[t[0]]}))}(e,r)}(e._data,t,r)}return e}(this,e,t,n);default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.get=function(e){return Ya(this._data,e)},r.prototype.set=function(e,t,r){if(!Wn(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new xa(e.length,this._size.length,"<");var n,a,o,s=e.map((function(e){return e+1}));i(this,s,r);var l=this._data;for(n=0,a=e.length-1;n<a;n++)Ea(o=e[n],l.length),l=l[o];return Ea(o=e[e.length-1],l.length),l[o]=t,this},r.prototype.resize=function(e,t,r){if(!Yn(e))throw new TypeError("Array or Matrix expected");var i=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));return n(r?this.clone():this,i,t)},r.prototype.reshape=function(e,t){var r=t?this.clone():this;r._data=Ta(r._data,e);var n=r._size.reduce(((e,t)=>e*t));return r._size=Na(e,n),r},r.prototype.clone=function(){return new r({data:Mn(this._data),size:Mn(this._size),datatype:this._datatype})},r.prototype.size=function(){return this._size.slice(0)},r.prototype.map=function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,n=r._size.length-1;if(n<0)return r.clone();var i=js(e,r,"map",t),a=i.fn,o=r.create(void 0,r._datatype);if(o._size=r._size,t||i.isUnary)return o._data=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=Array(t.length);if(r<n)for(var o=0;o<t.length;o++)i[o]=e(t[o],r+1);else for(var s=0;s<t.length;s++)i[s]=a(t[s]);return i}(r._data),o;if(0===n){for(var s=r.valueOf(),l=Array(s.length),u=0;u<s.length;u++)l[u]=a(s[u],[u],r);return o._data=l,o}var c=[];return o._data=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=Array(t.length);if(i<n)for(var s=0;s<t.length;s++)c[i]=s,o[s]=e(t[s],i+1);else for(var l=0;l<t.length;l++)c[i]=l,o[l]=a(t[l],c.slice(),r);return o}(r._data),o},r.prototype.forEach=function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,n=r._size.length-1;if(!(n<0)){var i=js(e,r,"map",t),a=i.fn;if(t||i.isUnary)!function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(r<n)for(var i=0;i<t.length;i++)e(t[i],r+1);else for(var o=0;o<t.length;o++)a(t[o])}(r._data);else if(0!==n){var o=[];!function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(i<n)for(var s=0;s<t.length;s++)o[i]=s,e(t[s],i+1);else for(var l=0;l<t.length;l++)o[i]=l,a(t[l],o.slice(),r)}(r._data)}else for(var s=0;s<r._data.length;s++)a(r._data[s],[s],r)}},r.prototype[Symbol.iterator]=function*(){var e=this._size.length-1;if(!(e<0))if(0!==e){var t=[],r=function*(n,i){if(i<e)for(var a=0;a<n.length;a++)t[i]=a,yield*r(n[a],i+1);else for(var o=0;o<n.length;o++)t[i]=o,yield{value:n[o],index:t.slice()}};yield*r(this._data,0)}else for(var n=0;n<this._data.length;n++)yield{value:this._data[n],index:[n]}},r.prototype.rows=function(){var e=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var t=this._data;for(var n of t)e.push(new r([n],this._datatype));return e},r.prototype.columns=function(){var e=this,t=[],n=this.size();if(2!==n.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,a=function(n){var a=i.map((e=>[e[n]]));t.push(new r(a,e._datatype))},o=0;o<n[1];o++)a(o);return t},r.prototype.toArray=function(){return Mn(this._data)},r.prototype.valueOf=function(){return this._data},r.prototype.format=function(e){return ha(this._data,e)},r.prototype.toString=function(){return ha(this._data)},r.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.prototype.diagonal=function(e){if(e){if(Un(e)&&(e=e.toNumber()),!jn(e)||!Fi(e))throw new TypeError("The parameter k must be an integer number")}else e=0;for(var t=e>0?e:0,n=e<0?-e:0,i=this._size[0],a=this._size[1],o=Math.min(i-n,a-t),s=[],l=0;l<o;l++)s[l]=this._data[l+n][l+t];return new r({data:s,size:[o],datatype:this._datatype})},r.diagonal=function(e,t,n,i){if(!Wn(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(Un(e)&&(e=e.toNumber()),!jn(e)||!Fi(e)||e<1)throw new Error("Size values must be positive integers");return e})),n){if(Un(n)&&(n=n.toNumber()),!jn(n)||!Fi(n))throw new TypeError("The parameter k must be an integer number")}else n=0;var a,o=n>0?n:0,s=n<0?-n:0,l=e[0],u=e[1],c=Math.min(l-s,u-o);if(Wn(t)){if(t.length!==c)throw new Error("Invalid value array length");a=function(e){return t[e]}}else if(Xn(t)){var h=t.size();if(1!==h.length||h[0]!==c)throw new Error("Invalid matrix length");a=function(e){return t.get([e])}}else a=function(){return t};i||(i=Un(a(0))?a(0).mul(0):0);var p=[];if(e.length>0){p=Sa(p,e,i);for(var d=0;d<c;d++)p[d+s][d+o]=a(d)}return new r({data:p,size:[l,u]})},r.fromJSON=function(e){return new r(e)},r.prototype.swapRows=function(e,t){if(!(jn(e)&&Fi(e)&&jn(t)&&Fi(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Ea(e,this._size[0]),Ea(t,this._size[0]),r._swapRows(e,t,this._data),this},r._swapRows=function(e,t,r){var n=r[e];r[e]=r[t],r[t]=n},r}),{isClass:!0}),kd=Ii("replacer",[],(()=>function(e,t){return"number"!=typeof t||isFinite(t)&&!isNaN(t)?"bigint"==typeof t?{mathjs:"bigint",value:String(t)}:t:{mathjs:"number",value:String(t)}})),Fd=function(){return Fd=qs.create,qs},Rd=Ii("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(e){var{BigNumber:t,Complex:r,DenseMatrix:n,Fraction:i}=e,a=Fd();return a.clear(),a.addTypes([{name:"number",test:jn},{name:"Complex",test:Zn},{name:"BigNumber",test:Un},{name:"bigint",test:Vn},{name:"Fraction",test:$n},{name:"Unit",test:Gn},{name:"identifier",test:e=>Hn&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(e)},{name:"string",test:Hn},{name:"Chain",test:Di},{name:"Array",test:Wn},{name:"Matrix",test:Xn},{name:"DenseMatrix",test:Kn},{name:"SparseMatrix",test:Jn},{name:"Range",test:Qn},{name:"Index",test:ei},{name:"boolean",test:ti},{name:"ResultSet",test:ri},{name:"Help",test:ni},{name:"function",test:ii},{name:"Date",test:ai},{name:"RegExp",test:oi},{name:"null",test:ui},{name:"undefined",test:ci},{name:"AccessorNode",test:hi},{name:"ArrayNode",test:pi},{name:"AssignmentNode",test:di},{name:"BlockNode",test:fi},{name:"ConditionalNode",test:mi},{name:"ConstantNode",test:gi},{name:"FunctionNode",test:xi},{name:"FunctionAssignmentNode",test:vi},{name:"IndexNode",test:_i},{name:"Node",test:bi},{name:"ObjectNode",test:wi},{name:"OperatorNode",test:Ai},{name:"ParenthesisNode",test:Ci},{name:"RangeNode",test:Ei},{name:"RelationalNode",test:Mi},{name:"SymbolNode",test:Si},{name:"Map",test:li},{name:"Object",test:si}]),a.addConversions([{from:"number",to:"BigNumber",convert:function(e){if(t||Od(e),function(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t(e)}},{from:"number",to:"Complex",convert:function(e){return r||Ld(e),new r(e,0)}},{from:"BigNumber",to:"Complex",convert:function(e){return r||Ld(e),new r(e.toNumber(),0)}},{from:"bigint",to:"number",convert:function(e){if(e>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+e+")");return Number(e)}},{from:"bigint",to:"BigNumber",convert:function(e){return t||Od(e),new t(e.toString())}},{from:"bigint",to:"Fraction",convert:function(e){return i||qd(e),new i(e)}},{from:"Fraction",to:"BigNumber",convert:function(e){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return r||Ld(e),new r(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){i||qd(e);var t=new i(e);if(t.valueOf()!==e)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+e+"). Use function fraction(x) to convert to Fraction.");return t}},{from:"string",to:"number",convert:function(e){var t=Number(e);if(isNaN(t))throw new Error('Cannot convert "'+e+'" to a number');return t}},{from:"string",to:"BigNumber",convert:function(e){t||Od(e);try{return new t(e)}catch(t){throw new Error('Cannot convert "'+e+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(e){try{return BigInt(e)}catch(t){throw new Error('Cannot convert "'+e+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(e){i||qd(e);try{return new i(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(e){r||Ld(e);try{return new r(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Complex')}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(e){return t||Od(e),new t(+e)}},{from:"boolean",to:"bigint",convert:function(e){return BigInt(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return i||qd(e),new i(+e)}},{from:"boolean",to:"string",convert:function(e){return String(e)}},{from:"Array",to:"Matrix",convert:function(e){return n||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new n(e)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}]),a.onMismatch=(e,t,r)=>{var n=a.createError(e,t,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===t.length&&Yn(t[0])&&r.some((e=>!e.params.includes(",")))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=n.data,i}throw n},a.onMismatch=(e,t,r)=>{var n=a.createError(e,t,r);if(["wrongType","mismatch"].includes(n.data.category)&&1===t.length&&Yn(t[0])&&r.some((e=>!e.params.includes(",")))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=n.data,i}throw n},a}));function Od(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function Ld(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function qd(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}var jd="number",Ud="number, number";function Vd(e){return Math.abs(e)}function Zd(e,t){return e+t}function $d(e,t){return e-t}function Gd(e,t){return e*t}function Hd(e){return-e}function Wd(e){return e}function Xd(e){return Ui(e)}function Yd(e){return e*e*e}function Kd(e){return Math.exp(e)}function Jd(e){return Vi(e)}function Qd(e,t){if(!Fi(e)||!Fi(t))throw new Error("Parameters in function lcm must be integer numbers");if(0===e||0===t)return 0;for(var r,n=e*t;0!==t;)t=e%(r=t),e=r;return Math.abs(n/e)}function ef(e,t){return t?Math.log(e)/Math.log(t):Math.log(e)}function tf(e){return qi(e)}function rf(e){return Li(e)}function nf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=t<0;if(r&&(t=-t),0===t)throw new Error("Root must be non-zero");if(e<0&&Math.abs(t)%2!=1)throw new Error("Root must be odd when a is negative.");if(0===e)return r?1/0:0;if(!isFinite(e))return r?0:e;var n=Math.pow(Math.abs(e),1/t);return n=e<0?-n:n,r?1/n:n}function af(e){return Oi(e)}function of(e){return e*e}function sf(e,t){var r,n,i,a=0,o=1,s=1,l=0;if(!Fi(e)||!Fi(t))throw new Error("Parameters in function xgcd must be integer numbers");for(;t;)i=e-(n=Math.floor(e/t))*t,r=a,a=o-n*a,o=r,r=s,s=l-n*s,l=r,e=t,t=i;return e<0?[-e,-o,-l]:[e,e?o:0,l]}function lf(e,t){return e*e<1&&t===1/0||e*e>1&&t===-1/0?0:Math.pow(e,t)}function uf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!Fi(t)||t<0||t>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(Wi(e,t))}Vd.signature=jd,Zd.signature=Ud,$d.signature=Ud,Gd.signature=Ud,Hd.signature=jd,Wd.signature=jd,Xd.signature=jd,Yd.signature=jd,Kd.signature=jd,Jd.signature=jd,Qd.signature=Ud,tf.signature=jd,rf.signature=jd,af.signature=jd,of.signature=jd,sf.signature=Ud,lf.signature=Ud;var cf=Ii("abs",["typed"],(e=>{var{typed:t}=e;return t("abs",{number:Vd,"Complex | BigNumber | Fraction | Unit":e=>e.abs(),bigint:e=>e<0n?-e:e,"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e,!0)))})})),hf="acos",pf=Ii(hf,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(hf,{number:function(e){return e>=-1&&e<=1||r.predictable?Math.acos(e):new n(e,0).acos()},Complex:function(e){return e.acos()},BigNumber:function(e){return e.acos()}})})),df="number";function ff(e){return Qi(e)}function mf(e){return Math.atan(1/e)}function gf(e){return isFinite(e)?(Math.log((e+1)/e)+Math.log(e/(e-1)))/2:0}function yf(e){return Math.asin(1/e)}function vf(e){var t=1/e;return Math.log(t+Math.sqrt(t*t+1))}function xf(e){return Math.acos(1/e)}function _f(e){var t=1/e,r=Math.sqrt(t*t-1);return Math.log(r+t)}function bf(e){return ea(e)}function wf(e){return ta(e)}function Af(e){return 1/Math.tan(e)}function Cf(e){var t=Math.exp(2*e);return(t+1)/(t-1)}function Ef(e){return 1/Math.sin(e)}function Mf(e){return 0===e?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(e)-Math.exp(-e)))*Oi(e)}function Sf(e){return 1/Math.cos(e)}function Df(e){return 2/(Math.exp(e)+Math.exp(-e))}function Tf(e){return na(e)}ff.signature=df,mf.signature=df,gf.signature=df,yf.signature=df,vf.signature=df,xf.signature=df,_f.signature=df,bf.signature=df,wf.signature=df,Af.signature=df,Cf.signature=df,Ef.signature=df,Mf.signature=df,Sf.signature=df,Df.signature=df,Tf.signature=df;var Nf="acot",If=Ii(Nf,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(Nf,{number:mf,Complex:function(e){return e.acot()},BigNumber:function(e){return new r(1).div(e).atan()}})})),Pf="acsc",zf=Ii(Pf,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:r,Complex:n,BigNumber:i}=e;return t(Pf,{number:function(e){return e<=-1||e>=1||r.predictable?yf(e):new n(e,0).acsc()},Complex:function(e){return e.acsc()},BigNumber:function(e){return new i(1).div(e).asin()}})})),Bf="addScalar",kf=Ii(Bf,["typed"],(e=>{var{typed:t}=e;return t(Bf,{"number, number":Zd,"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"bigint, bigint":function(e,t){return e+t},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":t.referToSelf((e=>(r,n)=>{if(null===r.value||void 0===r.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var i=r.clone();return i.value=t.find(e,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}))})})),Ff=Ii("arg",["typed"],(e=>{var{typed:t}=e;return t("arg",{number:function(e){return Math.atan2(0,e)},BigNumber:function(e){return e.constructor.atan2(0,e)},Complex:function(e){return e.arg()},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),Rf="asech",Of=Ii(Rf,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:r,Complex:n,BigNumber:i}=e;return t(Rf,{number:function(e){if(e<=1&&e>=-1||r.predictable){var t=1/e;if(t>0||r.predictable)return _f(e);var i=Math.sqrt(t*t-1);return new n(Math.log(i-t),Math.PI)}return new n(e,0).asech()},Complex:function(e){return e.asech()},BigNumber:function(e){return new i(1).div(e).acosh()}})})),Lf=Ii("asinh",["typed"],(e=>{var{typed:t}=e;return t("asinh",{number:bf,Complex:function(e){return e.asinh()},BigNumber:function(e){return e.asinh()}})})),qf=Ii("atan",["typed"],(e=>{var{typed:t}=e;return t("atan",{number:function(e){return Math.atan(e)},Complex:function(e){return e.atan()},BigNumber:function(e){return e.atan()}})})),jf="atanh",Uf=Ii(jf,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(jf,{number:function(e){return e<=1&&e>=-1||r.predictable?wf(e):new n(e,0).atanh()},Complex:function(e){return e.atanh()},BigNumber:function(e){return e.atanh()}})})),Vf=Ii("bigint",["typed"],(e=>{var{typed:t}=e,r=t("bigint",{"":function(){return 0n},bigint:function(e){return e},number:function(e){return BigInt(e.toFixed())},BigNumber:function(e){return BigInt(e.round().toString())},Fraction:function(e){return BigInt(e.valueOf().toFixed())},"string | boolean":function(e){return BigInt(e)},null:function(e){return 0n},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))});return r.fromJSON=function(e){return BigInt(e.value)},r})),Zf="bitNot",$f=Ii(Zf,["typed"],(e=>{var{typed:t}=e;return t(Zf,{number:Hl,BigNumber:Ol,bigint:e=>~e,"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),Gf="boolean",Hf=Ii(Gf,["typed"],(e=>{var{typed:t}=e;return t(Gf,{"":function(){return!1},boolean:function(e){return e},number:function(e){return!!e},null:function(e){return!1},BigNumber:function(e){return!e.isZero()},string:function(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;var r=Number(e);if(""!==e&&!isNaN(r))return!!r;throw new Error('Cannot convert "'+e+'" to a boolean')},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),Wf="clone",Xf=Ii(Wf,["typed"],(e=>{var{typed:t}=e;return t(Wf,{any:Mn})}));function Yf(e,t){if(t<e)return 1;if(t===e)return t;var r=t+e>>1;return Yf(e,r)*Yf(r+1,t)}function Kf(e,t){if(!Fi(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(!Fi(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(t>e)throw new TypeError("k must be less than or equal to n");for(var r=e-t,n=1,i=2,a=t<r?t:r,o=t<r?r+1:t+1;o<=e;++o)for(n*=o;i<=a&&n%i===0;)n/=i,++i;return i<=a&&(n/=Yf(i,a)),n}Kf.signature="number, number";var Jf="combinations",Qf=Ii(Jf,["typed"],(e=>{var{typed:t}=e;return t(Jf,{"number, number":Kf,"BigNumber, BigNumber":function(e,t){var r,n,i=e.constructor,a=e.minus(t),o=new i(1);if(!em(e)||!em(t))throw new TypeError("Positive integer value expected in function combinations");if(t.gt(e))throw new TypeError("k must be less than n in function combinations");if(r=o,t.lt(a))for(n=o;n.lte(a);n=n.plus(o))r=r.times(t.plus(n)).dividedBy(n);else for(n=o;n.lte(t);n=n.plus(o))r=r.times(a.plus(n)).dividedBy(n);return r}})}));function em(e){return e.isInteger()&&e.gte(0)}var tm=Ii("complex",["typed","Complex"],(e=>{var{typed:t,Complex:r}=e;return t("complex",{"":function(){return r.ZERO},number:function(e){return new r(e,0)},"number, number":function(e,t){return new r(e,t)},"BigNumber, BigNumber":function(e,t){return new r(e.toNumber(),t.toNumber())},Fraction:function(e){return new r(e.valueOf(),0)},Complex:function(e){return e.clone()},string:function(e){return r(e)},null:function(e){return r(0)},Object:function(e){if("re"in e&&"im"in e)return new r(e.re,e.im);if("r"in e&&"phi"in e||"abs"in e&&"arg"in e)return new r(e);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),rm="conj",nm=Ii(rm,["typed"],(e=>{var{typed:t}=e;return t(rm,{"number | BigNumber | Fraction":e=>e,Complex:e=>e.conjugate(),Unit:t.referToSelf((e=>t=>new t.constructor(e(t.toNumeric()),t.formatUnits()))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),im=Ii("trigUnit",["typed"],(e=>{var{typed:t}=e;return{Unit:t.referToSelf((e=>r=>{if(!r.hasBase(r.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return t.find(e,r.valueType())(r.value)}))}})),am=Ii("cos",["typed"],(e=>{var{typed:t}=e,r=im({typed:t});return t("cos",{number:Math.cos,"Complex | BigNumber":e=>e.cos()},r)})),om=Ii("cot",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t("cot",{number:Af,Complex:e=>e.cot(),BigNumber:e=>new r(1).div(e.tan())},im({typed:t}))})),sm=Ii("csc",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t("csc",{number:Ef,Complex:e=>e.csc(),BigNumber:e=>new r(1).div(e.sin())},im({typed:t}))})),lm="cube",um=Ii(lm,["typed"],(e=>{var{typed:t}=e;return t(lm,{number:Yd,Complex:function(e){return e.mul(e).mul(e)},BigNumber:function(e){return e.times(e).times(e)},bigint:function(e){return e*e*e},Fraction:function(e){return e.pow(3)},Unit:function(e){return e.pow(3)}})}));function cm(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-9,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(r<=0)throw new Error("Relative tolerance must be greater than 0");if(n<0)throw new Error("Absolute tolerance must be at least 0");return!e.isNaN()&&!t.isNaN()&&(e.isFinite()&&t.isFinite()?!!e.eq(t)||e.minus(t).abs().lte(e.constructor.max(e.constructor.max(e.abs(),t.abs()).mul(r),n)):e.eq(t))}var hm=Ii("compareUnits",["typed"],(e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf((e=>(r,n)=>{if(!r.equalBase(n))throw new Error("Cannot compare units with different base");return t.find(e,[r.valueType(),n.valueType()])(r.value,n.value)}))}})),pm="equalScalar",dm=Ii(pm,["typed","config"],(e=>{var{typed:t,config:r}=e,n=hm({typed:t});return t(pm,{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,t){return Ji(e,t,r.relTol,r.absTol)},"BigNumber, BigNumber":function(e,t){return e.eq(t)||cm(e,t,r.relTol,r.absTol)},"bigint, bigint":function(e,t){return e===t},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return function(e,t,r,n){return Ji(e.re,t.re,r,n)&&Ji(e.im,t.im,r,n)}(e,t,r.relTol,r.absTol)}},n)})),fm=(Ii(pm,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(pm,{"number, number":function(e,t){return Ji(e,t,r.relTol,r.absTol)}})})),Ii("erf",["typed"],(e=>{var{typed:t}=e;return t("name",{number:function(e){var t=Math.abs(e);return t>=xm?Oi(e):t<=mm?Oi(e)*function(e){var t,r=e*e,n=ym[0][4]*r,i=r;for(t=0;t<3;t+=1)n=(n+ym[0][t])*r,i=(i+vm[0][t])*r;return e*(n+ym[0][3])/(i+vm[0][3])}(t):t<=4?Oi(e)*(1-function(e){var t,r=ym[1][8]*e,n=e;for(t=0;t<7;t+=1)r=(r+ym[1][t])*e,n=(n+vm[1][t])*e;var i=(r+ym[1][7])/(n+vm[1][7]),a=parseInt(16*e)/16,o=(e-a)*(e+a);return Math.exp(-a*a)*Math.exp(-o)*i}(t)):Oi(e)*(1-function(e){var t,r=1/(e*e),n=ym[2][5]*r,i=r;for(t=0;t<4;t+=1)n=(n+ym[2][t])*r,i=(i+vm[2][t])*r;var a=r*(n+ym[2][4])/(i+vm[2][4]);a=(gm-a)/e;var o=(e-(r=parseInt(16*e)/16))*(e+r);return Math.exp(-r*r)*Math.exp(-o)*a}(t))},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})}))),mm=.46875,gm=.5641895835477563,ym=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],vm=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],xm=Math.pow(2,53),_m=Ii("exp",["typed"],(e=>{var{typed:t}=e;return t("exp",{number:Kd,Complex:function(e){return e.exp()},BigNumber:function(e){return e.exp()}})})),bm="expm1",wm=Ii(bm,["typed","Complex"],(e=>{var{typed:t,Complex:r}=e;return t(bm,{number:Jd,Complex:function(e){var t=Math.exp(e.re);return new r(t*Math.cos(e.im)-1,t*Math.sin(e.im))},BigNumber:function(e){return e.exp().minus(1)}})})),Am="flatten",Cm=Ii(Am,["typed"],(e=>{var{typed:t}=e;return t(Am,{Array:function(e){return Fa(e)},Matrix:function(e){return e.create(Fa(e.valueOf(),!0),e.datatype())}})})),Em="format",Mm=Ii(Em,["typed"],(e=>{var{typed:t}=e;return t(Em,{any:ha,"any, Object | function | number | BigNumber":ha})})),Sm="getMatrixDataType",Dm=Ii(Sm,["typed"],(e=>{var{typed:t}=e;return t(Sm,{Array:function(e){return Za(e,Ti)},Matrix:function(e){return e.getDataType()}})})),Tm=Ii("hex",["typed","format"],(e=>{var{typed:t,format:r}=e;return t("hex",{"number | BigNumber":function(e){return r(e,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(e,t){return r(e,{notation:"hex",wordSize:t})}})})),Nm=Ii("im",["typed"],(e=>{var{typed:t}=e;return t("im",{number:()=>0,"BigNumber | Fraction":e=>e.mul(0),Complex:e=>e.im,"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),Im="isInteger",Pm=Ii(Im,["typed"],(e=>{var{typed:t}=e;return t(Im,{number:Fi,BigNumber:function(e){return e.isInt()},bigint:function(e){return!0},Fraction:function(e){return 1n===e.d},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),zm="number";function Bm(e){return e<0}function km(e){return e>0}function Fm(e){return Number.isNaN(e)}Bm.signature=zm,km.signature=zm,Fm.signature=zm;var Rm="isNegative",Om=Ii(Rm,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(Rm,{number:e=>!Ji(e,0,r.relTol,r.absTol)&&Bm(e),BigNumber:e=>!cm(e,new e.constructor(0),r.relTol,r.absTol)&&e.isNeg()&&!e.isZero()&&!e.isNaN(),bigint:e=>e<0n,Fraction:e=>e.s<0n,Unit:t.referToSelf((e=>r=>t.find(e,r.valueType())(r.value))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),Lm="isPositive",qm=Ii(Lm,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(Lm,{number:e=>!Ji(e,0,r.relTol,r.absTol)&&km(e),BigNumber:e=>!(cm(e,new e.constructor(0),r.relTol,r.absTol)||e.isNeg()||e.isZero()||e.isNaN()),bigint:e=>e>0n,Fraction:e=>e.s>0n&&e.n>0n,Unit:t.referToSelf((e=>r=>t.find(e,r.valueType())(r.value))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),jm="isZero",Um=Ii(jm,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return t(jm,{"number | BigNumber | Complex | Fraction":e=>r(e,0),bigint:e=>0n===e,Unit:t.referToSelf((e=>r=>t.find(e,r.valueType())(r.value))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})}));function Vm(e){var t;if(Fi(e))return e<=0?isFinite(e)?1/0:NaN:e>171?1/0:Yf(1,e-1);if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*Vm(1-e));if(e>=171.35)return 1/0;if(e>85){var r=e*e,n=r*e,i=n*e,a=i*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*r)-139/(51840*n)-571/(2488320*i)+163879/(209018880*a)+5246819/(75246796800*a*e))}--e,t=$m[0];for(var o=1;o<$m.length;++o)t+=$m[o]/(e+o);var s=e+Zm+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,e+.5)*Math.exp(-s)*t}Vm.signature="number";var Zm=4.7421875,$m=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],Gm=.9189385332046728,Hm=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function Wm(e){if(e<0)return NaN;if(0===e)return 1/0;if(!isFinite(e))return e;if(e<.5)return Math.log(Math.PI/Math.sin(Math.PI*e))-Wm(1-e);for(var t=5+(e-=1)+.5,r=Hm[0],n=6;n>=1;n--)r+=Hm[n]/(e+n);return Gm+(e+.5)*Math.log(t)-t+Math.log(r)}Wm.signature="number";var Xm="lgamma",Ym=Ii(Xm,["Complex","typed"],(e=>{var{Complex:t,typed:r}=e,n=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return r(Xm,{number:Wm,Complex:function e(r){if(r.isNaN())return new t(NaN,NaN);if(0===r.im)return new t(Wm(r.re),0);if(r.re>=7||Math.abs(r.im)>=7)return i(r);if(r.re<=.1){var n=(l=6.283185307179586,(!0^((u=r.im)>0||!(u<0)&&1/u==1/0)?-l:l)*Math.floor(.5*r.re+.25)),o=r.mul(Math.PI).sin().log(),s=e(new t(1-r.re,-r.im));return new t(1.1447298858494002,n).sub(o).sub(s)}return r.im>=0?a(r):a(r.conjugate()).conjugate();var l,u},BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function i(e){for(var r=e.sub(.5).mul(e.log()).sub(e).add(Gm),i=new t(1,0).div(e),a=i.div(e),o=n[0],s=n[1],l=2*a.re,u=a.re*a.re+a.im*a.im,c=2;c<8;c++){var h=s;s=-u*o+n[c],o=l*o+h}var p=i.mul(a.mul(o).add(s));return r.add(p)}function a(e){var r=0,n=0,a=e;for(e=e.add(1);e.re<=7;){var o=(a=a.mul(e)).im<0?1:0;0!==o&&0===n&&r++,n=o,e=e.add(1)}return i(e).sub(a.log()).sub(new t(0,2*r*Math.PI*1))}}));function Km(e,t,r,n){return function(i){if(i>0||r.predictable){if(i<=0)return NaN;var a=i.toString(16),o=a.substring(0,15);return e*(a.length-o.length)+t(Number("0x"+o))}return n(i.toNumber())}}var Jm="log10",Qm=["typed","config","Complex"],eg=tf(16),tg=Ii(Jm,Qm,(e=>{var{typed:t,config:r,Complex:n}=e;function i(e){return e.log().div(Math.LN10)}function a(e){return i(new n(e,0))}return t(Jm,{number:function(e){return e>=0||r.predictable?tf(e):a(e)},bigint:Km(eg,tf,r,a),Complex:i,BigNumber:function(e){return!e.isNegative()||r.predictable?e.log():a(e.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),rg="log2",ng=Ii(rg,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;function i(e){return a(new n(e,0))}return t(rg,{number:function(e){return e>=0||r.predictable?rf(e):i(e)},bigint:Km(4,rf,r,i),Complex:a,BigNumber:function(e){return!e.isNegative()||r.predictable?e.log(2):i(e.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))});function a(e){var t=Math.sqrt(e.re*e.re+e.im*e.im);return new n(Math.log2?Math.log2(t):Math.log(t)/Math.LN2,Math.atan2(e.im,e.re)/Math.LN2)}})),ig=Ii("multiplyScalar",["typed"],(e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":Gd,"Complex, Complex":function(e,t){return e.mul(t)},"BigNumber, BigNumber":function(e,t){return e.times(t)},"bigint, bigint":function(e,t){return e*t},"Fraction, Fraction":function(e,t){return e.mul(t)},"number | Fraction | BigNumber | Complex, Unit":(e,t)=>t.multiply(e),"Unit, number | Fraction | BigNumber | Complex | Unit":(e,t)=>e.multiply(t)})})),ag=Ii("not",["typed"],(e=>{var{typed:t}=e;return t("not",{"null | undefined":()=>!0,number:pl,Complex:function(e){return 0===e.re&&0===e.im},BigNumber:function(e){return e.isZero()||e.isNaN()},bigint:e=>!e,Unit:t.referToSelf((e=>r=>t.find(e,r.valueType())(r.value))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),og=Ii("number",["typed"],(e=>{var{typed:t}=e,r=t("number",{"":function(){return 0},number:function(e){return e},string:function(e){if("NaN"===e)return NaN;var t,r,n=(r=(t=e).match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/))?{input:t,radix:{"0b":2,"0o":8,"0x":16}[r[1]],integerPart:r[2],fractionalPart:r[3]}:null;if(n)return function(e){for(var t=parseInt(e.integerPart,e.radix),r=0,n=0;n<e.fractionalPart.length;n++)r+=parseInt(e.fractionalPart[n],e.radix)/Math.pow(e.radix,n+1);var i=t+r;if(isNaN(i))throw new SyntaxError('String "'+e.input+'" is not a valid number');return i}(n);var i=0,a=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);a&&(i=Number(a[2]),e=a[1]);var o=Number(e);if(isNaN(o))throw new SyntaxError('String "'+e+'" is not a valid number');if(a){if(o>2**i-1)throw new SyntaxError('String "'.concat(e,'" is out of range'));o>=2**(i-1)&&(o-=2**i)}return o},BigNumber:function(e){return e.toNumber()},bigint:function(e){return Number(e)},Fraction:function(e){return e.valueOf()},Unit:t.referToSelf((e=>t=>{var r=t.clone();return r.value=e(t.value),r})),null:function(e){return 0},"Unit, string | Unit":function(e,t){return e.toNumber(t)},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))});return r.fromJSON=function(e){return parseFloat(e.value)},r})),sg=Ii("oct",["typed","format"],(e=>{var{typed:t,format:r}=e;return t("oct",{"number | BigNumber":function(e){return r(e,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(e,t){return r(e,{notation:"oct",wordSize:t})}})})),lg=r(7391),ug=lg(Date.now());function cg(e){var t,r;return t=null===(r=e)?ug:lg(String(r)),function(){return t()}}var hg="pickRandom",pg=Ii(hg,["typed","config","?on"],(e=>{var{typed:t,config:r,on:n}=e,i=cg(r.randomSeed);return n&&n("config",(function(e,t){e.randomSeed!==t.randomSeed&&(i=cg(e.randomSeed))})),t(hg,{"Array | Matrix":function(e){return a(e,{})},"Array | Matrix, Object":function(e,t){return a(e,t)},"Array | Matrix, number":function(e,t){return a(e,{number:t})},"Array | Matrix, Array | Matrix":function(e,t){return a(e,{weights:t})},"Array | Matrix, Array | Matrix, number":function(e,t,r){return a(e,{number:r,weights:t})},"Array | Matrix, number, Array | Matrix":function(e,t,r){return a(e,{number:t,weights:r})}});function a(e,t){var{number:r,weights:n,elementWise:a=!0}=t,o=void 0===r;o&&(r=1);var s=Xn(e)?e.create:Xn(n)?n.create:null;e=e.valueOf(),n&&(n=n.valueOf()),!0===a&&(e=Fa(e),n=Fa(n));var l=0;if(void 0!==n){if(n.length!==e.length)throw new Error("Weights must have the same length as possibles");for(var u=0,c=n.length;u<c;u++){if(!jn(n[u])||n[u]<0)throw new Error("Weights must be an array of positive numbers");l+=n[u]}}for(var h,p=e.length,d=[];d.length<r;){if(void 0===n)h=e[Math.floor(i()*p)];else for(var f=i()*l,m=0,g=e.length;m<g;m++)if((f-=n[m])<0){h=e[m];break}d.push(h)}return o?d[0]:s?s(d):d}}));function dg(e,t){var r=[];if((e=e.slice(0)).length>1)for(var n=0,i=e.shift();n<i;n++)r.push(dg(e,t));else for(var a=0,o=e.shift();a<o;a++)r.push(t());return r}var fg="random",mg=Ii(fg,["typed","config","?on"],(e=>{var{typed:t,config:r,on:n}=e,i=cg(r.randomSeed);return n&&n("config",(function(e,t){e.randomSeed!==t.randomSeed&&(i=cg(e.randomSeed))})),t(fg,{"":()=>o(0,1),number:e=>o(0,e),"number, number":(e,t)=>o(e,t),"Array | Matrix":e=>a(e,0,1),"Array | Matrix, number":(e,t)=>a(e,0,t),"Array | Matrix, number, number":(e,t,r)=>a(e,t,r)});function a(e,t,r){var n=dg(e.valueOf(),(()=>o(t,r)));return Xn(e)?e.create(n,"number"):n}function o(e,t){return e+i()*(t-e)}})),gg=Ii("re",["typed"],(e=>{var{typed:t}=e;return t("re",{"number | BigNumber | Fraction":e=>e,Complex:e=>e.re,"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),yg=Ii("sec",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t("sec",{number:Sf,Complex:e=>e.sec(),BigNumber:e=>new r(1).div(e.cos())},im({typed:t}))})),vg="sign",xg=Ii(vg,["typed","BigNumber","Fraction","complex"],(e=>{var{typed:t,BigNumber:r,complex:n,Fraction:i}=e;return t(vg,{number:af,Complex:function(e){return 0===e.im?n(af(e.re)):e.sign()},BigNumber:function(e){return new r(e.cmp(0))},bigint:function(e){return e>0n?1n:e<0n?-1n:0n},Fraction:function(e){return new i(e.s)},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e,!0))),Unit:t.referToSelf((e=>r=>{if(!r._isDerived()&&0!==r.units[0].unit.offset)throw new TypeError("sign is ambiguous for units with offset");return t.find(e,r.valueType())(r.value)}))})})),_g=Ii("sin",["typed"],(e=>{var{typed:t}=e,r=im({typed:t});return t("sin",{number:Math.sin,"Complex | BigNumber":e=>e.sin()},r)})),bg=Ii("SparseMatrix",["typed","equalScalar","Matrix"],(e=>{var{typed:t,equalScalar:r,Matrix:n}=e;function i(e,t){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!Hn(t))throw new Error("Invalid datatype: "+t);if(Xn(e))!function(e,t,r){"SparseMatrix"===t.type?(e._values=t._values?Mn(t._values):void 0,e._index=Mn(t._index),e._ptr=Mn(t._ptr),e._size=Mn(t._size),e._datatype=r||t._datatype):a(e,t.valueOf(),r||t._datatype)}(this,e,t);else if(e&&Wn(e.index)&&Wn(e.ptr)&&Wn(e.size))this._values=e.values,this._index=e.index,this._ptr=e.ptr,this._size=e.size,this._datatype=t||e.datatype;else if(Wn(e))a(this,e,t);else{if(e)throw new TypeError("Unsupported type of data ("+Ti(e)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=t}}function a(e,n,i){e._values=[],e._index=[],e._ptr=[],e._datatype=i;var a=n.length,o=0,s=r,l=0;if(Hn(i)&&(s=t.find(r,[i,i])||r,l=t.convert(0,i)),a>0){var u=0;do{e._ptr.push(e._index.length);for(var c=0;c<a;c++){var h=n[c];if(Wn(h)){if(0===u&&o<h.length&&(o=h.length),u<h.length){var p=h[u];s(p,l)||(e._values.push(p),e._index.push(c))}}else 0===u&&o<1&&(o=1),s(h,l)||(e._values.push(h),e._index.push(c))}u++}while(u<o)}e._ptr.push(e._index.length),e._size=[a,o]}function o(e,t,r,n){if(r-t===0)return r;for(var i=t;i<r;i++)if(n[i]===e)return i;return t}function s(e,t,r,n,i,a,o){i.splice(e,0,n),a.splice(e,0,t);for(var s=r+1;s<o.length;s++)o[s]++}function l(e,n,i,a){var o=a||0,s=r,l=0;Hn(e._datatype)&&(s=t.find(r,[e._datatype,e._datatype])||r,l=t.convert(0,e._datatype),o=t.convert(o,e._datatype));var u,c,h,p=!s(o,l),d=e._size[0],f=e._size[1];if(i>f){for(c=f;c<i;c++)if(e._ptr[c]=e._values.length,p)for(u=0;u<d;u++)e._values.push(o),e._index.push(u);e._ptr[i]=e._values.length}else i<f&&(e._ptr.splice(i+1,f-i),e._values.splice(e._ptr[i],e._values.length),e._index.splice(e._ptr[i],e._index.length));if(f=i,n>d){if(p){var m=0;for(c=0;c<f;c++){e._ptr[c]=e._ptr[c]+m,h=e._ptr[c+1]+m;var g=0;for(u=d;u<n;u++,g++)e._values.splice(h+g,0,o),e._index.splice(h+g,0,u),m++}e._ptr[f]=e._values.length}}else if(n<d){var y=0;for(c=0;c<f;c++){e._ptr[c]=e._ptr[c]-y;var v=e._ptr[c],x=e._ptr[c+1]-y;for(h=v;h<x;h++)(u=e._index[h])>n-1&&(e._values.splice(h,1),e._index.splice(h,1),y++)}e._ptr[c]=e._values.length}return e._size[0]=n,e._size[1]=i,e}function u(e,t,r,n,i){var a,o,s=n[0],l=n[1],u=[];for(a=0;a<s;a++)for(u[a]=[],o=0;o<l;o++)u[a][o]=0;for(o=0;o<l;o++)for(var c=r[o],h=r[o+1],p=c;p<h;p++)u[a=t[p]][o]=e?i?Mn(e[p]):e[p]:1;return u}return i.prototype=new n,i.prototype.createSparseMatrix=function(e,t){return new i(e,t)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return Za(this._values,Ti)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(e,t){return new i(e,t)},i.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},i.prototype.subset=function(e,t,r){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(e,t){if(!ei(t))throw new TypeError("Invalid index");if(t.isScalar())return e.get(t.min());var r,n,a,o,s=t.size();if(s.length!==e._size.length)throw new xa(s.length,e._size.length);var l=t.min(),u=t.max();for(r=0,n=e._size.length;r<n;r++)Ea(l[r],e._size[r]),Ea(u[r],e._size[r]);var c=e._values,h=e._index,p=e._ptr,d=t.dimension(0),f=t.dimension(1),m=[],g=[];d.forEach((function(e,t){g[e]=t[0],m[e]=!0}));var y=c?[]:void 0,v=[],x=[];return f.forEach((function(e){for(x.push(v.length),a=p[e],o=p[e+1];a<o;a++)r=h[a],!0===m[r]&&(v.push(g[r]),y&&y.push(c[a]))})),x.push(v.length),new i({values:y,index:v,ptr:x,size:s,datatype:e._datatype})}(this,e);case 2:case 3:return function(e,t,r,n){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var i,a=t.size(),o=t.isScalar();if(Xn(r)?(i=r.size(),r=r.toArray()):i=ba(r),o){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),r,n)}else{if(1!==a.length&&2!==a.length)throw new xa(a.length,e._size.length,"<");if(i.length<a.length){for(var s=0,l=0;1===a[s]&&1===i[s];)s++;for(;1===a[s];)l++,s++;r=Ba(r,a.length,l,i)}if(!Dn(a,i))throw new xa(a,i,">");if(1===a.length)t.dimension(0).forEach((function(t,i){Ea(t),e.set([t,0],r[i[0]],n)}));else{var u=t.dimension(0),c=t.dimension(1);u.forEach((function(t,i){Ea(t),c.forEach((function(a,o){Ea(a),e.set([t,a],r[i[0]][o[0]],n)}))}))}}return e}(this,e,t,r);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(e){if(!Wn(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new xa(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],r=e[1];Ea(t,this._size[0]),Ea(r,this._size[1]);var n=o(t,this._ptr[r],this._ptr[r+1],this._index);return n<this._ptr[r+1]&&this._index[n]===t?this._values[n]:0},i.prototype.set=function(e,n,i){if(!Wn(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new xa(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var a=e[0],u=e[1],c=this._size[0],h=this._size[1],p=r,d=0;Hn(this._datatype)&&(p=t.find(r,[this._datatype,this._datatype])||r,d=t.convert(0,this._datatype)),(a>c-1||u>h-1)&&(l(this,Math.max(a+1,c),Math.max(u+1,h),i),c=this._size[0],h=this._size[1]),Ea(a,c),Ea(u,h);var f=o(a,this._ptr[u],this._ptr[u+1],this._index);return f<this._ptr[u+1]&&this._index[f]===a?p(n,d)?function(e,t,r,n,i){r.splice(e,1),n.splice(e,1);for(var a=t+1;a<i.length;a++)i[a]--}(f,u,this._values,this._index,this._ptr):this._values[f]=n:p(n,d)||s(f,a,u,n,this._values,this._index,this._ptr),this},i.prototype.resize=function(e,t,r){if(!Yn(e))throw new TypeError("Array or Matrix expected");var n=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));if(2!==n.length)throw new Error("Only two dimensions matrix are supported");return n.forEach((function(e){if(!jn(e)||!Fi(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+ha(n)+")")})),l(r?this.clone():this,n[0],n[1],t)},i.prototype.reshape=function(e,t){if(!Wn(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");e.forEach((function(t){if(!jn(t)||!Fi(t)||t<=-2||0===t)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+ha(e)+")")}));var r=this._size[0]*this._size[1];if(r!==(e=Na(e,r))[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var n=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return n;for(var i=[],a=0;a<n._ptr.length;a++)for(var l=0;l<n._ptr[a+1]-n._ptr[a];l++)i.push(a);for(var u=n._values.slice(),c=n._index.slice(),h=0;h<n._index.length;h++){var p=c[h],d=i[h],f=p*n._size[1]+d;i[h]=f%e[1],c[h]=Math.floor(f/e[1])}n._values.length=0,n._index.length=0,n._ptr.length=e[1]+1,n._size=e.slice();for(var m=0;m<n._ptr.length;m++)n._ptr[m]=0;for(var g=0;g<u.length;g++){var y=c[g],v=i[g],x=u[g];s(o(y,n._ptr[v],n._ptr[v+1],n._index),y,v,x,n._values,n._index,n._ptr)}return n},i.prototype.clone=function(){return new i({values:this._values?Mn(this._values):void 0,index:Mn(this._index),ptr:Mn(this._ptr),size:Mn(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(e,n){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var a=this,o=this._size[0],s=this._size[1],l=js(e,a,"map");return function(e,n,o,s,u,c,h){var p=[],d=[],f=[],m=r,g=0;Hn(e._datatype)&&(m=t.find(r,[e._datatype,e._datatype])||r,g=t.convert(0,e._datatype));for(var y=function(e,t,r){var n=function(e,t,r){return l.fn(e,[t,r],a)}(e,t,r);m(n,g)||(p.push(n),d.push(t))},v=0;v<=u;v++){f.push(p.length);var x=e._ptr[v],_=e._ptr[v+1];if(h)for(var b=x;b<_;b++){var w=e._index[b];w>=0&&w<=o&&y(e._values[b],w-0,v-0)}else{for(var A={},C=x;C<_;C++)A[e._index[C]]=e._values[C];for(var E=0;E<=o;E++)y(E in A?A[E]:0,E-0,v-0)}}return f.push(p.length),new i({values:p,index:d,ptr:f,size:[o-0+1,u-0+1]})}(this,0,o-1,0,s-1,0,n)},i.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var r=this,n=this._size[0],i=this._size[1],a=js(e,r,"forEach"),o=0;o<i;o++){var s=this._ptr[o],l=this._ptr[o+1];if(t)for(var u=s;u<l;u++){var c=this._index[u];a.fn(this._values[u],[c,o],r)}else{for(var h={},p=s;p<l;p++)h[this._index[p]]=this._values[p];for(var d=0;d<n;d++){var f=d in h?h[d]:0;a.fn(f,[d,o],r)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var e=this._size[1],t=0;t<e;t++)for(var r=this._ptr[t],n=this._ptr[t+1],i=r;i<n;i++){var a=this._index[i];yield{value:this._values[i],index:[a,t]}}},i.prototype.toArray=function(){return u(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return u(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(e){for(var t=this._size[0],r=this._size[1],n=this.density(),i="Sparse Matrix ["+ha(t,e)+" x "+ha(r,e)+"] density: "+ha(n,e)+"\n",a=0;a<r;a++)for(var o=this._ptr[a],s=this._ptr[a+1],l=o;l<s;l++)i+="\n    ("+ha(this._index[l],e)+", "+ha(a,e)+") ==> "+(this._values?ha(this._values[l],e):"X");return i},i.prototype.toString=function(){return ha(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(e){if(e){if(Un(e)&&(e=e.toNumber()),!jn(e)||!Fi(e))throw new TypeError("The parameter k must be an integer number")}else e=0;var t=e>0?e:0,r=e<0?-e:0,n=this._size[0],a=this._size[1],o=Math.min(n-r,a-t),s=[],l=[],u=[];u[0]=0;for(var c=t;c<a&&s.length<o;c++)for(var h=this._ptr[c],p=this._ptr[c+1],d=h;d<p;d++){var f=this._index[d];if(f===c-t+r){s.push(this._values[d]),l[s.length-1]=f-r;break}}return u.push(s.length),new i({values:s,index:l,ptr:u,size:[o,1]})},i.fromJSON=function(e){return new i(e)},i.diagonal=function(e,n,a,o,s){if(!Wn(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(Un(e)&&(e=e.toNumber()),!jn(e)||!Fi(e)||e<1)throw new Error("Size values must be positive integers");return e})),a){if(Un(a)&&(a=a.toNumber()),!jn(a)||!Fi(a))throw new TypeError("The parameter k must be an integer number")}else a=0;var l=r,u=0;Hn(s)&&(l=t.find(r,[s,s])||r,u=t.convert(0,s));var c,h=a>0?a:0,p=a<0?-a:0,d=e[0],f=e[1],m=Math.min(d-p,f-h);if(Wn(n)){if(n.length!==m)throw new Error("Invalid value array length");c=function(e){return n[e]}}else if(Xn(n)){var g=n.size();if(1!==g.length||g[0]!==m)throw new Error("Invalid matrix length");c=function(e){return n.get([e])}}else c=function(){return n};for(var y=[],v=[],x=[],_=0;_<f;_++){x.push(y.length);var b=_-h;if(b>=0&&b<m){var w=c(b);l(w,u)||(v.push(b+p),y.push(w))}}return x.push(y.length),new i({values:y,index:v,ptr:x,size:[d,f]})},i.prototype.swapRows=function(e,t){if(!(jn(e)&&Fi(e)&&jn(t)&&Fi(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return Ea(e,this._size[0]),Ea(t,this._size[0]),i._swapRows(e,t,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(e,t,r,n,i){for(var a=n[e],o=n[e+1],s=a;s<o;s++)i(r[s],t[s])},i._swapRows=function(e,t,r,n,i,a){for(var s=0;s<r;s++){var l=a[s],u=a[s+1],c=o(e,l,u,i),h=o(t,l,u,i);if(c<u&&h<u&&i[c]===e&&i[h]===t){if(n){var p=n[c];n[c]=n[h],n[h]=p}}else if(c<u&&i[c]===e&&(h>=u||i[h]!==t)){var d=n?n[c]:void 0;i.splice(h,0,t),n&&n.splice(h,0,d),i.splice(h<=c?c+1:c,1),n&&n.splice(h<=c?c+1:c,1)}else if(h<u&&i[h]===t&&(c>=u||i[c]!==e)){var f=n?n[h]:void 0;i.splice(c,0,e),n&&n.splice(c,0,f),i.splice(c<=h?h+1:h,1),n&&n.splice(c<=h?h+1:h,1)}}},i}),{isClass:!0}),wg="splitUnit",Ag=Ii(wg,["typed"],(e=>{var{typed:t}=e;return t(wg,{"Unit, Array":function(e,t){return e.splitUnit(t)}})})),Cg="square",Eg=Ii(Cg,["typed"],(e=>{var{typed:t}=e;return t(Cg,{number:of,Complex:function(e){return e.mul(e)},BigNumber:function(e){return e.times(e)},bigint:function(e){return e*e},Fraction:function(e){return e.mul(e)},Unit:function(e){return e.pow(2)}})})),Mg="string",Sg=Ii(Mg,["typed"],(e=>{var{typed:t}=e;return t(Mg,{"":function(){return""},number:$i,null:function(e){return"null"},boolean:function(e){return e+""},string:function(e){return e},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e))),any:function(e){return String(e)}})})),Dg="subtractScalar",Tg=Ii(Dg,["typed"],(e=>{var{typed:t}=e;return t(Dg,{"number, number":$d,"Complex, Complex":function(e,t){return e.sub(t)},"BigNumber, BigNumber":function(e,t){return e.minus(t)},"bigint, bigint":function(e,t){return e-t},"Fraction, Fraction":function(e,t){return e.sub(t)},"Unit, Unit":t.referToSelf((e=>(r,n)=>{if(null===r.value||void 0===r.value)throw new Error("Parameter x contains a unit with undefined value");if(null===n.value||void 0===n.value)throw new Error("Parameter y contains a unit with undefined value");if(!r.equalBase(n))throw new Error("Units do not match");var i=r.clone();return i.value=t.find(e,[i.valueType(),n.valueType()])(i.value,n.value),i.fixPrefix=!1,i}))})})),Ng=Ii("tan",["typed"],(e=>{var{typed:t}=e,r=im({typed:t});return t("tan",{number:Math.tan,"Complex | BigNumber":e=>e.tan()},r)})),Ig="typeOf",Pg=Ii(Ig,["typed"],(e=>{var{typed:t}=e;return t(Ig,{any:Ti})})),zg="acosh",Bg=Ii(zg,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(zg,{number:function(e){return e>=1||r.predictable?ff(e):e<=-1?new n(Math.log(Math.sqrt(e*e-1)-e),Math.PI):new n(e,0).acosh()},Complex:function(e){return e.acosh()},BigNumber:function(e){return e.acosh()}})})),kg="acsch",Fg=Ii(kg,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(kg,{number:vf,Complex:function(e){return e.acsch()},BigNumber:function(e){return new r(1).div(e).asinh()}})})),Rg="asec",Og=Ii(Rg,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:r,Complex:n,BigNumber:i}=e;return t(Rg,{number:function(e){return e<=-1||e>=1||r.predictable?xf(e):new n(e,0).asec()},Complex:function(e){return e.asec()},BigNumber:function(e){return new i(1).div(e).acos()}})})),Lg=Ii("bignumber",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t("bignumber",{"":function(){return new r(0)},number:function(e){return new r(e+"")},string:function(e){var t=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(t){var n=t[2],i=r(t[1]),a=new r(2).pow(Number(n));if(i.gt(a.sub(1)))throw new SyntaxError('String "'.concat(e,'" is out of range'));var o=new r(2).pow(Number(n)-1);return i.gte(o)?i.sub(a):i}return new r(e)},BigNumber:function(e){return e},bigint:function(e){return new r(e.toString())},Unit:t.referToSelf((e=>t=>{var r=t.clone();return r.value=e(t.value),r})),Fraction:function(e){return new r(String(e.n)).div(String(e.d)).times(String(e.s))},null:function(e){return new r(0)},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),qg="combinationsWithRep",jg=Ii(qg,["typed"],(e=>{var{typed:t}=e;return t(qg,{"number, number":function(e,t){if(!Fi(e)||e<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!Fi(t)||t<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e<1)throw new TypeError("k must be less than or equal to n + k - 1");return t<e-1?Yf(e,e+t-1)/Yf(1,t):Yf(t+1,e+t-1)/Yf(1,e-1)},"BigNumber, BigNumber":function(e,t){var r,n,i=new(0,e.constructor)(1),a=e.minus(i);if(!Ug(e)||!Ug(t))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e.lt(i))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(r=i,t.lt(a))for(n=i;n.lte(a);n=n.plus(i))r=r.times(t.plus(n)).dividedBy(n);else for(n=i;n.lte(t);n=n.plus(i))r=r.times(a.plus(n)).dividedBy(n);return r}})}));function Ug(e){return e.isInteger()&&e.gte(0)}var Vg="cosh",Zg=Ii(Vg,["typed"],(e=>{var{typed:t}=e;return t(Vg,{number:ra,"Complex | BigNumber":e=>e.cosh()})})),$g="csch",Gg=Ii($g,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t($g,{number:Mf,Complex:e=>e.csch(),BigNumber:e=>new r(1).div(e.sinh())})})),Hg="isNaN",Wg=Ii(Hg,["typed"],(e=>{var{typed:t}=e;return t(Hg,{number:Fm,BigNumber:function(e){return e.isNaN()},bigint:function(e){return!1},Fraction:function(e){return!1},Complex:function(e){return e.isNaN()},Unit:function(e){return Number.isNaN(e.value)},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),Xg="isPrime",Yg=Ii(Xg,["typed"],(e=>{var{typed:t}=e;return t(Xg,{number:function(e){if(e<=3)return e>1;if(e%2==0||e%3==0)return!1;for(var t=5;t*t<=e;t+=6)if(e%t===0||e%(t+2)===0)return!1;return!0},bigint:function(e){if(e<=3n)return e>1n;if(e%2n==0n||e%3n==0n)return!1;for(var t=5n;t*t<=e;t+=6n)if(e%t===0n||e%(t+2n)===0n)return!1;return!0},BigNumber:function(e){if(e.lte(3))return e.gt(1);if(e.mod(2).eq(0)||e.mod(3).eq(0))return!1;if(e.lt(Math.pow(2,32))){for(var t=e.toNumber(),r=5;r*r<=t;r+=6)if(t%r===0||t%(r+2)===0)return!1;return!0}function n(e,t,r){for(var n=1;!t.eq(0);)t.mod(2).eq(0)?(t=t.div(2),e=e.mul(e).mod(r)):(t=t.sub(1),n=e.mul(n).mod(r));return n}for(var i=e.constructor.clone({precision:2*e.toFixed(0).length}),a=0,o=(e=new i(e)).sub(1);o.mod(2).eq(0);)o=o.div(2),a+=1;var s=null;if(e.lt("3317044064679887385961981"))s=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter((t=>t<e));else{var l=Math.min(e.toNumber()-2,Math.floor(2*Math.pow(e.toFixed(0).length*Math.log(10),2)));s=[];for(var u=2;u<=l;u+=1)s.push(l)}for(var c=0;c<s.length;c+=1){var h=s[c],p=n(e.sub(e).add(h),o,e);if(!p.eq(1))for(var d=0,f=p;!f.eq(e.sub(1));d+=1,f=f.mul(f).mod(e))if(d===a-1)return!1}return!0},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),Kg="matrix",Jg=Ii(Kg,["typed","Matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,Matrix:r,DenseMatrix:n,SparseMatrix:i}=e;return t(Kg,{"":function(){return a([])},string:function(e){return a([],e)},"string, string":function(e,t){return a([],e,t)},Array:function(e){return a(e)},Matrix:function(e){return a(e,e.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(e,t,r){if("dense"===t||"default"===t||void 0===t)return new n(e,r);if("sparse"===t)return new i(e,r);throw new TypeError("Unknown matrix type "+JSON.stringify(t)+".")}})),Qg="matrixFromFunction",ey=Ii(Qg,["typed","matrix","isZero"],(e=>{var{typed:t,matrix:r,isZero:n}=e;return t(Qg,{"Array | Matrix, function, string, string":function(e,t,r,n){return i(e,t,r,n)},"Array | Matrix, function, string":function(e,t,r){return i(e,t,r)},"Matrix, function":function(e,t){return i(e,t,"dense")},"Array, function":function(e,t){return i(e,t,"dense").toArray()},"Array | Matrix, string, function":function(e,t,r){return i(e,r,t)},"Array | Matrix, string, string, function":function(e,t,r,n){return i(e,n,t,r)}});function i(e,t,i,a){var o;return(o=void 0!==a?r(i,a):r(i)).resize(e),o.forEach((function(e,r){var i=t(r);n(i)||o.set(r,i)})),o}})),ty=Ii("ones",["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:r,matrix:n,BigNumber:i}=e;return t("ones",{"":function(){return"Array"===r.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(e){if("string"==typeof e[e.length-1]){var t=e.pop();return a(e,t)}return"Array"===r.matrix?a(e):a(e,"default")},Array:a,Matrix:function(e){var t=e.storage();return a(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return a(e.valueOf(),t)}});function a(e,t){var r=function(e){var t=!1;return e.forEach((function(e,r,n){Un(e)&&(t=!0,n[r]=e.toNumber())})),t}(e),a=r?new i(1):1;if(function(e){e.forEach((function(e){if("number"!=typeof e||!Fi(e)||e<0)throw new Error("Parameters in function ones must be positive integers")}))}(e),t){var o=n(t);return e.length>0?o.resize(e,a):o}var s=[];return e.length>0?Sa(s,e,a):s}})),ry="randomInt",ny=Ii(ry,["typed","config","log2","?on"],(e=>{var{typed:t,config:r,log2:n,on:i}=e,a=cg(r.randomSeed);return i&&i("config",(function(e,t){e.randomSeed!==t.randomSeed&&(a=cg(e.randomSeed))})),t(ry,{"":()=>s(0,2),number:e=>s(0,e),"number, number":(e,t)=>s(e,t),bigint:e=>l(0n,e),"bigint, bigint":l,"Array | Matrix":e=>o(e,0,1),"Array | Matrix, number":(e,t)=>o(e,0,t),"Array | Matrix, number, number":(e,t,r)=>o(e,t,r)});function o(e,t,r){var n=dg(e.valueOf(),(()=>s(t,r)));return Xn(e)?e.create(n,"number"):n}function s(e,t){return Math.floor(e+a()*(t-e))}function l(e,t){var r=t-e;if(r<=2n**30n)return e+BigInt(s(0,Number(r)));for(var i=n(r),o=r;o>=r;){o=0n;for(var l=0;l<i;++l)o=2n*o+(a()<.5?0n:1n)}return e+o}})),iy="reshape",ay=Ii(iy,["typed","isInteger","matrix"],(e=>{var{typed:t,isInteger:r}=e;return t(iy,{"Matrix, Array":function(e,t){return e.reshape(t,!0)},"Array, Array":function(e,t){return t.forEach((function(e){if(!r(e))throw new TypeError("Invalid size for dimension: "+e)})),Ta(e,t)}})})),oy="sech",sy=Ii(oy,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(oy,{number:Df,Complex:e=>e.sech(),BigNumber:e=>new r(1).div(e.cosh())})})),ly="sinh",uy=Ii(ly,["typed"],(e=>{var{typed:t}=e;return t(ly,{number:Tf,"Complex | BigNumber":e=>e.sinh()})})),cy="sparse",hy=Ii(cy,["typed","SparseMatrix"],(e=>{var{typed:t,SparseMatrix:r}=e;return t(cy,{"":function(){return new r([])},string:function(e){return new r([],e)},"Array | Matrix":function(e){return new r(e)},"Array | Matrix, string":function(e,t){return new r(e,t)}})})),py=Ii("sqrt",["config","typed","Complex"],(e=>{var{config:t,typed:r,Complex:n}=e;return r("sqrt",{number:i,Complex:function(e){return e.sqrt()},BigNumber:function(e){return!e.isNegative()||t.predictable?e.sqrt():i(e.toNumber())},Unit:function(e){return e.pow(.5)}});function i(e){return isNaN(e)?NaN:e>=0||t.predictable?Math.sqrt(e):new n(e,0).sqrt()}})),dy="squeeze",fy=Ii(dy,["typed"],(e=>{var{typed:t}=e;return t(dy,{Array:function(e){return Pa(Mn(e))},Matrix:function(e){var t=Pa(e.toArray());return Array.isArray(t)?e.create(t,e.datatype()):t},any:function(e){return Mn(e)}})})),my=Ii("tanh",["typed"],(e=>{var{typed:t}=e;return t("tanh",{number:ia,"Complex | BigNumber":e=>e.tanh()})})),gy="transpose",yy=Ii(gy,["typed","matrix"],(e=>{var{typed:t,matrix:r}=e;return t(gy,{Array:e=>n(r(e)).valueOf(),Matrix:n,any:Mn});function n(e){var t,r=e.size();switch(r.length){case 1:t=e.clone();break;case 2:var n=r[0],i=r[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+ha(r)+")");switch(e.storage()){case"dense":t=function(e,t,r){for(var n,i=e._data,a=[],o=0;o<r;o++){n=a[o]=[];for(var s=0;s<t;s++)n[s]=Mn(i[s][o])}return e.createDenseMatrix({data:a,size:[r,t],datatype:e._datatype})}(e,n,i);break;case"sparse":t=function(e,t,r){for(var n,i,a,o=e._values,s=e._index,l=e._ptr,u=o?[]:void 0,c=[],h=[],p=[],d=0;d<t;d++)p[d]=0;for(n=0,i=s.length;n<i;n++)p[s[n]]++;for(var f=0,m=0;m<t;m++)h.push(f),f+=p[m],p[m]=h[m];for(h.push(f),a=0;a<r;a++)for(var g=l[a],y=l[a+1],v=g;v<y;v++){var x=p[s[v]]++;c[x]=a,o&&(u[x]=Mn(o[v]))}return e.createSparseMatrix({values:u,index:c,ptr:h,size:[r,t],datatype:e._datatype})}(e,n,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+ha(r)+")")}return t}})),vy="xgcd",xy=Ii(vy,["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:r,matrix:n,BigNumber:i}=e;return t(vy,{"number, number":function(e,t){var i=sf(e,t);return"Array"===r.matrix?i:n(i)},"BigNumber, BigNumber":function(e,t){var a,o,s,l,u=new i(0),c=new i(1),h=u,p=c,d=c,f=u;if(!e.isInt()||!t.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!t.isZero();)o=e.div(t).floor(),s=e.mod(t),a=h,h=p.minus(o.times(h)),p=a,a=d,d=f.minus(o.times(d)),f=a,e=t,t=s;return l=e.lt(u)?[e.neg(),p.neg(),f.neg()]:[e,e.isZero()?0:p,f],"Array"===r.matrix?l:n(l)}})})),_y="zeros",by=Ii(_y,["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:r,matrix:n,BigNumber:i}=e;return t(_y,{"":function(){return"Array"===r.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(e){if("string"==typeof e[e.length-1]){var t=e.pop();return a(e,t)}return"Array"===r.matrix?a(e):a(e,"default")},Array:a,Matrix:function(e){var t=e.storage();return a(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return a(e.valueOf(),t)}});function a(e,t){var r=function(e){var t=!1;return e.forEach((function(e,r,n){Un(e)&&(t=!0,n[r]=e.toNumber())})),t}(e),a=r?new i(0):0;if(function(e){e.forEach((function(e){if("number"!=typeof e||!Fi(e)||e<0)throw new Error("Parameters in function zeros must be positive integers")}))}(e),t){var o=n(t);return e.length>0?o.resize(e,a):o}var s=[];return e.length>0?Sa(s,e,a):s}})),wy="acoth",Ay=Ii(wy,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:r,Complex:n,BigNumber:i}=e;return t(wy,{number:function(e){return e>=1||e<=-1||r.predictable?gf(e):new n(e,0).acoth()},Complex:function(e){return e.acoth()},BigNumber:function(e){return new i(1).div(e).atanh()}})})),Cy="asin",Ey=Ii(Cy,["typed","config","Complex"],(e=>{var{typed:t,config:r,Complex:n}=e;return t(Cy,{number:function(e){return e>=-1&&e<=1||r.predictable?Math.asin(e):new n(e,0).asin()},Complex:function(e){return e.asin()},BigNumber:function(e){return e.asin()}})})),My=Ii("bin",["typed","format"],(e=>{var{typed:t,format:r}=e;return t("bin",{"number | BigNumber":function(e){return r(e,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(e,t){return r(e,{notation:"bin",wordSize:t})}})})),Sy="coth",Dy=Ii(Sy,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:r}=e;return t(Sy,{number:Cf,Complex:e=>e.coth(),BigNumber:e=>new r(1).div(e.tanh())})})),Ty="ctranspose",Ny=Ii(Ty,["typed","transpose","conj"],(e=>{var{typed:t,transpose:r,conj:n}=e;return t(Ty,{any:function(e){return n(r(e))}})})),Iy="diag",Py=Ii(Iy,["typed","matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,matrix:r,DenseMatrix:n,SparseMatrix:i}=e;return t(Iy,{Array:function(e){return a(e,0,ba(e),null)},"Array, number":function(e,t){return a(e,t,ba(e),null)},"Array, BigNumber":function(e,t){return a(e,t.toNumber(),ba(e),null)},"Array, string":function(e,t){return a(e,0,ba(e),t)},"Array, number, string":function(e,t,r){return a(e,t,ba(e),r)},"Array, BigNumber, string":function(e,t,r){return a(e,t.toNumber(),ba(e),r)},Matrix:function(e){return a(e,0,e.size(),e.storage())},"Matrix, number":function(e,t){return a(e,t,e.size(),e.storage())},"Matrix, BigNumber":function(e,t){return a(e,t.toNumber(),e.size(),e.storage())},"Matrix, string":function(e,t){return a(e,0,e.size(),t)},"Matrix, number, string":function(e,t,r){return a(e,t,e.size(),r)},"Matrix, BigNumber, string":function(e,t,r){return a(e,t.toNumber(),e.size(),r)}});function a(e,t,a,o){if(!Fi(t))throw new TypeError("Second parameter in function diag must be an integer");var s=t>0?t:0,l=t<0?-t:0;switch(a.length){case 1:return function(e,t,r,a,o,s){var l=[a+o,a+s];if(r&&"sparse"!==r&&"dense"!==r)throw new TypeError("Unknown matrix type ".concat(r,'"'));var u="sparse"===r?i.diagonal(l,e,t):n.diagonal(l,e,t);return null!==r?u:u.valueOf()}(e,t,o,a[0],l,s);case 2:return function(e,t,n,i,a,o){if(Xn(e)){var s=e.diagonal(t);return null!==n?n!==s.storage()?r(s,n):s:s.valueOf()}for(var l=Math.min(i[0]-a,i[1]-o),u=[],c=0;c<l;c++)u[c]=e[c+a][c+o];return null!==n?r(u):u}(e,t,o,a,l,s)}throw new RangeError("Matrix for function diag must be 2 dimensional")}})),zy=Ii("matAlgo09xS0Sf",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var a=e._values,o=e._index,s=e._ptr,l=e._size,u=e._datatype||void 0===e._data?e._datatype:e.getDataType(),c=n._values,h=n._index,p=n._ptr,d=n._size,f=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(l.length!==d.length)throw new xa(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");var m,g=l[0],y=l[1],v=r,x=0,_=i;"string"==typeof u&&u===f&&"mixed"!==u&&(m=u,v=t.find(r,[m,m]),x=t.convert(0,m),_=t.find(i,[m,m]));var b,w,A,C,E,M=a&&c?[]:void 0,S=[],D=[],T=M?[]:void 0,N=[];for(w=0;w<y;w++){D[w]=S.length;var I=w+1;if(T)for(C=p[w],E=p[w+1],A=C;A<E;A++)N[b=h[A]]=I,T[b]=c[A];for(C=s[w],E=s[w+1],A=C;A<E;A++)if(b=o[A],T){var P=N[b]===I?T[b]:x,z=_(a[A],P);v(z,x)||(S.push(b),M.push(z))}else S.push(b)}return D[y]=S.length,e.createSparseMatrix({values:M,index:S,ptr:D,size:[g,y],datatype:u===e._datatype&&f===n._datatype?m:void 0})}})),By="dotMultiply",ky=Ii(By,["typed","matrix","equalScalar","multiplyScalar","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,multiplyScalar:i,concat:a}=e,o=vl({typed:t,equalScalar:n}),s=zy({typed:t,equalScalar:n}),l=xl({typed:t,equalScalar:n}),u=cl({typed:t,matrix:r,concat:a});return t(By,u({elop:i,SS:s,DS:o,Ss:l}))})),Fy=Ii("matAlgo07xSSf",["typed","SparseMatrix"],(e=>{var{typed:t,SparseMatrix:r}=e;return function(e,i,a){var o=e._size,s=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=i._size,u=i._datatype||void 0===i._data?i._datatype:i.getDataType();if(o.length!==l.length)throw new xa(o.length,l.length);if(o[0]!==l[0]||o[1]!==l[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+l+")");var c,h=o[0],p=o[1],d=0,f=a;"string"==typeof s&&s===u&&"mixed"!==s&&(c=s,d=t.convert(0,c),f=t.find(a,[c,c]));for(var m=[],g=[],y=new Array(p+1).fill(0),v=[],x=[],_=[],b=[],w=0;w<p;w++){var A=w+1,C=0;n(e,w,_,v,A),n(i,w,b,x,A);for(var E=0;E<h;E++){var M=f(_[E]===A?v[E]:d,b[E]===A?x[E]:d);0!==M&&!1!==M&&(g.push(E),m.push(M),C++)}y[w+1]=y[w]+C}return new r({values:m,index:g,ptr:y,size:[h,p],datatype:s===e._datatype&&u===i._datatype?c:void 0})};function n(e,t,r,n,i){for(var a=e._values,o=e._index,s=e._ptr,l=s[t],u=s[t+1];l<u;l++){var c=o[l];r[c]=i,n[c]=a[l]}}})),Ry="equal",Oy=Ii(Ry,["typed","matrix","equalScalar","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:r,equalScalar:n,DenseMatrix:i,concat:a,SparseMatrix:o}=e,s=il({typed:t}),l=Fy({typed:t,SparseMatrix:o}),u=al({typed:t,DenseMatrix:i}),c=cl({typed:t,matrix:r,concat:a});return t(Ry,Ly({typed:t,equalScalar:n}),c({elop:n,SS:l,DS:s,Ss:u}))})),Ly=Ii(Ry,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return t(Ry,{"any, any":function(e,t){return null===e?null===t:null===t?null===e:void 0===e?void 0===t:void 0===t?void 0===e:r(e,t)}})})),qy=Ii("fraction",["typed","Fraction"],(e=>{var{typed:t,Fraction:r}=e;return t("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new r(e)},string:function(e){return new r(e)},"number, number":function(e,t){return new r(e,t)},"bigint, bigint":function(e,t){return new r(e,t)},null:function(e){return new r(0)},BigNumber:function(e){return new r(e.toString())},bigint:function(e){return new r(e.toString())},Fraction:function(e){return e},Unit:t.referToSelf((e=>t=>{var r=t.clone();return r.value=e(t.value),r})),Object:function(e){return new r(e)},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),jy="identity",Uy=Ii(jy,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,config:r,matrix:n,BigNumber:i,DenseMatrix:a,SparseMatrix:o}=e;return t(jy,{"":function(){return"Matrix"===r.matrix?n([]):[]},string:function(e){return n(e)},"number | BigNumber":function(e){return l(e,e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, string":function(e,t){return l(e,e,t)},"number | BigNumber, number | BigNumber":function(e,t){return l(e,t,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(e,t,r){return l(e,t,r)},Array:function(e){return s(e)},"Array, string":function(e,t){return s(e,t)},Matrix:function(e){return s(e.valueOf(),e.storage())},"Matrix, string":function(e,t){return s(e.valueOf(),t)}});function s(e,t){switch(e.length){case 0:return t?n(t):[];case 1:return l(e[0],e[0],t);case 2:return l(e[0],e[1],t);default:throw new Error("Vector containing two values expected")}}function l(e,t,r){var n=Un(e)||Un(t)?i:null;if(Un(e)&&(e=e.toNumber()),Un(t)&&(t=t.toNumber()),!Fi(e)||e<1)throw new Error("Parameters in function identity must be positive integers");if(!Fi(t)||t<1)throw new Error("Parameters in function identity must be positive integers");var s=n?new i(1):1,l=n?new n(0):0,u=[e,t];if(r){if("sparse"===r)return o.diagonal(u,s,0,l);if("dense"===r)return a.diagonal(u,s,0,l);throw new TypeError('Unknown matrix type "'.concat(r,'"'))}for(var c=Sa([],u,l),h=e<t?e:t,p=0;p<h;p++)c[p][p]=s;return c}})),Vy="isNumeric",Zy=Ii(Vy,["typed"],(e=>{var{typed:t}=e;return t(Vy,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),$y="kron",Gy=Ii($y,["typed","matrix","multiplyScalar"],(e=>{var{typed:t,matrix:r,multiplyScalar:n}=e;return t($y,{"Matrix, Matrix":function(e,t){return r(i(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return r(i(e.toArray(),t))},"Array, Matrix":function(e,t){return r(i(e,t.toArray()))},"Array, Array":i});function i(e,t){if(1===ba(e).length&&(e=[e]),1===ba(t).length&&(t=[t]),ba(e).length>2||ba(t).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(e.length)+", y = "+JSON.stringify(t.length)+")");var r=[],i=[];return e.map((function(e){return t.map((function(t){return i=[],r.push(i),e.map((function(e){return t.map((function(t){return i.push(n(e,t))}))}))}))}))&&r}})),Hy="largerEq",Wy=Ii(Hy,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=e,s=il({typed:t}),l=Fy({typed:t,SparseMatrix:o}),u=al({typed:t,DenseMatrix:i}),c=cl({typed:t,matrix:n,concat:a}),h=hm({typed:t});return t(Hy,Xy({typed:t,config:r}),{"boolean, boolean":(e,t)=>e>=t,"BigNumber, BigNumber":function(e,t){return e.gte(t)||cm(e,t,r.relTol,r.absTol)},"bigint, bigint":function(e,t){return e>=t},"Fraction, Fraction":(e,t)=>-1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,c({SS:l,DS:s,Ss:u}))})),Xy=Ii(Hy,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(Hy,{"number, number":function(e,t){return e>=t||Ji(e,t,r.relTol,r.absTol)}})})),Yy=Ii("matAlgo08xS0Sid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return function(e,n,i){var a=e._values,o=e._index,s=e._ptr,l=e._size,u=e._datatype||void 0===e._data?e._datatype:e.getDataType(),c=n._values,h=n._index,p=n._ptr,d=n._size,f=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(l.length!==d.length)throw new xa(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!a||!c)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var m,g=l[0],y=l[1],v=r,x=0,_=i;"string"==typeof u&&u===f&&"mixed"!==u&&(m=u,v=t.find(r,[m,m]),x=t.convert(0,m),_=t.find(i,[m,m]));for(var b,w,A,C,E=[],M=[],S=[],D=[],T=[],N=0;N<y;N++){S[N]=M.length;var I=N+1;for(w=s[N],A=s[N+1],b=w;b<A;b++)T[C=o[b]]=I,D[C]=a[b],M.push(C);for(w=p[N],A=p[N+1],b=w;b<A;b++)T[C=h[b]]===I&&(D[C]=_(D[C],c[b]));for(b=S[N];b<M.length;){var P=D[C=M[b]];v(P,x)?M.splice(b,1):(E.push(P),b++)}}return S[y]=M.length,e.createSparseMatrix({values:E,index:M,ptr:S,size:[g,y],datatype:u===e._datatype&&f===n._datatype?m:void 0})}})),Ky=Ii("useMatrixForArrayScalar",["typed","matrix"],(e=>{var{typed:t,matrix:r}=e;return{"Array, number":t.referTo("DenseMatrix, number",(e=>(t,n)=>e(r(t),n).valueOf())),"Array, BigNumber":t.referTo("DenseMatrix, BigNumber",(e=>(t,n)=>e(r(t),n).valueOf())),"number, Array":t.referTo("number, DenseMatrix",(e=>(t,n)=>e(t,r(n)).valueOf())),"BigNumber, Array":t.referTo("BigNumber, DenseMatrix",(e=>(t,n)=>e(t,r(n)).valueOf()))}})),Jy="leftShift",Qy=Ii(Jy,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,DenseMatrix:a,concat:o}=e,s=mu({typed:t}),l=vl({typed:t,equalScalar:n}),u=Yy({typed:t,equalScalar:n}),c=du({typed:t,DenseMatrix:a}),h=xl({typed:t,equalScalar:n}),p=ll({typed:t}),d=cl({typed:t,matrix:r,concat:o}),f=Ky({typed:t,matrix:r});return t(Jy,{"number, number":Yl,"BigNumber, BigNumber":Vl,"bigint, bigint":(e,t)=>e<<t,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():h(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():p(t,r,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):c(r,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):p(r,t,e,!0)))},f,d({SS:u,DS:s,SD:l}))})),ev="mode",tv=Ii(ev,["typed","isNaN","isNumeric"],(e=>{var{typed:t,isNaN:r,isNumeric:n}=e;return t(ev,{"Array | Matrix":i,"...":function(e){return i(e)}});function i(e){if(0===(e=Fa(e.valueOf())).length)throw new Error("Cannot calculate mode of an empty array");for(var t={},i=[],a=0,o=0;o<e.length;o++){var s=e[o];if(n(s)&&r(s))throw new Error("Cannot calculate mode of an array containing NaN values");s in t||(t[s]=0),t[s]++,t[s]===a?i.push(s):t[s]>a&&(a=t[s],i=[s])}return i}})),rv="nthRoot",nv=Ii(rv,["typed","matrix","equalScalar","BigNumber","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,BigNumber:i,concat:a}=e,o=mu({typed:t}),s=vl({typed:t,equalScalar:n}),l=_l({typed:t,equalScalar:n}),u=xl({typed:t,equalScalar:n}),c=cl({typed:t,matrix:r,concat:a});function h(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return t(rv,{number:nf,"number, number":nf,BigNumber:e=>p(e,new i(2)),"BigNumber, BigNumber":p,Complex:h,"Complex, number":h,Array:t.referTo("DenseMatrix,number",(e=>t=>e(r(t),2).valueOf())),DenseMatrix:t.referTo("DenseMatrix,number",(e=>t=>e(t,2))),SparseMatrix:t.referTo("SparseMatrix,number",(e=>t=>e(t,2))),"SparseMatrix, SparseMatrix":t.referToSelf((e=>(t,r)=>{if(1===r.density())return l(t,r,e);throw new Error("Root must be non-zero")})),"DenseMatrix, SparseMatrix":t.referToSelf((e=>(t,r)=>{if(1===r.density())return o(t,r,e,!1);throw new Error("Root must be non-zero")})),"Array, SparseMatrix":t.referTo("DenseMatrix,SparseMatrix",(e=>(t,n)=>e(r(t),n))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,r)=>{if(1===r.density())return u(r,t,e,!0);throw new Error("Root must be non-zero")}))},c({scalar:"number | BigNumber",SD:s,Ss:u,sS:!1}));function p(e,t){var r=i.precision,n=i.clone({precision:r+2}),a=new i(0),o=new n(1),s=t.isNegative();if(s&&(t=t.neg()),t.isZero())throw new Error("Root must be non-zero");if(e.isNegative()&&!t.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(e.isZero())return s?new n(1/0):0;if(!e.isFinite())return s?a:e;var l=e.abs().pow(o.div(t));return l=e.isNeg()?l.neg():l,new i((s?o.div(l):l).toPrecision(r))}})),iv=Ii("numeric",["number","?bignumber","?fraction"],(e=>{var{number:t,bignumber:r,fraction:n}=e,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:e=>t(e),BigNumber:r?e=>r(e):as,bigint:e=>BigInt(e),Fraction:n?e=>n(e):os};return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";if(void 0!==(arguments.length>2?arguments[2]:void 0))throw new SyntaxError("numeric() takes one or two arguments");var r=Ti(e);if(!(r in i))throw new TypeError("Cannot convert "+e+' of type "'+r+'"; valid input types are '+Object.keys(i).join(", "));if(!(t in a))throw new TypeError("Cannot convert "+e+' to type "'+t+'"; valid output types are '+Object.keys(a).join(", "));return t===r?e:a[t](e)}})),av="prod",ov=Ii(av,["typed","config","multiplyScalar","numeric"],(e=>{var{typed:t,config:r,multiplyScalar:n,numeric:i}=e;return t(av,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("prod(A, dim) is not yet supported")},"...":function(e){return a(e)}});function a(e){var t;if(Wo(e,(function(e){try{t=void 0===t?e:n(t,e)}catch(t){throw zl(t,"prod",e)}})),"string"==typeof t&&(t=i(t,Ri(t,r))),void 0===t)throw new Error("Cannot calculate prod of an empty array");return t}}));function sv(e,t,r,n){if(!(this instanceof sv))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.count=t,this.min=r,this.max=n,this.message="Wrong number of arguments in function "+e+" ("+t+" provided, "+r+(null!=n?"-"+n:"")+" expected)",this.stack=(new Error).stack}sv.prototype=new Error,sv.prototype.constructor=Error,sv.prototype.name="ArgumentsError",sv.prototype.isArgumentsError=!0;var lv=Ii("resize",["config","matrix"],(e=>{var{config:t,matrix:r}=e;return function(e,n,i){if(2!==arguments.length&&3!==arguments.length)throw new sv("resize",arguments.length,2,3);if(Xn(n)&&(n=n.valueOf()),Un(n[0])&&(n=n.map((function(e){return Un(e)?e.toNumber():e}))),Xn(e))return e.resize(n,i,!0);if("string"==typeof e)return function(e,t,r){if(void 0!==r){if("string"!=typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";if(1!==t.length)throw new xa(t.length,1);var n=t[0];if("number"!=typeof n||!Fi(n))throw new TypeError("Invalid size, must contain positive integers (size: "+ha(t)+")");if(e.length>n)return e.substring(0,n);if(e.length<n){for(var i=e,a=0,o=n-e.length;a<o;a++)i+=r;return i}return e}(e,n,i);var a=!Array.isArray(e)&&"Array"!==t.matrix;if(0===n.length){for(;Array.isArray(e);)e=e[0];return Mn(e)}Array.isArray(e)||(e=[e]);var o=Sa(e=Mn(e),n,i);return a?r(o):o}})),uv="rightArithShift",cv=Ii(uv,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,DenseMatrix:a,concat:o}=e,s=mu({typed:t}),l=vl({typed:t,equalScalar:n}),u=Yy({typed:t,equalScalar:n}),c=du({typed:t,DenseMatrix:a}),h=xl({typed:t,equalScalar:n}),p=ll({typed:t}),d=cl({typed:t,matrix:r,concat:o}),f=Ky({typed:t,matrix:r});return t(uv,{"number, number":Kl,"BigNumber, BigNumber":Zl,"bigint, bigint":(e,t)=>e>>t,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():h(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():p(t,r,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):c(r,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):p(r,t,e,!0)))},f,d({SS:u,DS:s,SD:l}))})),hv="Number of decimals in function round must be an integer",pv="round",dv=Ii(pv,["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],(e=>{var{typed:t,config:r,matrix:n,equalScalar:i,zeros:a,BigNumber:o,DenseMatrix:s}=e,l=xl({typed:t,equalScalar:i}),u=al({typed:t,DenseMatrix:s}),c=ll({typed:t});function h(e){return Math.abs(Hi(e).exponent)}return t(pv,{number:function(e){var t=uf(e,h(r.relTol));return uf(Ji(e,t,r.relTol,r.absTol)?t:e)},"number, number":function(e,t){var n=h(r.relTol);if(t>=n)return uf(e,t);var i=uf(e,n);return uf(Ji(e,i,r.relTol,r.absTol)?i:e,t)},"number, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(hv);return new o(e).toDecimalPlaces(t.toNumber())},Complex:function(e){return e.round()},"Complex, number":function(e,t){if(t%1)throw new TypeError(hv);return e.round(t)},"Complex, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(hv);var r=t.toNumber();return e.round(r)},BigNumber:function(e){var t=new o(e).toDecimalPlaces(h(r.relTol));return(cm(e,t,r.relTol,r.absTol)?t:e).toDecimalPlaces(0)},"BigNumber, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(hv);var n=h(r.relTol);if(t>=n)return e.toDecimalPlaces(t.toNumber());var i=e.toDecimalPlaces(n);return(cm(e,i,r.relTol,r.absTol)?i:e).toDecimalPlaces(t.toNumber())},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.round()},"Fraction, number":function(e,t){if(t%1)throw new TypeError(hv);return e.round(t)},"Fraction, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(hv);return e.round(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,r,n){var i=t.toNumeric(n);return n.multiply(e(i,r))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,r,n)=>e(t,r.toNumber(),n))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,r,n)=>Xo(t,(t=>e(t,r,n)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,r)=>e(t,0,r))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e,!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>l(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>c(t,r,e,!1))),"Array, number | BigNumber":t.referToSelf((e=>(t,r)=>c(n(t),r,e,!1).valueOf())),"number | Complex | BigNumber | Fraction, SparseMatrix":t.referToSelf((e=>(t,r)=>i(t,0)?a(r.size(),r.storage()):u(r,t,e,!0))),"number | Complex | BigNumber | Fraction, DenseMatrix":t.referToSelf((e=>(t,r)=>i(t,0)?a(r.size(),r.storage()):c(r,t,e,!0))),"number | Complex | BigNumber | Fraction, Array":t.referToSelf((e=>(t,r)=>c(n(r),t,e,!0).valueOf()))})})),fv="size",mv=Ii(fv,["typed","config","?matrix"],(e=>{var{typed:t,config:r,matrix:n}=e;return t(fv,{Matrix:function(e){return e.create(e.size(),"number")},Array:ba,string:function(e){return"Array"===r.matrix?[e.length]:n([e.length],"dense","number")},"number | Complex | BigNumber | Unit | boolean | null":function(e){return"Array"===r.matrix?[]:n?n([],"dense","number"):ss()}})})),gv="smaller",yv=Ii(gv,["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:r,bignumber:n,matrix:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=il({typed:t}),u=Fy({typed:t,SparseMatrix:s}),c=al({typed:t,DenseMatrix:a}),h=cl({typed:t,matrix:i,concat:o}),p=hm({typed:t});function d(e,t){return e.lt(t)&&!cm(e,t,r.relTol,r.absTol)}return t(gv,vv({typed:t,config:r}),{"boolean, boolean":(e,t)=>e<t,"BigNumber, BigNumber":d,"bigint, bigint":(e,t)=>e<t,"Fraction, Fraction":(e,t)=>-1===e.compare(t),"Fraction, BigNumber":function(e,t){return d(n(e),t)},"BigNumber, Fraction":function(e,t){return d(e,n(t))},"Complex, Complex":function(e,t){throw new TypeError("No ordering relation is defined for complex numbers")}},p,h({SS:u,DS:l,Ss:c}))})),vv=Ii(gv,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(gv,{"number, number":function(e,t){return e<t&&!Ji(e,t,r.relTol,r.absTol)}})})),xv=Ii("to",["typed","matrix","concat"],(e=>{var{typed:t,matrix:r,concat:n}=e;return t("to",{"Unit, Unit | string":(e,t)=>e.to(t)},cl({typed:t,matrix:r,concat:n})({Ds:!0}))})),_v="unaryMinus",bv=Ii(_v,["typed"],(e=>{var{typed:t}=e;return t(_v,{number:Hd,"Complex | BigNumber | Fraction":e=>e.neg(),bigint:e=>-e,Unit:t.referToSelf((e=>r=>{var n=r.clone();return n.value=t.find(e,n.valueType())(r.value),n})),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e,!0)))})})),wv="unequal",Av=Ii(wv,["typed","config","equalScalar","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:r,equalScalar:n,matrix:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=il({typed:t}),u=Fy({typed:t,SparseMatrix:s}),c=al({typed:t,DenseMatrix:a}),h=cl({typed:t,matrix:i,concat:o});return t(wv,Cv({typed:t,equalScalar:n}),h({elop:function(e,t){return!n(e,t)},SS:u,DS:l,Ss:c}))})),Cv=Ii(wv,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:r}=e;return t(wv,{"any, any":function(e,t){return null===e?null!==t:null===t?null!==e:void 0===e?void 0!==t:void 0===t?void 0!==e:!r(e,t)}})})),Ev=Ii("xor",["typed","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:r,DenseMatrix:n,concat:i,SparseMatrix:a}=e,o=il({typed:t}),s=Fy({typed:t,SparseMatrix:a}),l=al({typed:t,DenseMatrix:n}),u=cl({typed:t,matrix:r,concat:i});return t("xor",{"number, number":fl,"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)!=(0!==t.re||0!==t.im)},"bigint, bigint":fl,"BigNumber, BigNumber":function(e,t){return(!e.isZero()&&!e.isNaN())!=(!t.isZero()&&!t.isNaN())},"Unit, Unit":t.referToSelf((e=>(t,r)=>e(t.value||0,r.value||0)))},u({SS:s,DS:o,Ss:l}))})),Mv=Ii("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],(e=>{var{typed:t,matrix:r,addScalar:n,equalScalar:i,DenseMatrix:a,SparseMatrix:o,concat:s}=e,l=mu({typed:t}),u=fu({typed:t,equalScalar:i}),c=du({typed:t,DenseMatrix:a}),h=cl({typed:t,matrix:r,concat:s});return t("add",{"any, any":n,"any, any, ...any":t.referToSelf((e=>(t,r,n)=>{for(var i=e(t,r),a=0;a<n.length;a++)i=e(i,n[a]);return i}))},h({elop:n,DS:l,SS:u,Ss:c}))})),Sv="atan2",Dv=Ii(Sv,["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,BigNumber:i,DenseMatrix:a,concat:o}=e,s=vl({typed:t,equalScalar:n}),l=il({typed:t}),u=zy({typed:t,equalScalar:n}),c=xl({typed:t,equalScalar:n}),h=al({typed:t,DenseMatrix:a}),p=cl({typed:t,matrix:r,concat:o});return t(Sv,{"number, number":Math.atan2,"BigNumber, BigNumber":(e,t)=>i.atan2(e,t)},p({scalar:"number | BigNumber",SS:u,DS:l,SD:s,Ss:c,sS:h}))})),Tv="bitXor",Nv=Ii(Tv,["typed","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:r,DenseMatrix:n,concat:i,SparseMatrix:a}=e,o=il({typed:t}),s=Fy({typed:t,SparseMatrix:a}),l=al({typed:t,DenseMatrix:n}),u=cl({typed:t,matrix:r,concat:i});return t(Tv,{"number, number":Xl,"BigNumber, BigNumber":Ul,"bigint, bigint":(e,t)=>e^t},u({SS:s,DS:o,Ss:l}))})),Iv="cbrt",Pv=Ii(Iv,["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],(e=>{var{config:t,typed:r,isNegative:n,unaryMinus:i,matrix:a,Complex:o,BigNumber:s,Fraction:l}=e;return r(Iv,{number:Xd,Complex:u,"Complex, boolean":u,BigNumber:function(e){return e.cbrt()},Unit:function(e){if(e.value&&Zn(e.value)){var t=e.clone();return t.value=1,(t=t.pow(1/3)).value=u(e.value),t}var r,a=n(e.value);a&&(e.value=i(e.value)),r=Un(e.value)?new s(1).div(3):$n(e.value)?new l(1,3):1/3;var o=e.pow(r);return a&&(o.value=i(o.value)),o}});function u(e,r){var n=e.arg()/3,i=e.abs(),s=new o(Xd(i),0).mul(new o(0,n).exp());if(r){var l=[s,new o(Xd(i),0).mul(new o(0,n+2*Math.PI/3).exp()),new o(Xd(i),0).mul(new o(0,n-2*Math.PI/3).exp())];return"Array"===t.matrix?l:a(l)}return s}})),zv="compare",Bv=Ii(zv,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],(e=>{var{typed:t,config:r,equalScalar:n,matrix:i,BigNumber:a,Fraction:o,DenseMatrix:s,concat:l}=e,u=il({typed:t}),c=ol({typed:t,equalScalar:n}),h=al({typed:t,DenseMatrix:s}),p=cl({typed:t,matrix:i,concat:l}),d=hm({typed:t});return t(zv,kv({typed:t,config:r}),{"boolean, boolean":function(e,t){return e===t?0:e>t?1:-1},"BigNumber, BigNumber":function(e,t){return cm(e,t,r.relTol,r.absTol)?new a(0):new a(e.cmp(t))},"bigint, bigint":function(e,t){return e===t?0n:e>t?1n:-1n},"Fraction, Fraction":function(e,t){return new o(e.compare(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,p({SS:c,DS:u,Ss:h}))})),kv=Ii(zv,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(zv,{"number, number":function(e,t){return Ji(e,t,r.relTol,r.absTol)?0:e>t?1:-1}})})),Fv="compareText",Rv=["typed","matrix","concat"];ga.signature="any, any";var Ov=Ii(Fv,Rv,(e=>{var{typed:t,matrix:r,concat:n}=e,i=cl({typed:t,matrix:r,concat:n});return t(Fv,ga,i({elop:ga,Ds:!0}))})),Lv="count",qv=Ii(Lv,["typed","size","prod"],(e=>{var{typed:t,size:r,prod:n}=e;return t(Lv,{string:function(e){return e.length},"Matrix | Array":function(e){return n(r(e))}})})),jv="deepEqual",Uv=Ii(jv,["typed","equal"],(e=>{var{typed:t,equal:r}=e;return t(jv,{"any, any":function(e,t){return n(e.valueOf(),t.valueOf())}});function n(e,t){if(Array.isArray(e)){if(Array.isArray(t)){var i=e.length;if(i!==t.length)return!1;for(var a=0;a<i;a++)if(!n(e[a],t[a]))return!1;return!0}return!1}return!Array.isArray(t)&&r(e,t)}})),Vv="divideScalar",Zv=Ii(Vv,["typed","numeric"],(e=>{var{typed:t,numeric:r}=e;return t(Vv,{"number, number":function(e,t){return e/t},"Complex, Complex":function(e,t){return e.div(t)},"BigNumber, BigNumber":function(e,t){return e.div(t)},"bigint, bigint":function(e,t){return e/t},"Fraction, Fraction":function(e,t){return e.div(t)},"Unit, number | Complex | Fraction | BigNumber | Unit":(e,t)=>e.divide(t),"number | Fraction | Complex | BigNumber, Unit":(e,t)=>t.divideInto(e)})})),$v="dotDivide",Gv=Ii($v,["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:r,equalScalar:n,divideScalar:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=vl({typed:t,equalScalar:n}),u=il({typed:t}),c=Fy({typed:t,SparseMatrix:s}),h=xl({typed:t,equalScalar:n}),p=al({typed:t,DenseMatrix:a}),d=cl({typed:t,matrix:r,concat:o});return t($v,d({elop:i,SS:c,DS:u,SD:l,Ss:h,sS:p}))})),Hv="equalText",Wv=Ii(Hv,["typed","compareText","isZero"],(e=>{var{typed:t,compareText:r,isZero:n}=e;return t(Hv,{"any, any":function(e,t){return n(r(e,t))}})})),Xv="floor",Yv=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],Kv=new Nh(10),Jv=Ii(Xv,["typed","config","round"],(e=>{var{typed:t,config:r,round:n}=e;function i(e){var t=Math.floor(e),i=n(e);return t===i?t:Ji(e,i,r.relTol,r.absTol)&&!Ji(e,t,r.relTol,r.absTol)?i:t}return t(Xv,{number:i,"number, number":function(e,t){if(!Fi(t))throw new RangeError("number of decimals in function floor must be an integer");if(t<0||t>15)throw new RangeError("number of decimals in floor number must be in range 0 - 15");var r=10**t;return i(e*r)/r}})})),Qv=Ii(Xv,Yv,(e=>{var{typed:t,config:r,round:n,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s}=e,l=xl({typed:t,equalScalar:a}),u=al({typed:t,DenseMatrix:s}),c=ll({typed:t}),h=Jv({typed:t,config:r,round:n});function p(e){var t=(e,t)=>cm(e,t,r.relTol,r.absTol),i=e.floor(),a=n(e);return i.eq(a)?i:t(e,a)&&!t(e,i)?a:i}return t("floor",{number:h.signatures.number,"number,number":h.signatures["number,number"],Complex:function(e){return e.floor()},"Complex, number":function(e,t){return e.floor(t)},"Complex, BigNumber":function(e,t){return e.floor(t.toNumber())},BigNumber:p,"BigNumber, BigNumber":function(e,t){var r=Kv.pow(t);return p(e.mul(r)).div(r)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.floor()},"Fraction, number":function(e,t){return e.floor(t)},"Fraction, BigNumber":function(e,t){return e.floor(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,r,n){var i=t.toNumeric(n);return n.multiply(e(i,r))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,r,n)=>e(t,r.toNumber(),n))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,r,n)=>Xo(t,(t=>e(t,r,n)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,r)=>e(t,0,r))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e,!0))),"Array, number | BigNumber":t.referToSelf((e=>(t,r)=>Xo(t,(t=>e(t,r)),!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>l(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>c(t,r,e,!1))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,r)=>c(i(r),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,r)=>a(t,0)?o(r.size(),r.storage()):"dense"===r.storage()?c(r,t,e,!0):u(r,t,e,!0)))})})),ex=Ii("mod",["typed","config","round","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,config:r,round:n,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s,concat:l}=e,u=Qv({typed:t,config:r,round:n,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s}),c=vl({typed:t,equalScalar:a}),h=il({typed:t}),p=ol({typed:t,equalScalar:a}),d=xl({typed:t,equalScalar:a}),f=al({typed:t,DenseMatrix:s});return t("mod",{"number, number":function(e,t){return 0===t?e:e-t*u(e/t)},"BigNumber, BigNumber":function(e,t){return t.isZero()?e:e.sub(t.mul(u(e.div(t))))},"bigint, bigint":function(e,t){if(0n===t)return e;if(e<0){var r=e%t;return 0n===r?r:r+t}return e%t},"Fraction, Fraction":function(e,t){return t.equals(0)?e:e.sub(t.mul(u(e.div(t))))}},cl({typed:t,matrix:i,concat:l})({SS:p,DS:h,SD:c,Ss:d,sS:f}))})),tx=["typed","config","round","matrix","equalScalar","zeros","BigNumber","DenseMatrix","concat"],rx="number | BigNumber | Fraction | Matrix | Array",nx="".concat(rx,", ").concat(rx,", ...").concat(rx);function ix(e){return!e.some((e=>Array.isArray(e)))}var ax=Ii("gcd",tx,(e=>{var{typed:t,matrix:r,config:n,round:i,equalScalar:a,zeros:o,BigNumber:s,DenseMatrix:l,concat:u}=e,c=ex({typed:t,config:n,round:i,matrix:r,equalScalar:a,zeros:o,DenseMatrix:l,concat:u}),h=mu({typed:t}),p=fu({typed:t,equalScalar:a}),d=du({typed:t,DenseMatrix:l});return t("gcd",{"number, number":function(e,t){if(!Fi(e)||!Fi(t))throw new Error("Parameters in function gcd must be integer numbers");for(var r;0!==t;)r=c(e,t),e=t,t=r;return e<0?-e:e},"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function gcd must be integer numbers");for(var r=new s(0);!t.isZero();){var n=c(e,t);e=t,t=n}return e.lt(r)?e.neg():e},"Fraction, Fraction":(e,t)=>e.gcd(t)},cl({typed:t,matrix:r,concat:u})({SS:p,DS:h,Ss:d}),{[nx]:t.referToSelf((e=>(t,r,n)=>{for(var i=e(t,r),a=0;a<n.length;a++)i=e(i,n[a]);return i})),Array:t.referToSelf((e=>t=>{if(1===t.length&&Array.isArray(t[0])&&ix(t[0]))return e(...t[0]);if(ix(t))return e(...t);throw new sv("gcd() supports only 1d matrices!")})),Matrix:t.referToSelf((e=>t=>e(t.toArray())))})})),ox="hasNumericValue",sx=Ii(ox,["typed","isNumeric"],(e=>{var{typed:t,isNumeric:r}=e;return t(ox,{boolean:()=>!0,string:function(e){return e.trim().length>0&&!isNaN(Number(e))},any:function(e){return r(e)}})})),lx="hypot",ux=Ii(lx,["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],(e=>{var{typed:t,abs:r,addScalar:n,divideScalar:i,multiplyScalar:a,sqrt:o,smaller:s,isPositive:l}=e;return t(lx,{"... number | BigNumber":u,Array:u,Matrix:e=>u(Fa(e.toArray(),!0))});function u(e){for(var t=0,u=0,c=0;c<e.length;c++){if(Zn(e[c]))throw new TypeError("Unexpected type of argument to hypot");var h=r(e[c]);s(u,h)?(t=a(t,a(i(u,h),i(u,h))),t=n(t,1),u=h):t=n(t,l(h)?a(i(h,u),i(h,u)):h)}return a(u,o(t))}})),cx=Ii("ImmutableDenseMatrix",["smaller","DenseMatrix"],(e=>{var{smaller:t,DenseMatrix:r}=e;function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!Hn(t))throw new Error("Invalid datatype: "+t);if(Xn(e)||Wn(e)){var i=new r(e,t);this._data=i._data,this._size=i._size,this._datatype=i._datatype,this._min=null,this._max=null}else if(e&&Wn(e.data)&&Wn(e.size))this._data=e.data,this._size=e.size,this._datatype=e.datatype,this._min=void 0!==e.min?e.min:null,this._max=void 0!==e.max?e.max:null;else{if(e)throw new TypeError("Unsupported type of data ("+Ti(e)+")");this._data=[],this._size=[0],this._datatype=t,this._min=null,this._max=null}}return n.prototype=new r,n.prototype.type="ImmutableDenseMatrix",n.prototype.isImmutableDenseMatrix=!0,n.prototype.subset=function(e){switch(arguments.length){case 1:var t=r.prototype.subset.call(this,e);return Xn(t)?new n({data:t._data,size:t._size,datatype:t._datatype}):t;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},n.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},n.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},n.prototype.clone=function(){return new n({data:Mn(this._data),size:Mn(this._size),datatype:this._datatype})},n.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.fromJSON=function(e){return new n(e)},n.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},n.prototype.min=function(){if(null===this._min){var e=null;this.forEach((function(r){(null===e||t(r,e))&&(e=r)})),this._min=null!==e?e:void 0}return this._min},n.prototype.max=function(){if(null===this._max){var e=null;this.forEach((function(r){(null===e||t(e,r))&&(e=r)})),this._max=null!==e?e:void 0}return this._max},n}),{isClass:!0}),hx=Ii("Index",["ImmutableDenseMatrix","getMatrixDataType"],(e=>{var{ImmutableDenseMatrix:t,getMatrixDataType:r}=e;function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var t=0,a=arguments.length;t<a;t++){var o=arguments[t],s=Wn(o),l=Xn(o),u=typeof o,c=null;if(Qn(o))this._dimensions.push(o),this._isScalar=!1;else if(s||l){var h=void 0;"boolean"===r(o)?(s&&(h=i(px(o).valueOf())),l&&(h=i(px(o._data).valueOf())),c=o.valueOf().length):h=i(o.valueOf()),this._dimensions.push(h);var p=h.size();1===p.length&&1===p[0]&&null===c||(this._isScalar=!1)}else if("number"===u)this._dimensions.push(i([o]));else if("bigint"===u)this._dimensions.push(i([Number(o)]));else{if("string"!==u)throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");this._dimensions.push(o)}this._sourceSize.push(c)}}function i(e){for(var r=0,n=e.length;r<n;r++)if("number"!=typeof e[r]||!Fi(e[r]))throw new TypeError("Index parameters must be positive integer numbers");return new t(e)}return n.prototype.type="Index",n.prototype.isIndex=!0,n.prototype.clone=function(){var e=new n;return e._dimensions=Mn(this._dimensions),e._isScalar=this._isScalar,e._sourceSize=this._sourceSize,e},n.create=function(e){var t=new n;return n.apply(t,e),t},n.prototype.size=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];e[t]="string"==typeof n?1:n.size()[0]}return e},n.prototype.max=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];e[t]="string"==typeof n?n:n.max()}return e},n.prototype.min=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];e[t]="string"==typeof n?n:n.min()}return e},n.prototype.forEach=function(e){for(var t=0,r=this._dimensions.length;t<r;t++)e(this._dimensions[t],t,this)},n.prototype.dimension=function(e){return"number"!=typeof e?null:this._dimensions[e]||null},n.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},n.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},n.prototype.isScalar=function(){return this._isScalar},n.prototype.toArray=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];e.push("string"==typeof n?n:n.toArray())}return e},n.prototype.valueOf=n.prototype.toArray,n.prototype.toString=function(){for(var e=[],t=0,r=this._dimensions.length;t<r;t++){var n=this._dimensions[t];"string"==typeof n?e.push(JSON.stringify(n)):e.push(n.toString())}return"["+e.join(", ")+"]"},n.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},n.fromJSON=function(e){return n.create(e.dimensions)},n}),{isClass:!0});function px(e){var t=[];return e.forEach(((e,r)=>{e&&t.push(r)})),t}var dx="larger",fx=Ii(dx,["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:r,bignumber:n,matrix:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=il({typed:t}),u=Fy({typed:t,SparseMatrix:s}),c=al({typed:t,DenseMatrix:a}),h=cl({typed:t,matrix:i,concat:o}),p=hm({typed:t});function d(e,t){return e.gt(t)&&!cm(e,t,r.relTol,r.absTol)}return t(dx,mx({typed:t,config:r}),{"boolean, boolean":(e,t)=>e>t,"BigNumber, BigNumber":d,"bigint, bigint":(e,t)=>e>t,"Fraction, Fraction":(e,t)=>1===e.compare(t),"Fraction, BigNumber":function(e,t){return d(n(e),t)},"BigNumber, Fraction":function(e,t){return d(e,n(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},p,h({SS:u,DS:l,Ss:c}))})),mx=Ii(dx,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(dx,{"number, number":function(e,t){return e>t&&!Ji(e,t,r.relTol,r.absTol)}})})),gx=["config","typed","typeOf","divideScalar","Complex"],yx=Math.log(16),vx=Ii("log",gx,(e=>{var{typed:t,typeOf:r,config:n,divideScalar:i,Complex:a}=e;function o(e){return e.log()}function s(e){return o(new a(e,0))}return t("log",{number:function(e){return e>=0||n.predictable?ef(e):s(e)},bigint:Km(yx,ef,n,s),Complex:o,BigNumber:function(e){return!e.isNegative()||n.predictable?e.ln():s(e.toNumber())},"any, any":t.referToSelf((e=>(t,n)=>{if("Fraction"===r(t)&&"Fraction"===r(n)){var a=t.log(n);if(null!==a)return a}return i(e(t),e(n))}))})}));function xx(e){var{DenseMatrix:t}=e;return function(e,r,n){var i=e.size();if(2!==i.length)throw new RangeError("Matrix must be two dimensional (size: "+ha(i)+")");var a=i[0];if(a!==i[1])throw new RangeError("Matrix must be square (size: "+ha(i)+")");var o=[];if(Xn(r)){var s=r.size(),l=r._data;if(1===s.length){if(s[0]!==a)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var u=0;u<a;u++)o[u]=[l[u]];return new t({data:o,size:[a,1],datatype:r._datatype})}if(2===s.length){if(s[0]!==a||1!==s[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(Kn(r)){if(n){o=[];for(var c=0;c<a;c++)o[c]=[l[c][0]];return new t({data:o,size:[a,1],datatype:r._datatype})}return r}if(Jn(r)){for(var h=0;h<a;h++)o[h]=[0];for(var p=r._values,d=r._index,f=r._ptr,m=f[1],g=f[0];g<m;g++)o[d[g]][0]=p[g];return new t({data:o,size:[a,1],datatype:r._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(Wn(r)){var y=ba(r);if(1===y.length){if(y[0]!==a)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var v=0;v<a;v++)o[v]=[r[v]];return new t({data:o,size:[a,1]})}if(2===y.length){if(y[0]!==a||1!==y[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var x=0;x<a;x++)o[x]=[r[x][0]];return new t({data:o,size:[a,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var _x="lsolve",bx=Ii(_x,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=xx({DenseMatrix:s});return t(_x,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var r=(t=l(e,t,!0))._data,u=e._size[0],c=e._size[1],h=e._values,p=e._index,d=e._ptr,f=[],m=0;m<c;m++){var g=r[m][0]||0;if(o(g,0))f[m]=[0];else{for(var y=0,v=[],x=[],_=d[m],b=d[m+1],w=_;w<b;w++){var A=p[w];A===m?y=h[w]:A>m&&(v.push(h[w]),x.push(A))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var C=n(g,y),E=0,M=x.length;E<M;E++){var S=x[E];r[S]=[a(r[S][0]||0,i(C,v[E]))]}f[m]=[C]}}return new s({data:f,size:[u,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return u(e,t)},"Array, Array | Matrix":function(e,t){return u(r(e),t).valueOf()}});function u(e,t){for(var r=(t=l(e,t,!0))._data,u=e._size[0],c=e._size[1],h=[],p=e._data,d=0;d<c;d++){var f=r[d][0]||0,m=void 0;if(o(f,0))m=0;else{var g=p[d][d];if(o(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=n(f,g);for(var y=d+1;y<u;y++)r[y]=[a(r[y][0]||0,i(m,p[y][d]))]}h[d]=[m]}return new s({data:h,size:[u,1]})}})),wx="matrixFromColumns",Ax=Ii(wx,["typed","matrix","flatten","size"],(e=>{var{typed:t,matrix:r,flatten:n,size:i}=e;return t(wx,{"...Array":function(e){return a(e)},"...Matrix":function(e){return r(a(e.map((e=>e.toArray()))))}});function a(e){if(0===e.length)throw new TypeError("At least one column is needed to construct a matrix.");for(var t=o(e[0]),r=[],i=0;i<t;i++)r[i]=[];for(var a of e){var s=o(a);if(s!==t)throw new TypeError("The vectors had different length: "+(0|t)+" ≠ "+(0|s));for(var l=n(a),u=0;u<t;u++)r[u].push(l[u])}return r}function o(e){var t=i(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),Cx="nthRoots",Ex=Ii(Cx,["config","typed","divideScalar","Complex"],(e=>{var{typed:t,config:r,divideScalar:n,Complex:i}=e,a=[function(e){return new i(e,0)},function(e){return new i(0,e)},function(e){return new i(-e,0)},function(e){return new i(0,-e)}];function o(e,t){if(t<0)throw new Error("Root must be greater than zero");if(0===t)throw new Error("Root must be non-zero");if(t%1!=0)throw new Error("Root must be an integer");if(0===e||0===e.abs())return[new i(0,0)];var r,n="number"==typeof e;(n||0===e.re||0===e.im)&&(r=n?2*+(e<0):0===e.im?2*+(e.re<0):2*+(e.im<0)+1);for(var o=e.arg(),s=e.abs(),l=[],u=Math.pow(s,1/t),c=0;c<t;c++){var h=(r+4*c)/t;h!==Math.round(h)?l.push(new i({r:u,phi:(o+2*Math.PI*c)/t})):l.push(a[h%4](u))}return l}return t(Cx,{Complex:function(e){return o(e,2)},"Complex, number":o})})),Mx="partitionSelect",Sx=Ii(Mx,["typed","isNumeric","isNaN","compare"],(e=>{var{typed:t,isNumeric:r,isNaN:n,compare:i}=e,a=i,o=(e,t)=>-i(e,t);return t(Mx,{"Array | Matrix, number":function(e,t){return s(e,t,a)},"Array | Matrix, number, string":function(e,t,r){if("asc"===r)return s(e,t,a);if("desc"===r)return s(e,t,o);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":s});function s(e,t,r){if(!Fi(t)||t<0)throw new Error("k must be a non-negative integer");if(Xn(e)){if(e.size().length>1)throw new Error("Only one dimensional matrices supported");return l(e.valueOf(),t,r)}if(Array.isArray(e))return l(e,t,r)}function l(e,t,i){if(t>=e.length)throw new Error("k out of bounds");for(var a=0;a<e.length;a++)if(r(e[a])&&n(e[a]))return e[a];for(var o=0,s=e.length-1;o<s;){for(var l=o,u=s,c=e[Math.floor(Math.random()*(s-o+1))+o];l<u;)if(i(e[l],c)>=0){var h=e[u];e[u]=e[l],e[l]=h,--u}else++l;i(e[l],c)>0&&--l,t<=l?s=l:o=l+1}return e[t]}})),Dx=Ii("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],(e=>{var{typed:t,matrix:r,zeros:n,identity:i,isZero:a,equal:o,sign:s,sqrt:l,conj:u,unaryMinus:c,addScalar:h,divideScalar:p,multiplyScalar:d,subtractScalar:f,complex:m}=e;return An(t("qr",{DenseMatrix:function(e){return y(e)},SparseMatrix:function(e){return function(){throw new Error("qr not implemented for sparse matrices yet")}()},Array:function(e){var t=y(r(e));return{Q:t.Q.valueOf(),R:t.R.valueOf()}}}),{_denseQRimpl:g});function g(e){var t,r,m,g=e._size[0],y=e._size[1],v=i([g],"dense"),x=v._data,_=e.clone(),b=_._data,w=n([g],"");for(m=0;m<Math.min(y,g);++m){var A=b[m][m],C=c(o(A,0)?1:s(A)),E=u(C),M=0;for(t=m;t<g;t++)M=h(M,d(b[t][m],u(b[t][m])));var S=d(C,l(M));if(!a(S)){var D=f(A,S);for(w[m]=1,t=m+1;t<g;t++)w[t]=p(b[t][m],D);var T=c(u(p(D,S))),N=void 0;for(r=m;r<y;r++){for(N=0,t=m;t<g;t++)N=h(N,d(u(w[t]),b[t][r]));for(N=d(N,T),t=m;t<g;t++)b[t][r]=d(f(b[t][r],d(w[t],N)),E)}for(t=0;t<g;t++){for(N=0,r=m;r<g;r++)N=h(N,d(x[t][r],w[r]));for(N=d(N,T),r=m;r<g;++r)x[t][r]=p(f(x[t][r],d(N,u(w[r]))),E)}}}return{Q:v,R:_,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function y(e){var t=g(e),r=t.R._data;if(e._data.length>0)for(var n="Complex"===r[0][0].type?m(0):0,i=0;i<r.length;++i)for(var a=0;a<i&&a<(r[0]||[]).length;++a)r[i][a]=n;return t}})),Tx="rightLogShift",Nx=Ii(Tx,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,zeros:i,DenseMatrix:a,concat:o}=e,s=mu({typed:t}),l=vl({typed:t,equalScalar:n}),u=Yy({typed:t,equalScalar:n}),c=du({typed:t,DenseMatrix:a}),h=xl({typed:t,equalScalar:n}),p=ll({typed:t}),d=cl({typed:t,matrix:r,concat:o}),f=Ky({typed:t,matrix:r});return t(Tx,{"number, number":Jl,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():h(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>n(r,0)?t.clone():p(t,r,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):c(r,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,r)=>n(t,0)?i(r.size(),r.storage()):p(r,t,e,!0)))},f,d({SS:u,DS:s,SD:l}))})),Ix="smallerEq",Px=Ii(Ix,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:r,matrix:n,DenseMatrix:i,concat:a,SparseMatrix:o}=e,s=il({typed:t}),l=Fy({typed:t,SparseMatrix:o}),u=al({typed:t,DenseMatrix:i}),c=cl({typed:t,matrix:n,concat:a}),h=hm({typed:t});return t(Ix,zx({typed:t,config:r}),{"boolean, boolean":(e,t)=>e<=t,"BigNumber, BigNumber":function(e,t){return e.lte(t)||cm(e,t,r.relTol,r.absTol)},"bigint, bigint":(e,t)=>e<=t,"Fraction, Fraction":(e,t)=>1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,c({SS:l,DS:s,Ss:u}))})),zx=Ii(Ix,["typed","config"],(e=>{var{typed:t,config:r}=e;return t(Ix,{"number, number":function(e,t){return e<=t||Ji(e,t,r.relTol,r.absTol)}})})),Bx="subtract",kx=Ii(Bx,["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,subtractScalar:i,unaryMinus:a,DenseMatrix:o,concat:s}=e,l=mu({typed:t}),u=il({typed:t}),c=ol({typed:t,equalScalar:n}),h=du({typed:t,DenseMatrix:o}),p=al({typed:t,DenseMatrix:o}),d=cl({typed:t,matrix:r,concat:s});return t(Bx,{"any, any":i},d({elop:i,SS:c,DS:l,SD:u,Ss:p,sS:h}))})),Fx=Ii("trace",["typed","matrix","add"],(e=>{var{typed:t,matrix:r,add:n}=e;return t("trace",{Array:function(e){return i(r(e))},SparseMatrix:function(e){var t=e._values,r=e._index,i=e._ptr,a=e._size,o=a[0],s=a[1];if(o===s){var l=0;if(t.length>0)for(var u=0;u<s;u++)for(var c=i[u],h=i[u+1],p=c;p<h;p++){var d=r[p];if(d===u){l=n(l,t[p]);break}if(d>u)break}return l}throw new RangeError("Matrix must be square (size: "+ha(a)+")")},DenseMatrix:i,any:Mn});function i(e){var t=e._size,r=e._data;switch(t.length){case 1:if(1===t[0])return Mn(r[0]);throw new RangeError("Matrix must be square (size: "+ha(t)+")");case 2:var i=t[0];if(i===t[1]){for(var a=0,o=0;o<i;o++)a=n(a,r[o][o]);return a}throw new RangeError("Matrix must be square (size: "+ha(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+ha(t)+")")}}})),Rx="usolve",Ox=Ii(Rx,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=xx({DenseMatrix:s});return t(Rx,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var r=(t=l(e,t,!0))._data,u=e._size[0],c=e._size[1],h=e._values,p=e._index,d=e._ptr,f=[],m=c-1;m>=0;m--){var g=r[m][0]||0;if(o(g,0))f[m]=[0];else{for(var y=0,v=[],x=[],_=d[m],b=d[m+1]-1;b>=_;b--){var w=p[b];w===m?y=h[b]:w<m&&(v.push(h[b]),x.push(w))}if(o(y,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var A=n(g,y),C=0,E=x.length;C<E;C++){var M=x[C];r[M]=[a(r[M][0],i(A,v[C]))]}f[m]=[A]}}return new s({data:f,size:[u,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return u(e,t)},"Array, Array | Matrix":function(e,t){return u(r(e),t).valueOf()}});function u(e,t){for(var r=(t=l(e,t,!0))._data,u=e._size[0],c=e._size[1],h=[],p=e._data,d=c-1;d>=0;d--){var f=r[d][0]||0,m=void 0;if(o(f,0))m=0;else{var g=p[d][d];if(o(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=n(f,g);for(var y=d-1;y>=0;y--)r[y]=[a(r[y][0]||0,i(m,p[y][d]))]}h[d]=[m]}return new s({data:h,size:[u,1]})}})),Lx="catalan",qx=Ii(Lx,["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],(e=>{var{typed:t,addScalar:r,divideScalar:n,multiplyScalar:i,combinations:a,isNegative:o,isInteger:s}=e;return t(Lx,{"number | BigNumber":function(e){if(!s(e)||o(e))throw new TypeError("Non-negative integer value expected in function catalan");return n(a(i(e,2),e),r(e,1))}})})),jx=r(1880),Ux="compareNatural",Vx=Ii(Ux,["typed","compare"],(e=>{var{typed:t,compare:r}=e,n=r.signatures["boolean,boolean"];return t(Ux,{"any, any":function e(t,o){var s,l=Ti(t),u=Ti(o);if(!("number"!==l&&"BigNumber"!==l&&"Fraction"!==l||"number"!==u&&"BigNumber"!==u&&"Fraction"!==u))return"0"!==(s=r(t,o)).toString()?s>0?1:-1:jx(l,u);var c=["Array","DenseMatrix","SparseMatrix"];if(c.includes(l)||c.includes(u))return 0!==(s=i(e,t,o))?s:jx(l,u);if(l!==u)return jx(l,u);if("Complex"===l)return function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0}(t,o);if("Unit"===l)return t.equalBase(o)?e(t.value,o.value):a(e,t.formatUnits(),o.formatUnits());if("boolean"===l)return n(t,o);if("string"===l)return jx(t,o);if("Object"===l)return function(e,t,r){var n=Object.keys(t),i=Object.keys(r);n.sort(jx),i.sort(jx);var o=a(e,n,i);if(0!==o)return o;for(var s=0;s<n.length;s++){var l=e(t[n[s]],r[i[s]]);if(0!==l)return l}return 0}(e,t,o);if("null"===l)return 0;if("undefined"===l)return 0;throw new TypeError('Unsupported type of value "'+l+'"')}});function i(e,t,r){return Jn(t)&&Jn(r)?a(e,t.toJSON().values,r.toJSON().values):Jn(t)?i(e,t.toArray(),r):Jn(r)?i(e,t,r.toArray()):Kn(t)?i(e,t.toJSON().data,r):Kn(r)?i(e,t,r.toJSON().data):Array.isArray(t)?Array.isArray(r)?a(e,t,r):i(e,t,[r]):i(e,[t],r)}function a(e,t,r){for(var n=0,i=Math.min(t.length,r.length);n<i;n++){var a=e(t[n],r[n]);if(0!==a)return a}return t.length>r.length?1:t.length<r.length?-1:0}})),Zx="composition",$x=Ii(Zx,["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],(e=>{var{typed:t,addScalar:r,combinations:n,isPositive:i,isNegative:a,isInteger:o,larger:s}=e;return t(Zx,{"number | BigNumber, number | BigNumber":function(e,t){if(!(o(e)&&i(e)&&o(t)&&i(t)))throw new TypeError("Positive integer value expected in function composition");if(s(t,e))throw new TypeError("k must be less than or equal to n in function composition");return n(r(e,-1),r(t,-1))}})})),Gx="distance",Hx=Ii(Gx,["typed","addScalar","subtractScalar","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],(e=>{var{typed:t,addScalar:r,subtractScalar:n,multiplyScalar:i,divideScalar:a,deepEqual:o,sqrt:s,abs:l}=e;return t(Gx,{"Array, Array, Array":function(e,t,r){if(2===e.length&&2===t.length&&2===r.length){if(!c(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!c(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!c(r))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(o(t,r))throw new TypeError("LinePoint1 should not be same with LinePoint2");var a=n(r[1],t[1]),s=n(t[0],r[0]),l=n(i(r[0],t[1]),i(t[0],r[1]));return m(e[0],e[1],a,s,l)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(e,t,r){if(2===Object.keys(e).length&&2===Object.keys(t).length&&2===Object.keys(r).length){if(!c(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!c(t))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!c(r))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(o(f(t),f(r)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in e&&"pointY"in e&&"lineOnePtX"in t&&"lineOnePtY"in t&&"lineTwoPtX"in r&&"lineTwoPtY"in r){var a=n(r.lineTwoPtY,t.lineOnePtY),s=n(t.lineOnePtX,r.lineTwoPtX),l=n(i(r.lineTwoPtX,t.lineOnePtY),i(t.lineOnePtX,r.lineTwoPtY));return m(e.pointX,e.pointY,a,s,l)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(e,t){if(2===e.length&&3===t.length){if(!c(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!h(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return m(e[0],e[1],t[0],t[1],t[2])}if(3===e.length&&6===t.length){if(!h(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!d(t))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return g(e[0],e[1],e[2],t[0],t[1],t[2],t[3],t[4],t[5])}if(e.length===t.length&&e.length>0){if(!p(e))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!p(t))throw new TypeError("All values of an array should be numbers or BigNumbers");return y(e,t)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(e,t){if(2===Object.keys(e).length&&3===Object.keys(t).length){if(!c(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!h(t))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"xCoeffLine"in t&&"yCoeffLine"in t&&"constant"in t)return m(e.pointX,e.pointY,t.xCoeffLine,t.yCoeffLine,t.constant);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&6===Object.keys(t).length){if(!h(e))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!d(t))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"x0"in t&&"y0"in t&&"z0"in t&&"a"in t&&"b"in t&&"c"in t)return g(e.pointX,e.pointY,e.pointZ,t.x0,t.y0,t.z0,t.a,t.b,t.c);throw new TypeError("Key names do not match")}if(2===Object.keys(e).length&&2===Object.keys(t).length){if(!c(e))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!c(t))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointTwoX"in t&&"pointTwoY"in t)return y([e.pointOneX,e.pointOneY],[t.pointTwoX,t.pointTwoY]);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&3===Object.keys(t).length){if(!h(e))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!h(t))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointOneZ"in e&&"pointTwoX"in t&&"pointTwoY"in t&&"pointTwoZ"in t)return y([e.pointOneX,e.pointOneY,e.pointOneZ],[t.pointTwoX,t.pointTwoY,t.pointTwoZ]);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(e){if(!function(e){if(2===e[0].length&&u(e[0][0])&&u(e[0][1])){if(e.some((e=>2!==e.length||!u(e[0])||!u(e[1]))))return!1}else{if(!(3===e[0].length&&u(e[0][0])&&u(e[0][1])&&u(e[0][2])))return!1;if(e.some((e=>3!==e.length||!u(e[0])||!u(e[1])||!u(e[2]))))return!1}return!0}(e))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return function(e){for(var t=[],r=[],n=[],i=0;i<e.length-1;i++)for(var a=i+1;a<e.length;a++)2===e[0].length?(r=[e[i][0],e[i][1]],n=[e[a][0],e[a][1]]):3===e[0].length&&(r=[e[i][0],e[i][1],e[i][2]],n=[e[a][0],e[a][1],e[a][2]]),t.push(y(r,n));return t}(e)}});function u(e){return"number"==typeof e||Un(e)}function c(e){return e.constructor!==Array&&(e=f(e)),u(e[0])&&u(e[1])}function h(e){return e.constructor!==Array&&(e=f(e)),u(e[0])&&u(e[1])&&u(e[2])}function p(e){return Array.isArray(e)||(e=f(e)),e.every(u)}function d(e){return e.constructor!==Array&&(e=f(e)),u(e[0])&&u(e[1])&&u(e[2])&&u(e[3])&&u(e[4])&&u(e[5])}function f(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;n++)r.push(e[t[n]]);return r}function m(e,t,n,o,u){var c=l(r(r(i(n,e),i(o,t)),u)),h=s(r(i(n,n),i(o,o)));return a(c,h)}function g(e,t,o,l,u,c,h,p,d){var f=[n(i(n(u,t),d),i(n(c,o),p)),n(i(n(c,o),h),i(n(l,e),d)),n(i(n(l,e),p),i(n(u,t),h))];f=s(r(r(i(f[0],f[0]),i(f[1],f[1])),i(f[2],f[2])));var m=s(r(r(i(h,h),i(p,p)),i(d,d)));return a(f,m)}function y(e,t){for(var a=e.length,o=0,l=0,u=0;u<a;u++)l=n(e[u],t[u]),o=r(i(l,l),o);return s(o)}})),Wx=Ii("dot",["typed","addScalar","multiplyScalar","conj","size"],(e=>{var{typed:t,addScalar:r,multiplyScalar:n,conj:i,size:a}=e;return t("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(e,a){var l=o(e,a),u=Xn(e)?e._data:e,c=Xn(e)?e._datatype||e.getDataType():void 0,h=Xn(a)?a._data:a,p=Xn(a)?a._datatype||a.getDataType():void 0,d=2===s(e).length,f=2===s(a).length,m=r,g=n;if(c&&p&&c===p&&"string"==typeof c&&"mixed"!==c){var y=c;m=t.find(r,[y,y]),g=t.find(n,[y,y])}if(!d&&!f){for(var v=g(i(u[0]),h[0]),x=1;x<l;x++)v=m(v,g(i(u[x]),h[x]));return v}if(!d&&f){for(var _=g(i(u[0]),h[0][0]),b=1;b<l;b++)_=m(_,g(i(u[b]),h[b][0]));return _}if(d&&!f){for(var w=g(i(u[0][0]),h[0]),A=1;A<l;A++)w=m(w,g(i(u[A][0]),h[A]));return w}if(d&&f){for(var C=g(i(u[0][0]),h[0][0]),E=1;E<l;E++)C=m(C,g(i(u[E][0]),h[E][0]));return C}},"SparseMatrix, SparseMatrix":function(e,t){o(e,t);for(var i=e._index,a=e._values,s=t._index,l=t._values,u=0,c=r,h=n,p=0,d=0;p<i.length&&d<s.length;){var f=i[p],m=s[d];f<m?p++:f>m?d++:f===m&&(u=c(u,h(a[p],l[d])),p++,d++)}return u}});function o(e,t){var r,n,i=s(e),a=s(t);if(1===i.length)r=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");r=i[0]}if(1===a.length)n=a[0];else{if(2!==a.length||1!==a[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");n=a[0]}if(r!==n)throw new RangeError("Vectors must have equal length ("+r+" != "+n+")");if(0===r)throw new RangeError("Cannot calculate the dot product of empty vectors");return r}function s(e){return Xn(e)?e.size():a(e)}})),Xx=Ii("FibonacciHeap",["smaller","larger"],(e=>{var{smaller:t,larger:r}=e,n=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function a(e,t,r){t.left.right=t.right,t.right.left=t.left,r.degree--,r.child===t&&(r.child=t.right),0===r.degree&&(r.child=null),t.left=e,t.right=e.right,e.right=t,t.right.left=t,t.parent=null,t.mark=!1}function o(e,t){var r=t.parent;r&&(t.mark?(a(e,t,r),o(r)):t.mark=!0)}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(e,r){var n={key:e,value:r,degree:0};if(this._minimum){var i=this._minimum;n.left=i,n.right=i.right,i.right=n,n.right.left=n,t(e,i.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var e=this._minimum;if(null===e)return e;for(var i=this._minimum,a=e.degree,o=e.child;a>0;){var l=o.right;o.left.right=o.right,o.right.left=o.left,o.left=i,o.right=i.right,i.right=o,o.right.left=o,o.parent=null,o=l,a--}return e.left.right=e.right,e.right.left=e.left,i=e===e.right?null:function(e,i){var a,o=Math.floor(Math.log(i)*n)+1,l=new Array(o),u=0,c=e;if(c)for(u++,c=c.right;c!==e;)u++,c=c.right;for(;u>0;){for(var h=c.degree,p=c.right;a=l[h];){if(r(c.key,a.key)){var d=a;a=c,c=d}s(a,c),l[h]=null,h++}l[h]=c,c=p,u--}e=null;for(var f=0;f<o;f++)(a=l[f])&&(e?(a.left.right=a.right,a.right.left=a.left,a.left=e,a.right=e.right,e.right=a,a.right.left=a,t(a.key,e.key)&&(e=a)):e=a);return e}(i=e.right,this._size),this._size--,this._minimum=i,e},i.prototype.remove=function(e){this._minimum=function(e,r){r.key=-1;var n=r.parent;return n&&t(r.key,n.key)&&(a(e,r,n),o(e,n)),t(r.key,e.key)&&(e=r),e}(this._minimum,e),this.extractMinimum()};var s=function(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right=e,e.right.left=e):(t.child=e,e.right=e,e.left=e),t.degree++,e.mark=!1};return i}),{isClass:!0}),Yx="index",Kx=Ii(Yx,["typed","Index"],(e=>{var{typed:t,Index:r}=e;return t(Yx,{"...number | string | BigNumber | Range | Array | Matrix":function(e){var t=e.map((function(e){return Un(e)?e.toNumber():Wn(e)||Xn(e)?e.map((function(e){return Un(e)?e.toNumber():e})):e})),n=new r;return r.apply(n,t),n}})})),Jx="invmod",Qx=Ii(Jx,["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],(e=>{var{typed:t,config:r,BigNumber:n,xgcd:i,equal:a,smaller:o,mod:s,add:l,isInteger:u}=e;return t(Jx,{"number, number":c,"BigNumber, BigNumber":c});function c(e,t){if(!u(e)||!u(t))throw new Error("Parameters in function invmod must be integer numbers");if(e=s(e,t),a(t,0))throw new Error("Divisor must be non zero");var r=i(e,t);r=r.valueOf();var[c,h]=r;return a(c,n(1))?(h=s(h,t),o(h,n(0))&&(h=l(h,t)),h):NaN}})),e_=Ii("lcm",["typed","matrix","equalScalar","concat"],(e=>{var{typed:t,matrix:r,equalScalar:n,concat:i}=e,a=vl({typed:t,equalScalar:n}),o=_l({typed:t,equalScalar:n}),s=xl({typed:t,equalScalar:n}),l=cl({typed:t,matrix:r,concat:i}),u="number | BigNumber | Fraction | Matrix | Array",c={};return c["".concat(u,", ").concat(u,", ...").concat(u)]=t.referToSelf((e=>(t,r,n)=>{for(var i=e(t,r),a=0;a<n.length;a++)i=e(i,n[a]);return i})),t("lcm",{"number, number":Qd,"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero())return e;if(t.isZero())return t;for(var r=e.times(t);!t.isZero();){var n=t;t=e.mod(n),e=n}return r.div(e).abs()},"Fraction, Fraction":(e,t)=>e.lcm(t)},l({SS:o,DS:a,Ss:s}),c)})),t_="log1p",r_=Ii(t_,["typed","config","divideScalar","log","Complex"],(e=>{var{typed:t,config:r,divideScalar:n,log:i,Complex:a}=e;return t(t_,{number:function(e){return e>=-1||r.predictable?ji(e):o(new a(e,0))},Complex:o,BigNumber:function(e){var t=e.plus(1);return!t.isNegative()||r.predictable?t.ln():o(new a(e.toNumber(),0))},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e))),"any, any":t.referToSelf((e=>(t,r)=>n(e(t),i(r))))});function o(e){var t=e.re+1;return new a(Math.log(Math.sqrt(t*t+e.im*e.im)),Math.atan2(e.im,t))}})),n_="lsolveAll",i_=Ii(n_,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=xx({DenseMatrix:s});return t(n_,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var r=[l(e,t,!0)._data.map((e=>e[0]))],u=e._size[0],c=e._size[1],h=e._values,p=e._index,d=e._ptr,f=0;f<c;f++)for(var m=r.length,g=0;g<m;g++){for(var y=r[g],v=[],x=[],_=d[f],b=d[f+1],w=0,A=_;A<b;A++){var C=p[A];C===f?w=h[A]:C>f&&(v.push(h[A]),x.push(C))}if(o(w,0))if(o(y[f],0)){if(0===g){var E=[...y];E[f]=1;for(var M=0,S=x.length;M<S;M++){var D=x[M];E[D]=a(E[D],v[M])}r.push(E)}}else{if(0===g)return[];r.splice(g,1),g-=1,m-=1}else{y[f]=n(y[f],w);for(var T=0,N=x.length;T<N;T++){var I=x[T];y[I]=a(y[I],i(y[f],v[T]))}}}return r.map((e=>new s({data:e.map((e=>[e])),size:[u,1]})))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return u(e,t)},"Array, Array | Matrix":function(e,t){return u(r(e),t).map((e=>e.valueOf()))}});function u(e,t){for(var r=[l(e,t,!0)._data.map((e=>e[0]))],u=e._data,c=e._size[0],h=e._size[1],p=0;p<h;p++)for(var d=r.length,f=0;f<d;f++){var m=r[f];if(o(u[p][p],0))if(o(m[p],0)){if(0===f){var g=[...m];g[p]=1;for(var y=p+1;y<h;y++)g[y]=a(g[y],u[y][p]);r.push(g)}}else{if(0===f)return[];r.splice(f,1),f-=1,d-=1}else{m[p]=n(m[p],u[p][p]);for(var v=p+1;v<h;v++)m[v]=a(m[v],i(m[p],u[v][p]))}}return r.map((e=>new s({data:e.map((e=>[e])),size:[c,1]})))}})),a_="matrixFromRows",o_=Ii(a_,["typed","matrix","flatten","size"],(e=>{var{typed:t,matrix:r,flatten:n,size:i}=e;return t(a_,{"...Array":function(e){return a(e)},"...Matrix":function(e){return r(a(e.map((e=>e.toArray()))))}});function a(e){if(0===e.length)throw new TypeError("At least one row is needed to construct a matrix.");var t=o(e[0]),r=[];for(var i of e){var a=o(i);if(a!==t)throw new TypeError("The vectors had different length: "+(0|t)+" ≠ "+(0|a));r.push(n(i))}return r}function o(e){var t=i(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),s_="multiply",l_=Ii(s_,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(e=>{var{typed:t,matrix:r,addScalar:n,multiplyScalar:i,equalScalar:a,dot:o}=e,s=xl({typed:t,equalScalar:a}),l=ll({typed:t});function u(e,t){switch(e.length){case 1:switch(t.length){case 1:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+e[0]+") must match Matrix rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;case 2:switch(t.length){case 1:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+e[1]+") must match Vector length ("+t[0]+")");break;case 2:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+e[1]+") must match Matrix B rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+e.length+" dimensions)")}}var c=t("_multiplyMatrixVector",{"DenseMatrix, any":function(e,r){var a,o=e._data,s=e._size,l=e._datatype||e.getDataType(),u=r._data,c=r._datatype||r.getDataType(),h=s[0],p=s[1],d=n,f=i;l&&c&&l===c&&"string"==typeof l&&"mixed"!==l&&(a=l,d=t.find(n,[a,a]),f=t.find(i,[a,a]));for(var m=[],g=0;g<h;g++){for(var y=o[g],v=f(y[0],u[0]),x=1;x<p;x++)v=d(v,f(y[x],u[x]));m[g]=v}return e.createDenseMatrix({data:m,size:[h],datatype:l===e._datatype&&c===r._datatype?a:void 0})},"SparseMatrix, any":function(e,r){var o=e._values,s=e._index,l=e._ptr,u=e._datatype||void 0===e._data?e._datatype:e.getDataType();if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c,h=r._data,p=r._datatype||r.getDataType(),d=e._size[0],f=r._size[0],m=[],g=[],y=[],v=n,x=i,_=a,b=0;u&&p&&u===p&&"string"==typeof u&&"mixed"!==u&&(c=u,v=t.find(n,[c,c]),x=t.find(i,[c,c]),_=t.find(a,[c,c]),b=t.convert(0,c));var w=[],A=[];y[0]=0;for(var C=0;C<f;C++){var E=h[C];if(!_(E,b))for(var M=l[C],S=l[C+1],D=M;D<S;D++){var T=s[D];A[T]?w[T]=v(w[T],x(E,o[D])):(A[T]=!0,g.push(T),w[T]=x(E,o[D]))}}for(var N=g.length,I=0;I<N;I++){var P=g[I];m[I]=w[P]}return y[1]=g.length,e.createSparseMatrix({values:m,index:g,ptr:y,size:[d,1],datatype:u===e._datatype&&p===r._datatype?c:void 0})}}),h=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(e,r){var a,o=e._data,s=e._size,l=e._datatype||e.getDataType(),u=r._data,c=r._size,h=r._datatype||r.getDataType(),p=s[0],d=s[1],f=c[1],m=n,g=i;l&&h&&l===h&&"string"==typeof l&&"mixed"!==l&&"mixed"!==l&&(a=l,m=t.find(n,[a,a]),g=t.find(i,[a,a]));for(var y=[],v=0;v<p;v++){var x=o[v];y[v]=[];for(var _=0;_<f;_++){for(var b=g(x[0],u[0][_]),w=1;w<d;w++)b=m(b,g(x[w],u[w][_]));y[v][_]=b}}return e.createDenseMatrix({data:y,size:[p,f],datatype:l===e._datatype&&h===r._datatype?a:void 0})},"DenseMatrix, SparseMatrix":function(e,r){var o=e._data,s=e._size,l=e._datatype||e.getDataType(),u=r._values,c=r._index,h=r._ptr,p=r._size,d=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(!u)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var f,m=s[0],g=p[1],y=n,v=i,x=a,_=0;l&&d&&l===d&&"string"==typeof l&&"mixed"!==l&&(f=l,y=t.find(n,[f,f]),v=t.find(i,[f,f]),x=t.find(a,[f,f]),_=t.convert(0,f));for(var b=[],w=[],A=[],C=r.createSparseMatrix({values:b,index:w,ptr:A,size:[m,g],datatype:l===e._datatype&&d===r._datatype?f:void 0}),E=0;E<g;E++){A[E]=w.length;var M=h[E],S=h[E+1];if(S>M)for(var D=0,T=0;T<m;T++){for(var N=T+1,I=void 0,P=M;P<S;P++){var z=c[P];D!==N?(I=v(o[T][z],u[P]),D=N):I=y(I,v(o[T][z],u[P]))}D!==N||x(I,_)||(w.push(T),b.push(I))}}return A[g]=w.length,C},"SparseMatrix, DenseMatrix":function(e,r){var o=e._values,s=e._index,l=e._ptr,u=e._datatype||void 0===e._data?e._datatype:e.getDataType();if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var c,h=r._data,p=r._datatype||r.getDataType(),d=e._size[0],f=r._size[0],m=r._size[1],g=n,y=i,v=a,x=0;u&&p&&u===p&&"string"==typeof u&&"mixed"!==u&&(c=u,g=t.find(n,[c,c]),y=t.find(i,[c,c]),v=t.find(a,[c,c]),x=t.convert(0,c));for(var _=[],b=[],w=[],A=e.createSparseMatrix({values:_,index:b,ptr:w,size:[d,m],datatype:u===e._datatype&&p===r._datatype?c:void 0}),C=[],E=[],M=0;M<m;M++){w[M]=b.length;for(var S=M+1,D=0;D<f;D++){var T=h[D][M];if(!v(T,x))for(var N=l[D],I=l[D+1],P=N;P<I;P++){var z=s[P];E[z]!==S?(E[z]=S,b.push(z),C[z]=y(T,o[P])):C[z]=g(C[z],y(T,o[P]))}}for(var B=w[M],k=b.length,F=B;F<k;F++){var R=b[F];_[F]=C[R]}}return w[m]=b.length,A},"SparseMatrix, SparseMatrix":function(e,r){var a,o=e._values,s=e._index,l=e._ptr,u=e._datatype||void 0===e._data?e._datatype:e.getDataType(),c=r._values,h=r._index,p=r._ptr,d=r._datatype||void 0===r._data?r._datatype:r.getDataType(),f=e._size[0],m=r._size[1],g=o&&c,y=n,v=i;u&&d&&u===d&&"string"==typeof u&&"mixed"!==u&&(a=u,y=t.find(n,[a,a]),v=t.find(i,[a,a]));for(var x,_,b,w,A,C,E,M,S=g?[]:void 0,D=[],T=[],N=e.createSparseMatrix({values:S,index:D,ptr:T,size:[f,m],datatype:u===e._datatype&&d===r._datatype?a:void 0}),I=g?[]:void 0,P=[],z=0;z<m;z++){T[z]=D.length;var B=z+1;for(A=p[z],C=p[z+1],w=A;w<C;w++)if(M=h[w],g)for(_=l[M],b=l[M+1],x=_;x<b;x++)P[E=s[x]]!==B?(P[E]=B,D.push(E),I[E]=v(c[w],o[x])):I[E]=y(I[E],v(c[w],o[x]));else for(_=l[M],b=l[M+1],x=_;x<b;x++)P[E=s[x]]!==B&&(P[E]=B,D.push(E));if(g)for(var k=T[z],F=D.length,R=k;R<F;R++){var O=D[R];S[R]=I[O]}}return T[m]=D.length,N}});return t(s_,i,{"Array, Array":t.referTo("Matrix, Matrix",(e=>(t,n)=>{u(ba(t),ba(n));var i=e(r(t),r(n));return Xn(i)?i.valueOf():i})),"Matrix, Matrix":function(e,r){var a=e.size(),s=r.size();return u(a,s),1===a.length?1===s.length?function(e,t,r){if(0===r)throw new Error("Cannot multiply two empty vectors");return o(e,t)}(e,r,a[0]):function(e,r){if("dense"!==r.storage())throw new Error("Support for SparseMatrix not implemented");return function(e,r){var a,o=e._data,s=e._size,l=e._datatype||e.getDataType(),u=r._data,c=r._size,h=r._datatype||r.getDataType(),p=s[0],d=c[1],f=n,m=i;l&&h&&l===h&&"string"==typeof l&&"mixed"!==l&&(a=l,f=t.find(n,[a,a]),m=t.find(i,[a,a]));for(var g=[],y=0;y<d;y++){for(var v=m(o[0],u[0][y]),x=1;x<p;x++)v=f(v,m(o[x],u[x][y]));g[y]=v}return e.createDenseMatrix({data:g,size:[d],datatype:l===e._datatype&&h===r._datatype?a:void 0})}(e,r)}(e,r):1===s.length?c(e,r):h(e,r)},"Matrix, Array":t.referTo("Matrix,Matrix",(e=>(t,n)=>e(t,r(n)))),"Array, Matrix":t.referToSelf((e=>(t,n)=>e(r(t,n.storage()),n))),"SparseMatrix, any":function(e,t){return s(e,t,i,!1)},"DenseMatrix, any":function(e,t){return l(e,t,i,!1)},"any, SparseMatrix":function(e,t){return s(t,e,i,!0)},"any, DenseMatrix":function(e,t){return l(t,e,i,!0)},"Array, any":function(e,t){return l(r(e),t,i,!1).valueOf()},"any, Array":function(e,t){return l(r(t),e,i,!0).valueOf()},"any, any":i,"any, any, ...any":t.referToSelf((e=>(t,r,n)=>{for(var i=e(t,r),a=0;a<n.length;a++)i=e(i,n[a]);return i}))})})),u_="setCartesian",c_=Ii(u_,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:o}=e;return t(u_,{"Array | Matrix, Array | Matrix":function(e,t){var s=[];if(0!==n(r(e),new a(0))&&0!==n(r(t),new a(0))){var l=Fa(Array.isArray(e)?e:e.toArray()).sort(i),u=Fa(Array.isArray(t)?t:t.toArray()).sort(i);s=[];for(var c=0;c<l.length;c++)for(var h=0;h<u.length;h++)s.push([l[c],u[h]])}return Array.isArray(e)&&Array.isArray(t)?s:new o(s)}})})),h_="setDistinct",p_=Ii(h_,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:o}=e;return t(h_,{"Array | Matrix":function(e){var t;if(0===n(r(e),new a(0)))t=[];else{var s=Fa(Array.isArray(e)?e:e.toArray()).sort(i);(t=[]).push(s[0]);for(var l=1;l<s.length;l++)0!==i(s[l],s[l-1])&&t.push(s[l])}return Array.isArray(e)?t:new o(t)}})})),d_="setIsSubset",f_=Ii(d_,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:a}=e;return t(d_,{"Array | Matrix, Array | Matrix":function(e,t){if(0===n(r(e),new a(0)))return!0;if(0===n(r(t),new a(0)))return!1;for(var o,s=Ua(Fa(Array.isArray(e)?e:e.toArray()).sort(i)),l=Ua(Fa(Array.isArray(t)?t:t.toArray()).sort(i)),u=0;u<s.length;u++){o=!1;for(var c=0;c<l.length;c++)if(0===i(s[u].value,l[c].value)&&s[u].identifier===l[c].identifier){o=!0;break}if(!1===o)return!1}return!0}})})),m_="setPowerset",g_=Ii(m_,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:a}=e;return t(m_,{"Array | Matrix":function(e){if(0===n(r(e),new a(0)))return[];for(var t=Fa(Array.isArray(e)?e:e.toArray()).sort(i),s=[],l=0;l.toString(2).length<=t.length;)s.push(o(t,l.toString(2).split("").reverse())),l++;return function(e){for(var t=[],r=e.length-1;r>0;r--)for(var n=0;n<r;n++)e[n].length>e[n+1].length&&(t=e[n],e[n]=e[n+1],e[n+1]=t);return e}(s)}});function o(e,t){for(var r=[],n=0;n<t.length;n++)"1"===t[n]&&r.push(e[n]);return r}}));function y_(e,t,r,n,i,a,o){var s=0;for(r[o]=e;s>=0;){var l=r[o+s],u=r[n+l];-1===u?(s--,a[t++]=l):(r[n+l]=r[i+u],r[o+ ++s]=u)}return t}function v_(e){return-e-2}var x_=Ii("csAmd",["add","multiply","transpose"],(e=>{var{add:t,multiply:r,transpose:n}=e;return function(e,o){if(!o||e<=0||e>3)return null;var s=o._size,l=s[0],u=s[1],c=0,h=Math.max(16,10*Math.sqrt(u)),p=function(e,i,a,o,s){var l=n(i);if(1===e&&o===a)return t(i,l);if(2===e){for(var u=l._index,c=l._ptr,h=0,p=0;p<a;p++){var d=c[p];if(c[p]=h,!(c[p+1]-d>s))for(var f=c[p+1];d<f;d++)u[h++]=u[d]}return c[a]=h,i=n(l),r(l,i)}return r(l,i)}(e,o,l,u,h=Math.min(u-2,h));!function(e,t){for(var r=e._values,n=e._index,i=e._ptr,a=e._size[1],o=0,s=0;s<a;s++){var l=i[s];for(i[s]=o;l<i[s+1];l++)t(n[l],s,r?r[l]:1,null)&&(n[o]=n[l],r&&(r[o]=r[l]),o++)}i[a]=o,n.splice(o,n.length-o),r&&r.splice(o,r.length-o)}(p,a);for(var d,f,m,g,y,v,x,_,b,w,A,C,E,M,S,D,T=p._index,N=p._ptr,I=N[u],P=[],z=[],B=u+1,k=2*(u+1),F=3*(u+1),R=4*(u+1),O=5*(u+1),L=6*(u+1),q=7*(u+1),j=P,U=function(e,t,r,n,a,o,s,l,u,c,h,p){for(var d=0;d<e;d++)r[0+d]=t[d+1]-t[d];r[0+e]=0;for(var f=0;f<=e;f++)r[a+f]=-1,o[f]=-1,r[s+f]=-1,r[l+f]=-1,r[u+f]=1,r[c+f]=1,r[h+f]=0,r[p+f]=r[0+f];var m=i(0,0,r,c,e);return r[h+e]=-2,t[e]=-1,r[c+e]=0,m}(u,N,z,0,F,j,k,q,B,L,R,O),V=function(e,t,r,n,i,a,o,s,l,u,c){for(var h=0,p=0;p<e;p++){var d=r[n+p];if(0===d)r[i+p]=-2,h++,t[p]=-1,r[a+p]=0;else if(d>o)r[s+p]=0,r[i+p]=-1,h++,t[p]=v_(e),r[s+e]++;else{var f=r[l+d];-1!==f&&(u[f]=p),r[c+p]=r[l+d],r[l+d]=p}}return h}(u,N,z,O,R,L,h,B,F,j,k),Z=0;V<u;){for(m=-1;Z<u&&-1===(m=z[F+Z]);Z++);-1!==z[k+m]&&(j[z[k+m]]=-1),z[F+Z]=z[k+m];var $=z[R+m],G=z[B+m];V+=G;var H=0;z[B+m]=-G;var W=N[m],X=0===$?W:I,Y=X;for(g=1;g<=$+1;g++){for(g>$?(v=m,x=W,_=z[0+m]-$):(x=N[v=T[W++]],_=z[0+v]),y=1;y<=_;y++)(b=z[B+(d=T[x++])])<=0||(H+=b,z[B+d]=-b,T[Y++]=d,-1!==z[k+d]&&(j[z[k+d]]=j[d]),-1!==j[d]?z[k+j[d]]=z[k+d]:z[F+z[O+d]]=z[k+d]);v!==m&&(N[v]=v_(m),z[L+v]=0)}for(0!==$&&(I=Y),z[O+m]=H,N[m]=X,z[0+m]=Y-X,z[R+m]=-2,U=i(U,c,z,L,u),w=X;w<Y;w++)if(!((A=z[R+(d=T[w])])<=0)){var K=U-(b=-z[B+d]);for(W=N[d],C=N[d]+A-1;W<=C;W++)z[L+(v=T[W])]>=U?z[L+v]-=b:0!==z[L+v]&&(z[L+v]=z[O+v]+K)}for(w=X;w<Y;w++){for(E=(C=N[d=T[w]])+z[R+d]-1,M=C,S=0,D=0,W=C;W<=E;W++)if(0!==z[L+(v=T[W])]){var J=z[L+v]-U;J>0?(D+=J,T[M++]=v,S+=v):(N[v]=v_(m),z[L+v]=0)}z[R+d]=M-C+1;var Q=M,ee=C+z[0+d];for(W=E+1;W<ee;W++){var te=z[B+(f=T[W])];te<=0||(D+=te,T[M++]=f,S+=f)}0===D?(N[d]=v_(m),H-=b=-z[B+d],G+=b,V+=b,z[B+d]=0,z[R+d]=-1):(z[O+d]=Math.min(z[O+d],D),T[M]=T[Q],T[Q]=T[C],T[C]=m,z[0+d]=M-C+1,S=(S<0?-S:S)%u,z[k+d]=z[q+S],z[q+S]=d,j[d]=S)}for(z[O+m]=H,U=i(U+(c=Math.max(c,H)),c,z,L,u),w=X;w<Y;w++)if(!(z[B+(d=T[w])]>=0))for(d=z[q+(S=j[d])],z[q+S]=-1;-1!==d&&-1!==z[k+d];d=z[k+d],U++){for(_=z[0+d],A=z[R+d],W=N[d]+1;W<=N[d]+_-1;W++)z[L+T[W]]=U;var re=d;for(f=z[k+d];-1!==f;){var ne=z[0+f]===_&&z[R+f]===A;for(W=N[f]+1;ne&&W<=N[f]+_-1;W++)z[L+T[W]]!==U&&(ne=0);ne?(N[f]=v_(d),z[B+d]+=z[B+f],z[B+f]=0,z[R+f]=-1,f=z[k+f],z[k+re]=f):(re=f,f=z[k+f])}}for(W=X,w=X;w<Y;w++)(b=-z[B+(d=T[w])])<=0||(z[B+d]=b,D=z[O+d]+H-b,-1!==z[F+(D=Math.min(D,u-V-b))]&&(j[z[F+D]]=d),z[k+d]=z[F+D],j[d]=-1,z[F+D]=d,Z=Math.min(Z,D),z[O+d]=D,T[W++]=d);z[B+m]=G,0===(z[0+m]=W-X)&&(N[m]=-1,z[L+m]=0),0!==$&&(I=W)}for(d=0;d<u;d++)N[d]=v_(N[d]);for(f=0;f<=u;f++)z[F+f]=-1;for(f=u;f>=0;f--)z[B+f]>0||(z[k+f]=z[F+N[f]],z[F+N[f]]=f);for(v=u;v>=0;v--)z[B+v]<=0||-1!==N[v]&&(z[k+v]=z[F+N[v]],z[F+N[v]]=v);for(m=0,d=0;d<=u;d++)-1===N[d]&&(m=y_(d,m,z,F,k,P,L));return P.splice(P.length-1,1),P};function i(e,t,r,n,i){if(e<2||e+t<0){for(var a=0;a<i;a++)0!==r[n+a]&&(r[n+a]=1);e=2}return e}function a(e,t){return e!==t}}));function __(e,t,r,n,i,a,o){var s,l,u,c=0;if(e<=t||r[n+t]<=r[i+e])return-1;r[i+e]=r[n+t];var h=r[a+e];if(r[a+e]=t,-1===h)c=1,u=e;else{for(c=2,u=h;u!==r[o+u];u=r[o+u]);for(s=h;s!==u;s=l)l=r[o+s],r[o+s]=u}return{jleaf:c,q:u}}var b_=Ii("csCounts",["transpose"],(e=>{var{transpose:t}=e;return function(e,r,n,i){if(!e||!r||!n)return null;var a,o,s,l,u,c,h,p=e._size,d=p[0],f=p[1],m=4*f+(i?f+d+1:0),g=[],y=f,v=2*f,x=3*f,_=4*f,b=5*f+1;for(s=0;s<m;s++)g[s]=-1;var w=[],A=t(e),C=A._index,E=A._ptr;for(s=0;s<f;s++)for(w[o=n[s]]=-1===g[x+o]?1:0;-1!==o&&-1===g[x+o];o=r[o])g[x+o]=s;if(i){for(s=0;s<f;s++)g[n[s]]=s;for(a=0;a<d;a++){for(s=f,c=E[a],h=E[a+1],u=c;u<h;u++)s=Math.min(s,g[C[u]]);g[b+a]=g[_+s],g[_+s]=a}}for(a=0;a<f;a++)g[0+a]=a;for(s=0;s<f;s++){for(-1!==r[o=n[s]]&&w[r[o]]--,l=i?g[_+s]:o;-1!==l;l=i?g[b+l]:-1)for(u=E[l];u<E[l+1];u++){var M=__(a=C[u],o,g,x,y,v,0);M.jleaf>=1&&w[o]++,2===M.jleaf&&w[M.q]--}-1!==r[o]&&(g[0+o]=r[o])}for(o=0;o<f;o++)-1!==r[o]&&(w[r[o]]+=w[o]);return w}})),w_=Ii("csSqr",["add","multiply","transpose"],(e=>{var{add:t,multiply:r,transpose:n}=e,i=x_({add:t,multiply:r,transpose:n}),a=b_({transpose:n});return function(e,t,r){var n,o=t._ptr,s=t._size[1],l={};if(l.q=i(e,t),e&&!l.q)return null;if(r){var u=e?function(e,t,r){for(var n=e._values,i=e._index,a=e._ptr,o=e._size,s=e._datatype,l=o[0],u=o[1],c=null,h=[],p=[],d=0,f=0;f<u;f++){p[f]=d;for(var m=r?r[f]:f,g=a[m],y=a[m+1],v=g;v<y;v++){var x=i[v];h[d]=x,c&&(c[d]=n[v]),d++}}return p[u]=d,e.createSparseMatrix({values:c,index:h,ptr:p,size:[l,u],datatype:s})}(t,0,l.q):t;l.parent=function(e){if(!e)return null;var t,r,n=e._index,i=e._ptr,a=e._size,o=a[0],s=a[1],l=[],u=[],c=s;for(t=0;t<o;t++)u[c+t]=-1;for(var h=0;h<s;h++){l[h]=-1,u[0+h]=-1;for(var p=i[h],d=i[h+1],f=p;f<d;f++){var m=n[f];for(t=u[c+m];-1!==t&&t<h;t=r)r=u[0+t],u[0+t]=h,-1===r&&(l[t]=h);u[c+m]=h}}return l}(u);var c=function(e,t){if(!e)return null;var r,n=0,i=[],a=[],o=t,s=2*t;for(r=0;r<t;r++)a[0+r]=-1;for(r=t-1;r>=0;r--)-1!==e[r]&&(a[o+r]=a[0+e[r]],a[0+e[r]]=r);for(r=0;r<t;r++)-1===e[r]&&(n=y_(r,n,a,0,o,i,s));return i}(l.parent,s);if(l.cp=a(u,l.parent,c,1),u&&l.parent&&l.cp&&function(e,t){var r=e._ptr,n=e._index,i=e._size,a=i[0],o=i[1];t.pinv=[],t.leftmost=[];var s,l,u,c,h,p=t.parent,d=t.pinv,f=t.leftmost,m=[],g=a,y=a+o,v=a+2*o;for(l=0;l<o;l++)m[g+l]=-1,m[y+l]=-1,m[v+l]=0;for(s=0;s<a;s++)f[s]=-1;for(l=o-1;l>=0;l--)for(c=r[l],h=r[l+1],u=c;u<h;u++)f[n[u]]=l;for(s=a-1;s>=0;s--)d[s]=-1,-1!==(l=f[s])&&(0===m[v+l]++&&(m[y+l]=s),m[0+s]=m[g+l],m[g+l]=s);for(t.lnz=0,t.m2=a,l=0;l<o;l++)if(s=m[g+l],t.lnz++,s<0&&(s=t.m2++),d[s]=l,!(--v[l]<=0)){t.lnz+=m[v+l];var x=p[l];-1!==x&&(0===m[v+x]&&(m[y+x]=m[y+l]),m[0+m[y+l]]=m[g+x],m[g+x]=m[0+s],m[v+x]+=m[v+l])}for(s=0;s<a;s++)d[s]<0&&(d[s]=l++);return!0}(u,l))for(l.unz=0,n=0;n<s;n++)l.unz+=l.cp[n]}else l.unz=4*o[s]+s,l.lnz=l.unz;return l}}));function A_(e,t){return e[t]<0}function C_(e,t){e[t]=v_(e[t])}function E_(e){return e<0?v_(e):e}function M_(e,t,r,n,i){var a,o,s,l=t._index,u=t._ptr,c=t._size[1],h=0;for(n[0]=e;h>=0;){e=n[h];var p=i?i[e]:e;A_(u,e)||(C_(u,e),n[c+h]=p<0?0:E_(u[p]));var d=1;for(o=n[c+h],s=p<0?0:E_(u[p+1]);o<s;o++)if(!A_(u,a=l[o])){n[c+h]=o,n[++h]=a,d=0;break}d&&(h--,n[--r]=e)}return r}var S_=Ii("csSpsolve",["divideScalar","multiply","subtract"],(e=>{var{divideScalar:t,multiply:r,subtract:n}=e;return function(e,i,a,o,s,l,u){var c,h,p,d,f=e._values,m=e._index,g=e._ptr,y=e._size[1],v=i._values,x=i._index,_=i._ptr,b=function(e,t,r,n,i){var a,o,s,l=e._ptr,u=e._size,c=t._index,h=t._ptr,p=u[1],d=p;for(o=h[r],s=h[r+1],a=o;a<s;a++){var f=c[a];A_(l,f)||(d=M_(f,e,d,n,i))}for(a=d;a<p;a++)C_(l,n[a]);return d}(e,i,a,o,l);for(c=b;c<y;c++)s[o[c]]=0;for(h=_[a],p=_[a+1],c=h;c<p;c++)s[x[c]]=v[c];for(var w=b;w<y;w++){var A=o[w],C=l?l[A]:A;if(!(C<0))for(h=g[C],p=g[C+1],s[A]=t(s[A],f[u?h:p-1]),c=u?h+1:h,d=u?p:p-1;c<d;c++){var E=m[c];s[E]=n(s[E],r(f[c],s[A]))}}return b}})),D_=Ii("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],(e=>{var{abs:t,divideScalar:r,multiply:n,subtract:i,larger:a,largerEq:o,SparseMatrix:s}=e,l=S_({divideScalar:r,multiply:n,subtract:i});return function(e,i,u){if(!e)return null;var c,h=e._size[1],p=100,d=100;i&&(c=i.q,p=i.lnz||p,d=i.unz||d);var f,m,g=[],y=[],v=[],x=new s({values:g,index:y,ptr:v,size:[h,h]}),_=[],b=[],w=[],A=new s({values:_,index:b,ptr:w,size:[h,h]}),C=[],E=[],M=[];for(f=0;f<h;f++)E[f]=0,C[f]=-1,v[f+1]=0;p=0,d=0;for(var S=0;S<h;S++){v[S]=p,w[S]=d;var D=c?c[S]:S,T=l(x,e,D,M,E,C,1),N=-1,I=-1;for(m=T;m<h;m++)if(C[f=M[m]]<0){var P=t(E[f]);a(P,I)&&(I=P,N=f)}else b[d]=C[f],_[d++]=E[f];if(-1===N||I<=0)return null;C[D]<0&&o(t(E[D]),n(I,u))&&(N=D);var z=E[N];for(b[d]=S,_[d++]=z,C[N]=S,y[p]=N,g[p++]=1,m=T;m<h;m++)C[f=M[m]]<0&&(y[p]=f,g[p++]=r(E[f],z)),E[f]=0}for(v[h]=p,w[h]=d,m=0;m<p;m++)y[m]=C[y[m]];return g.splice(p,g.length-p),y.splice(p,y.length-p),_.splice(d,_.length-d),b.splice(d,b.length-d),{L:x,U:A,pinv:C}}})),T_=Ii("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],(e=>{var{typed:t,abs:r,add:n,multiply:i,transpose:a,divideScalar:o,subtract:s,larger:l,largerEq:u,SparseMatrix:c}=e,h=w_({add:n,multiply:i,transpose:a}),p=D_({abs:r,divideScalar:o,multiply:i,subtract:s,larger:l,largerEq:u,SparseMatrix:c});return t("slu",{"SparseMatrix, number, number":function(e,t,r){if(!Fi(t)||t<0||t>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(r<0||r>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var n=h(t,e,!1),i=p(e,n,r);return{L:i.L,U:i.U,p:i.pinv,q:n.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})})),N_="sort",I_=Ii(N_,["typed","matrix","compare","compareNatural"],(e=>{var{typed:t,matrix:r,compare:n,compareNatural:i}=e,a=n,o=(e,t)=>-n(e,t);return t(N_,{Array:function(e){return l(e),e.sort(a)},Matrix:function(e){return u(e),r(e.toArray().sort(a),e.storage())},"Array, function":function(e,t){return l(e),e.sort(t)},"Matrix, function":function(e,t){return u(e),r(e.toArray().sort(t),e.storage())},"Array, string":function(e,t){return l(e),e.sort(s(t))},"Matrix, string":function(e,t){return u(e),r(e.toArray().sort(s(t)),e.storage())}});function s(e){if("asc"===e)return a;if("desc"===e)return o;if("natural"===e)return i;throw new Error('String "asc", "desc", or "natural" expected')}function l(e){if(1!==ba(e).length)throw new Error("One dimensional array expected")}function u(e){if(1!==e.size().length)throw new Error("One dimensional matrix expected")}})),P_="unaryPlus",z_=Ii(P_,["typed","config","numeric"],(e=>{var{typed:t,config:r,numeric:n}=e;return t(P_,{number:Wd,Complex:function(e){return e},BigNumber:function(e){return e},bigint:function(e){return e},Fraction:function(e){return e},Unit:function(e){return e.clone()},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e,!0))),boolean:function(e){return n(e?1:0,r.number)},string:function(e){return n(e,Ri(e,r))}})})),B_="usolveAll",k_=Ii(B_,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:r,divideScalar:n,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=xx({DenseMatrix:s});return t(B_,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var r=[l(e,t,!0)._data.map((e=>e[0]))],u=e._size[0],c=e._size[1],h=e._values,p=e._index,d=e._ptr,f=c-1;f>=0;f--)for(var m=r.length,g=0;g<m;g++){for(var y=r[g],v=[],x=[],_=d[f],b=0,w=d[f+1]-1;w>=_;w--){var A=p[w];A===f?b=h[w]:A<f&&(v.push(h[w]),x.push(A))}if(o(b,0))if(o(y[f],0)){if(0===g){var C=[...y];C[f]=1;for(var E=0,M=x.length;E<M;E++){var S=x[E];C[S]=a(C[S],v[E])}r.push(C)}}else{if(0===g)return[];r.splice(g,1),g-=1,m-=1}else{y[f]=n(y[f],b);for(var D=0,T=x.length;D<T;D++){var N=x[D];y[N]=a(y[N],i(y[f],v[D]))}}}return r.map((e=>new s({data:e.map((e=>[e])),size:[u,1]})))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return u(e,t)},"Array, Array | Matrix":function(e,t){return u(r(e),t).map((e=>e.valueOf()))}});function u(e,t){for(var r=[l(e,t,!0)._data.map((e=>e[0]))],u=e._data,c=e._size[0],h=e._size[1]-1;h>=0;h--)for(var p=r.length,d=0;d<p;d++){var f=r[d];if(o(u[h][h],0))if(o(f[h],0)){if(0===d){var m=[...f];m[h]=1;for(var g=h-1;g>=0;g--)m[g]=a(m[g],u[g][h]);r.push(m)}}else{if(0===d)return[];r.splice(d,1),d-=1,p-=1}else{f[h]=n(f[h],u[h][h]);for(var y=h-1;y>=0;y--)f[y]=a(f[y],i(f[h],u[y][h]))}}return r.map((e=>new s({data:e.map((e=>[e])),size:[c,1]})))}})),F_="zpk2tf",R_=Ii(F_,["typed","add","multiply","Complex","number"],(e=>{var{typed:t,add:r,multiply:n,Complex:i,number:a}=e;return t(F_,{"Array,Array,number":function(e,t,r){return o(e,t,r)},"Array,Array":function(e,t){return o(e,t,1)},"Matrix,Matrix,number":function(e,t,r){return o(e.valueOf(),t.valueOf(),r)},"Matrix,Matrix":function(e,t){return o(e.valueOf(),t.valueOf(),1)}});function o(e,t,r){e.some((e=>"BigNumber"===e.type))&&(e=e.map((e=>a(e)))),t.some((e=>"BigNumber"===e.type))&&(t=t.map((e=>a(e))));for(var o=[i(1,0)],l=[i(1,0)],u=0;u<e.length;u++){var c=e[u];"number"==typeof c&&(c=i(c,0)),o=s(o,[i(1,0),i(-c.re,-c.im)])}for(var h=0;h<t.length;h++){var p=t[h];"number"==typeof p&&(p=i(p,0)),l=s(l,[i(1,0),i(-p.re,-p.im)])}for(var d=0;d<o.length;d++)o[d]=n(o[d],r);return[o,l]}function s(e,t){for(var a=[],o=0;o<e.length+t.length-1;o++){a[o]=i(0,0);for(var s=0;s<e.length;s++)o-s>=0&&o-s<t.length&&(a[o]=r(a[o],n(e[s],t[o-s])))}return a}})),O_="ceil",L_=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],q_=new Nh(10),j_=Ii(O_,["typed","config","round"],(e=>{var{typed:t,config:r,round:n}=e;function i(e){var t=Math.ceil(e),i=n(e);return t===i?t:Ji(e,i,r.relTol,r.absTol)&&!Ji(e,t,r.relTol,r.absTol)?i:t}return t(O_,{number:i,"number, number":function(e,t){if(!Fi(t))throw new RangeError("number of decimals in function ceil must be an integer");if(t<0||t>15)throw new RangeError("number of decimals in ceil number must be in range 0-15");var r=10**t;return i(e*r)/r}})})),U_=Ii(O_,L_,(e=>{var{typed:t,config:r,round:n,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s}=e,l=xl({typed:t,equalScalar:a}),u=al({typed:t,DenseMatrix:s}),c=ll({typed:t}),h=j_({typed:t,config:r,round:n});function p(e){var t=(e,t)=>cm(e,t,r.relTol,r.absTol),i=e.ceil(),a=n(e);return i.eq(a)?i:t(e,a)&&!t(e,i)?a:i}return t("ceil",{number:h.signatures.number,"number,number":h.signatures["number,number"],Complex:function(e){return e.ceil()},"Complex, number":function(e,t){return e.ceil(t)},"Complex, BigNumber":function(e,t){return e.ceil(t.toNumber())},BigNumber:p,"BigNumber, BigNumber":function(e,t){var r=q_.pow(t);return p(e.mul(r)).div(r)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.ceil()},"Fraction, number":function(e,t){return e.ceil(t)},"Fraction, BigNumber":function(e,t){return e.ceil(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,r,n){var i=t.toNumeric(n);return n.multiply(e(i,r))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,r,n)=>e(t,r.toNumber(),n))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,r,n)=>Xo(t,(t=>e(t,r,n)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,r)=>e(t,0,r))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e,!0))),"Array, number | BigNumber":t.referToSelf((e=>(t,r)=>Xo(t,(t=>e(t,r)),!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>l(t,r,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,r)=>c(t,r,e,!1))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,r)=>c(i(r),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,r)=>a(t,0)?o(r.size(),r.storage()):"dense"===r.storage()?c(r,t,e,!0):u(r,t,e,!0)))})})),V_="cross",Z_=Ii(V_,["typed","matrix","subtract","multiply"],(e=>{var{typed:t,matrix:r,subtract:n,multiply:i}=e;return t(V_,{"Matrix, Matrix":function(e,t){return r(a(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return r(a(e.toArray(),t))},"Array, Matrix":function(e,t){return r(a(e,t.toArray()))},"Array, Array":a});function a(e,t){var r=Math.max(ba(e).length,ba(t).length);e=Pa(e),t=Pa(t);var a=ba(e),o=ba(t);if(1!==a.length||1!==o.length||3!==a[0]||3!==o[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+a.join(", ")+"], B = ["+o.join(", ")+"])");var s=[n(i(e[1],t[2]),i(e[2],t[1])),n(i(e[2],t[0]),i(e[0],t[2])),n(i(e[0],t[1]),i(e[1],t[0]))];return r>1?[s]:s}})),$_=Ii("det",["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],(e=>{var{typed:t,matrix:r,subtractScalar:n,multiply:i,divideScalar:a,isZero:o,unaryMinus:s}=e;return t("det",{any:function(e){return Mn(e)},"Array | Matrix":function(e){var t;switch((t=Xn(e)?e.size():Array.isArray(e)?(e=r(e)).size():[]).length){case 0:return Mn(e);case 1:if(1===t[0])return Mn(e.valueOf()[0]);if(0===t[0])return 1;throw new RangeError("Matrix must be square (size: "+ha(t)+")");case 2:var l=t[0],u=t[1];if(l===u)return function(e,t){if(1===t)return Mn(e[0][0]);if(2===t)return n(i(e[0][0],e[1][1]),i(e[1][0],e[0][1]));for(var r=!1,l=new Array(t).fill(0).map(((e,t)=>t)),u=0;u<t;u++){var c=l[u];if(o(e[c][u])){var h=void 0;for(h=u+1;h<t;h++)if(!o(e[l[h]][u])){c=l[h],l[h]=l[u],l[u]=c,r=!r;break}if(h===t)return e[c][u]}for(var p=e[c][u],d=0===u?1:e[l[u-1]][u-1],f=u+1;f<t;f++)for(var m=l[f],g=u+1;g<t;g++)e[m][g]=a(n(i(e[m][g],p),i(e[m][u],e[c][g])),d)}var y=e[l[t-1]][t-1];return r?s(y):y}(e.clone().valueOf(),l);if(0===u)return 1;throw new RangeError("Matrix must be square (size: "+ha(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+ha(t)+")")}}})})),G_="fix",H_=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],W_=Ii(G_,["typed","ceil","floor"],(e=>{var{typed:t,ceil:r,floor:n}=e;return t(G_,{number:function(e){return e>0?n(e):r(e)},"number, number":function(e,t){return e>0?n(e,t):r(e,t)}})})),X_=Ii(G_,H_,(e=>{var{typed:t,Complex:r,matrix:n,ceil:i,floor:a,equalScalar:o,zeros:s,DenseMatrix:l}=e,u=al({typed:t,DenseMatrix:l}),c=ll({typed:t}),h=W_({typed:t,ceil:i,floor:a});return t("fix",{number:h.signatures.number,"number, number | BigNumber":h.signatures["number,number"],Complex:function(e){return new r(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im))},"Complex, number":function(e,t){return new r(e.re>0?a(e.re,t):i(e.re,t),e.im>0?a(e.im,t):i(e.im,t))},"Complex, BigNumber":function(e,t){var n=t.toNumber();return new r(e.re>0?a(e.re,n):i(e.re,n),e.im>0?a(e.im,n):i(e.im,n))},BigNumber:function(e){return e.isNegative()?i(e):a(e)},"BigNumber, number | BigNumber":function(e,t){return e.isNegative()?i(e,t):a(e,t)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.s<0n?e.ceil():e.floor()},"Fraction, number | BigNumber":function(e,t){return e.s<0n?i(e,t):a(e,t)},"Unit, number, Unit":t.referToSelf((e=>function(t,r,n){var i=t.toNumeric(n);return n.multiply(e(i,r))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,r,n)=>e(t,r.toNumber(),n))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,r,n)=>Xo(t,(t=>e(t,r,n)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,r)=>e(t,0,r))),"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e,!0))),"Array | Matrix, number | BigNumber":t.referToSelf((e=>(t,r)=>Xo(t,(t=>e(t,r)),!0))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,r)=>c(n(r),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,r)=>o(t,0)?s(r.size(),r.storage()):"dense"===r.storage()?c(r,t,e,!0):u(r,t,e,!0)))})})),Y_=Ii("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],(e=>{var{typed:t,matrix:r,divideScalar:n,addScalar:i,multiply:a,unaryMinus:o,det:s,identity:l,abs:u}=e;return t("inv",{"Array | Matrix":function(e){var t=Xn(e)?e.size():ba(e);switch(t.length){case 1:if(1===t[0])return Xn(e)?r([n(1,e.valueOf()[0])]):[n(1,e[0])];throw new RangeError("Matrix must be square (size: "+ha(t)+")");case 2:var i=t[0],a=t[1];if(i===a)return Xn(e)?r(c(e.valueOf(),i,a),e.storage()):c(e,i,a);throw new RangeError("Matrix must be square (size: "+ha(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+ha(t)+")")}},any:function(e){return n(1,e)}});function c(e,t,r){var c,h,p,d,f;if(1===t){if(0===(d=e[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[n(1,d)]]}if(2===t){var m=s(e);if(0===m)throw Error("Cannot calculate inverse, determinant is zero");return[[n(e[1][1],m),n(o(e[0][1]),m)],[n(o(e[1][0]),m),n(e[0][0],m)]]}var g=e.concat();for(c=0;c<t;c++)g[c]=g[c].concat();for(var y=l(t).valueOf(),v=0;v<r;v++){var x=u(g[v][v]),_=v;for(c=v+1;c<t;)u(g[c][v])>x&&(x=u(g[c][v]),_=c),c++;if(0===x)throw Error("Cannot calculate inverse, determinant is zero");(c=_)!==v&&(f=g[v],g[v]=g[c],g[c]=f,f=y[v],y[v]=y[c],y[c]=f);var b=g[v],w=y[v];for(c=0;c<t;c++){var A=g[c],C=y[c];if(c!==v){if(0!==A[v]){for(p=n(o(A[v]),b[v]),h=v;h<r;h++)A[h]=i(A[h],a(p,b[h]));for(h=0;h<r;h++)C[h]=i(C[h],a(p,w[h]))}}else{for(p=b[v],h=v;h<r;h++)A[h]=n(A[h],p);for(h=0;h<r;h++)C[h]=n(C[h],p)}}}return y}})),K_="pinv",J_=Ii(K_,["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],(e=>{var{typed:t,matrix:r,inv:n,deepEqual:i,equal:a,dotDivide:o,dot:s,ctranspose:l,divideScalar:u,multiply:c,add:h,Complex:p}=e;return t(K_,{"Array | Matrix":function(e){var t=Xn(e)?e.size():ba(e);switch(t.length){case 1:return m(e)?l(e):1===t[0]?n(e):o(l(e),s(e,e));case 2:if(m(e))return l(e);var i=t[0],a=t[1];if(i===a)try{return n(e)}catch(e){if(!(e instanceof Error&&e.message.match(/Cannot calculate inverse, determinant is zero/)))throw e}return Xn(e)?r(d(e.valueOf(),i,a),e.storage()):d(e,i,a);default:throw new RangeError("Matrix must be two dimensional (size: "+ha(t)+")")}},any:function(e){return a(e,0)?Mn(e):u(1,e)}});function d(e,t,r){var{C:i,F:a}=function(e,t,r){var n=function(e,t,r){for(var n=Mn(e),i=0,a=0;a<t;a++){if(r<=i)return n;for(var s=a;f(n[s][i]);)if(t===++s&&(s=a,r===++i))return n;[n[s],n[a]]=[n[a],n[s]];for(var l=n[a][i],u=0;u<r;u++)n[a][u]=o(n[a][u],l);for(var p=0;p<t;p++)if(p!==a){l=n[p][i];for(var d=0;d<r;d++)n[p][d]=h(n[p][d],c(-1,c(l,n[a][d])))}i++}return n}(e,t,r),i=e.map(((e,r)=>e.filter(((e,r)=>r<t&&!f(s(n[r],n[r])))))),a=n.filter(((e,t)=>!f(s(n[t],n[t]))));return{C:i,F:a}}(e,t,r),u=c(n(c(l(i),i)),l(i)),p=c(l(a),n(c(a,l(a))));return c(p,u)}function f(e){return a(h(e,p(1,1)),h(0,p(1,1)))}function m(e){return i(h(e,p(1,1)),h(c(e,0),p(1,1)))}})),Q_=Ii("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],(e=>{var{typed:t,config:r,identity:n,multiply:i,matrix:a,inv:o,number:s,fraction:l,Complex:u}=e;return t("pow",{"number, number":c,"Complex, Complex":function(e,t){return e.pow(t)},"BigNumber, BigNumber":function(e,t){return t.isInteger()||e>=0||r.predictable?e.pow(t):new u(e.toNumber(),0).pow(t.toNumber(),0)},"bigint, bigint":(e,t)=>e**t,"Fraction, Fraction":function(e,t){var n=e.pow(t);if(null!=n)return n;if(r.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return c(e.valueOf(),t.valueOf())},"Array, number":h,"Array, BigNumber":function(e,t){return h(e,t.toNumber())},"Matrix, number":p,"Matrix, BigNumber":function(e,t){return p(e,t.toNumber())},"Unit, number | BigNumber":function(e,t){return e.pow(t)}});function c(e,t){if(r.predictable&&!Fi(t)&&e<0)try{var n=l(t),i=s(n);if((t===i||Math.abs((t-i)/t)<1e-14)&&n.d%2n==1n)return(n.n%2n==0n?1:-1)*Math.pow(-e,t)}catch(e){}return r.predictable&&(e<-1&&t===1/0||e>-1&&e<0&&t===-1/0)?NaN:Fi(t)||e>=0||r.predictable?lf(e,t):e*e<1&&t===1/0||e*e>1&&t===-1/0?0:new u(e,0).pow(t,0)}function h(e,t){if(!Fi(t))throw new TypeError("For A^b, b must be an integer (value is "+t+")");var r=ba(e);if(2!==r.length)throw new Error("For A^b, A must be 2 dimensional (A has "+r.length+" dimensions)");if(r[0]!==r[1])throw new Error("For A^b, A must be square (size is "+r[0]+"x"+r[1]+")");if(t<0)try{return h(o(e),-t)}catch(e){if("Cannot calculate inverse, determinant is zero"===e.message)throw new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+t+")");throw e}for(var a=n(r[0]).valueOf(),s=e;t>=1;)1&~t||(a=i(s,a)),t>>=1,s=i(s,s);return a}function p(e,t){return a(h(e.valueOf(),t))}})),eb="setDifference",tb=Ii(eb,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:o}=e;return t(eb,{"Array | Matrix, Array | Matrix":function(e,t){var s;if(0===n(r(e),new a(0)))s=[];else{if(0===n(r(t),new a(0)))return Fa(e.toArray());var l,u=Ua(Fa(Array.isArray(e)?e:e.toArray()).sort(i)),c=Ua(Fa(Array.isArray(t)?t:t.toArray()).sort(i));s=[];for(var h=0;h<u.length;h++){l=!1;for(var p=0;p<c.length;p++)if(0===i(u[h].value,c[p].value)&&u[h].identifier===c[p].identifier){l=!0;break}l||s.push(u[h])}}return Array.isArray(e)&&Array.isArray(t)?Va(s):new o(Va(s))}})})),rb="setMultiplicity",nb=Ii(rb,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:a}=e;return t(rb,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(e,t){if(0===n(r(t),new a(0)))return 0;for(var o=Fa(Array.isArray(t)?t:t.toArray()),s=0,l=0;l<o.length;l++)0===i(o[l],e)&&s++;return s}})})),ib="setSymDifference",ab=Ii(ib,["typed","size","concat","subset","setDifference","Index"],(e=>{var{typed:t,size:r,concat:n,subset:i,setDifference:a,Index:o}=e;return t(ib,{"Array | Matrix, Array | Matrix":function(e,t){if(0===i(r(e),new o(0)))return Fa(t);if(0===i(r(t),new o(0)))return Fa(e);var s=Fa(e),l=Fa(t);return n(a(s,l),a(l,s))}})})),ob=Ii("Spa",["addScalar","equalScalar","FibonacciHeap"],(e=>{var{addScalar:t,equalScalar:r,FibonacciHeap:n}=e;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new n}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(e,t){if(this._values[e])this._values[e].value=t;else{var r=this._heap.insert(e,t);this._values[e]=r}},i.prototype.get=function(e){var t=this._values[e];return t?t.value:0},i.prototype.accumulate=function(e,r){var n=this._values[e];n?n.value=t(n.value,r):(n=this._heap.insert(e,r),this._values[e]=n)},i.prototype.forEach=function(e,t,n){var i=this._heap,a=this._values,o=[],s=i.extractMinimum();for(s&&o.push(s);s&&s.key<=t;)s.key>=e&&(r(s.value,0)||n(s.key,s.value,this)),(s=i.extractMinimum())&&o.push(s);for(var l=0;l<o.length;l++){var u=o[l];a[(s=i.insert(u.key,u.value)).key]=s}},i.prototype.swap=function(e,t){var r=this._values[e],n=this._values[t];if(!r&&n)r=this._heap.insert(e,n.value),this._heap.remove(n),this._values[e]=r,this._values[t]=void 0;else if(r&&!n)n=this._heap.insert(t,r.value),this._heap.remove(r),this._values[t]=n,this._values[e]=void 0;else if(r&&n){var i=r.value;r.value=n.value,n.value=i}},i}),{isClass:!0}),sb="sqrtm",lb=Ii(sb,["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],(e=>{var{typed:t,abs:r,add:n,multiply:i,map:a,sqrt:o,subtract:s,inv:l,size:u,max:c,identity:h}=e,p=1e-6;function d(e){var t,a=0,o=e,d=h(u(e));do{var f=o;if(o=i(.5,n(f,l(d))),d=i(.5,n(d,l(f))),(t=c(r(s(o,f))))>p&&++a>1e3)throw new Error("computing square root of matrix: iterative method could not converge")}while(t>p);return o}return t(sb,{"Array | Matrix":function(e){var t=Xn(e)?e.size():ba(e);switch(t.length){case 1:if(1===t[0])return a(e,o);throw new RangeError("Matrix must be square (size: "+ha(t)+")");case 2:if(t[0]===t[1])return d(e);throw new RangeError("Matrix must be square (size: "+ha(t)+")");default:throw new RangeError("Matrix must be at most two dimensional (size: "+ha(t)+")")}}})}));function ub(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function cb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ub(Object(r),!0).forEach((function(t){ki(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ub(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var hb=Ii("Unit",["?on","config","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],(e=>{var t,r,n,{on:i,config:a,addScalar:o,subtractScalar:s,multiplyScalar:l,divideScalar:u,pow:c,abs:h,fix:p,round:d,equal:f,isNumeric:m,format:g,number:y,Complex:v,BigNumber:x,Fraction:_}=e,b=y;function w(e,t){if(!(this instanceof w))throw new Error("Constructor must be called with the new operator");if(null!=e&&!m(e)&&!Zn(e))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,void 0===t)this.units=[],this.dimensions=B.map((e=>0));else if("string"==typeof t){var r=w.parse(t);this.units=r.units,this.dimensions=r.dimensions}else{if(!Gn(t)||null!==t.value)throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.fixPrefix=t.fixPrefix,this.skipAutomaticSimplification=t.skipAutomaticSimplification,this.dimensions=t.dimensions.slice(0),this.units=t.units.map((e=>An({},e)))}this.value=this._normalize(e)}function A(){for(;" "===n||"\t"===n;)E()}function C(e){return e>="0"&&e<="9"}function E(){r++,n=t.charAt(r)}function M(e){r=e,n=t.charAt(r)}function S(){var e="",t=r;if("+"===n?E():"-"===n&&(e+=n,E()),!function(e){return e>="0"&&e<="9"||"."===e}(n))return M(t),null;if("."===n){if(e+=n,E(),!C(n))return M(t),null}else{for(;C(n);)e+=n,E();"."===n&&(e+=n,E())}for(;C(n);)e+=n,E();if("E"===n||"e"===n){var i="",a=r;if(i+=n,E(),"+"!==n&&"-"!==n||(i+=n,E()),!C(n))return M(a),e;for(e+=i;C(n);)e+=n,E()}return e}function D(){for(var e="";C(n)||w.isValidAlpha(n);)e+=n,E();var t=e.charAt(0);return w.isValidAlpha(t)?e:null}function T(e){return n===e?(E(),e):null}Object.defineProperty(w,"name",{value:"Unit"}),w.prototype.constructor=w,w.prototype.type="Unit",w.prototype.isUnit=!0,w.parse=function(e,i){if(i=i||{},r=-1,n="","string"!=typeof(t=e))throw new TypeError("Invalid argument in Unit.parse, string expected");var o=new w;o.units=[];var s=1,l=!1;E(),A();var u=S(),c=null;if(u){if("BigNumber"===a.number)c=new x(u);else if("Fraction"===a.number)try{c=new _(u)}catch(e){c=parseFloat(u)}else c=parseFloat(u);A(),T("*")?(s=1,l=!0):T("/")&&(s=-1,l=!0)}for(var h=[],p=1;;){for(A();"("===n;)h.push(s),p*=s,s=1,E(),A();var d;if(!n)break;var f=n;if(null===(d=D()))throw new SyntaxError('Unexpected "'+f+'" in "'+t+'" at index '+r.toString());var m=N(d);if(null===m)throw new SyntaxError('Unit "'+d+'" not found.');var g=s*p;if(A(),T("^")){A();var y=S();if(null===y)throw new SyntaxError('In "'+e+'", "^" must be followed by a floating-point number');g*=y}o.units.push({unit:m.unit,prefix:m.prefix,power:g});for(var v=0;v<B.length;v++)o.dimensions[v]+=(m.unit.dimensions[v]||0)*g;for(A();")"===n;){if(0===h.length)throw new SyntaxError('Unmatched ")" in "'+t+'" at index '+r.toString());p/=h.pop(),E(),A()}if(l=!1,T("*")?(s=1,l=!0):T("/")?(s=-1,l=!0):s=1,m.unit.base){var b=m.unit.base.key;j.auto[b]={unit:m.unit,prefix:m.prefix}}}if(A(),n)throw new SyntaxError('Could not parse: "'+e+'"');if(l)throw new SyntaxError('Trailing characters: "'+e+'"');if(0!==h.length)throw new SyntaxError('Unmatched "(" in "'+t+'"');if(0===o.units.length&&!i.allowNoUnits)throw new SyntaxError('"'+e+'" contains no units');return o.value=void 0!==c?o._normalize(c):null,o},w.prototype.clone=function(){var e=new w;e.fixPrefix=this.fixPrefix,e.skipAutomaticSimplification=this.skipAutomaticSimplification,e.value=Mn(this.value),e.dimensions=this.dimensions.slice(0),e.units=[];for(var t=0;t<this.units.length;t++)for(var r in e.units[t]={},this.units[t])Tn(this.units[t],r)&&(e.units[t][r]=this.units[t][r]);return e},w.prototype.valueType=function(){return Ti(this.value)},w.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},w.prototype._normalize=function(e){if(null==e||0===this.units.length)return e;for(var t=e,r=w._getNumberConverter(Ti(e)),n=0;n<this.units.length;n++){var i=r(this.units[n].unit.value),a=r(this.units[n].prefix.value),o=r(this.units[n].power);t=l(t,c(l(i,a),o))}return t},w.prototype._denormalize=function(e,t){if(null==e||0===this.units.length)return e;for(var r=e,n=w._getNumberConverter(Ti(e)),i=0;i<this.units.length;i++){var a=n(this.units[i].unit.value),o=n(this.units[i].prefix.value),s=n(this.units[i].power);r=u(r,c(l(a,o),s))}return r};var N=Uh((e=>{if(Tn(O,e)){var t=O[e];return{unit:t,prefix:t.prefixes[""]}}for(var r in O)if(Tn(O,r)&&ca(e,r)){var n=O[r],i=e.length-r.length,a=e.substring(0,i),o=Tn(n.prefixes,a)?n.prefixes[a]:void 0;if(void 0!==o)return{unit:n,prefix:o}}return null}),{hasher:e=>e[0],limit:100});function I(e){return e.equalBase(k.NONE)&&null!==e.value&&!a.predictable?e.value:e}function P(e){return w._getNumberConverter(Ti(e))(1)}w.isValuelessUnit=function(e){return null!==N(e)},w.prototype.hasBase=function(e){if("string"==typeof e&&(e=k[e]),!e)return!1;for(var t=0;t<B.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},w.prototype.equalBase=function(e){for(var t=0;t<B.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},w.prototype.equals=function(e){return this.equalBase(e)&&f(this.value,e.value)},w.prototype.multiply=function(e){for(var t=this.clone(),r=Gn(e)?e:new w(e),n=0;n<B.length;n++)t.dimensions[n]=(this.dimensions[n]||0)+(r.dimensions[n]||0);for(var i=0;i<r.units.length;i++){var a=cb({},r.units[i]);t.units.push(a)}if(null!==this.value||null!==r.value){var o=null===this.value?this._normalize(P(r.value)):this.value,s=null===r.value?r._normalize(P(this.value)):r.value;t.value=l(o,s)}else t.value=null;return Gn(e)&&(t.skipAutomaticSimplification=!1),I(t)},w.prototype.divideInto=function(e){return new w(e).divide(this)},w.prototype.divide=function(e){for(var t=this.clone(),r=Gn(e)?e:new w(e),n=0;n<B.length;n++)t.dimensions[n]=(this.dimensions[n]||0)-(r.dimensions[n]||0);for(var i=0;i<r.units.length;i++){var a=cb(cb({},r.units[i]),{},{power:-r.units[i].power});t.units.push(a)}if(null!==this.value||null!==r.value){var o=null===this.value?this._normalize(P(r.value)):this.value,s=null===r.value?r._normalize(P(this.value)):r.value;t.value=u(o,s)}else t.value=null;return Gn(e)&&(t.skipAutomaticSimplification=!1),I(t)},w.prototype.pow=function(e){for(var t=this.clone(),r=0;r<B.length;r++)t.dimensions[r]=(this.dimensions[r]||0)*e;for(var n=0;n<t.units.length;n++)t.units[n].power*=e;return null!==t.value?t.value=c(t.value,e):t.value=null,t.skipAutomaticSimplification=!1,I(t)},w.prototype.abs=function(){var e=this.clone();if(null!==e.value)if(e._isDerived()||0===e.units.length||0===e.units[0].unit.offset)e.value=h(e.value);else{var t=e._numberConverter(),r=t(e.units[0].unit.value),n=t(e.units[0].unit.offset),i=l(r,n);e.value=s(h(o(e.value,i)),i)}for(var a in e.units)"VA"!==e.units[a].unit.name&&"VAR"!==e.units[a].unit.name||(e.units[a].unit=O.W);return e},w.prototype.to=function(e){var t,r=null===this.value?this._normalize(1):this.value;if("string"==typeof e)t=w.parse(e);else{if(!Gn(e))throw new Error("String or Unit expected as parameter");t=e.clone()}if(!this.equalBase(t))throw new Error("Units do not match ('".concat(t.toString(),"' != '").concat(this.toString(),"')"));if(null!==t.value)throw new Error("Cannot convert to a unit with a value");if(null===this.value||this._isDerived()||0===this.units.length||0===t.units.length||this.units[0].unit.offset===t.units[0].unit.offset)t.value=Mn(r);else{var n=w._getNumberConverter(Ti(r)),i=this.units[0].unit.value,a=this.units[0].unit.offset,u=l(i,a),c=t.units[0].unit.value,h=t.units[0].unit.offset,p=l(c,h);t.value=o(r,n(s(u,p)))}return t.fixPrefix=!0,t.skipAutomaticSimplification=!0,t},w.prototype.toNumber=function(e){return b(this.toNumeric(e))},w.prototype.toNumeric=function(e){var t;return(t=e?this.to(e):this.clone())._isDerived()||0===t.units.length?t._denormalize(t.value):t._denormalize(t.value,t.units[0].prefix.value)},w.prototype.toString=function(){return this.format()},w.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.units.length>0?this.formatUnits():null,fixPrefix:this.fixPrefix}},w.fromJSON=function(e){var t,r=new w(e.value,null!==(t=e.unit)&&void 0!==t?t:void 0);return r.fixPrefix=e.fixPrefix||!1,r},w.prototype.valueOf=w.prototype.toString,w.prototype.simplify=function(){var e,t,r=this.clone(),n=[];for(var i in U)if(Tn(U,i)&&r.hasBase(k[i])){e=i;break}if("NONE"===e)r.units=[];else if(e&&Tn(U,e)&&(t=U[e]),t)r.units=[{unit:t.unit,prefix:t.prefix,power:1}];else{for(var a=!1,o=0;o<B.length;o++){var s=B[o];Math.abs(r.dimensions[o]||0)>1e-12&&(Tn(U,s)?n.push({unit:U[s].unit,prefix:U[s].prefix,power:r.dimensions[o]||0}):a=!0)}n.length<r.units.length&&!a&&(r.units=n)}return r},w.prototype.toSI=function(){for(var e=this.clone(),t=[],r=0;r<B.length;r++){var n=B[r];if(Math.abs(e.dimensions[r]||0)>1e-12){if(!Tn(j.si,n))throw new Error("Cannot express custom unit "+n+" in SI units");t.push({unit:j.si[n].unit,prefix:j.si[n].prefix,power:e.dimensions[r]||0})}}return e.units=t,e.fixPrefix=!0,e.skipAutomaticSimplification=!0,null!==this.value?(e.value=null,this.to(e)):e},w.prototype.formatUnits=function(){for(var e="",t="",r=0,n=0,i=0;i<this.units.length;i++)this.units[i].power>0?(r++,e+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(e+="^"+this.units[i].power)):this.units[i].power<0&&n++;if(n>0)for(var a=0;a<this.units.length;a++)this.units[a].power<0&&(r>0?(t+=" "+this.units[a].prefix.name+this.units[a].unit.name,Math.abs(this.units[a].power+1)>1e-15&&(t+="^"+-this.units[a].power)):(t+=" "+this.units[a].prefix.name+this.units[a].unit.name,t+="^"+this.units[a].power));e=e.substr(1),t=t.substr(1),r>1&&n>0&&(e="("+e+")"),n>1&&r>0&&(t="("+t+")");var o=e;return r>0&&n>0&&(o+=" / "),o+t},w.prototype.format=function(e){var t=this.skipAutomaticSimplification||null===this.value?this.clone():this.simplify(),r=!1;for(var n in void 0!==t.value&&null!==t.value&&Zn(t.value)&&(r=Math.abs(t.value.re)<1e-14),t.units)Tn(t.units,n)&&t.units[n].unit&&("VA"===t.units[n].unit.name&&r?t.units[n].unit=O.VAR:"VAR"!==t.units[n].unit.name||r||(t.units[n].unit=O.VA));1!==t.units.length||t.fixPrefix||Math.abs(t.units[0].power-Math.round(t.units[0].power))<1e-14&&(t.units[0].prefix=t._bestPrefix());var i=t._denormalize(t.value),a=null!==t.value?g(i,e||{}):"",o=t.formatUnits();return t.value&&Zn(t.value)&&(a="("+a+")"),o.length>0&&a.length>0&&(a+=" "),a+o},w.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var e=null!==this.value?h(this.value):0,t=h(this.units[0].unit.value),r=this.units[0].prefix;if(0===e)return r;var n=this.units[0].power,i=Math.log(e/Math.pow(r.value*t,n))/Math.LN10-1.2;if(i>-2.200001&&i<1.800001)return r;i=Math.abs(i);var a=this.units[0].unit.prefixes;for(var o in a)if(Tn(a,o)){var s=a[o];if(s.scientific){var l=Math.abs(Math.log(e/Math.pow(s.value*t,n))/Math.LN10-1.2);(l<i||l===i&&s.name.length<r.name.length)&&(r=s,i=l)}}return r},w.prototype.splitUnit=function(e){for(var t=this.clone(),r=[],n=0;n<e.length&&(t=t.to(e[n]),n!==e.length-1);n++){var i=t.toNumeric(),a=d(i),l=new w(f(a,i)?a:p(t.toNumeric()),e[n].toString());r.push(l),t=s(t,l)}for(var u=0,c=0;c<r.length;c++)u=o(u,r[c].value);return f(u,this.value)&&(t.value=0),r.push(t),r};var z={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},R:{name:"R",value:1e27,scientific:!0},Q:{name:"Q",value:1e30,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0},r:{name:"r",value:1e-27,scientific:!0},q:{name:"q",value:1e-30,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},ronna:{name:"ronna",value:1e27,scientific:!0},quetta:{name:"quetta",value:1e30,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0},ronto:{name:"ronto",value:1e-27,scientific:!0},quecto:{name:"quecto",value:1e-30,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},R:{name:"R",value:1e54,scientific:!0},Q:{name:"Q",value:1e60,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0},r:{name:"r",value:1e-54,scientific:!0},q:{name:"q",value:1e-60,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},R:{name:"R",value:1e81,scientific:!0},Q:{name:"Q",value:1e90,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0},r:{name:"r",value:1e-81,scientific:!0},q:{name:"q",value:1e-90,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};z.SHORTLONG=An({},z.SHORT,z.LONG),z.BINARY_SHORT=An({},z.BINARY_SHORT_SI,z.BINARY_SHORT_IEC),z.BINARY_LONG=An({},z.BINARY_LONG_SI,z.BINARY_LONG_IEC);var B=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],k={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var F in k)Tn(k,F)&&(k[F].key=F);var R={name:"",base:{},value:1,offset:0,dimensions:B.map((e=>0))},O={meter:{name:"meter",base:k.LENGTH,prefixes:z.LONG,value:1,offset:0},inch:{name:"inch",base:k.LENGTH,prefixes:z.NONE,value:.0254,offset:0},foot:{name:"foot",base:k.LENGTH,prefixes:z.NONE,value:.3048,offset:0},yard:{name:"yard",base:k.LENGTH,prefixes:z.NONE,value:.9144,offset:0},mile:{name:"mile",base:k.LENGTH,prefixes:z.NONE,value:1609.344,offset:0},link:{name:"link",base:k.LENGTH,prefixes:z.NONE,value:.201168,offset:0},rod:{name:"rod",base:k.LENGTH,prefixes:z.NONE,value:5.0292,offset:0},chain:{name:"chain",base:k.LENGTH,prefixes:z.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:k.LENGTH,prefixes:z.NONE,value:1e-10,offset:0},m:{name:"m",base:k.LENGTH,prefixes:z.SHORT,value:1,offset:0},in:{name:"in",base:k.LENGTH,prefixes:z.NONE,value:.0254,offset:0},ft:{name:"ft",base:k.LENGTH,prefixes:z.NONE,value:.3048,offset:0},yd:{name:"yd",base:k.LENGTH,prefixes:z.NONE,value:.9144,offset:0},mi:{name:"mi",base:k.LENGTH,prefixes:z.NONE,value:1609.344,offset:0},li:{name:"li",base:k.LENGTH,prefixes:z.NONE,value:.201168,offset:0},rd:{name:"rd",base:k.LENGTH,prefixes:z.NONE,value:5.02921,offset:0},ch:{name:"ch",base:k.LENGTH,prefixes:z.NONE,value:20.1168,offset:0},mil:{name:"mil",base:k.LENGTH,prefixes:z.NONE,value:254e-7,offset:0},m2:{name:"m2",base:k.SURFACE,prefixes:z.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:k.SURFACE,prefixes:z.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:k.SURFACE,prefixes:z.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:k.SURFACE,prefixes:z.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:k.SURFACE,prefixes:z.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:k.SURFACE,prefixes:z.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:k.SURFACE,prefixes:z.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:k.SURFACE,prefixes:z.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:k.SURFACE,prefixes:z.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:k.SURFACE,prefixes:z.NONE,value:1e4,offset:0},m3:{name:"m3",base:k.VOLUME,prefixes:z.CUBIC,value:1,offset:0},L:{name:"L",base:k.VOLUME,prefixes:z.SHORT,value:.001,offset:0},l:{name:"l",base:k.VOLUME,prefixes:z.SHORT,value:.001,offset:0},litre:{name:"litre",base:k.VOLUME,prefixes:z.LONG,value:.001,offset:0},cuin:{name:"cuin",base:k.VOLUME,prefixes:z.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:k.VOLUME,prefixes:z.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:k.VOLUME,prefixes:z.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:k.VOLUME,prefixes:z.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:k.VOLUME,prefixes:z.NONE,value:15e-6,offset:0},drop:{name:"drop",base:k.VOLUME,prefixes:z.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:k.VOLUME,prefixes:z.NONE,value:5e-8,offset:0},minim:{name:"minim",base:k.VOLUME,prefixes:z.NONE,value:6.1611519921875e-8,offset:0},fluiddram:{name:"fluiddram",base:k.VOLUME,prefixes:z.NONE,value:36966911953125e-19,offset:0},fluidounce:{name:"fluidounce",base:k.VOLUME,prefixes:z.NONE,value:295735295625e-16,offset:0},gill:{name:"gill",base:k.VOLUME,prefixes:z.NONE,value:.00011829411825,offset:0},cc:{name:"cc",base:k.VOLUME,prefixes:z.NONE,value:1e-6,offset:0},cup:{name:"cup",base:k.VOLUME,prefixes:z.NONE,value:.0002365882365,offset:0},pint:{name:"pint",base:k.VOLUME,prefixes:z.NONE,value:.000473176473,offset:0},quart:{name:"quart",base:k.VOLUME,prefixes:z.NONE,value:.000946352946,offset:0},gallon:{name:"gallon",base:k.VOLUME,prefixes:z.NONE,value:.003785411784,offset:0},beerbarrel:{name:"beerbarrel",base:k.VOLUME,prefixes:z.NONE,value:.117347765304,offset:0},oilbarrel:{name:"oilbarrel",base:k.VOLUME,prefixes:z.NONE,value:.158987294928,offset:0},hogshead:{name:"hogshead",base:k.VOLUME,prefixes:z.NONE,value:.238480942392,offset:0},g:{name:"g",base:k.MASS,prefixes:z.SHORT,value:.001,offset:0},gram:{name:"gram",base:k.MASS,prefixes:z.LONG,value:.001,offset:0},ton:{name:"ton",base:k.MASS,prefixes:z.SHORT,value:907.18474,offset:0},t:{name:"t",base:k.MASS,prefixes:z.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:k.MASS,prefixes:z.LONG,value:1e3,offset:0},grain:{name:"grain",base:k.MASS,prefixes:z.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:k.MASS,prefixes:z.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:k.MASS,prefixes:z.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:k.MASS,prefixes:z.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:k.MASS,prefixes:z.NONE,value:45.359237,offset:0},stick:{name:"stick",base:k.MASS,prefixes:z.NONE,value:.115,offset:0},stone:{name:"stone",base:k.MASS,prefixes:z.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:k.MASS,prefixes:z.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:k.MASS,prefixes:z.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:k.MASS,prefixes:z.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:k.MASS,prefixes:z.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:k.MASS,prefixes:z.NONE,value:45.359237,offset:0},s:{name:"s",base:k.TIME,prefixes:z.SHORT,value:1,offset:0},min:{name:"min",base:k.TIME,prefixes:z.NONE,value:60,offset:0},h:{name:"h",base:k.TIME,prefixes:z.NONE,value:3600,offset:0},second:{name:"second",base:k.TIME,prefixes:z.LONG,value:1,offset:0},sec:{name:"sec",base:k.TIME,prefixes:z.LONG,value:1,offset:0},minute:{name:"minute",base:k.TIME,prefixes:z.NONE,value:60,offset:0},hour:{name:"hour",base:k.TIME,prefixes:z.NONE,value:3600,offset:0},day:{name:"day",base:k.TIME,prefixes:z.NONE,value:86400,offset:0},week:{name:"week",base:k.TIME,prefixes:z.NONE,value:604800,offset:0},month:{name:"month",base:k.TIME,prefixes:z.NONE,value:2629800,offset:0},year:{name:"year",base:k.TIME,prefixes:z.NONE,value:31557600,offset:0},decade:{name:"decade",base:k.TIME,prefixes:z.NONE,value:315576e3,offset:0},century:{name:"century",base:k.TIME,prefixes:z.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:k.TIME,prefixes:z.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:k.FREQUENCY,prefixes:z.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:k.FREQUENCY,prefixes:z.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:k.ANGLE,prefixes:z.SHORT,value:1,offset:0},radian:{name:"radian",base:k.ANGLE,prefixes:z.LONG,value:1,offset:0},deg:{name:"deg",base:k.ANGLE,prefixes:z.SHORT,value:null,offset:0},degree:{name:"degree",base:k.ANGLE,prefixes:z.LONG,value:null,offset:0},grad:{name:"grad",base:k.ANGLE,prefixes:z.SHORT,value:null,offset:0},gradian:{name:"gradian",base:k.ANGLE,prefixes:z.LONG,value:null,offset:0},cycle:{name:"cycle",base:k.ANGLE,prefixes:z.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:k.ANGLE,prefixes:z.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:k.ANGLE,prefixes:z.NONE,value:null,offset:0},A:{name:"A",base:k.CURRENT,prefixes:z.SHORT,value:1,offset:0},ampere:{name:"ampere",base:k.CURRENT,prefixes:z.LONG,value:1,offset:0},K:{name:"K",base:k.TEMPERATURE,prefixes:z.SHORT,value:1,offset:0},degC:{name:"degC",base:k.TEMPERATURE,prefixes:z.SHORT,value:1,offset:273.15},degF:{name:"degF",base:k.TEMPERATURE,prefixes:z.SHORT,value:new _(5,9),offset:459.67},degR:{name:"degR",base:k.TEMPERATURE,prefixes:z.SHORT,value:new _(5,9),offset:0},kelvin:{name:"kelvin",base:k.TEMPERATURE,prefixes:z.LONG,value:1,offset:0},celsius:{name:"celsius",base:k.TEMPERATURE,prefixes:z.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:k.TEMPERATURE,prefixes:z.LONG,value:new _(5,9),offset:459.67},rankine:{name:"rankine",base:k.TEMPERATURE,prefixes:z.LONG,value:new _(5,9),offset:0},mol:{name:"mol",base:k.AMOUNT_OF_SUBSTANCE,prefixes:z.SHORT,value:1,offset:0},mole:{name:"mole",base:k.AMOUNT_OF_SUBSTANCE,prefixes:z.LONG,value:1,offset:0},cd:{name:"cd",base:k.LUMINOUS_INTENSITY,prefixes:z.SHORT,value:1,offset:0},candela:{name:"candela",base:k.LUMINOUS_INTENSITY,prefixes:z.LONG,value:1,offset:0},N:{name:"N",base:k.FORCE,prefixes:z.SHORT,value:1,offset:0},newton:{name:"newton",base:k.FORCE,prefixes:z.LONG,value:1,offset:0},dyn:{name:"dyn",base:k.FORCE,prefixes:z.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:k.FORCE,prefixes:z.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:k.FORCE,prefixes:z.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:k.FORCE,prefixes:z.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:k.FORCE,prefixes:z.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:k.FORCE,prefixes:z.NONE,value:9.80665,offset:0},J:{name:"J",base:k.ENERGY,prefixes:z.SHORT,value:1,offset:0},joule:{name:"joule",base:k.ENERGY,prefixes:z.LONG,value:1,offset:0},erg:{name:"erg",base:k.ENERGY,prefixes:z.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:k.ENERGY,prefixes:z.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:k.ENERGY,prefixes:z.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:k.ENERGY,prefixes:z.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:k.ENERGY,prefixes:z.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:k.POWER,prefixes:z.SHORT,value:1,offset:0},watt:{name:"watt",base:k.POWER,prefixes:z.LONG,value:1,offset:0},hp:{name:"hp",base:k.POWER,prefixes:z.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:k.POWER,prefixes:z.SHORT,value:v.I,offset:0},VA:{name:"VA",base:k.POWER,prefixes:z.SHORT,value:1,offset:0},Pa:{name:"Pa",base:k.PRESSURE,prefixes:z.SHORT,value:1,offset:0},psi:{name:"psi",base:k.PRESSURE,prefixes:z.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:k.PRESSURE,prefixes:z.NONE,value:101325,offset:0},bar:{name:"bar",base:k.PRESSURE,prefixes:z.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:k.PRESSURE,prefixes:z.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:k.PRESSURE,prefixes:z.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:k.PRESSURE,prefixes:z.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:k.PRESSURE,prefixes:z.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:k.ELECTRIC_CHARGE,prefixes:z.LONG,value:1,offset:0},C:{name:"C",base:k.ELECTRIC_CHARGE,prefixes:z.SHORT,value:1,offset:0},farad:{name:"farad",base:k.ELECTRIC_CAPACITANCE,prefixes:z.LONG,value:1,offset:0},F:{name:"F",base:k.ELECTRIC_CAPACITANCE,prefixes:z.SHORT,value:1,offset:0},volt:{name:"volt",base:k.ELECTRIC_POTENTIAL,prefixes:z.LONG,value:1,offset:0},V:{name:"V",base:k.ELECTRIC_POTENTIAL,prefixes:z.SHORT,value:1,offset:0},ohm:{name:"ohm",base:k.ELECTRIC_RESISTANCE,prefixes:z.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:k.ELECTRIC_INDUCTANCE,prefixes:z.LONG,value:1,offset:0},H:{name:"H",base:k.ELECTRIC_INDUCTANCE,prefixes:z.SHORT,value:1,offset:0},siemens:{name:"siemens",base:k.ELECTRIC_CONDUCTANCE,prefixes:z.LONG,value:1,offset:0},S:{name:"S",base:k.ELECTRIC_CONDUCTANCE,prefixes:z.SHORT,value:1,offset:0},weber:{name:"weber",base:k.MAGNETIC_FLUX,prefixes:z.LONG,value:1,offset:0},Wb:{name:"Wb",base:k.MAGNETIC_FLUX,prefixes:z.SHORT,value:1,offset:0},tesla:{name:"tesla",base:k.MAGNETIC_FLUX_DENSITY,prefixes:z.LONG,value:1,offset:0},T:{name:"T",base:k.MAGNETIC_FLUX_DENSITY,prefixes:z.SHORT,value:1,offset:0},b:{name:"b",base:k.BIT,prefixes:z.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:k.BIT,prefixes:z.BINARY_LONG,value:1,offset:0},B:{name:"B",base:k.BIT,prefixes:z.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:k.BIT,prefixes:z.BINARY_LONG,value:8,offset:0}},L={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fldr:"fluiddram",fluiddrams:"fluiddram",floz:"fluidounce",fluidounces:"fluidounce",gi:"gill",gills:"gill",cp:"cup",cups:"cup",pt:"pint",pints:"pint",qt:"quart",quarts:"quart",gal:"gallon",gallons:"gallon",bbl:"beerbarrel",beerbarrels:"beerbarrel",obl:"oilbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function q(e){if("BigNumber"===e.number){var t=$h(x);O.rad.value=new x(1),O.deg.value=t.div(180),O.grad.value=t.div(200),O.cycle.value=t.times(2),O.arcsec.value=t.div(648e3),O.arcmin.value=t.div(10800)}else O.rad.value=1,O.deg.value=Math.PI/180,O.grad.value=Math.PI/200,O.cycle.value=2*Math.PI,O.arcsec.value=Math.PI/648e3,O.arcmin.value=Math.PI/10800;O.radian.value=O.rad.value,O.degree.value=O.deg.value,O.gradian.value=O.grad.value}q(a),i&&i("config",(function(e,t){e.number!==t.number&&q(e)}));var j={si:{NONE:{unit:R,prefix:z.NONE[""]},LENGTH:{unit:O.m,prefix:z.SHORT[""]},MASS:{unit:O.g,prefix:z.SHORT.k},TIME:{unit:O.s,prefix:z.SHORT[""]},CURRENT:{unit:O.A,prefix:z.SHORT[""]},TEMPERATURE:{unit:O.K,prefix:z.SHORT[""]},LUMINOUS_INTENSITY:{unit:O.cd,prefix:z.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:O.mol,prefix:z.SHORT[""]},ANGLE:{unit:O.rad,prefix:z.SHORT[""]},BIT:{unit:O.bits,prefix:z.SHORT[""]},FORCE:{unit:O.N,prefix:z.SHORT[""]},ENERGY:{unit:O.J,prefix:z.SHORT[""]},POWER:{unit:O.W,prefix:z.SHORT[""]},PRESSURE:{unit:O.Pa,prefix:z.SHORT[""]},ELECTRIC_CHARGE:{unit:O.C,prefix:z.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:O.F,prefix:z.SHORT[""]},ELECTRIC_POTENTIAL:{unit:O.V,prefix:z.SHORT[""]},ELECTRIC_RESISTANCE:{unit:O.ohm,prefix:z.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:O.H,prefix:z.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:O.S,prefix:z.SHORT[""]},MAGNETIC_FLUX:{unit:O.Wb,prefix:z.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:O.T,prefix:z.SHORT[""]},FREQUENCY:{unit:O.Hz,prefix:z.SHORT[""]}}};j.cgs=JSON.parse(JSON.stringify(j.si)),j.cgs.LENGTH={unit:O.m,prefix:z.SHORT.c},j.cgs.MASS={unit:O.g,prefix:z.SHORT[""]},j.cgs.FORCE={unit:O.dyn,prefix:z.SHORT[""]},j.cgs.ENERGY={unit:O.erg,prefix:z.NONE[""]},j.us=JSON.parse(JSON.stringify(j.si)),j.us.LENGTH={unit:O.ft,prefix:z.NONE[""]},j.us.MASS={unit:O.lbm,prefix:z.NONE[""]},j.us.TEMPERATURE={unit:O.degF,prefix:z.NONE[""]},j.us.FORCE={unit:O.lbf,prefix:z.NONE[""]},j.us.ENERGY={unit:O.BTU,prefix:z.BTU[""]},j.us.POWER={unit:O.hp,prefix:z.NONE[""]},j.us.PRESSURE={unit:O.psi,prefix:z.NONE[""]},j.auto=JSON.parse(JSON.stringify(j.si));var U=j.auto;for(var V in w.setUnitSystem=function(e){if(!Tn(j,e))throw new Error("Unit system "+e+" does not exist. Choices are: "+Object.keys(j).join(", "));U=j[e]},w.getUnitSystem=function(){for(var e in j)if(Tn(j,e)&&j[e]===U)return e},w.typeConverters={BigNumber:function(e){return null!=e&&e.isFraction?new x(String(e.n)).div(String(e.d)).times(String(e.s)):new x(e+"")},Fraction:function(e){return new _(e)},Complex:function(e){return e},number:function(e){return null!=e&&e.isFraction?y(e):e}},w.prototype._numberConverter=function(){var e=w.typeConverters[this.valueType()];if(e)return e;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},w._getNumberConverter=function(e){if(!w.typeConverters[e])throw new TypeError('Unsupported type "'+e+'"');return w.typeConverters[e]},O)if(Tn(O,V)){var Z=O[V];Z.dimensions=Z.base.dimensions}for(var $ in L)if(Tn(L,$)){var G=O[L[$]],H={};for(var W in G)Tn(G,W)&&(H[W]=G[W]);H.name=$,O[$]=H}return w.isValidAlpha=function(e){return/^[a-zA-Z]$/.test(e)},w.createUnit=function(e,t){if("object"!=typeof e)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(t&&t.override)for(var r in e)if(Tn(e,r)&&w.deleteUnit(r),e[r].aliases)for(var n=0;n<e[r].aliases.length;n++)w.deleteUnit(e[r].aliases[n]);var i;for(var a in e)Tn(e,a)&&(i=w.createUnitSingle(a,e[a]));return i},w.createUnitSingle=function(e,t){if(null==t&&(t={}),"string"!=typeof e)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(Tn(O,e))throw new Error('Cannot create unit "'+e+'": a unit with that name already exists');!function(e){for(var t=0;t<e.length;t++){if(n=e.charAt(t),0===t&&!w.isValidAlpha(n))throw new Error('Invalid unit name (must begin with alpha character): "'+e+'"');if(t>0&&!w.isValidAlpha(n)&&!C(n))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+e+'"')}}(e);var r,i,a,o=null,s=[],l=0;if(t&&"Unit"===t.type)o=t.clone();else if("string"==typeof t)""!==t&&(r=t);else{if("object"!=typeof t)throw new TypeError('Cannot create unit "'+e+'" from "'+t.toString()+'": expecting "string" or "Unit" or "Object"');r=t.definition,i=t.prefixes,l=t.offset,a=t.baseName,t.aliases&&(s=t.aliases.valueOf())}if(s)for(var u=0;u<s.length;u++)if(Tn(O,s[u]))throw new Error('Cannot create alias "'+s[u]+'": a unit with that name already exists');if(r&&"string"==typeof r&&!o)try{o=w.parse(r,{allowNoUnits:!0})}catch(t){throw t.message='Could not create unit "'+e+'" from "'+r+'": '+t.message,t}else r&&"Unit"===r.type&&(o=r.clone());s=s||[],l=l||0,i=i&&i.toUpperCase&&z[i.toUpperCase()]||z.NONE;var c={};if(o){c={name:e,value:o.value,dimensions:o.dimensions.slice(0),prefixes:i,offset:l};var h=!1;for(var p in k)if(Tn(k,p)){for(var d=!0,f=0;f<B.length;f++)if(Math.abs((c.dimensions[f]||0)-(k[p].dimensions[f]||0))>1e-12){d=!1;break}if(d){h=!0,c.base=k[p];break}}if(!h){a=a||e+"_STUFF";var m={dimensions:o.dimensions.slice(0)};m.key=a,k[a]=m,U[a]={unit:c,prefix:z.NONE[""]},c.base=k[a]}}else{if(a=a||e+"_STUFF",B.indexOf(a)>=0)throw new Error('Cannot create new base unit "'+e+'": a base unit with that name already exists (and cannot be overridden)');for(var g in B.push(a),k)Tn(k,g)&&(k[g].dimensions[B.length-1]=0);for(var y={dimensions:[]},v=0;v<B.length;v++)y.dimensions[v]=0;y.dimensions[B.length-1]=1,y.key=a,k[a]=y,c={name:e,value:1,dimensions:k[a].dimensions.slice(0),prefixes:i,offset:l,base:k[a]},U[a]={unit:c,prefix:z.NONE[""]}}w.UNITS[e]=c;for(var x=0;x<s.length;x++){var _=s[x],b={};for(var A in c)Tn(c,A)&&(b[A]=c[A]);b.name=_,w.UNITS[_]=b}return delete N.cache,new w(null,e)},w.deleteUnit=function(e){delete w.UNITS[e],delete N.cache},w.PREFIXES=z,w.BASE_DIMENSIONS=B,w.BASE_UNITS=k,w.UNIT_SYSTEMS=j,w.UNITS=O,w}),{isClass:!0}),pb="createUnit",db=Ii(pb,["typed","Unit"],(e=>{var{typed:t,Unit:r}=e;return t(pb,{"Object, Object":function(e,t){return r.createUnit(e,t)},Object:function(e){return r.createUnit(e,{})},"string, Unit | string | Object, Object":function(e,t,n){var i={};return i[e]=t,r.createUnit(i,n)},"string, Unit | string | Object":function(e,t){var n={};return n[e]=t,r.createUnit(n,{})},string:function(e){var t={};return t[e]={},r.createUnit(t,{})}})})),fb="dotPow",mb=Ii(fb,["typed","equalScalar","matrix","pow","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,equalScalar:r,matrix:n,pow:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=il({typed:t}),u=Fy({typed:t,SparseMatrix:s}),c=xl({typed:t,equalScalar:r}),h=al({typed:t,DenseMatrix:a}),p=cl({typed:t,matrix:n,concat:o}),d={};for(var f in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,f)&&(f.includes("Matrix")||f.includes("Array")||(d[f]=i.signatures[f]));var m=t(d);return t(fb,p({elop:m,SS:u,DS:l,Ss:c,sS:h}))})),gb="expm",yb=Ii(gb,["typed","abs","add","identity","inv","multiply"],(e=>{var{typed:t,abs:r,add:n,identity:i,inv:a,multiply:o}=e;return t(gb,{Matrix:function(e){var t=e.size();if(2!==t.length||t[0]!==t[1])throw new RangeError("Matrix must be square (size: "+ha(t)+")");for(var l=t[0],u=function(e){for(var t=e.size()[0],n=0,i=0;i<t;i++){for(var a=0,o=0;o<t;o++)a+=r(e.get([i,o]));n=Math.max(a,n)}return n}(e),c=function(e){for(var t=0;t<30;t++)for(var r=0;r<=t;r++){var n=t-r;if(s(e,r,n)<1e-15)return{q:r,j:n}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}(u),h=c.q,p=c.j,d=o(e,Math.pow(2,-p)),f=i(l),m=i(l),g=1,y=d,v=-1,x=1;x<=h;x++)x>1&&(y=o(y,d),v=-v),f=n(f,o(g=g*(h-x+1)/((2*h-x+1)*x),y)),m=n(m,o(g*v,y));for(var _=o(a(m),f),b=0;b<p;b++)_=o(_,_);return Jn(e)?e.createSparseMatrix(_):_}});function s(e,t,r){for(var n=1,i=2;i<=t;i++)n*=i;for(var a=n,o=t+1;o<=2*t;o++)a*=o;var s=a*(2*t+1);return 8*Math.pow(e/Math.pow(2,r),2*t)*n*n/(a*s)}})),vb=Ii("fft",["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],(e=>{var{typed:t,matrix:r,addScalar:n,multiplyScalar:i,divideScalar:a,exp:o,tau:s,i:l,dotDivide:u,conj:c,pow:h,ceil:p,log2:d}=e;return t("fft",{Array:f,Matrix:function(e){return e.create(f(e.valueOf()),e.datatype())}});function f(e){var t=ba(e);return 1===t.length?g(e,t[0]):m(e.map((e=>f(e,t.slice(1)))),0)}function m(e,t){var r=ba(e);if(0!==t)return new Array(r[0]).fill(0).map(((r,n)=>m(e[n],t-1)));if(1===r.length)return g(e);function n(e){var t=ba(e);return new Array(t[1]).fill(0).map(((r,n)=>new Array(t[0]).fill(0).map(((t,r)=>e[r][n]))))}return n(m(n(e),1))}function g(e){var t=e.length;if(1===t)return[e[0]];if(t%2==0){for(var r=[...g(e.filter(((e,t)=>t%2==0))),...g(e.filter(((e,t)=>t%2==1)))],m=0;m<t/2;m++){var y=r[m],v=i(r[m+t/2],o(i(i(s,l),a(-m,t))));r[m]=n(y,v),r[m+t/2]=n(y,i(-1,v))}return r}return function(e){for(var t=e.length,r=o(a(i(-1,i(l,s)),t)),n=[],m=1-t;m<t;m++)n.push(h(r,a(h(m,2),2)));for(var y=h(2,p(d(t+t-1))),v=[...new Array(t).fill(0).map(((r,a)=>i(e[a],n[t-1+a]))),...new Array(y-t).fill(0)],x=[...new Array(t+t-1).fill(0).map(((e,t)=>a(1,n[t]))),...new Array(y-(t+t-1)).fill(0)],_=g(v),b=g(x),w=new Array(y).fill(0).map(((e,t)=>i(_[t],b[t]))),A=u(c(f(c(w))),y),C=[],E=t-1;E<t+t-1;E++)C.push(i(A[E],n[E]));return C}(e)}})),xb="gamma",_b=Ii(xb,["typed","config","multiplyScalar","pow","BigNumber","Complex"],(e=>{var{typed:t,config:r,multiplyScalar:n,pow:i,BigNumber:a,Complex:o}=e;return t(xb,{number:Vm,Complex:function e(t){if(0===t.im)return Vm(t.re);if(t.re<.5){var r=new o(1-t.re,-t.im),n=new o(Math.PI*t.re,Math.PI*t.im);return new o(Math.PI).div(n.sin()).div(e(r))}t=new o(t.re-1,t.im);for(var i=new o($m[0],0),a=1;a<$m.length;++a){var s=new o($m[a],0);i=i.add(s.div(t.add(a)))}var l=new o(t.re+Zm+.5,t.im),u=Math.sqrt(2*Math.PI),c=l.pow(t.add(.5)),h=l.neg().exp();return i.mul(u).mul(c).mul(h)},BigNumber:function(e){if(e.isInteger())return e.isNegative()||e.isZero()?new a(1/0):s(e.minus(1));if(!e.isFinite())return new a(e.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}});function s(e){if(e<8)return new a([1,1,2,6,24,120,720,5040][e]);var t=r.precision+(0|Math.log(e.toNumber())),n=a.clone({precision:t});if(e%2==1)return e.times(s(new a(e-1)));for(var i=e,o=new n(e),l=e.toNumber();i>2;)l+=i-=2,o=o.times(l);return new a(o.toPrecision(a.precision))}})),bb="ifft",wb=Ii(bb,["typed","fft","dotDivide","conj"],(e=>{var{typed:t,fft:r,dotDivide:n,conj:i}=e;return t(bb,{"Array | Matrix":function(e){var t=Xn(e)?e.size():ba(e);return n(i(r(i(e))),t.reduce(((e,t)=>e*t),1))}})})),Ab="setSize",Cb=Ii(Ab,["typed","compareNatural"],(e=>{var{typed:t,compareNatural:r}=e;return t(Ab,{"Array | Matrix":function(e){return Array.isArray(e)?Fa(e).length:Fa(e.toArray()).length},"Array | Matrix, boolean":function(e,t){if(!1===t||0===e.length)return Array.isArray(e)?Fa(e).length:Fa(e.toArray()).length;for(var n=Fa(Array.isArray(e)?e:e.toArray()).sort(r),i=1,a=1;a<n.length;a++)0!==r(n[a],n[a-1])&&i++;return i}})})),Eb=Ii("divide",["typed","matrix","multiply","equalScalar","divideScalar","inv"],(e=>{var{typed:t,matrix:r,multiply:n,equalScalar:i,divideScalar:a,inv:o}=e,s=xl({typed:t,equalScalar:i}),l=ll({typed:t});return t("divide",Sn({"Array | Matrix, Array | Matrix":function(e,t){return n(e,o(t))},"DenseMatrix, any":function(e,t){return l(e,t,a,!1)},"SparseMatrix, any":function(e,t){return s(e,t,a,!1)},"Array, any":function(e,t){return l(r(e),t,a,!1).valueOf()},"any, Array | Matrix":function(e,t){return n(e,o(t))}},a.signatures))})),Mb="factorial",Sb=Ii(Mb,["typed","gamma"],(e=>{var{typed:t,gamma:r}=e;return t(Mb,{number:function(e){if(e<0)throw new Error("Value must be non-negative");return r(e+1)},BigNumber:function(e){if(e.isNegative())throw new Error("Value must be non-negative");return r(e.plus(1))},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),Db=Ii("intersect",["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],(e=>{var{typed:t,config:r,abs:n,add:i,addScalar:a,matrix:o,multiply:s,multiplyScalar:l,divideScalar:u,subtract:c,smaller:h,equalScalar:p,flatten:d,isZero:f,isNumeric:m}=e;return t("intersect",{"Array, Array, Array":g,"Array, Array, Array, Array":y,"Matrix, Matrix, Matrix":function(e,t,r){var n=g(e.valueOf(),t.valueOf(),r.valueOf());return null===n?null:o(n)},"Matrix, Matrix, Matrix, Matrix":function(e,t,r,n){var i=y(e.valueOf(),t.valueOf(),r.valueOf(),n.valueOf());return null===i?null:o(i)}});function g(e,t,r){if(e=v(e),t=v(t),r=v(r),!_(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!_(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!function(e){return 4===e.length&&m(e[0])&&m(e[1])&&m(e[2])&&m(e[3])}(r))throw new TypeError("Array with 4 numbers expected as third argument");return function(e,t,r,n,i,o,s,h,p,d){var f=l(e,s),m=l(n,s),g=l(t,h),y=l(i,h),v=l(r,p),x=l(o,p),_=c(c(c(d,f),g),v),b=c(c(c(a(a(m,y),x),f),g),v),w=u(_,b);return[a(e,l(w,c(n,e))),a(t,l(w,c(i,t))),a(r,l(w,c(o,r)))]}(e[0],e[1],e[2],t[0],t[1],t[2],r[0],r[1],r[2],r[3])}function y(e,t,o,d){if(e=v(e),t=v(t),o=v(o),d=v(d),2===e.length){if(!x(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!x(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!x(o))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!x(d))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return function(e,t,o,p){var d=e,m=o,g=c(d,t),y=c(m,p),v=c(l(g[0],y[1]),l(y[0],g[1]));if(f(v))return null;if(h(n(v),r.relTol))return null;var x=l(y[0],d[1]),_=l(y[1],d[0]),b=l(y[0],m[1]),w=l(y[1],m[0]),A=u(a(c(c(x,_),b),w),v);return i(s(g,A),d)}(e,t,o,d)}if(3===e.length){if(!_(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!_(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!_(o))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!_(d))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return function(e,t,r,n,i,o,s,h,d,m,g,y){var v=b(e,s,m,s,t,h,g,h,r,d,y,d),x=b(m,s,n,e,g,h,i,t,y,d,o,r),_=b(e,s,n,e,t,h,i,t,r,d,o,r),w=b(m,s,m,s,g,h,g,h,y,d,y,d),A=b(n,e,n,e,i,t,i,t,o,r,o,r),C=c(l(v,x),l(_,w)),E=c(l(A,w),l(x,x));if(f(E))return null;var M=u(C,E),S=u(a(v,l(M,x)),w),D=a(e,l(M,c(n,e))),T=a(t,l(M,c(i,t))),N=a(r,l(M,c(o,r))),I=a(s,l(S,c(m,s))),P=a(h,l(S,c(g,h))),z=a(d,l(S,c(y,d)));return p(D,I)&&p(T,P)&&p(N,z)?[D,T,N]:null}(e[0],e[1],e[2],t[0],t[1],t[2],o[0],o[1],o[2],d[0],d[1],d[2])}throw new TypeError("Arrays with two or thee dimensional points expected")}function v(e){return 1===e.length?e[0]:e.length>1&&Array.isArray(e[0])&&e.every((e=>Array.isArray(e)&&1===e.length))?d(e):e}function x(e){return 2===e.length&&m(e[0])&&m(e[1])}function _(e){return 3===e.length&&m(e[0])&&m(e[1])&&m(e[2])}function b(e,t,r,n,i,o,s,u,h,p,d,f){var m=l(c(e,t),c(r,n)),g=l(c(i,o),c(s,u)),y=l(c(h,p),c(d,f));return a(a(m,g),y)}})),Tb=Ii("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],(e=>{var{typed:t,matrix:r,abs:n,addScalar:i,divideScalar:a,multiplyScalar:o,subtractScalar:s,larger:l,equalScalar:u,unaryMinus:c,DenseMatrix:h,SparseMatrix:p,Spa:d}=e;return t("lup",{DenseMatrix:function(e){return f(e)},SparseMatrix:function(e){return function(e){var t,r,i,s=e._size[0],h=e._size[1],f=Math.min(s,h),m=e._values,g=e._index,y=e._ptr,v=[],x=[],_=[],b=[s,f],w=[],A=[],C=[],E=[f,h],M=[],S=[];for(t=0;t<s;t++)M[t]=t,S[t]=t;var D=function(){var e=new d;r<s&&(_.push(v.length),v.push(1),x.push(r)),C.push(w.length);var h=y[r],f=y[r+1];for(i=h;i<f;i++)t=g[i],e.set(M[t],m[i]);r>0&&e.forEach(0,r-1,(function(t,r){p._forEachRow(t,v,x,_,(function(n,i){n>t&&e.accumulate(n,c(o(i,r)))}))}));var D,T,N,I,P=r,z=e.get(r),B=n(z);e.forEach(r+1,s-1,(function(e,t){var r=n(t);l(r,B)&&(P=e,B=r,z=t)})),r!==P&&(p._swapRows(r,P,b[1],v,x,_),p._swapRows(r,P,E[1],w,A,C),e.swap(r,P),T=P,N=S[D=r],I=S[T],M[N]=T,M[I]=D,S[D]=I,S[T]=N),e.forEach(0,s-1,(function(e,t){e<=r?(w.push(t),A.push(e)):(t=a(t,z),u(t,0)||(v.push(t),x.push(e)))}))};for(r=0;r<h;r++)D();return C.push(w.length),_.push(v.length),{L:new p({values:v,index:x,ptr:_,size:b}),U:new p({values:w,index:A,ptr:C,size:E}),p:M,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}(e)},Array:function(e){var t=f(r(e));return{L:t.L.valueOf(),U:t.U.valueOf(),p:t.p}}});function f(e){var t,r,c,p=e._size[0],d=e._size[1],f=Math.min(p,d),m=Mn(e._data),g=[],y=[p,f],v=[],x=[f,d],_=[];for(t=0;t<p;t++)_[t]=t;for(r=0;r<d;r++){if(r>0)for(t=0;t<p;t++){var b=Math.min(t,r),w=0;for(c=0;c<b;c++)w=i(w,o(m[t][c],m[c][r]));m[t][r]=s(m[t][r],w)}var A=r,C=0,E=0;for(t=r;t<p;t++){var M=m[t][r],S=n(M);l(S,C)&&(A=t,C=S,E=M)}if(r!==A&&(_[r]=[_[A],_[A]=_[r]][0],h._swapRows(r,A,m)),r<p)for(t=r+1;t<p;t++){var D=m[t][r];u(D,0)||(m[t][r]=a(m[t][r],E))}}for(r=0;r<d;r++)for(t=0;t<p;t++)0===r&&(t<d&&(v[t]=[]),g[t]=[]),t<r?(t<d&&(v[t][r]=m[t][r]),r<p&&(g[t][r]=0)):t!==r?(t<d&&(v[t][r]=0),r<p&&(g[t][r]=m[t][r])):(t<d&&(v[t][r]=m[t][r]),r<p&&(g[t][r]=1));var T=new h({data:g,size:y}),N=new h({data:v,size:x}),I=[];for(t=0,f=_.length;t<f;t++)I[_[t]]=t;return{L:T,U:N,p:I,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}})),Nb="multinomial",Ib=Ii(Nb,["typed","add","divide","multiply","factorial","isInteger","isPositive"],(e=>{var{typed:t,add:r,divide:n,multiply:i,factorial:a,isInteger:o,isPositive:s}=e;return t(Nb,{"Array | Matrix":function(e){var t=0,l=1;return Wo(e,(function(e){if(!o(e)||!s(e))throw new TypeError("Positive integer value expected in function multinomial");t=r(t,e),l=i(l,a(e))})),n(a(t),l)}})})),Pb="permutations",zb=Ii(Pb,["typed","factorial"],(e=>{var{typed:t,factorial:r}=e;return t(Pb,{"number | BigNumber":r,"number, number":function(e,t){if(!Fi(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(!Fi(t)||t<0)throw new TypeError("Positive integer value expected in function permutations");if(t>e)throw new TypeError("second argument k must be less than or equal to first argument n");return Yf(e-t+1,e)},"BigNumber, BigNumber":function(e,t){var r,n;if(!Bb(e)||!Bb(t))throw new TypeError("Positive integer value expected in function permutations");if(t.gt(e))throw new TypeError("second argument k must be less than or equal to first argument n");for(r=e.mul(0).add(1),n=e.minus(t).plus(1);n.lte(e);n=n.plus(1))r=r.times(n);return r}})}));function Bb(e){return e.isInteger()&&e.gte(0)}var kb="polynomialRoot",Fb=Ii(kb,["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],(e=>{var{typed:t,isZero:r,equalScalar:n,add:i,subtract:a,multiply:o,divide:s,sqrt:l,unaryMinus:u,cbrt:c,typeOf:h,im:p,re:d}=e;return t(kb,{"number|Complex, ...number|Complex":(e,t)=>{for(var f=[e,...t];f.length>0&&r(f[f.length-1]);)f.pop();if(f.length<2)throw new RangeError("Polynomial [".concat(e,", ").concat(t,"] must have a non-zero non-constant coefficient"));switch(f.length){case 2:return[u(s(f[0],f[1]))];case 3:var[m,g,y]=f,v=o(2,y),x=o(g,g),_=o(4,y,m);if(n(x,_))return[s(u(g),v)];var b=l(a(x,_));return[s(a(b,g),v),s(a(u(b),g),v)];case 4:var[w,A,C,E]=f,M=u(o(3,E)),S=o(C,C),D=o(3,E,A),T=i(o(2,C,C,C),o(27,E,E,w)),N=o(9,E,C,A);if(n(S,D)&&n(T,N))return[s(C,M)];var I,P=a(S,D),z=a(T,N),B=i(o(18,E,C,A,w),o(C,C,A,A)),k=i(o(4,C,C,C,w),o(4,E,A,A,A),o(27,E,E,w,w));return n(B,k)?[s(a(o(4,E,C,A),i(o(9,E,E,w),o(C,C,C))),o(E,P)),s(a(o(9,E,w),o(C,A)),o(2,P))]:(I=n(S,D)?z:s(i(z,l(a(o(z,z),o(4,P,P,P)))),2),c(I,!0).toArray().map((e=>s(i(C,e,s(P,e)),M))).map((e=>"Complex"===h(e)&&n(d(e),d(e)+p(e))?d(e):e)));default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(f))}}})})),Rb="setIntersect",Ob=Ii(Rb,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:r,subset:n,compareNatural:i,Index:a,DenseMatrix:o}=e;return t(Rb,{"Array | Matrix, Array | Matrix":function(e,t){var s;if(0===n(r(e),new a(0))||0===n(r(t),new a(0)))s=[];else{var l=Ua(Fa(Array.isArray(e)?e:e.toArray()).sort(i)),u=Ua(Fa(Array.isArray(t)?t:t.toArray()).sort(i));s=[];for(var c=0;c<l.length;c++)for(var h=0;h<u.length;h++)if(0===i(l[c].value,u[h].value)&&l[c].identifier===u[h].identifier){s.push(l[c]);break}}return Array.isArray(e)&&Array.isArray(t)?Va(s):new o(Va(s))}})}));function Lb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var qb=Ii("solveODE",["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],(e=>{var{typed:t,add:r,subtract:n,multiply:i,divide:a,max:o,map:s,abs:l,isPositive:u,isNegative:c,larger:h,smaller:p,matrix:d,bignumber:f,unaryMinus:m}=e;function g(e){return function(t,d,g,y){if(2!==d.length||!d.every(_)&&!d.every(Gn))throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var v=d[0],x=d[1],b=h(x,v),w=y.firstStep;if(void 0!==w&&!u(w))throw new Error('"firstStep" must be positive');var A=y.maxStep;if(void 0!==A&&!u(A))throw new Error('"maxStep" must be positive');var C=y.minStep;if(C&&c(C))throw new Error('"minStep" must be positive or zero');var E=[v,x,w,C,A].filter((e=>void 0!==e));if(!E.every(_)&&!E.every(Gn))throw new Error('Inconsistent type of "t" dependant variables');for(var M=y.tol?y.tol:1e-4,S=y.minDelta?y.minDelta:.2,D=y.maxDelta?y.maxDelta:5,T=y.maxIter?y.maxIter:1e4,N=[v,x,...g,A,C].some(Un),[I,P,z,B]=N?[f(e.a),f(e.c),f(e.b),f(e.bp)]:[e.a,e.c,e.b,e.bp],k=w?b?w:m(w):a(n(x,v),1),F=[v],R=[g],O=n(z,B),L=0,q=0,j=function(e){return e?p:h}(b),U=function(e){var t=e?h:p;return function(e,i,a){var o=r(e,a);return t(o,i)?n(i,e):a}}(b);j(F[L],x);){var V=[];k=U(F[L],x,k),V.push(t(F[L],R[L]));for(var Z=1;Z<P.length;++Z)V.push(t(r(F[L],i(P[Z],k)),r(R[L],i(k,I[Z],V))));var $=o(l(s(i(O,V),(e=>Gn(e)?e.value:e))));$<M&&M/$>1/4&&(F.push(r(F[L],k)),R.push(r(R[L],i(k,z,V))),L++);var G=.84*(M/$)**.2;if(p(G,S)?G=S:h(G,D)&&(G=D),G=N?f(G):G,k=i(k,G),A&&h(l(k),A)?k=b?A:m(A):C&&p(l(k),C)&&(k=b?C:m(C)),++q>T)throw new Error("Maximum number of iterations reached, try changing options")}return{t:F,y:R}}}function y(e,t,r,n){return g({a:[[],[.5],[0,3/4],[2/9,1/3,4/9]],c:[null,.5,3/4,1],b:[2/9,1/3,4/9,0],bp:[7/24,1/4,1/3,1/8]})(e,t,r,n)}function v(e,t,r,n){return g({a:[[],[.2],[3/40,9/40],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]],c:[null,.2,.3,.8,8/9,1,1],b:[35/384,0,500/1113,125/192,-2187/6784,11/84,0],bp:[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40]})(e,t,r,n)}function x(e,t,r,n){var i=n.method?n.method:"RK45",a={RK23:y,RK45:v};if(i.toUpperCase()in a){var o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lb(Object(r),!0).forEach((function(t){ki(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lb(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},n);return delete o.method,a[i.toUpperCase()](e,t,r,o)}var s=Object.keys(a).map((e=>'"'.concat(e,'"'))),l="".concat(s.slice(0,-1).join(", ")," and ").concat(s.slice(-1));throw new Error('Unavailable method "'.concat(i,'". Available methods are ').concat(l))}function _(e){return Un(e)||jn(e)}function b(e,t,r,n){var i=x(e,t.toArray(),r.toArray(),n);return{t:d(i.t),y:d(i.y)}}return t("solveODE",{"function, Array, Array, Object":x,"function, Matrix, Matrix, Object":b,"function, Array, Array":(e,t,r)=>x(e,t,r,{}),"function, Matrix, Matrix":(e,t,r)=>b(e,t,r,{}),"function, Array, number | BigNumber | Unit":(e,t,r)=>{var n=x(e,t,[r],{});return{t:n.t,y:n.y.map((e=>e[0]))}},"function, Matrix, number | BigNumber | Unit":(e,t,r)=>{var n=x(e,t.toArray(),[r],{});return{t:d(n.t),y:d(n.y.map((e=>e[0])))}},"function, Array, number | BigNumber | Unit, Object":(e,t,r,n)=>{var i=x(e,t,[r],n);return{t:i.t,y:i.y.map((e=>e[0]))}},"function, Matrix, number | BigNumber | Unit, Object":(e,t,r,n)=>{var i=x(e,t.toArray(),[r],n);return{t:d(i.t),y:d(i.y.map((e=>e[0])))}}})})),jb="stirlingS2",Ub=Ii(jb,["typed","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],(e=>{var{typed:t,addScalar:r,subtractScalar:n,multiplyScalar:i,divideScalar:a,pow:o,factorial:s,combinations:l,isNegative:u,isInteger:c,number:h,bignumber:p,larger:d}=e,f=[],m=[];return t(jb,{"number | BigNumber, number | BigNumber":function(e,t){if(!c(e)||u(e)||!c(t)||u(t))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(d(t,e))throw new TypeError("k must be less than or equal to n in function stirlingS2");var n=!(jn(e)&&jn(t)),a=n?m:f,o=n?p:h,s=h(e),l=h(t);if(a[s]&&a[s].length>l)return a[s][l];for(var g=0;g<=s;++g)if(a[g]||(a[g]=[o(0===g?1:0)]),0!==g)for(var y=a[g],v=a[g-1],x=y.length;x<=g&&x<=l;++x)y[x]=x===g?1:r(i(o(x),v[x]),v[x-1]);return a[s][l]}})})),Vb="unit",Zb=Ii(Vb,["typed","Unit"],(e=>{var{typed:t,Unit:r}=e;return t(Vb,{Unit:function(e){return e.clone()},string:function(e){return r.isValuelessUnit(e)?new r(null,e):r.parse(e,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(e,t){return new r(e,t)},"number | BigNumber | Fraction":function(e){return new r(e)},"Array | Matrix":t.referToSelf((e=>t=>Xo(t,e)))})})),$b="bellNumbers",Gb=Ii($b,["typed","addScalar","isNegative","isInteger","stirlingS2"],(e=>{var{typed:t,addScalar:r,isNegative:n,isInteger:i,stirlingS2:a}=e;return t($b,{"number | BigNumber":function(e){if(!i(e)||n(e))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var t=0,o=0;o<=e;o++)t=r(t,a(e,o));return t}})}));var Hb=Ii("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],(e=>{var{config:t,typed:r,matrix:n,addScalar:i,subtract:a,equal:o,abs:s,atan:l,cos:u,sin:c,multiplyScalar:h,divideScalar:p,inv:d,bignumber:f,multiply:m,add:g,larger:y,column:v,flatten:x,number:_,complex:b,sqrt:w,diag:A,size:C,reshape:E,qr:M,usolve:S,usolveAll:D,im:T,re:N,smaller:I,matrixFromColumns:P,dot:z}=e,B=function(e){var{config:t,addScalar:r,subtract:n,abs:i,atan:a,cos:o,sin:s,multiplyScalar:l,inv:u,bignumber:c,multiply:h,add:p}=e;function d(e,t,r,n){for(var i=e.length,a=Math.cos(t),o=Math.sin(t),s=Array(i).fill(0),l=Array(i).fill(0),u=0;u<i;u++)s[u]=a*e[u][r]-o*e[u][n],l[u]=o*e[u][r]+a*e[u][n];for(var c=0;c<i;c++)e[c][r]=s[c],e[c][n]=l[c];return e}function f(e,t,i,a){for(var u=e.length,h=o(t),p=s(t),d=Array(u).fill(c(0)),f=Array(u).fill(c(0)),m=0;m<u;m++)d[m]=n(l(h,e[m][i]),l(p,e[m][a])),f[m]=r(l(p,e[m][i]),l(h,e[m][a]));for(var g=0;g<u;g++)e[g][i]=d[g],e[g][a]=f[g];return e}function m(e,t,i,a){for(var u=e.length,d=c(o(t)),f=c(s(t)),m=l(d,d),g=l(f,f),y=Array(u).fill(c(0)),v=Array(u).fill(c(0)),x=h(c(2),d,f,e[i][a]),_=r(n(l(m,e[i][i]),x),l(g,e[a][a])),b=p(l(g,e[i][i]),x,l(m,e[a][a])),w=0;w<u;w++)y[w]=n(l(d,e[i][w]),l(f,e[a][w])),v[w]=r(l(f,e[i][w]),l(d,e[a][w]));e[i][i]=_,e[a][a]=b,e[i][a]=c(0),e[a][i]=c(0);for(var A=0;A<u;A++)A!==i&&A!==a&&(e[i][A]=y[A],e[A][i]=y[A],e[a][A]=v[A],e[A][a]=v[A]);return e}function g(e,t,r,n){for(var i=e.length,a=Math.cos(t),o=Math.sin(t),s=a*a,l=o*o,u=Array(i).fill(0),c=Array(i).fill(0),h=s*e[r][r]-2*a*o*e[r][n]+l*e[n][n],p=l*e[r][r]+2*a*o*e[r][n]+s*e[n][n],d=0;d<i;d++)u[d]=a*e[r][d]-o*e[n][d],c[d]=o*e[r][d]+a*e[n][d];e[r][r]=h,e[n][n]=p,e[r][n]=0,e[n][r]=0;for(var f=0;f<i;f++)f!==r&&f!==n&&(e[r][f]=u[f],e[f][r]=u[f],e[n][f]=c[f],e[f][n]=c[f]);return e}function y(e){for(var t=e.length,r=0,n=[0,1],i=0;i<t;i++)for(var a=i+1;a<t;a++)Math.abs(r)<Math.abs(e[i][a])&&(r=Math.abs(e[i][a]),n=[i,a]);return[n,r]}function v(e){for(var t=e.length,r=0,n=[0,1],a=0;a<t;a++)for(var o=a+1;o<t;o++)i(r)<i(e[a][o])&&(r=i(e[a][o]),n=[a,o]);return[n,r]}function x(e,t,r){var n,a=e.length,o=Array(a);if(r){n=Array(a);for(var s=0;s<a;s++)n[s]=Array(a)}for(var l=0;l<a;l++){for(var u=0,c=e[0],h=0;h<e.length;h++)i(e[h])<i(c)&&(c=e[u=h]);if(o[l]=e.splice(u,1)[0],r)for(var p=0;p<a;p++)n[l][p]=t[p][u],t[p].splice(u,1)}if(!r)return{values:o};var d=n.map(((e,t)=>({value:o[t],vector:e})));return{values:o,eigenvectors:d}}return function(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.relTol,s=arguments.length>3?arguments[3]:void 0,p=arguments.length>4?arguments[4]:void 0;if("number"===s)return function(e,r,n){var i,a,o=e.length,s=Math.abs(r/o);if(n){a=new Array(o);for(var l=0;l<o;l++)a[l]=Array(o).fill(0),a[l][l]=1}for(var u,c,h,p,f=y(e);Math.abs(f[1])>=Math.abs(s);){var m=f[0][0],v=f[0][1];e=g(e,(u=e[m][m],c=e[v][v],h=e[m][v],p=void 0,p=c-u,i=Math.abs(p)<=t.relTol?Math.PI/4:.5*Math.atan(2*h/(c-u))),m,v),n&&(a=d(a,i,m,v)),f=y(e)}for(var _=Array(o).fill(0),b=0;b<o;b++)_[b]=e[b][b];return x(Mn(_),a,n)}(e,o,p);if("BigNumber"===s)return function(e,r,o){var s,p,d=e.length,g=i(r/d);if(o){p=new Array(d);for(var y=0;y<d;y++)p[y]=Array(d).fill(0),p[y][y]=1}for(var _,b,w,A,C=v(e);i(C[1])>=i(g);){var E=C[0][0],M=C[0][1];e=m(e,(_=e[E][E],b=e[M][M],w=e[E][M],A=void 0,A=n(b,_),s=i(A)<=t.relTol?c(-1).acos().div(4):l(.5,a(h(2,w,u(A))))),E,M),o&&(p=f(p,s,E,M)),C=v(e)}for(var S=Array(d).fill(0),D=0;D<d;D++)S[D]=e[D][D];return x(Mn(S),p,o)}(e,o,p);throw TypeError("Unsupported data type: "+s)}}({config:t,addScalar:i,subtract:a,column:v,flatten:x,equal:o,abs:s,atan:l,cos:u,sin:c,multiplyScalar:h,inv:d,bignumber:f,complex:b,multiply:m,add:g}),k=function(e){var{addScalar:t,subtract:r,flatten:n,multiply:i,multiplyScalar:a,divideScalar:o,sqrt:s,abs:l,bignumber:u,diag:c,size:h,reshape:p,inv:d,qr:f,usolve:m,usolveAll:g,equal:y,complex:v,larger:x,smaller:_,matrixFromColumns:b,dot:w}=e;function A(e,t,n,i,a,o,s,c){var h="BigNumber"===c,p="Complex"===c,d=h?u(0):p?v(0):0,f=h?u(1):p?v(1):1;if(_(l(n),s))return[[f,d],[d,f]];if(x(l(r(a,o)),s))return[[r(a,i),r(o,i)],[n,n]];var m=r(e,a),g=r(i,a);return _(l(t),s)&&_(l(g),s)?[[m,f],[n,d]]:[[t,d],[g,f]]}function C(e,t){for(var r=0;r<e.length;r++)e[r].push(...Array(t-e[r].length).fill(0));for(var n=e.length;n<t;n++)e.push(Array(t).fill(0)),e[n][n]=1;return e}function E(e,t,r){for(var n=0;n<e.length;n++)if(r(e[n],t))return n;return-1}function M(e,t,r,n,i){for(var a,o="BigNumber"===i?u(1e3):1e3,s=0;s<5;++s){a=S(t,r,i);try{a=m(e,a)}catch(e){continue}if(x(T(a),o))break}if(s>=5)return null;for(s=0;;){var l=m(e,a);if(_(T(D(a,[l])),n))break;if(++s>=10)return null;a=N(l)}return a}function S(e,t,r){var n="BigNumber"===r,i="Complex"===r,a=Array(e).fill(0).map((e=>2*Math.random()-1));return n&&(a=a.map((e=>u(e)))),i&&(a=a.map((e=>v(e)))),N(a=D(a,t),r)}function D(e,t){var n=h(e);for(var a of t)a=p(a,n),e=r(e,i(o(w(a,e),w(a,a)),a));return e}function T(e){return l(s(w(e,e)))}function N(e,t){var r="Complex"===t,n="BigNumber"===t?u(1):r?v(1):1;return i(o(n,T(e)),e)}return function(e,h,p,m){var b=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],w=function(e,r,n,i,s){var h,p="BigNumber"===i,d="Complex"===i,f=p?u(0):0,m=p?u(1):d?v(1):1,g=p?u(1):1,b=p?u(10):2,w=a(b,b);s&&(h=Array(r).fill(m));for(var A=!1;!A;){A=!0;for(var C=0;C<r;C++){for(var E=f,M=f,S=0;S<r;S++)C!==S&&(E=t(E,l(e[S][C])),M=t(M,l(e[C][S])));if(!y(E,0)&&!y(M,0)){for(var D=g,T=E,N=o(M,b),I=a(M,b);_(T,N);)T=a(T,w),D=a(D,b);for(;x(T,I);)T=o(T,w),D=o(D,b);if(_(o(t(T,M),D),a(t(E,M),.95))){A=!1;for(var P=o(1,D),z=0;z<r;z++)C!==z&&(e[C][z]=a(e[C][z],P),e[z][C]=a(e[z][C],D));s&&(h[C]=a(h[C],P))}}}}return s?c(h):null}(e,h,0,m,b);!function(e,n,i,s,c,h){var p="BigNumber"===s,d="Complex"===s,f=p?u(0):d?v(0):0;p&&(i=u(i));for(var m=0;m<n-2;m++){for(var g=0,y=f,x=m+1;x<n;x++){var b=e[x][m];_(l(y),l(b))&&(y=b,g=x)}if(!_(l(y),i)){if(g!==m+1){var w=e[g];e[g]=e[m+1],e[m+1]=w;for(var A=0;A<n;A++){var C=e[A][g];e[A][g]=e[A][m+1],e[A][m+1]=C}if(c){var E=h[g];h[g]=h[m+1],h[m+1]=E}}for(var M=m+2;M<n;M++){var S=o(e[M][m],y);if(0!==S){for(var D=0;D<n;D++)e[M][D]=r(e[M][D],a(S,e[m+1][D]));for(var T=0;T<n;T++)e[T][m+1]=t(e[T][m+1],a(S,e[T][M]));if(c)for(var N=0;N<n;N++)h[M][N]=r(h[M][N],a(S,h[m+1][N]))}}}}}(e,h,p,m,b,w);var{values:S,C:D}=function(e,n,o,h,p){var d="BigNumber"===h,m="Complex"===h,g=d?u(1):m?v(1):1;d&&(o=u(o));for(var y,x,b,w,E,M,S,D,T=Mn(e),N=[],I=n,P=[],z=p?c(Array(n).fill(g)):void 0,B=p?c(Array(I).fill(g)):void 0,k=0;k<=100;){k+=1;for(var F=T[I-1][I-1],R=0;R<I;R++)T[R][R]=r(T[R][R],F);var{Q:O,R:L}=f(T);T=i(L,O);for(var q=0;q<I;q++)T[q][q]=t(T[q][q],F);if(p&&(B=i(B,O)),1===I||_(l(T[I-1][I-2]),o)){k=0,N.push(T[I-1][I-1]),p&&(P.unshift([[1]]),C(B,n),z=i(z,B),I>1&&(B=c(Array(I-1).fill(g)))),I-=1,T.pop();for(var j=0;j<I;j++)T[j].pop()}else if(2===I||_(l(T[I-2][I-3]),o)){k=0;var U=(y=T[I-2][I-2],x=T[I-2][I-1],b=T[I-1][I-2],w=T[I-1][I-1],E=void 0,M=void 0,S=void 0,D=void 0,E=t(y,w),M=r(a(y,w),a(x,b)),S=a(E,.5),D=a(s(r(a(E,E),a(4,M))),.5),[t(S,D),r(S,D)]);N.push(...U),p&&(P.unshift(A(T[I-2][I-2],T[I-2][I-1],T[I-1][I-2],T[I-1][I-1],U[0],U[1],o,h)),C(B,n),z=i(z,B),I>2&&(B=c(Array(I-2).fill(g)))),I-=2,T.pop(),T.pop();for(var V=0;V<I;V++)T[V].pop(),T[V].pop()}if(0===I)break}if(N.sort(((e,t)=>+r(l(e),l(t)))),k>100){var Z=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+N.join(", "));throw Z.values=N,Z.vectors=[],Z}var $=p?i(z,function(e,t){for(var r=[],n=0;n<t;n++)r[n]=Array(t).fill(0);var i=0;for(var a of e){for(var o=a.length,s=0;s<o;s++)for(var l=0;l<o;l++)r[i+s][i+l]=a[s][l];i+=o}return r}(P,n)):void 0;return{values:N,C:$}}(e,h,p,m,b);if(b){var T=function(e,t,a,o,s,l,h){var p=d(a),f=i(p,e,a),m="BigNumber"===h,x="Complex"===h,_=m?u(0):x?v(0):0,b=m?u(1):x?v(1):1,w=[],A=[];for(var C of s){var S=E(w,C,y);-1===S?(w.push(C),A.push(1)):A[S]+=1}for(var D=[],T=w.length,N=Array(t).fill(_),I=c(Array(t).fill(b)),P=function(){var e=w[z],s=r(f,i(e,I)),u=g(s,N);for(u.shift();u.length<A[z];){var c=M(s,t,u,l,h);if(null===c)break;u.push(c)}var p=i(d(o),a);u=u.map((e=>i(p,e))),D.push(...u.map((t=>({value:e,vector:n(t)}))))},z=0;z<T;z++)P();return D}(e,h,D,w,S,p,m);return{values:S,eigenvectors:T}}return{values:S}}}({config:t,addScalar:i,subtract:a,multiply:m,multiplyScalar:h,flatten:x,divideScalar:p,sqrt:w,abs:s,bignumber:f,diag:A,size:C,reshape:E,qr:M,inv:d,usolve:S,usolveAll:D,equal:o,complex:b,larger:y,smaller:I,matrixFromColumns:P,dot:z});return r("eigs",{Array:function(e){return F(n(e))},"Array, number|BigNumber":function(e,t){return F(n(e),{precision:t})},"Array, Object":(e,t)=>F(n(e),t),Matrix:function(e){return F(e,{matricize:!0})},"Matrix, number|BigNumber":function(e,t){return F(e,{precision:t,matricize:!0})},"Matrix, Object":function(e,t){var r={matricize:!0};return An(r,t),F(e,r)}});function F(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!("eigenvectors"in i)||i.eigenvectors,l=function(e,t,r){var n=e.toArray(),i=e.size();if(2!==i.length||i[0]!==i[1])throw new RangeError("Matrix must be square (size: ".concat(ha(i),")"));var o=i[0];if(function(e,t,r){for(var n=0;n<t;n++)for(var i=0;i<t;i++)if(y(f(s(T(e[n][i]))),r))return!1;return!0}(n,o,t)&&(function(e,t){for(var r=0;r<t;r++)for(var n=0;n<t;n++)e[r][n]=N(e[r][n])}(n,o),function(e,t,r){for(var n=0;n<t;n++)for(var i=n;i<t;i++)if(y(f(s(a(e[n][i],e[i][n]))),r))return!1;return!0}(n,o,t))){var l=R(e,n,o);return B(n,o,t,l,r)}var u=R(e,n,o);return k(n,o,t,u,r)}(e,null!==(r=i.precision)&&void 0!==r?r:t.relTol,o);return i.matricize&&(l.values=n(l.values),o&&(l.eigenvectors=l.eigenvectors.map((e=>{var{value:t,vector:r}=e;return{value:t,vector:n(r)}})))),o&&Object.defineProperty(l,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),l}function R(e,t,r){var n=e.datatype();if("number"===n||"BigNumber"===n||"Complex"===n)return n;for(var i=!1,a=!1,o=!1,s=0;s<r;s++)for(var l=0;l<r;l++){var u=t[s][l];if(jn(u)||$n(u))i=!0;else if(Un(u))a=!0;else{if(!Zn(u))throw TypeError("Unsupported type in Matrix: "+Ti(u));o=!0}}if(a&&o&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),o){for(var c=0;c<r;c++)for(var h=0;h<r;h++)t[c][h]=b(t[c][h]);return"Complex"}if(a){for(var p=0;p<r;p++)for(var d=0;d<r;d++)t[p][d]=f(t[p][d]);return"BigNumber"}if(i){for(var m=0;m<r;m++)for(var g=0;g<r;g++)t[m][g]=_(t[m][g]);return"number"}throw TypeError("Matrix contains unsupported types only.")}})),Wb="kldivergence",Xb=Ii(Wb,["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],(e=>{var{typed:t,matrix:r,divide:n,sum:i,multiply:a,map:o,dotDivide:s,log:l,isNumeric:u}=e;return t(Wb,{"Array, Array":function(e,t){return c(r(e),r(t))},"Matrix, Array":function(e,t){return c(e,r(t))},"Array, Matrix":function(e,t){return c(r(e),t)},"Matrix, Matrix":function(e,t){return c(e,t)}});function c(e,t){var r=t.size().length,c=e.size().length;if(r>1)throw new Error("first object must be one dimensional");if(c>1)throw new Error("second object must be one dimensional");if(r!==c)throw new Error("Length of two vectors must be equal");if(0===i(e))throw new Error("Sum of elements in first object must be non zero");if(0===i(t))throw new Error("Sum of elements in second object must be non zero");var h=n(e,i(e)),p=n(t,i(t)),d=i(a(h,o(s(h,p),(e=>l(e)))));return u(d)?d:Number.NaN}}));function Yb(e,t){var r,n=t.length,i=[];if(e)for(r=0;r<n;r++)i[e[r]]=t[r];else for(r=0;r<n;r++)i[r]=t[r];return i}var Kb="lusolve",Jb=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],Qb=Ii(Kb,Jb,(e=>{var{typed:t,matrix:r,lup:n,slu:i,usolve:a,lsolve:o,DenseMatrix:s}=e,l=xx({DenseMatrix:s});return t(Kb,{"Array, Array | Matrix":function(e,t){e=r(e);var i=n(e);return c(i.L,i.U,i.p,null,t).valueOf()},"DenseMatrix, Array | Matrix":function(e,t){var r=n(e);return c(r.L,r.U,r.p,null,t)},"SparseMatrix, Array | Matrix":function(e,t){var r=n(e);return c(r.L,r.U,r.p,null,t)},"SparseMatrix, Array | Matrix, number, number":function(e,t,r,n){var a=i(e,r,n);return c(a.L,a.U,a.p,a.q,t)},"Object, Array | Matrix":function(e,t){return c(e.L,e.U,e.p,e.q,t)}});function u(e){if(Xn(e))return e;if(Wn(e))return r(e);throw new TypeError("Invalid Matrix LU decomposition")}function c(e,t,r,n,i){e=u(e),t=u(t),r&&((i=l(e,i,!0))._data=Yb(r,i._data));var s=o(e,i),c=a(t,s);return n&&(c._data=Yb(n,c._data)),c}})),ew="setUnion",tw=["typed","size","concat","subset","setIntersect","setSymDifference","Index"],rw=Ii(ew,tw,(e=>{var{typed:t,size:r,concat:n,subset:i,setIntersect:a,setSymDifference:o,Index:s}=e;return t(ew,{"Array | Matrix, Array | Matrix":function(e,t){if(0===i(r(e),new s(0)))return Fa(t);if(0===i(r(t),new s(0)))return Fa(e);var l=Fa(e),u=Fa(t);return n(o(l,u),a(l,u))}})})),nw="median",iw=["typed","add","divide","compare","partitionSelect"],aw=Ii(nw,iw,(e=>{var{typed:t,add:r,divide:n,compare:i,partitionSelect:a}=e;function o(e){try{var t=(e=Fa(e.valueOf())).length;if(0===t)throw new Error("Cannot calculate median of an empty array");if(t%2==0){for(var r=t/2-1,n=a(e,r+1),o=e[r],u=0;u<r;++u)i(e[u],o)>0&&(o=e[u]);return l(o,n)}var c=a(e,(t-1)/2);return s(c)}catch(e){throw zl(e,"median")}}var s=t({"number | BigNumber | Complex | Unit":function(e){return e}}),l=t({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(e,t){return n(r(e,t),2)}});return t(nw,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("median(A, dim) is not yet supported")},"...":function(e){if(Ho(e))throw new TypeError("Scalar values expected in function median");return o(e)}})})),ow="corr",sw=["typed","matrix","mean","sqrt","sum","add","subtract","multiply","pow","divide"],lw=Ii(ow,sw,(e=>{var{typed:t,matrix:r,sqrt:n,sum:i,add:a,subtract:o,multiply:s,pow:l,divide:u}=e;return t(ow,{"Array, Array":function(e,t){return c(e,t)},"Matrix, Matrix":function(e,t){var n=c(e.toArray(),t.toArray());return Array.isArray(n)?r(n):n}});function c(e,t){var r=[];if(Array.isArray(e[0])&&Array.isArray(t[0])){if(e.length!==t.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same length.");for(var n=0;n<e.length;n++){if(e[n].length!==t[n].length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");r.push(h(e[n],t[n]))}return r}if(e.length!==t.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");return h(e,t)}function h(e,t){var r=e.length,c=i(e),h=i(t),p=e.reduce(((e,r,n)=>a(e,s(r,t[n]))),0),d=i(e.map((e=>l(e,2)))),f=i(t.map((e=>l(e,2)))),m=o(s(r,p),s(c,h)),g=n(s(o(s(r,d),l(c,2)),o(s(r,f),l(h,2))));return u(m,g)}})),uw="freqz",cw=["typed","add","multiply","Complex","divide","matrix"],hw=Ii(uw,cw,(e=>{var{typed:t,add:r,multiply:n,Complex:i,divide:a,matrix:o}=e;return t(uw,{"Array, Array":function(e,t){return s(e,t,l(512))},"Array, Array, Array":function(e,t,r){return s(e,t,r)},"Array, Array, number":function(e,t,r){if(r<0)throw new Error("w must be a positive number");return s(e,t,l(r))},"Matrix, Matrix":function(e,t){var r=l(512),{w:n,h:i}=s(e.valueOf(),t.valueOf(),r);return{w:o(n),h:o(i)}},"Matrix, Matrix, Matrix":function(e,t,r){var{h:n}=s(e.valueOf(),t.valueOf(),r.valueOf());return{h:o(n),w:o(r)}},"Matrix, Matrix, number":function(e,t,r){if(r<0)throw new Error("w must be a positive number");var n=l(r),{h:i}=s(e.valueOf(),t.valueOf(),n);return{h:o(i),w:o(n)}}});function s(e,t,o){for(var s=[],l=[],u=0;u<o.length;u++){for(var c=i(0,0),h=i(0,0),p=0;p<e.length;p++)c=r(c,n(e[p],i(Math.cos(-p*o[u]),Math.sin(-p*o[u]))));for(var d=0;d<t.length;d++)h=r(h,n(t[d],i(Math.cos(-d*o[u]),Math.sin(-d*o[u]))));s.push(c),l.push(h)}for(var f=[],m=0;m<s.length;m++)f.push(a(s[m],l[m]));return{h:f,w:o}}function l(e){for(var t=[],r=0;r<e;r++)t.push(r/e*Math.PI);return t}})),pw=["typed","abs","map","median","subtract"],dw=Ii("mad",pw,(e=>{var{typed:t,abs:r,map:n,median:i,subtract:a}=e;return t("mad",{"Array | Matrix":o,"...":function(e){return o(e)}});function o(e){if(0===(e=Fa(e.valueOf())).length)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var t=i(e);return i(n(e,(function(e){return r(a(e,t))})))}catch(e){throw e instanceof TypeError&&e.message.includes("median")?new TypeError(e.message.replace("median","mad")):zl(e,"mad")}}})),fw="zeta",mw=["typed","config","multiply","pow","divide","factorial","equal","smallerEq","isNegative","gamma","sin","subtract","add","?Complex","?BigNumber","pi"],gw=Ii(fw,mw,(e=>{var{typed:t,config:r,multiply:n,pow:i,divide:a,factorial:o,equal:s,smallerEq:l,isNegative:u,gamma:c,sin:h,subtract:p,add:d,Complex:f,BigNumber:m,pi:g}=e;return t(fw,{number:e=>y(e,(e=>e),(()=>20)),BigNumber:e=>y(e,(e=>new m(e)),(()=>Math.abs(Math.log10(r.relTol)))),Complex:function(e){return 0===e.re&&0===e.im?new f(-.5):1===e.re?new f(NaN,NaN):e.re===1/0&&0===e.im?new f(1):e.im===1/0||e.re===-1/0?new f(NaN,NaN):v(e,(e=>e),(e=>Math.round(19.5+.9*Math.abs(e.im))),(e=>e.re))}});function y(e,t,r){return s(e,0)?t(-.5):s(e,1)?t(NaN):isFinite(e)?v(e,t,r,(e=>e)):u(e)?t(NaN):t(1)}function v(e,t,r,o){var s=r(e);if(o(e)>-(s-1)/2)return function(e,t,r){for(var o=a(1,n(x(r(0),t),p(1,i(2,p(1,e))))),s=r(0),u=r(1);l(u,t);u=d(u,1))s=d(s,a(n((-1)**(u-1),x(u,t)),i(u,e)));return n(o,s)}(e,t(s),t);var u=n(i(2,e),i(t(g),p(e,1)));return u=n(u,h(n(a(t(g),2),e))),u=n(u,c(p(1,e))),n(u,v(p(1,e),t,r,o))}function x(e,t){for(var r=e,s=e;l(s,t);s=d(s,1)){var u=a(n(o(d(t,p(s,1))),i(4,s)),n(o(p(t,s)),o(n(2,s))));r=d(r,u)}return n(t,r)}})),yw="norm",vw=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],xw=Ii(yw,vw,(e=>{var{typed:t,abs:r,add:n,pow:i,conj:a,sqrt:o,multiply:s,equalScalar:l,larger:u,smaller:c,matrix:h,ctranspose:p,eigs:d}=e;return t(yw,{number:Math.abs,Complex:function(e){return e.abs()},BigNumber:function(e){return e.abs()},boolean:function(e){return Math.abs(e)},Array:function(e){return f(h(e),2)},Matrix:function(e){return f(e,2)},"Array, number | BigNumber | string":function(e,t){return f(h(e),t)},"Matrix, number | BigNumber | string":function(e,t){return f(e,t)}});function f(e,t){var h=e.size();if(1===h.length)return function(e,t){if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=0;return e.forEach((function(e){var n=r(e);u(n,t)&&(t=n)}),!0),t}(e);if(t===Number.NEGATIVE_INFINITY||"-inf"===t)return function(e){var t;return e.forEach((function(e){var n=r(e);t&&!c(n,t)||(t=n)}),!0),t||0}(e);if("fro"===t)return f(e,2);if("number"==typeof t&&!isNaN(t)){if(!l(t,0)){var a=0;return e.forEach((function(e){a=n(i(r(e),t),a)}),!0),i(a,1/t)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}(e,t);if(2===h.length){if(h[0]&&h[1])return function(e,t){if(1===t)return function(e){var t=[],i=0;return e.forEach((function(e,a){var o=a[1],s=n(t[o]||0,r(e));u(s,i)&&(i=s),t[o]=s}),!0),i}(e);if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=[],i=0;return e.forEach((function(e,a){var o=a[0],s=n(t[o]||0,r(e));u(s,i)&&(i=s),t[o]=s}),!0),i}(e);if("fro"===t)return function(e){var t=0;return e.forEach((function(e,r){t=n(t,s(e,a(e)))})),r(o(t))}(e);if(2===t)return function(e){var t=e.size();if(t[0]!==t[1])throw new RangeError("Invalid matrix dimensions");var n=p(e),i=s(n,e),a=d(i).values.toArray(),l=a[a.length-1];return r(o(l))}(e);throw new Error("Unsupported parameter value "+t)}(e,t);throw new RangeError("Invalid matrix dimensions")}}})),_w="rotationMatrix",bw=["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],ww=Ii(_w,bw,(e=>{var{typed:t,config:r,multiplyScalar:n,addScalar:i,unaryMinus:a,norm:o,BigNumber:s,matrix:l,DenseMatrix:u,SparseMatrix:c,cos:h,sin:p}=e;return t(_w,{"":function(){return"Matrix"===r.matrix?l([]):[]},string:function(e){return l(e)},"number | BigNumber | Complex | Unit":function(e){return d(e,"Matrix"===r.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(e,t){return d(e,t)},"number | BigNumber | Complex | Unit, Array":function(e,t){var r=l(t);return f(r),y(e,r,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(e,t){f(t);var n=t.storage()||("Matrix"===r.matrix?"dense":void 0);return y(e,t,n)},"number | BigNumber | Complex | Unit, Array, string":function(e,t,r){var n=l(t);return f(n),y(e,n,r)},"number | BigNumber | Complex | Unit, Matrix, string":function(e,t,r){return f(t),y(e,t,r)}});function d(e,t){var r=Un(e)?new s(-1):-1,i=h(e),a=p(e);return g([[i,n(r,a)],[a,i]],t)}function f(e){var t=e.size();if(t.length<1||3!==t[0])throw new RangeError("Vector must be of dimensions 1x3")}function m(e){return e.reduce(((e,t)=>n(e,t)))}function g(e,t){if(t){if("sparse"===t)return new c(e);if("dense"===t)return new u(e);throw new TypeError('Unknown matrix type "'.concat(t,'"'))}return e}function y(e,t,r){var n=o(t);if(0===n)throw new RangeError("Rotation around zero vector");var l=Un(e)?s:null,u=l?new l(1):1,c=l?new l(-1):-1,d=l?new l(t.get([0])/n):t.get([0])/n,f=l?new l(t.get([1])/n):t.get([1])/n,y=l?new l(t.get([2])/n):t.get([2])/n,v=h(e),x=i(u,a(v)),_=p(e);return g([[i(v,m([d,d,x])),i(m([d,f,x]),m([c,y,_])),i(m([d,y,x]),m([f,_]))],[i(m([d,f,x]),m([y,_])),i(v,m([f,f,x])),i(m([f,y,x]),m([c,d,_]))],[i(m([d,y,x]),m([c,f,_])),i(m([f,y,x]),m([d,_])),i(v,m([y,y,x]))]],r)}})),Aw="schur",Cw=["typed","matrix","identity","multiply","qr","norm","subtract"],Ew=Ii(Aw,Cw,(e=>{var{typed:t,matrix:r,identity:n,multiply:i,qr:a,norm:o,subtract:s}=e;return t(Aw,{Array:function(e){var t=l(r(e));return{U:t.U.valueOf(),T:t.T.valueOf()}},Matrix:function(e){return l(e)}});function l(e){var t,r=e.size()[0],l=e,u=n(r),c=0;do{t=l;var h=a(l),p=h.Q,d=h.R;if(l=i(d,p),u=i(u,p),c++>100)break}while(o(s(l,t))>1e-4);return{U:u,T:l}}})),Mw="rotate",Sw=["typed","multiply","rotationMatrix"],Dw=Ii(Mw,Sw,(e=>{var{typed:t,multiply:r,rotationMatrix:n}=e;return t(Mw,{"Array , number | BigNumber | Complex | Unit":function(e,t){return i(e,2),r(n(t),e).toArray()},"Matrix , number | BigNumber | Complex | Unit":function(e,t){return i(e,2),r(n(t),e)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,a){return i(e,3),r(n(t,a),e)},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,a){return i(e,3),r(n(t,a),e)}});function i(e,t){var r=Array.isArray(e)?ba(e):e.size();if(r.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(t));if(2===r.length&&1!==r[1])throw new RangeError("Vector must be of dimensions 1x".concat(t));if(r[0]!==t)throw new RangeError("Vector must be of dimensions 1x".concat(t))}})),Tw="sylvester",Nw=["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],Iw=Ii(Tw,Nw,(e=>{var{typed:t,schur:r,matrixFromColumns:n,matrix:i,multiply:a,range:o,concat:s,transpose:l,index:u,subset:c,add:h,subtract:p,identity:d,lusolve:f,abs:m}=e;return t(Tw,{"Matrix, Matrix, Matrix":g,"Array, Matrix, Matrix":function(e,t,r){return g(i(e),t,r)},"Array, Array, Matrix":function(e,t,r){return g(i(e),i(t),r)},"Array, Matrix, Array":function(e,t,r){return g(i(e),t,i(r))},"Matrix, Array, Matrix":function(e,t,r){return g(e,i(t),r)},"Matrix, Array, Array":function(e,t,r){return g(e,i(t),i(r))},"Matrix, Matrix, Array":function(e,t,r){return g(e,t,i(r))},"Array, Array, Array":function(e,t,r){return g(i(e),i(t),i(r)).toArray()}});function g(e,t,g){for(var y=t.size()[0],v=e.size()[0],x=r(e),_=x.T,b=x.U,w=r(a(-1,t)),A=w.T,C=w.U,E=a(a(l(b),g),C),M=o(0,v),S=[],D=(e,t)=>s(e,t,1),T=(e,t)=>s(e,t,0),N=0;N<y;N++)if(N<y-1&&m(c(A,u(N+1,N)))>1e-5){for(var I=T(c(E,u(M,N)),c(E,u(M,N+1))),P=0;P<N;P++)I=h(I,T(a(S[P],c(A,u(P,N))),a(S[P],c(A,u(P,N+1)))));var z=a(d(v),a(-1,c(A,u(N,N)))),B=a(d(v),a(-1,c(A,u(N+1,N)))),k=a(d(v),a(-1,c(A,u(N,N+1)))),F=a(d(v),a(-1,c(A,u(N+1,N+1)))),R=T(D(h(_,z),B),D(k,h(_,F))),O=f(R,I);S[N]=O.subset(u(o(0,v),0)),S[N+1]=O.subset(u(o(v,2*v),0)),N++}else{for(var L=c(E,u(M,N)),q=0;q<N;q++)L=h(L,a(S[q],c(A,u(q,N))));var j=c(A,u(N,N)),U=p(_,a(j,d(v)));S[N]=f(U,L)}var V=i(n(...S));return a(b,a(V,l(C)))}})),Pw="lyap",zw=["typed","matrix","sylvester","multiply","transpose"],Bw=Ii(Pw,zw,(e=>{var{typed:t,matrix:r,sylvester:n,multiply:i,transpose:a}=e;return t(Pw,{"Matrix, Matrix":function(e,t){return n(e,a(e),i(-1,t))},"Array, Matrix":function(e,t){return n(r(e),a(r(e)),i(-1,t))},"Matrix, Array":function(e,t){return n(e,a(r(e)),r(i(-1,t)))},"Array, Array":function(e,t){return n(r(e),a(r(e)),r(i(-1,t))).toArray()}})})),kw=Ih({config:En}),Fw=qh({}),Rw=ip({BigNumber:kw,config:En}),Ow=Jh({}),Lw=kp({BigNumber:kw,config:En}),qw=Nd({}),jw=pp({Complex:Fw}),Uw=ep({BigNumber:kw,config:En}),Vw=sp({BigNumber:kw,config:En}),Zw=up({BigNumber:kw,config:En}),$w=Id({}),Gw=tp({BigNumber:kw,config:En}),Hw=Qh({}),Ww=ap({BigNumber:kw,config:En}),Xw=Pd({}),Yw=zd({}),Kw=cp({BigNumber:kw,config:En}),Jw=ed({BigNumber:kw,config:En}),Qw=np({BigNumber:kw,config:En}),eA=Kh({}),tA=dp({}),rA=Bd({Matrix:$w}),nA=Zp({BigNumber:kw,config:En}),iA=op({BigNumber:kw,config:En}),aA=rp({BigNumber:kw,config:En}),oA=kd({}),sA=hp({BigNumber:kw,config:En}),lA=Rd({BigNumber:kw,Complex:Fw,DenseMatrix:rA,Fraction:qw}),uA=Vp({BigNumber:kw,config:En}),cA=cf({typed:lA}),hA=pf({Complex:Fw,config:En,typed:lA}),pA=If({BigNumber:kw,typed:lA}),dA=zf({BigNumber:kw,Complex:Fw,config:En,typed:lA}),fA=kf({typed:lA}),mA=Ff({typed:lA}),gA=Of({BigNumber:kw,Complex:Fw,config:En,typed:lA}),yA=Lf({typed:lA}),vA=qf({typed:lA}),xA=Uf({Complex:Fw,config:En,typed:lA}),_A=Vf({typed:lA}),bA=$f({typed:lA}),wA=Hf({typed:lA}),AA=Xf({typed:lA}),CA=Qf({typed:lA}),EA=tm({Complex:Fw,typed:lA}),MA=nm({typed:lA}),SA=am({typed:lA}),DA=om({BigNumber:kw,typed:lA}),TA=sm({BigNumber:kw,typed:lA}),NA=um({typed:lA}),IA=dm({config:En,typed:lA}),PA=fm({typed:lA}),zA=_m({typed:lA}),BA=wm({Complex:Fw,typed:lA}),kA=Zs({typed:lA}),FA=Cm({typed:lA}),RA=Js({typed:lA}),OA=Mm({typed:lA}),LA=Dm({typed:lA}),qA=Tm({format:OA,typed:lA}),jA=Nm({typed:lA}),UA=Pm({typed:lA}),VA=Om({config:En,typed:lA}),ZA=qm({config:En,typed:lA}),$A=Um({equalScalar:IA,typed:lA}),GA=lp({BigNumber:kw,config:En}),HA=Ym({Complex:Fw,typed:lA}),WA=tg({Complex:Fw,config:En,typed:lA}),XA=ng({Complex:Fw,config:En,typed:lA}),YA=rl({typed:lA}),KA=ig({typed:lA}),JA=ag({typed:lA}),QA=og({typed:lA}),eC=sg({format:OA,typed:lA}),tC=pg({config:En,typed:lA}),rC=Tl({typed:lA}),nC=mg({config:En,typed:lA}),iC=gg({typed:lA}),aC=yg({BigNumber:kw,typed:lA}),oC=xg({BigNumber:kw,Fraction:qw,complex:EA,typed:lA}),sC=_g({typed:lA}),lC=bg({Matrix:$w,equalScalar:IA,typed:lA}),uC=Ag({typed:lA}),cC=Eg({typed:lA}),hC=Sg({typed:lA}),pC=Tg({typed:lA}),dC=Ng({typed:lA}),fC=Pg({typed:lA}),mC=Bg({Complex:Fw,config:En,typed:lA}),gC=Fg({BigNumber:kw,typed:lA}),yC=Og({BigNumber:kw,Complex:Fw,config:En,typed:lA}),vC=Lg({BigNumber:kw,typed:lA}),xC=jg({typed:lA}),_C=Zg({typed:lA}),bC=Gg({BigNumber:kw,typed:lA}),wC=Wg({typed:lA}),AC=Yg({typed:lA}),CC=Fs({isInteger:UA,typed:lA}),EC=Jg({DenseMatrix:rA,Matrix:$w,SparseMatrix:lC,typed:lA}),MC=ey({isZero:$A,matrix:EC,typed:lA}),SC=ty({BigNumber:kw,config:En,matrix:EC,typed:lA}),DC=ny({config:En,log2:XA,typed:lA}),TC=ay({isInteger:UA,matrix:EC,typed:lA}),NC=sy({BigNumber:kw,typed:lA}),IC=uy({typed:lA}),PC=hy({SparseMatrix:lC,typed:lA}),zC=py({Complex:Fw,config:En,typed:lA}),BC=fy({typed:lA}),kC=my({typed:lA}),FC=yy({matrix:EC,typed:lA}),RC=xy({BigNumber:kw,config:En,matrix:EC,typed:lA}),OC=by({BigNumber:kw,config:En,matrix:EC,typed:lA}),LC=Ay({BigNumber:kw,Complex:Fw,config:En,typed:lA}),qC=Ey({Complex:Fw,config:En,typed:lA}),jC=My({format:OA,typed:lA}),UC=Cl({isInteger:UA,matrix:EC,typed:lA}),VC=Dy({BigNumber:kw,typed:lA}),ZC=Ny({conj:MA,transpose:FC,typed:lA}),$C=Py({DenseMatrix:rA,SparseMatrix:lC,matrix:EC,typed:lA}),GC=ky({concat:UC,equalScalar:IA,matrix:EC,multiplyScalar:KA,typed:lA}),HC=Oy({DenseMatrix:rA,SparseMatrix:lC,concat:UC,equalScalar:IA,matrix:EC,typed:lA}),WC=qy({Fraction:qw,typed:lA}),XC=Uy({BigNumber:kw,DenseMatrix:rA,SparseMatrix:lC,config:En,matrix:EC,typed:lA}),YC=Zy({typed:lA}),KC=Gy({matrix:EC,multiplyScalar:KA,typed:lA}),JC=Wy({DenseMatrix:rA,SparseMatrix:lC,concat:UC,config:En,matrix:EC,typed:lA}),QC=Qy({DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,typed:lA,zeros:OC}),eE=tv({isNaN:wC,isNumeric:YC,typed:lA}),tE=nv({BigNumber:kw,concat:UC,equalScalar:IA,matrix:EC,typed:lA}),rE=iv({bignumber:vC,fraction:WC,number:QA}),nE=ov({config:En,multiplyScalar:KA,numeric:rE,typed:lA}),iE=lv({config:En,matrix:EC}),aE=cv({DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,typed:lA,zeros:OC}),oE=dv({BigNumber:kw,DenseMatrix:rA,config:En,equalScalar:IA,matrix:EC,typed:lA,zeros:OC}),sE=mv({matrix:EC,config:En,typed:lA}),lE=yv({DenseMatrix:rA,SparseMatrix:lC,bignumber:vC,concat:UC,config:En,matrix:EC,typed:lA}),uE=xv({concat:UC,matrix:EC,typed:lA}),cE=bv({typed:lA}),hE=Av({DenseMatrix:rA,SparseMatrix:lC,concat:UC,config:En,equalScalar:IA,matrix:EC,typed:lA}),pE=Ev({DenseMatrix:rA,SparseMatrix:lC,concat:UC,matrix:EC,typed:lA}),dE=Mv({DenseMatrix:rA,SparseMatrix:lC,addScalar:fA,concat:UC,equalScalar:IA,matrix:EC,typed:lA}),fE=Dv({BigNumber:kw,DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,typed:lA}),mE=eu({concat:UC,equalScalar:IA,matrix:EC,typed:lA}),gE=yu({DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,typed:lA}),yE=Nv({DenseMatrix:rA,SparseMatrix:lC,concat:UC,matrix:EC,typed:lA}),vE=Pv({BigNumber:kw,Complex:Fw,Fraction:qw,config:En,isNegative:VA,matrix:EC,typed:lA,unaryMinus:cE}),xE=Bv({BigNumber:kw,DenseMatrix:rA,Fraction:qw,concat:UC,config:En,equalScalar:IA,matrix:EC,typed:lA}),_E=Ov({concat:UC,matrix:EC,typed:lA}),bE=qv({prod:nE,size:sE,typed:lA}),wE=Uv({equal:HC,typed:lA}),AE=Zv({numeric:rE,typed:lA}),CE=Gv({DenseMatrix:rA,SparseMatrix:lC,concat:UC,divideScalar:AE,equalScalar:IA,matrix:EC,typed:lA}),EE=Wv({compareText:_E,isZero:$A,typed:lA}),ME=Qv({DenseMatrix:rA,config:En,equalScalar:IA,matrix:EC,round:oE,typed:lA,zeros:OC}),SE=ax({BigNumber:kw,DenseMatrix:rA,concat:UC,config:En,equalScalar:IA,matrix:EC,round:oE,typed:lA,zeros:OC}),DE=sx({isNumeric:YC,typed:lA}),TE=ux({abs:cA,addScalar:fA,divideScalar:AE,isPositive:ZA,multiplyScalar:KA,smaller:lE,sqrt:zC,typed:lA}),NE=cx({DenseMatrix:rA,smaller:lE}),IE=hx({ImmutableDenseMatrix:NE,getMatrixDataType:LA}),PE=fx({DenseMatrix:rA,SparseMatrix:lC,bignumber:vC,concat:UC,config:En,matrix:EC,typed:lA}),zE=vx({Complex:Fw,config:En,divideScalar:AE,typeOf:fC,typed:lA}),BE=bx({DenseMatrix:rA,divideScalar:AE,equalScalar:IA,matrix:EC,multiplyScalar:KA,subtractScalar:pC,typed:lA}),kE=Ax({flatten:FA,matrix:EC,size:sE,typed:lA}),FE=Su({config:En,isNaN:wC,larger:PE,numeric:rE,typed:lA}),RE=ru({config:En,isNaN:wC,numeric:rE,smaller:lE,typed:lA}),OE=ex({DenseMatrix:rA,concat:UC,config:En,equalScalar:IA,matrix:EC,round:oE,typed:lA,zeros:OC}),LE=Ex({Complex:Fw,config:En,divideScalar:AE,typed:lA}),qE=gl({DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,typed:lA}),jE=Sx({compare:xE,isNaN:wC,isNumeric:YC,typed:lA}),UE=Dx({addScalar:fA,complex:EA,conj:MA,divideScalar:AE,equal:HC,identity:XC,isZero:$A,matrix:EC,multiplyScalar:KA,sign:oC,sqrt:zC,subtractScalar:pC,typed:lA,unaryMinus:cE,zeros:OC}),VE=Nx({DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,typed:lA,zeros:OC}),ZE=Px({DenseMatrix:rA,SparseMatrix:lC,concat:UC,config:En,matrix:EC,typed:lA}),$E=au({add:dE,matrix:EC,typed:lA,zeros:OC}),GE=kx({DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,subtractScalar:pC,typed:lA,unaryMinus:cE}),HE=Fx({add:dE,matrix:EC,typed:lA}),WE=Ox({DenseMatrix:rA,divideScalar:AE,equalScalar:IA,matrix:EC,multiplyScalar:KA,subtractScalar:pC,typed:lA}),XE=qx({addScalar:fA,combinations:CA,divideScalar:AE,isInteger:UA,isNegative:VA,multiplyScalar:KA,typed:lA}),YE=Vx({compare:xE,typed:lA}),KE=$x({addScalar:fA,combinations:CA,isInteger:UA,isNegative:VA,isPositive:ZA,larger:PE,typed:lA}),JE=Cu({matrix:EC,number:QA,subtract:GE,typed:lA}),QE=Hx({abs:cA,addScalar:fA,deepEqual:wE,divideScalar:AE,multiplyScalar:KA,sqrt:zC,subtractScalar:pC,typed:lA}),eM=Wx({addScalar:fA,conj:MA,multiplyScalar:KA,size:sE,typed:lA}),tM=Xx({larger:PE,smaller:lE}),rM=Kx({Index:IE,typed:lA}),nM=Qx({BigNumber:kw,add:dE,config:En,equal:HC,isInteger:UA,mod:OE,smaller:lE,typed:lA,xgcd:RC}),iM=e_({concat:UC,equalScalar:IA,matrix:EC,typed:lA}),aM=r_({Complex:Fw,config:En,divideScalar:AE,log:zE,typed:lA}),oM=i_({DenseMatrix:rA,divideScalar:AE,equalScalar:IA,matrix:EC,multiplyScalar:KA,subtractScalar:pC,typed:lA}),sM=o_({flatten:FA,matrix:EC,size:sE,typed:lA}),lM=l_({addScalar:fA,dot:eM,equalScalar:IA,matrix:EC,multiplyScalar:KA,typed:lA}),uM=Nu({bignumber:vC,matrix:EC,add:dE,config:En,isPositive:ZA,larger:PE,largerEq:JC,smaller:lE,smallerEq:ZE,typed:lA}),cM=Pu({Index:IE,matrix:EC,range:uM,typed:lA}),hM=c_({DenseMatrix:rA,Index:IE,compareNatural:YE,size:sE,subset:$E,typed:lA}),pM=p_({DenseMatrix:rA,Index:IE,compareNatural:YE,size:sE,subset:$E,typed:lA}),dM=f_({Index:IE,compareNatural:YE,size:sE,subset:$E,typed:lA}),fM=g_({Index:IE,compareNatural:YE,size:sE,subset:$E,typed:lA}),mM=T_({SparseMatrix:lC,abs:cA,add:dE,divideScalar:AE,larger:PE,largerEq:JC,multiply:lM,subtract:GE,transpose:FC,typed:lA}),gM=I_({compare:xE,compareNatural:YE,matrix:EC,typed:lA}),yM=z_({config:En,numeric:rE,typed:lA}),vM=k_({DenseMatrix:rA,divideScalar:AE,equalScalar:IA,matrix:EC,multiplyScalar:KA,subtractScalar:pC,typed:lA}),xM=R_({Complex:Fw,add:dE,multiply:lM,number:QA,typed:lA}),_M=bl({concat:UC,equalScalar:IA,matrix:EC,not:JA,typed:lA,zeros:OC}),bM=U_({DenseMatrix:rA,config:En,equalScalar:IA,matrix:EC,round:oE,typed:lA,zeros:OC}),wM=ku({Index:IE,matrix:EC,range:uM,typed:lA}),AM=Z_({matrix:EC,multiply:lM,subtract:GE,typed:lA}),CM=$_({divideScalar:AE,isZero:$A,matrix:EC,multiply:lM,subtractScalar:pC,typed:lA,unaryMinus:cE}),EM=X_({Complex:Fw,DenseMatrix:rA,ceil:bM,equalScalar:IA,floor:ME,matrix:EC,typed:lA,zeros:OC}),MM=Y_({abs:cA,addScalar:fA,det:CM,divideScalar:AE,identity:XC,matrix:EC,multiply:lM,typed:lA,unaryMinus:cE}),SM=J_({Complex:Fw,add:dE,ctranspose:ZC,deepEqual:wE,divideScalar:AE,dot:eM,dotDivide:CE,equal:HC,inv:MM,matrix:EC,multiply:lM,typed:lA}),DM=Q_({Complex:Fw,config:En,fraction:WC,identity:XC,inv:MM,matrix:EC,multiply:lM,number:QA,typed:lA}),TM=tb({DenseMatrix:rA,Index:IE,compareNatural:YE,size:sE,subset:$E,typed:lA}),NM=nb({Index:IE,compareNatural:YE,size:sE,subset:$E,typed:lA}),IM=ab({Index:IE,concat:UC,setDifference:TM,size:sE,subset:$E,typed:lA}),PM=ob({FibonacciHeap:tM,addScalar:fA,equalScalar:IA}),zM=lb({abs:cA,add:dE,identity:XC,inv:MM,map:YA,max:FE,multiply:lM,size:sE,sqrt:zC,subtract:GE,typed:lA}),BM=Bl({add:dE,config:En,numeric:rE,typed:lA}),kM=hb({BigNumber:kw,Complex:Fw,Fraction:qw,abs:cA,addScalar:fA,config:En,divideScalar:AE,equal:HC,fix:EM,format:OA,isNumeric:YC,multiplyScalar:KA,number:QA,pow:DM,round:oE,subtractScalar:pC}),FM=bp({BigNumber:kw,Unit:kM,config:En}),RM=nd({BigNumber:kw,Unit:kM,config:En}),OM=$p({BigNumber:kw,Unit:kM,config:En}),LM=Ep({BigNumber:kw,Unit:kM,config:En}),qM=Hp({BigNumber:kw,Unit:kM,config:En}),jM=Mp({BigNumber:kw,Unit:kM,config:En}),UM=wp({BigNumber:kw,Unit:kM,config:En}),VM=db({Unit:kM,typed:lA}),ZM=Op({BigNumber:kw,Unit:kM,config:En}),$M=mb({DenseMatrix:rA,SparseMatrix:lC,concat:UC,equalScalar:IA,matrix:EC,pow:DM,typed:lA}),GM=_p({BigNumber:kw,Unit:kM,config:En}),HM=Cp({BigNumber:kw,Unit:kM,config:En}),WM=yb({abs:cA,add:dE,identity:XC,inv:MM,multiply:lM,typed:lA}),XM=Wp({BigNumber:kw,Unit:kM,config:En}),YM=vb({addScalar:fA,ceil:bM,conj:MA,divideScalar:AE,dotDivide:CE,exp:zA,i:jw,log2:XA,matrix:EC,multiplyScalar:KA,pow:DM,tau:Qw,typed:lA}),KM=_b({BigNumber:kw,Complex:Fw,config:En,multiplyScalar:KA,pow:DM,typed:lA}),JM=gp({BigNumber:kw,Unit:kM,config:En}),QM=Fp({BigNumber:kw,Unit:kM,config:En}),eS=wb({conj:MA,dotDivide:CE,fft:YM,typed:lA}),tS=Sp({BigNumber:kw,Unit:kM,config:En}),rS=Np({BigNumber:kw,Unit:kM,config:En}),nS=Yp({BigNumber:kw,Unit:kM,config:En}),iS=xp({BigNumber:kw,Unit:kM,config:En}),aS=id({BigNumber:kw,Unit:kM,config:En}),oS=Jp({BigNumber:kw,Unit:kM,config:En}),sS=Lp({BigNumber:kw,Unit:kM,config:En}),lS=Tp({BigNumber:kw,Unit:kM,config:En}),uS=cd({BigNumber:kw,Unit:kM,config:En}),cS=sd({BigNumber:kw,Unit:kM,config:En}),hS=hd({BigNumber:kw,Unit:kM,config:En}),pS=Rp({BigNumber:kw,Unit:kM,config:En}),dS=qp({BigNumber:kw,Unit:kM,config:En}),fS=vp({BigNumber:kw,Unit:kM,config:En}),mS=jp({BigNumber:kw,Unit:kM,config:En}),gS=td({BigNumber:kw,Unit:kM,config:En}),yS=Cb({compareNatural:YE,typed:lA}),vS=mp({BigNumber:kw,Unit:kM,config:En}),xS=rd({BigNumber:kw,Unit:kM,config:En}),_S=Up({BigNumber:kw,Unit:kM,config:En}),bS=Gp({BigNumber:kw,Unit:kM,config:En}),wS=Ip({BigNumber:kw,Unit:kM,config:En}),AS=Ap({BigNumber:kw,Unit:kM,config:En}),CS=Eb({divideScalar:AE,equalScalar:IA,inv:MM,matrix:EC,multiply:lM,typed:lA}),ES=zp({BigNumber:kw,Unit:kM,config:En}),MS=Sb({gamma:KM,typed:lA}),SS=Xp({BigNumber:kw,Unit:kM,config:En}),DS=od({BigNumber:kw,Unit:kM,config:En}),TS=Db({abs:cA,add:dE,addScalar:fA,config:En,divideScalar:AE,equalScalar:IA,flatten:FA,isNumeric:YC,isZero:$A,matrix:EC,multiply:lM,multiplyScalar:KA,smaller:lE,subtract:GE,typed:lA}),NS=Tb({DenseMatrix:rA,Spa:PM,SparseMatrix:lC,abs:cA,addScalar:fA,divideScalar:AE,equalScalar:IA,larger:PE,matrix:EC,multiplyScalar:KA,subtractScalar:pC,typed:lA,unaryMinus:cE}),IS=Dp({BigNumber:kw,Unit:kM,config:En}),PS=ad({BigNumber:kw,Unit:kM,config:En}),zS=Ib({add:dE,divide:CS,factorial:MS,isInteger:UA,isPositive:ZA,multiply:lM,typed:lA}),BS=zb({factorial:MS,typed:lA}),kS=ld({BigNumber:kw,Unit:kM,config:En}),FS=Fb({add:dE,cbrt:vE,divide:CS,equalScalar:IA,im:jA,isZero:$A,multiply:lM,re:iC,sqrt:zC,subtract:GE,typeOf:fC,typed:lA,unaryMinus:cE}),RS=Ob({DenseMatrix:rA,Index:IE,compareNatural:YE,size:sE,subset:$E,typed:lA}),OS=qb({abs:cA,add:dE,bignumber:vC,divide:CS,isNegative:VA,isPositive:ZA,larger:PE,map:YA,matrix:EC,max:FE,multiply:lM,smaller:lE,subtract:GE,typed:lA,unaryMinus:cE}),LS=Ub({bignumber:vC,addScalar:fA,combinations:CA,divideScalar:AE,factorial:MS,isInteger:UA,isNegative:VA,larger:PE,multiplyScalar:KA,number:QA,pow:DM,subtractScalar:pC,typed:lA}),qS=Zb({Unit:kM,typed:lA}),jS=Gb({addScalar:fA,isInteger:UA,isNegative:VA,stirlingS2:LS,typed:lA}),US=_u({add:dE,typed:lA,unaryPlus:yM}),VS=Hb({abs:cA,add:dE,addScalar:fA,atan:vA,bignumber:vC,column:wM,complex:EA,config:En,cos:SA,diag:$C,divideScalar:AE,dot:eM,equal:HC,flatten:FA,im:jA,inv:MM,larger:PE,matrix:EC,matrixFromColumns:kE,multiply:lM,multiplyScalar:KA,number:QA,qr:UE,re:iC,reshape:TC,sin:sC,size:sE,smaller:lE,sqrt:zC,subtract:GE,typed:lA,usolve:WE,usolveAll:vM}),ZS=Bp({BigNumber:kw,Unit:kM,config:En}),$S=Kp({BigNumber:kw,Unit:kM,config:En}),GS=Xb({divide:CS,dotDivide:CE,isNumeric:YC,log:zE,map:YA,matrix:EC,multiply:lM,sum:BM,typed:lA}),HS=Qb({DenseMatrix:rA,lsolve:BE,lup:NS,matrix:EC,slu:mM,typed:lA,usolve:WE}),WS=Ou({add:dE,divide:CS,typed:lA}),XS=Qp({BigNumber:kw,Unit:kM,config:En}),YS=yp({BigNumber:kw,Unit:kM,config:En}),KS=ju({bignumber:vC,add:dE,compare:xE,divide:CS,isInteger:UA,larger:PE,mapSlices:CC,multiply:lM,partitionSelect:jE,smaller:lE,smallerEq:ZE,subtract:GE,typed:lA}),JS=rw({Index:IE,concat:UC,setIntersect:RS,setSymDifference:IM,size:sE,subset:$E,typed:lA}),QS=$u({add:dE,divide:CS,isNaN:wC,mapSlices:CC,multiply:lM,subtract:GE,typed:lA}),eD=Pp({BigNumber:kw,Unit:kM,config:En}),tD=aw({add:dE,compare:xE,divide:CS,partitionSelect:jE,typed:lA}),rD=lw({add:dE,divide:CS,matrix:EC,mean:WS,multiply:lM,pow:DM,sqrt:zC,subtract:GE,sum:BM,typed:lA}),nD=hw({Complex:Fw,add:dE,divide:CS,matrix:EC,multiply:lM,typed:lA}),iD=dw({abs:cA,map:YA,median:tD,subtract:GE,typed:lA}),aD=Wu({map:YA,sqrt:zC,typed:lA,variance:QS}),oD=gw({BigNumber:kw,Complex:Fw,add:dE,config:En,divide:CS,equal:HC,factorial:MS,gamma:KM,isNegative:VA,multiply:lM,pi:aA,pow:DM,sin:sC,smallerEq:ZE,subtract:GE,typed:lA}),sD=xw({abs:cA,add:dE,conj:MA,ctranspose:ZC,eigs:VS,equalScalar:IA,larger:PE,matrix:EC,multiply:lM,pow:DM,smaller:lE,sqrt:zC,typed:lA}),lD=ww({BigNumber:kw,DenseMatrix:rA,SparseMatrix:lC,addScalar:fA,config:En,cos:SA,matrix:EC,multiplyScalar:KA,norm:sD,sin:sC,typed:lA,unaryMinus:cE}),uD=ud({BigNumber:kw,Unit:kM,config:En}),cD=Ew({identity:XC,matrix:EC,multiply:lM,norm:sD,qr:UE,subtract:GE,typed:lA}),hD=Dw({multiply:lM,rotationMatrix:lD,typed:lA}),pD=Iw({abs:cA,add:dE,concat:UC,identity:XC,index:rM,lusolve:HS,matrix:EC,matrixFromColumns:kE,multiply:lM,range:uM,schur:cD,subset:$E,subtract:GE,transpose:FC,typed:lA}),dD=Bw({matrix:EC,multiply:lM,sylvester:pD,transpose:FC,typed:lA}),fD={},mD={},gD={},yD=zi({mathWithTransform:mD}),vD=va({Node:yD}),xD=fo({Node:yD}),_D=go({Node:yD}),bD=vo({Node:yD}),wD=_o({Node:yD}),AD=wo({Node:yD,ResultSet:Yw}),CD=Co({Node:yD}),ED=Mo({Node:yD}),MD=Do({Node:yD}),SD=To({classes:gD}),DD=No({math:fD,typed:lA}),TD=Po({Node:yD,typed:lA}),ND=Bo({Chain:DD,typed:lA}),ID=Oo({Node:yD,subset:$E}),PD=qo({matrix:EC,Node:yD,subset:$E}),zD=Uo({Node:yD,size:sE}),BD=Vo({Unit:kM,Node:yD,math:fD}),kD=$o({Node:yD,SymbolNode:BD,math:fD}),FD=es({AccessorNode:ID,ArrayNode:wD,AssignmentNode:PD,BlockNode:AD,ConditionalNode:CD,ConstantNode:ED,FunctionAssignmentNode:TD,FunctionNode:kD,IndexNode:zD,ObjectNode:vD,OperatorNode:xD,ParenthesisNode:_D,RangeNode:MD,RelationalNode:bD,SymbolNode:BD,config:En,numeric:rE,typed:lA}),RD=ts({ConstantNode:ED,FunctionNode:kD,OperatorNode:xD,ParenthesisNode:_D,parse:FD,typed:lA}),OD=ls({bignumber:vC,fraction:WC,AccessorNode:ID,ArrayNode:wD,ConstantNode:ED,FunctionNode:kD,IndexNode:zD,ObjectNode:vD,OperatorNode:xD,SymbolNode:BD,config:En,mathWithTransform:mD,matrix:EC,typed:lA}),LD=cs({parse:FD,typed:lA}),qD=ps({AccessorNode:ID,ArrayNode:wD,ConstantNode:ED,FunctionNode:kD,IndexNode:zD,ObjectNode:vD,OperatorNode:xD,ParenthesisNode:_D,SymbolNode:BD,add:dE,divide:CS,equal:HC,isZero:$A,multiply:lM,parse:FD,pow:DM,subtract:GE,typed:lA}),jD=fs({parse:FD,typed:lA}),UD=ms({evaluate:jD}),VD=gs({evaluate:jD,parse:FD}),ZD=xs({AccessorNode:ID,ArrayNode:wD,ConstantNode:ED,FunctionNode:kD,IndexNode:zD,ObjectNode:vD,OperatorNode:xD,ParenthesisNode:_D,SymbolNode:BD,equal:HC,parse:FD,replacer:oA,resolve:RD,simplifyConstant:OD,simplifyCore:qD,typed:lA}),$D=bs({OperatorNode:xD,parse:FD,simplify:ZD,typed:lA}),GD=As({parse:FD,typed:lA}),HD=Es({Parser:VD,typed:lA}),WD=Ss({bignumber:vC,fraction:WC,AccessorNode:ID,ArrayNode:wD,ConstantNode:ED,FunctionNode:kD,IndexNode:zD,ObjectNode:vD,OperatorNode:xD,ParenthesisNode:_D,SymbolNode:BD,add:dE,config:En,divide:CS,equal:HC,isZero:$A,mathWithTransform:mD,matrix:EC,multiply:lM,parse:FD,pow:DM,simplify:ZD,simplifyConstant:OD,simplifyCore:qD,subtract:GE,typed:lA}),XD=Ts({ConstantNode:ED,FunctionNode:kD,OperatorNode:xD,ParenthesisNode:_D,SymbolNode:BD,config:En,equal:HC,isZero:$A,numeric:rE,parse:FD,simplify:ZD,typed:lA}),YD=Bs({Help:UD,mathWithTransform:mD,typed:lA});function KD(e){return function(e){if(Array.isArray(e))return eT(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||QD(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function JD(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||QD(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function QD(e,t){if(e){if("string"==typeof e)return eT(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?eT(e,t):void 0}}function eT(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}An(fD,{e:Rw,false:Ow,fineStructure:Lw,i:jw,Infinity:Uw,LN10:Vw,LOG10E:Zw,NaN:Gw,null:Hw,phi:Ww,SQRT1_2:Kw,sackurTetrode:Jw,tau:Qw,true:eA,E:Rw,version:tA,efimovFactor:nA,LN2:iA,pi:aA,replacer:oA,reviver:SD,SQRT2:sA,typed:lA,PI:aA,weakMixingAngle:uA,abs:cA,acos:hA,acot:pA,acsc:dA,addScalar:fA,arg:mA,asech:gA,asinh:yA,atan:vA,atanh:xA,bigint:_A,bitNot:bA,boolean:wA,clone:AA,combinations:CA,complex:EA,conj:MA,cos:SA,cot:DA,csc:TA,cube:NA,equalScalar:IA,erf:PA,exp:zA,expm1:BA,filter:kA,flatten:FA,forEach:RA,format:OA,getMatrixDataType:LA,hex:qA,im:jA,isInteger:UA,isNegative:VA,isPositive:ZA,isZero:$A,LOG2E:GA,lgamma:HA,log10:WA,log2:XA,map:YA,multiplyScalar:KA,not:JA,number:QA,oct:eC,pickRandom:tC,print:rC,random:nC,re:iC,sec:aC,sign:oC,sin:sC,splitUnit:uC,square:cC,string:hC,subtractScalar:pC,tan:dC,typeOf:fC,acosh:mC,acsch:gC,asec:yC,bignumber:vC,chain:ND,combinationsWithRep:xC,cosh:_C,csch:bC,isNaN:wC,isPrime:AC,mapSlices:CC,matrix:EC,matrixFromFunction:MC,ones:SC,randomInt:DC,reshape:TC,sech:NC,sinh:IC,sparse:PC,sqrt:zC,squeeze:BC,tanh:kC,transpose:FC,xgcd:RC,zeros:OC,acoth:LC,asin:qC,bin:jC,concat:UC,coth:VC,ctranspose:ZC,diag:$C,dotMultiply:GC,equal:HC,fraction:WC,identity:XC,isNumeric:YC,kron:KC,largerEq:JC,leftShift:QC,mode:eE,nthRoot:tE,numeric:rE,prod:nE,resize:iE,rightArithShift:aE,round:oE,size:sE,smaller:lE,to:uE,unaryMinus:cE,unequal:hE,xor:pE,add:dE,atan2:fE,bitAnd:mE,bitOr:gE,bitXor:yE,cbrt:vE,compare:xE,compareText:_E,count:bE,deepEqual:wE,divideScalar:AE,dotDivide:CE,equalText:EE,floor:ME,gcd:SE,hasNumericValue:DE,hypot:TE,larger:PE,log:zE,lsolve:BE,matrixFromColumns:kE,max:FE,min:RE,mod:OE,nthRoots:LE,or:qE,partitionSelect:jE,qr:UE,rightLogShift:VE,smallerEq:ZE,subset:$E,subtract:GE,trace:HE,usolve:WE,catalan:XE,compareNatural:YE,composition:KE,diff:JE,distance:QE,dot:eM,index:rM,invmod:nM,lcm:iM,log1p:aM,lsolveAll:oM,matrixFromRows:sM,multiply:lM,range:uM,row:cM,setCartesian:hM,setDistinct:pM,setIsSubset:dM,setPowerset:fM,slu:mM,sort:gM,unaryPlus:yM,usolveAll:vM,zpk2tf:xM,and:_M,ceil:bM,column:wM,cross:AM,det:CM,fix:EM,inv:MM,pinv:SM,pow:DM,setDifference:TM,setMultiplicity:NM,setSymDifference:IM,sqrtm:zM,sum:BM,vacuumImpedance:FM,wienDisplacement:RM,atomicMass:OM,bohrMagneton:LM,boltzmann:qM,conductanceQuantum:jM,coulomb:UM,createUnit:VM,deuteronMass:ZM,dotPow:$M,electricConstant:GM,elementaryCharge:HM,expm:WM,faraday:XM,fft:YM,gamma:KM,gravitationConstant:JM,hartreeEnergy:QM,ifft:eS,inverseConductanceQuantum:tS,klitzing:rS,loschmidt:nS,magneticConstant:iS,molarMass:aS,molarPlanckConstant:oS,neutronMass:sS,nuclearMagneton:lS,planckCharge:uS,planckLength:cS,planckTemperature:hS,protonMass:pS,quantumOfCirculation:dS,reducedPlanckConstant:fS,rydberg:mS,secondRadiation:gS,setSize:yS,speedOfLight:vS,stefanBoltzmann:xS,thomsonCrossSection:_S,avogadro:bS,bohrRadius:wS,coulombConstant:AS,divide:CS,electronMass:ES,factorial:MS,firstRadiation:SS,gravity:DS,intersect:TS,lup:NS,magneticFluxQuantum:IS,molarMassC12:PS,multinomial:zS,parse:FD,permutations:BS,planckMass:kS,polynomialRoot:FS,resolve:RD,setIntersect:RS,simplifyConstant:OD,solveODE:OS,stirlingS2:LS,unit:qS,bellNumbers:jS,compile:LD,cumsum:US,eigs:VS,fermiCoupling:ZS,gasConstant:$S,kldivergence:GS,lusolve:HS,mean:WS,molarVolume:XS,planckConstant:YS,quantileSeq:KS,setUnion:JS,simplifyCore:qD,variance:QS,classicalElectronRadius:eD,evaluate:jD,median:tD,simplify:ZD,symbolicEqual:$D,corr:rD,freqz:nD,leafCount:GD,mad:iD,parser:HD,rationalize:WD,std:aD,zeta:oD,derivative:XD,norm:sD,rotationMatrix:lD,help:YD,planckTime:uD,schur:cD,rotate:hD,sylvester:pD,lyap:dD,config:En}),An(mD,fD,{mapSlices:Ls({isInteger:UA,typed:lA}),filter:Ys({typed:lA}),forEach:el({typed:lA}),map:nl({typed:lA}),or:yl({DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,typed:lA}),and:wl({add:dE,concat:UC,equalScalar:IA,matrix:EC,not:JA,typed:lA,zeros:OC}),concat:El({isInteger:UA,matrix:EC,typed:lA}),index:Ml({Index:IE,getMatrixDataType:LA}),print:Pl({add:dE,matrix:EC,typed:lA,zeros:OC}),sum:Fl({add:dE,config:En,numeric:rE,typed:lA}),bitAnd:tu({add:dE,concat:UC,equalScalar:IA,matrix:EC,not:JA,typed:lA,zeros:OC}),min:nu({config:En,isNaN:wC,numeric:rE,smaller:lE,typed:lA}),subset:pu({add:dE,matrix:EC,typed:lA,zeros:OC}),bitOr:vu({DenseMatrix:rA,concat:UC,equalScalar:IA,matrix:EC,typed:lA}),cumsum:wu({add:dE,typed:lA,unaryPlus:yM}),diff:Mu({bignumber:vC,matrix:EC,number:QA,subtract:GE,typed:lA}),max:Du({config:En,isNaN:wC,larger:PE,numeric:rE,typed:lA}),range:Iu({bignumber:vC,matrix:EC,add:dE,config:En,isPositive:ZA,larger:PE,largerEq:JC,smaller:lE,smallerEq:ZE,typed:lA}),row:zu({Index:IE,matrix:EC,range:uM,typed:lA}),column:Fu({Index:IE,matrix:EC,range:uM,typed:lA}),mean:Lu({add:dE,divide:CS,typed:lA}),quantileSeq:Uu({add:dE,bignumber:vC,compare:xE,divide:CS,isInteger:UA,larger:PE,mapSlices:CC,multiply:lM,partitionSelect:jE,smaller:lE,smallerEq:ZE,subtract:GE,typed:lA}),variance:Hu({add:dE,divide:CS,isNaN:wC,mapSlices:CC,multiply:lM,subtract:GE,typed:lA}),std:Xu({map:YA,sqrt:zC,typed:lA,variance:QS})}),An(gD,{BigNumber:kw,Complex:Fw,Fraction:qw,Matrix:$w,Node:yD,ObjectNode:vD,OperatorNode:xD,ParenthesisNode:_D,Range:Xw,RelationalNode:bD,ResultSet:Yw,ArrayNode:wD,BlockNode:AD,ConditionalNode:CD,ConstantNode:ED,DenseMatrix:rA,RangeNode:MD,Chain:DD,FunctionAssignmentNode:TD,SparseMatrix:lC,ImmutableDenseMatrix:NE,Index:IE,AccessorNode:ID,AssignmentNode:PD,FibonacciHeap:tM,IndexNode:zD,Spa:PM,Unit:kM,SymbolNode:BD,FunctionNode:kD,Help:UD,Parser:VD}),DD.createProxy(fD);var tT=function(r){var n=r.stops,i=r.title,a=r.labels,o=void 0===a?{}:a,s=r.barHeight,l=void 0===s?24:s,u=r.titleHeight,c=void 0===u?24:u,h=r.labelHeight,p=void 0===h?24:h,d=r.format,f=void 0===d?null:d,m=(0,e.useRef)(null),g=JD((0,e.useState)(0),2),y=g[0],v=g[1],x=(0,e.useRef)(null);return(0,e.useEffect)((function(){if(!m.current)return function(){};var e=new window.ResizeObserver((function(e){var t,r=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=QD(e))){t&&(e=t);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(o)throw i}}}}(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;v(n.contentRect.width)}}catch(e){r.e(e)}finally{r.f()}}));return e.observe(m.current),v(m.current.offsetWidth||0),function(){e.disconnect()}}),[]),(0,e.useEffect)((function(){if(n&&y){var e=function(e){return"string"==typeof e?new Ie([[document.querySelector(e)]],[document.documentElement]):new Ie([[e]],Ne)}(x.current);e.selectAll("*").remove();for(var t=Object.entries(n).map((function(e){var t=JD(e,2),r=t[0],n=t[1];return[parseFloat(r),n]})).sort((function(e,t){return e[0]-t[0]})),r=t.map((function(e){return JD(e,1)[0]})),a=t.map((function(e){return JD(e,2)[1]})),s=bn().domain([Math.min.apply(Math,KD(r)),Math.max.apply(Math,KD(r))]).range([0,y]),u=e.append("defs"),h="grad-"+Math.random().toString(36).substr(2,9),d=u.append("linearGradient").attr("id",h).attr("x1","0%").attr("x2","100%").attr("y1","0%").attr("y2","0%"),m=0;m<t.length;++m){var g=s(t[m][0])/y*100;d.append("stop").attr("offset","".concat(g,"%")).attr("stop-color",a[m][0]),d.append("stop").attr("offset","".concat(g,"%")).attr("stop-color",a[m][1])}e.append("rect").attr("x",0).attr("y",c).attr("width",y).attr("height",l).style("fill","url(#".concat(h,")")).style("stroke","var(--mantine-color-dark-6)").style("stroke-width",1);var v=Object.entries(o||{});if(0===v.length){var _=Math.max(2,Math.floor(y/200)),b=Math.max(1,Math.ceil(t.length/_));v=t.filter((function(e,r){return r%b===0||r===t.length-1})).map((function(e){var t=JD(e,1)[0],r=(s(t)/y).toFixed(4),n=t.toString();return f&&(n=function(e,t){if(!t)return e.toString();var r=t.match(/^(.*_val)(\.[0-9a-zA-Z%]+)$/);if(r){var n=r[1].replace(/_val/g,"(".concat(e,")")),i=r[2],a=e;try{a=jD(n)}catch(t){a=e}try{return Zr(i)(a)}catch(e){return a.toString()}}else try{return Zr(t)(e)}catch(t){return e.toString()}}(t,f)),[r,n]}))}v.forEach((function(t){var r=JD(t,2),n=r[0],i=r[1],a=Math.max(0,Math.min(1,parseFloat(n))),o=a*y,s="middle";a<=.05?s="start":a>=.95&&(s="end"),e.append("text").attr("x",o).attr("y",c+l+p/2).attr("text-anchor",s).attr("font-size",12).attr("fill","var(--mantine-color-text)").attr("dominant-baseline","middle").text(i)})),e.append("text").attr("x",y/2).attr("y",c/2).attr("text-anchor","middle").attr("font-size",14).attr("fill","var(--mantine-color-text)").attr("dominant-baseline","middle").text(i)}}),[n,o,i,l,y]),t().createElement("div",{ref:m,style:{width:"100%"}},t().createElement("svg",{ref:x,width:y||1,height:c+l+p,style:{display:"block"}}))};tT.propTypes={stops:i().object.isRequired,title:i().string,labels:i().object,barHeight:i().number,titleHeight:i().number,labelHeight:i().number,format:i().string};const rT=tT;var nT=["id","basemap","center","zoom","max_bounds","bearing","pitch","sources","layers","style","colorbar_map","colorbar_risk","setProps"];function iT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function aT(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?iT(Object(r),!0).forEach((function(t){oT(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iT(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oT(e,t,r){return(t=function(e){var t=function(e){if("object"!=cT(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=cT(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==cT(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sT(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||lT(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lT(e,t){if(e){if("string"==typeof e)return uT(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?uT(e,t):void 0}}function uT(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function cT(e){return cT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cT(e)}var hT={version:8,name:"Empty",sources:{},layers:[]};function pT(e,t){if(!e)return null;if("object"!==cT(e)||Array.isArray(e))return e;var r=Object.keys(e);if(!(r.length>0&&r.every((function(e){return!isNaN(Number(e))}))))return e;for(var n=r.map(Number).sort((function(e,t){return e-t})),i=null,a=0;a<n.length&&t>=n[a];a++)i=e[n[a]];return i}var dT=function(r){var n=r.id,i=r.basemap,a=void 0===i?hT:i,o=r.center,l=void 0===o?[0,0]:o,u=r.zoom,c=void 0===u?2:u,h=r.max_bounds,p=void 0===h?null:h,d=r.bearing,f=void 0===d?0:d,m=r.pitch,g=void 0===m?0:m,y=r.sources,v=void 0===y?{}:y,x=r.layers,_=void 0===x?[]:x,b=r.style,w=void 0===b?{}:b,A=r.colorbar_map,C=void 0===A?null:A,E=r.colorbar_risk,M=void 0===E?null:E,S=r.setProps,D=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(r,nT),T=(0,e.useRef)(null),N=(0,e.useRef)(null),I=(0,e.useRef)([]),P=sT((0,e.useState)((function(){return _.filter((function(e){return e.display_name})).map((function(e){return e.id}))})),2),z=P[0],B=P[1],k=sT((0,e.useState)(!1),2),F=k[0],R=k[1],O=(0,e.useRef)({center:l,zoom:c}),L=_.filter((function(e){return e.display_name})),q=sT((0,e.useState)(c),2),j=q[0],U=q[1];return(0,e.useEffect)((function(){return N.current||(N.current=new(s().Map)(aT({container:T.current,center:l,zoom:c,bearing:f,pitch:g,maxBounds:p},D)),window._map=N.current),function(){N.current&&(N.current.remove(),N.current=null)}}),[]),(0,e.useEffect)((function(){if(N.current){var e=N.current;return R(!1),I.current=[],e.on("idle",t),e.setStyle(a),function(){e.off("idle",t)}}function t(){R(!0),e.off("idle",t)}}),[a]),(0,e.useEffect)((function(){if(N.current&&F){var e=N.current;Object.entries(v).forEach((function(t){var r=sT(t,2),n=r[0],i=r[1];if(e.getSource(n))"geojson"===i.type&&e.getSource(n).setData(i.data);else try{e.addSource(n,i)}catch(e){console.error(e)}}))}}),[v,F]),(0,e.useEffect)((function(){if(N.current&&F){var e=N.current;I.current.forEach((function(t){var r=Boolean(e.getSource(t.source)),n=_.some((function(e){return e.id===t.id}));r&&n||!e.getLayer(t.id)||e.removeLayer(t.id)})),_.forEach((function(t,r){if(Boolean(e.getSource(t.source))){if(!e.getLayer(t.id)){for(var n=null,i=r+1;i<_.length;i++)if(e.getLayer(_[i].id)){n=_[i].id;break}try{e.addLayer(t,n)}catch(e){console.warn("addLayer failed",t.id,e)}}!function(e,t){var r=e.getLayer(t.id);if(r){var n=t.paint||{};Object.entries(n).forEach((function(r){var n=sT(r,2),i=n[0],a=n[1];try{e.getPaintProperty(t.id,i)!==a&&e.setPaintProperty(t.id,i,a)}catch(e){console.error(e)}}));var i=t.layout||{};if(Object.entries(i).forEach((function(r){var n=sT(r,2),i=n[0],a=n[1];try{e.getLayoutProperty(t.id,i)!==a&&e.setLayoutProperty(t.id,i,a)}catch(e){console.error(e)}})),"filter"in t)try{JSON.stringify(e.getFilter(t.id))!==JSON.stringify(t.filter)&&e.setFilter(t.id,t.filter)}catch(e){console.error(e)}if("minzoom"in t)try{r.minzoom!==t.minzoom&&e.setLayerZoomRange(t.id,t.minzoom,r.maxzoom)}catch(e){console.error(e)}if("maxzoom"in t)try{r.maxzoom!==t.maxzoom&&e.setLayerZoomRange(t.id,r.minzoom,t.maxzoom)}catch(e){console.error(e)}}}(e,t)}else console.warn("[DashMaplibre] Not adding app layer (missing source):",t.id,"source:",t.source)})),I.current=_.slice()}}),[_,v,F]),(0,e.useEffect)((function(){if(N.current){var e=N.current,t={},r={};return _.forEach((function(n){if(n.hover_html){var i=n.id,a=n.hover_html;r[i]={onMouseEnter:o,onMouseLeave:l},e.getLayer(i)&&(e.on("mouseenter",i,o),e.on("mouseleave",i,l))}function o(r){var n=r.features[0];e.getCanvas().style.cursor="pointer";var o=n.properties,l=function(e,t){return e.replace(/\{(\w+)(?::([.\d\w]+))?\}/g,(function(e,r,n){var i=t[r];if(null===i)return"";if(n&&"number"==typeof i){var a=n.match(/^\.([0-9]+)f$/);if(a){var o=parseInt(a[1],10);return i.toFixed(o)}var s=n.match(/^\.([0-9]+)e$/);if(s){var l=parseInt(s[1],10);return i.toExponential(l)}}return String(i)}))}(a,o);t[i]||(t[i]=new(s().Popup)({closeButton:!1,closeOnClick:!1})),t[i].setLngLat(n.geometry.coordinates).setHTML(l).addTo(e)}function l(){e.getCanvas().style.cursor="",t[i]&&t[i].remove()}})),function(){_.forEach((function(n){if(n.hover_html){var i=n.id,a=r[i];a&&e.getLayer(i)&&(e.off("mouseenter",i,a.onMouseEnter),e.off("mouseleave",i,a.onMouseLeave)),t[i]&&(t[i].remove(),delete t[i])}}))}}}),[_,v,F]),(0,e.useEffect)((function(){if(N.current&&F){var e=N.current;if(l&&"number"==typeof c&&(O.current={center:l,zoom:c}),l){var t=e.getCenter();t.lng===l[0]&&t.lat===l[1]||e.setCenter(l)}"number"==typeof c&&e.getZoom()!==c&&e.setZoom(c),"number"==typeof f&&e.getBearing()!==f&&e.setBearing(f),"number"==typeof g&&e.getPitch()!==g&&e.setPitch(g)}}),[l,c,f,g,F]),(0,e.useEffect)((function(){N.current&&_.forEach((function(e){e.display_name&&N.current.getLayer(e.id)&&N.current.setLayoutProperty(e.id,"visibility",z.includes(e.id)?"visible":"none")}))}),[z,_,F]),(0,e.useEffect)((function(){var e=_.filter((function(e){return e.display_name})).map((function(e){return e.id}));B((function(t){return t.length===e.length&&t.every((function(t,r){return t===e[r]}))?t:e}))}),[_]),(0,e.useEffect)((function(){if(N.current){var e=N.current;return e.doubleClickZoom.disable(),e.on("dblclick",t),function(){e.off("dblclick",t)}}function t(t){O.current&&e.flyTo({center:O.current.center,zoom:O.current.zoom,bearing:0,pitch:0})}}),[]),(0,e.useEffect)((function(){if(N.current){var e=N.current,t={};return _.forEach((function(r){if(r.send_click){var n=r.id;t[n]=i,e.getLayer(n)&&e.on("click",n,i)}function i(e){S&&e.features&&e.features.length>0&&S({clickData:{layer:n,features:e.features.map((function(e){return{properties:e.properties}}))}})}})),function(){_.forEach((function(r){if(r.send_click){var n=r.id,i=t[n];i&&e.getLayer(n)&&e.off("click",n,i)}}))}}}),[_,v,F]),(0,e.useEffect)((function(){if(N.current){var e=N.current;return e.on("zoom",t),U(e.getZoom()),function(){e.off("zoom",t)}}function t(){U(e.getZoom())}}),[F]),t().createElement("div",{style:aT({width:"100%",height:"100%",display:"flex",flexDirection:"column"},w),id:n},t().createElement("div",{style:{flex:1,minHeight:0,minWidth:0,position:"relative",display:"flex",flexDirection:"column"}},t().createElement("div",{style:{display:"flex",flexDirection:"row",gap:24,width:"100%",maxWidth:"100%",alignItems:"stretch"}},pT(C,j)&&t().createElement("div",{style:{flex:"1 1 0",minWidth:0,padding:"0 8px"}},t().createElement(rT,pT(C,j))),M&&t().createElement("div",{style:{flex:"1 1 0",minWidth:0,padding:"0 8px"}},t().createElement(rT,M))),t().createElement("div",{ref:T,style:{width:"100%",height:"100%",flex:1,minHeight:0,minWidth:0,position:"relative"}},L.length>0&&function(e,r,n){return t().createElement("div",{style:{position:"absolute",top:0,left:0,background:"var(--mantine-color-body)",padding:6,zIndex:10,boxShadow:"0 2px 8px rgba(0,0,0,0.13)",minWidth:120}},e.map((function(e){var i,a,o,s=(null===(i=e.paint)||void 0===i?void 0:i["circle-color"])||(null===(a=e.paint)||void 0===a?void 0:a["fill-color"])||(null===(o=e.paint)||void 0===o?void 0:o["line-color"])||"#ccc";Array.isArray(s)&&(s="#ccc");var l;return l="circle"===e.type?t().createElement("span",{style:{display:"inline-block",width:12,height:12,borderRadius:6,marginRight:13,marginLeft:3,background:s}}):"fill"===e.type?t().createElement("span",{style:{display:"inline-block",width:20,height:12,marginRight:10,background:s}}):"line"===e.type?t().createElement("svg",{width:20,height:16,style:{marginRight:10,verticalAlign:"middle"}},t().createElement("line",{x1:2,y1:8,x2:18,y2:8,stroke:s,strokeWidth:4})):t().createElement("span",{style:{display:"inline-block",width:20,height:12,marginRight:10,background:"#ccc",border:"1px solid #999"}}),t().createElement("div",{key:e.id,style:{display:"flex",alignItems:"center",cursor:"pointer",fontWeight:"normal",opacity:r.includes(e.id)?1:.5,userSelect:"none"},onClick:function(){n((function(t){return t.includes(e.id)?t.filter((function(t){return t!==e.id})):[].concat(function(e){if(Array.isArray(e))return uT(e)}(r=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||lT(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[e.id]);var r}))},title:e.id},l,t().createElement("span",null,e.display_name))})))}(L,z,B))))};dT.propTypes={id:i().string,basemap:i().oneOfType([i().string,i().object]),center:i().array,zoom:i().number,max_bounds:i().array,bearing:i().number,pitch:i().number,sources:i().object,layers:i().array,style:i().object,colorbar_map:i().oneOfType([i().object,i().shape({})]),colorbar_risk:i().object,setProps:i().func};const fT=dT})(),window.dash_maplibre=o})();
//# sourceMappingURL=dash_maplibre.min.js.map